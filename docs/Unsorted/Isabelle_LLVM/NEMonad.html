<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory NEMonad</title>
</head>


<body>
<div class="head">
<h1>Theory NEMonad</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Nondeterminism Error Monad›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
  The NE monad used as basis for the state-error monad in our LLVM semantics.
  Note: for abstract programs, we use an (equivalent) monad (nres), defined in
  the original Monadic Refinement Framework. 
  That's for legacy reasons, and needs to be unified at some point!
›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><a href="NEMonad.html"><span>NEMonad</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> </span><span class="quoted"><span>"</span><a href="Basic_Imports.html"><span>../Basic_Imports</span></a><span>"</span></span><span> </span><a href="Flat_CCPO.html"><span>Flat_CCPO</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Additions to Partial Function›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>context</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.partial_function_definitions|locale"><span>partial_function_definitions</span></a><span>
  </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.tailrec.monotoneI|fact"><span class="entity_def" id="NEMonad.option.monotoneI|fact"><span class="entity_def" id="NEMonad.partial_function_definitions.monotoneI|fact"><span class="entity_def" id="NEMonad.option.monotoneI|thm"><span class="entity_def" id="NEMonad.tailrec.monotoneI|thm"><span class="entity_def" id="NEMonad.partial_function_definitions.monotoneI|thm"><span>monotoneI</span></span></span></span></span></span></span><span class="main"><span>:</span></span><span>
      </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>mono_body</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>f</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>F</span></span><span> </span><span class="bound"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.monotone|const"><span>monotone</span></a><span> </span><span>le_fun</span><span> </span><span>le_fun</span><span> </span><span class="free"><span>F</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.monotone_def|fact"><span>monotone_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_ord_def|fact"><span>fun_ord_def</span></a><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_607..612">lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.tailrec.fp_unfold|fact"><span class="entity_def" id="NEMonad.option.fp_unfold|fact"><span class="entity_def" id="NEMonad.partial_function_definitions.fp_unfold|fact"><span class="entity_def" id="NEMonad.option.fp_unfold|thm"><span class="entity_def" id="NEMonad.tailrec.fp_unfold|thm"><span class="entity_def" id="NEMonad.partial_function_definitions.fp_unfold|thm"><span>fp_unfold</span></span></span></span></span></span></span><span class="main"><span>:</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span>fixp_fun</span><span> </span><span class="free"><span>F</span></span><span>"</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>mono_body</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>f</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>F</span></span><span> </span><span class="bound"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>F</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#offset_607..612"><span>assms</span></a><span> </span><span>mono_body_fixp</span><span class="main"><span>[</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="free"><span>F</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.fun_ordD|fact"><span class="entity_def" id="NEMonad.fun_ordD|thm"><span>fun_ordD</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_ord|const"><span>fun_ord</span></a><span> </span><span class="free"><span>le</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>g</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>le</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>g</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_ord_def|fact"><span>fun_ord_def</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.fun_ord_mono_alt|fact"><span class="entity_def" id="NEMonad.fun_ord_mono_alt|thm"><span>fun_ord_mono_alt</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.monotone|const"><span>monotone</span></a><span> </span><span class="free"><span>le</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_ord|const"><span>fun_ord</span></a><span> </span><span class="free"><span>le'</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.monotone|const"><span>monotone</span></a><span> </span><span class="free"><span>le</span></span><span> </span><span class="free"><span>le'</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>mono_tags</span><span class="main"><span class="main"><span>,</span></span></span><span> lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_ord_def|fact"><span>fun_ord_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.monotone_def|fact"><span>monotone_def</span></a><span class="main"><span>)</span></span><span>



  </span><span class="keyword1"><span class="command"><span>method_setup</span></span></span><span> </span><span class="entity_def" id="NEMonad.pf_mono_prover|method"><span>pf_mono_prover</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span>‹</span><span>Scan.succeed</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>SIMPLE_METHOD'</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Subgoal.FOCUS_PREMS</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>{</span></span><span>context</span><span class="main"><span>=</span></span><span class="entity"><span>ctxt</span></span><span class="main"><span>,</span></span><span class="main"><span>...</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>CHANGED</span><span> </span><span class="main"><span>(</span></span><span>ALLGOALS</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Partial_Function.mono_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>›</span></span><span>

  </span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹
    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>discharge_monos</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>aux</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
        </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>prems</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Thm.prems_of</span><span> </span><span class="entity"><span>thm</span></span><span>

        </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>prove_simple</span></span><span> </span><span class="entity"><span>tac</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Goal.prove</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>{</span></span><span>context</span><span class="main"><span>=</span></span><span class="entity"><span>ctxt</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>...</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>ALLGOALS</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>


        </span><span class="comment1"><span>(*val mono_tac = Subgoal.FOCUS (fn {context=ctxt,...} =&gt; CHANGED (ALLGOALS (Partial_Function.mono_tac ctxt)))*)</span></span><span>
        </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>mono_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>CHANGED</span><span> </span><span>o</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Partial_Function.mono_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span>

        </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>cinst</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>t</span></span><span> </span><span class="keyword1"><span class="keyword"><span>as</span></span></span><span> </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>mpat</span></span><span> </span><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.monotone|const"><span>monotone</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_ord|const"><span>fun_ord</span></a><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>_</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>the_default</span><span> </span><span>asm_rl</span><span> </span><span class="main"><span>(</span></span><span>try</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>prove_simple</span></span><span> </span><span class="entity"><span>mono_tac</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span>
          </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>cinst</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>asm_rl</span><span>

        </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>insts</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>map</span><span> </span><span class="entity"><span>cinst</span></span><span> </span><span class="entity"><span>prems</span></span><span>

        </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>thm</span></span><span> </span><span>OF</span><span> </span><span class="entity"><span>insts</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
        </span><span class="entity"><span>thm</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
      </span><span class="comment1"><span>(* Avoid surprises with schematic variables being instantiated *)</span></span><span>
      </span><span>singleton</span><span> </span><span class="main"><span>(</span></span><span>Variable.trade</span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span>o</span><span> </span><span class="entity"><span>aux</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>thm</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

  ›</span></span><span>

  </span><span class="keyword1"><span class="command"><span>attribute_setup</span></span></span><span> </span><span class="entity_def" id="NEMonad.discharge_monos|attribute"><span>discharge_monos</span></span><span>
    </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span>‹</span><span>Scan.succeed</span><span> </span><span class="main"><span>(</span></span><span>Thm.rule_attribute</span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>discharge_monos</span></span><span> </span><span>o</span><span> </span><span>Context.proof_of</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>›</span></span><span>
    </span><span class="quoted"><span>‹Try to discharge monotonicity premises›</span></span><span>



  </span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Type Definition›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
    The result of a nondeterministic computation
  ›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="NEMonad.arity_full_exhaustive_neM|fact"><span class="entity_def" id="NEMonad.neM.full_exhaustive_neM.simps|fact"><span class="entity_def" id="NEMonad.full_exhaustive_neM_inst.full_exhaustive_neM|fact"><span class="entity_def" id="NEMonad.arity_random_neM|fact"><span class="entity_def" id="NEMonad.random_neM_def|fact"><span class="entity_def" id="NEMonad.random_neM_inst.random_neM|fact"><span class="entity_def" id="NEMonad.neM.random_aux.simps|fact"><span class="entity_def" id="NEMonad.random_aux_neM_def|fact"><span class="entity_def" id="NEMonad.neM.size_neq|fact"><span class="entity_def" id="NEMonad.neM.size_gen|fact"><span class="entity_def" id="NEMonad.neM.size|fact"><span class="entity_def" id="NEMonad.arity_size_neM|fact"><span class="entity_def" id="NEMonad.neM.size_neM_overloaded_def|fact"><span class="entity_def" id="NEMonad.size_neM_inst.size_neM|fact"><span class="entity_def" id="NEMonad.neM.size_neM_def|fact"><span class="entity_def" id="NEMonad.neM.simps|fact"><span class="entity_def" id="NEMonad.neM.rec_transfer|fact"><span class="entity_def" id="NEMonad.neM.rec|fact"><span class="entity_def" id="NEMonad.neM.induct|fact"><span class="entity_def" id="NEMonad.neM.case_transfer|fact"><span class="entity_def" id="NEMonad.neM.splits|fact"><span class="entity_def" id="NEMonad.neM.split_sels|fact"><span class="entity_def" id="NEMonad.neM.split_sel_asm|fact"><span class="entity_def" id="NEMonad.neM.split_sel|fact"><span class="entity_def" id="NEMonad.neM.split_asm|fact"><span class="entity_def" id="NEMonad.neM.split|fact"><span class="entity_def" id="NEMonad.neM.sel|fact"><span class="entity_def" id="NEMonad.neM.nchotomy|fact"><span class="entity_def" id="NEMonad.neM.inject|fact"><span class="entity_def" id="NEMonad.neM.expand|fact"><span class="entity_def" id="NEMonad.neM.exhaust_sel|fact"><span class="entity_def" id="NEMonad.neM.exhaust_disc|fact"><span class="entity_def" id="NEMonad.neM.exhaust|fact"><span class="entity_def" id="NEMonad.neM.distinct|fact"><span class="entity_def" id="NEMonad.neM.discI|fact"><span class="entity_def" id="NEMonad.neM.disc_eq_case|fact"><span class="entity_def" id="NEMonad.neM.collapse|fact"><span class="entity_def" id="NEMonad.neM.case_eq_if|fact"><span class="entity_def" id="NEMonad.neM.case_distrib|fact"><span class="entity_def" id="NEMonad.neM.case_cong_weak|fact"><span class="entity_def" id="NEMonad.neM.case_cong|fact"><span class="entity_def" id="NEMonad.neM.case|fact"><span class="entity_def" id="NEMonad.neM.eq.simps|fact"><span class="entity_def" id="NEMonad.neM.eq.refl|fact"><span class="entity_def" id="NEMonad.arity_equal_neM|fact"><span class="entity_def" id="NEMonad.equal_neM_def|fact"><span class="entity_def" id="NEMonad.equal_neM_inst.equal_neM|fact"><span class="entity_def" id="NEMonad.arity_partial_term_of_neM|fact"><span class="entity_def" id="NEMonad.partial_term_of_neM_triv|fact"><span class="entity_def" id="NEMonad.partial_term_of_neM_inst.partial_term_of_neM|fact"><span class="entity_def" id="NEMonad.arity_term_of_neM|fact"><span class="entity_def" id="NEMonad.term_of_neM_triv|fact"><span class="entity_def" id="NEMonad.term_of_neM_inst.term_of_neM|fact"><span class="entity_def" id="NEMonad.neM.the_spec_def|fact"><span class="entity_def" id="NEMonad.neM.case_neM_def|fact"><span class="entity_def" id="NEMonad.neM.ctor_rec_neM_def|fact"><span class="entity_def" id="NEMonad.neM.dtor_neM_def|fact"><span class="entity_def" id="NEMonad.neM.ctor_fold_neM_def|fact"><span class="entity_def" id="NEMonad.neM.ctor_neM_def|fact"><span class="entity_def" id="NEMonad.arity_typerep_neM|fact"><span class="entity_def" id="NEMonad.typerep_neM_def|fact"><span class="entity_def" id="NEMonad.typerep_neM_inst.typerep_neM|fact"><span class="entity_def" id="NEMonad.neM.Abs_neM_induct|fact"><span class="entity_def" id="NEMonad.neM.Rep_neM_induct|fact"><span class="entity_def" id="NEMonad.neM.Abs_neM_cases|fact"><span class="entity_def" id="NEMonad.neM.Rep_neM_cases|fact"><span class="entity_def" id="NEMonad.neM.Abs_neM_inject|fact"><span class="entity_def" id="NEMonad.neM.Rep_neM_inject|fact"><span class="entity_def" id="NEMonad.neM.Abs_neM_inverse|fact"><span class="entity_def" id="NEMonad.neM.Rep_neM_inverse|fact"><span class="entity_def" id="NEMonad.neM.Rep_neM|fact"><span class="entity_def" id="NEMonad.neM.type_definition_neM|fact"><span class="entity_def" id="NEMonad.arity_type_neM|fact"><span class="entity_def" id="NEMonad.neM.str_init_neM_def|fact"><span class="entity_def" id="NEMonad.neM.arity_typerep_neM_IITN_neM|fact"><span class="entity_def" id="NEMonad.neM.typerep_neM_IITN_neM_def|fact"><span class="entity_def" id="NEMonad.neM.typerep_neM_IITN_neM_inst.typerep_neM_IITN_neM|fact"><span class="entity_def" id="NEMonad.neM.neM_IITN_neM.Abs_neM_IITN_neM_induct|fact"><span class="entity_def" id="NEMonad.neM.neM_IITN_neM.Rep_neM_IITN_neM_induct|fact"><span class="entity_def" id="NEMonad.neM.neM_IITN_neM.Abs_neM_IITN_neM_cases|fact"><span class="entity_def" id="NEMonad.neM.neM_IITN_neM.Rep_neM_IITN_neM_cases|fact"><span class="entity_def" id="NEMonad.neM.neM_IITN_neM.Abs_neM_IITN_neM_inject|fact"><span class="entity_def" id="NEMonad.neM.neM_IITN_neM.Rep_neM_IITN_neM_inject|fact"><span class="entity_def" id="NEMonad.neM.neM_IITN_neM.Abs_neM_IITN_neM_inverse|fact"><span class="entity_def" id="NEMonad.neM.neM_IITN_neM.Rep_neM_IITN_neM_inverse|fact"><span class="entity_def" id="NEMonad.neM.neM_IITN_neM.Rep_neM_IITN_neM|fact"><span class="entity_def" id="NEMonad.neM.neM_IITN_neM.type_definition_neM_IITN_neM|fact"><span class="entity_def" id="NEMonad.arity_type_neM_IITN_neM|fact"><span class="entity_def" id="NEMonad.neM.min_alg_neM_def|fact"><span class="entity_def" id="NEMonad.neM.mor_neM_def|fact"><span class="entity_def" id="NEMonad.neM.alg_neM_def|fact"><span class="entity_def" id="NEMonad.pre_neM.neM.set_pre_neM_def|fact"><span class="entity_def" id="NEMonad.pre_neM.neM.rel_pre_neM_def|fact"><span class="entity_def" id="NEMonad.pre_neM.neM.map_pre_neM_def|fact"><span class="entity_def" id="NEMonad.neM.arity_typerep_neM_pre_neM_bdT|fact"><span class="entity_def" id="NEMonad.neM.typerep_neM_pre_neM_bdT_def|fact"><span class="entity_def" id="NEMonad.neM.typerep_neM_pre_neM_bdT_inst.typerep_neM_pre_neM_bdT|fact"><span class="entity_def" id="NEMonad.neM.neM_pre_neM_bdT.Abs_neM_pre_neM_bdT_induct|fact"><span class="entity_def" id="NEMonad.neM.neM_pre_neM_bdT.Rep_neM_pre_neM_bdT_induct|fact"><span class="entity_def" id="NEMonad.neM.neM_pre_neM_bdT.Abs_neM_pre_neM_bdT_cases|fact"><span class="entity_def" id="NEMonad.neM.neM_pre_neM_bdT.Rep_neM_pre_neM_bdT_cases|fact"><span class="entity_def" id="NEMonad.neM.neM_pre_neM_bdT.Abs_neM_pre_neM_bdT_inject|fact"><span class="entity_def" id="NEMonad.neM.neM_pre_neM_bdT.Rep_neM_pre_neM_bdT_inject|fact"><span class="entity_def" id="NEMonad.neM.neM_pre_neM_bdT.Abs_neM_pre_neM_bdT_inverse|fact"><span class="entity_def" id="NEMonad.neM.neM_pre_neM_bdT.Rep_neM_pre_neM_bdT_inverse|fact"><span class="entity_def" id="NEMonad.neM.neM_pre_neM_bdT.Rep_neM_pre_neM_bdT|fact"><span class="entity_def" id="NEMonad.neM.neM_pre_neM_bdT.type_definition_neM_pre_neM_bdT|fact"><span class="entity_def" id="NEMonad.arity_type_neM_pre_neM_bdT|fact"><span class="entity_def" id="NEMonad.arity_full_exhaustive_neM|thm"><span class="entity_def" id="NEMonad.neM.full_exhaustive_neM.simps|thm"><span class="entity_def" id="NEMonad.full_exhaustive_neM_inst.full_exhaustive_neM|thm"><span class="entity_def" id="NEMonad.arity_random_neM|thm"><span class="entity_def" id="NEMonad.random_neM_def|thm"><span class="entity_def" id="NEMonad.random_neM_inst.random_neM|thm"><span class="entity_def" id="NEMonad.neM.random_aux.simps|thm"><span class="entity_def" id="NEMonad.random_aux_neM_def|thm"><span class="entity_def" id="NEMonad.neM.size_neq|thm"><span class="entity_def" id="NEMonad.neM.size_gen(2)|thm"><span class="entity_def" id="NEMonad.neM.size_gen(1)|thm"><span class="entity_def" id="NEMonad.neM.size(4)|thm"><span class="entity_def" id="NEMonad.neM.size(3)|thm"><span class="entity_def" id="NEMonad.neM.size(2)|thm"><span class="entity_def" id="NEMonad.neM.size(1)|thm"><span class="entity_def" id="NEMonad.arity_size_neM|thm"><span class="entity_def" id="NEMonad.neM.size_neM_overloaded_def|thm"><span class="entity_def" id="NEMonad.size_neM_inst.size_neM|thm"><span class="entity_def" id="NEMonad.neM.size_neM_def|thm"><span class="entity_def" id="NEMonad.neM.simps(7)|thm"><span class="entity_def" id="NEMonad.neM.simps(6)|thm"><span class="entity_def" id="NEMonad.neM.simps(5)|thm"><span class="entity_def" id="NEMonad.neM.simps(4)|thm"><span class="entity_def" id="NEMonad.neM.simps(3)|thm"><span class="entity_def" id="NEMonad.neM.simps(2)|thm"><span class="entity_def" id="NEMonad.neM.simps(1)|thm"><span class="entity_def" id="NEMonad.neM.rec_transfer|thm"><span class="entity_def" id="NEMonad.neM.rec(2)|thm"><span class="entity_def" id="NEMonad.neM.rec(1)|thm"><span class="entity_def" id="NEMonad.neM.induct|thm"><span class="entity_def" id="NEMonad.neM.case_transfer|thm"><span class="entity_def" id="NEMonad.neM.splits(2)|thm"><span class="entity_def" id="NEMonad.neM.splits(1)|thm"><span class="entity_def" id="NEMonad.neM.split_sels(2)|thm"><span class="entity_def" id="NEMonad.neM.split_sels(1)|thm"><span class="entity_def" id="NEMonad.neM.split_sel_asm|thm"><span class="entity_def" id="NEMonad.neM.split_sel|thm"><span class="entity_def" id="NEMonad.neM.split_asm|thm"><span class="entity_def" id="NEMonad.neM.split|thm"><span class="entity_def" id="NEMonad.neM.sel|thm"><span class="entity_def" id="NEMonad.neM.nchotomy|thm"><span class="entity_def" id="NEMonad.neM.inject|thm"><span class="entity_def" id="NEMonad.neM.expand|thm"><span class="entity_def" id="NEMonad.neM.exhaust_sel|thm"><span class="entity_def" id="NEMonad.neM.exhaust_disc|thm"><span class="entity_def" id="NEMonad.neM.exhaust|thm"><span class="entity_def" id="NEMonad.neM.distinct(2)|thm"><span class="entity_def" id="NEMonad.neM.distinct(1)|thm"><span class="entity_def" id="NEMonad.neM.discI|thm"><span class="entity_def" id="NEMonad.neM.disc_eq_case(2)|thm"><span class="entity_def" id="NEMonad.neM.disc_eq_case(1)|thm"><span class="entity_def" id="NEMonad.neM.collapse|thm"><span class="entity_def" id="NEMonad.neM.case_eq_if|thm"><span class="entity_def" id="NEMonad.neM.case_distrib|thm"><span class="entity_def" id="NEMonad.neM.case_cong_weak|thm"><span class="entity_def" id="NEMonad.neM.case_cong|thm"><span class="entity_def" id="NEMonad.neM.case(2)|thm"><span class="entity_def" id="NEMonad.neM.case(1)|thm"><span class="entity_def" id="NEMonad.neM.eq.simps(6)|thm"><span class="entity_def" id="NEMonad.neM.eq.simps(5)|thm"><span class="entity_def" id="NEMonad.neM.eq.simps(4)|thm"><span class="entity_def" id="NEMonad.neM.eq.simps(3)|thm"><span class="entity_def" id="NEMonad.neM.eq.simps(2)|thm"><span class="entity_def" id="NEMonad.neM.eq.simps(1)|thm"><span class="entity_def" id="NEMonad.neM.eq.refl|thm"><span class="entity_def" id="NEMonad.arity_equal_neM|thm"><span class="entity_def" id="NEMonad.equal_neM_def|thm"><span class="entity_def" id="NEMonad.equal_neM_inst.equal_neM|thm"><span class="entity_def" id="NEMonad.arity_partial_term_of_neM|thm"><span class="entity_def" id="NEMonad.partial_term_of_neM_triv|thm"><span class="entity_def" id="NEMonad.partial_term_of_neM_inst.partial_term_of_neM|thm"><span class="entity_def" id="NEMonad.arity_term_of_neM|thm"><span class="entity_def" id="NEMonad.term_of_neM_triv|thm"><span class="entity_def" id="NEMonad.term_of_neM_inst.term_of_neM|thm"><span class="entity_def" id="NEMonad.neM.the_spec_def|thm"><span class="entity_def" id="NEMonad.neM.case_neM_def|thm"><span class="entity_def" id="NEMonad.neM.ctor_rec_neM_def|thm"><span class="entity_def" id="NEMonad.neM.dtor_neM_def|thm"><span class="entity_def" id="NEMonad.neM.ctor_fold_neM_def|thm"><span class="entity_def" id="NEMonad.neM.ctor_neM_def|thm"><span class="entity_def" id="NEMonad.arity_typerep_neM|thm"><span class="entity_def" id="NEMonad.typerep_neM_def|thm"><span class="entity_def" id="NEMonad.typerep_neM_inst.typerep_neM|thm"><span class="entity_def" id="NEMonad.neM.Abs_neM_induct|thm"><span class="entity_def" id="NEMonad.neM.Rep_neM_induct|thm"><span class="entity_def" id="NEMonad.neM.Abs_neM_cases|thm"><span class="entity_def" id="NEMonad.neM.Rep_neM_cases|thm"><span class="entity_def" id="NEMonad.neM.Abs_neM_inject|thm"><span class="entity_def" id="NEMonad.neM.Rep_neM_inject|thm"><span class="entity_def" id="NEMonad.neM.Abs_neM_inverse|thm"><span class="entity_def" id="NEMonad.neM.Rep_neM_inverse|thm"><span class="entity_def" id="NEMonad.neM.Rep_neM|thm"><span class="entity_def" id="NEMonad.neM.type_definition_neM|thm"><span class="entity_def" id="NEMonad.arity_type_neM|thm"><span class="entity_def" id="NEMonad.neM.str_init_neM_def|thm"><span class="entity_def" id="NEMonad.neM.arity_typerep_neM_IITN_neM|thm"><span class="entity_def" id="NEMonad.neM.typerep_neM_IITN_neM_def|thm"><span class="entity_def" id="NEMonad.neM.typerep_neM_IITN_neM_inst.typerep_neM_IITN_neM|thm"><span class="entity_def" id="NEMonad.neM.neM_IITN_neM.Abs_neM_IITN_neM_induct|thm"><span class="entity_def" id="NEMonad.neM.neM_IITN_neM.Rep_neM_IITN_neM_induct|thm"><span class="entity_def" id="NEMonad.neM.neM_IITN_neM.Abs_neM_IITN_neM_cases|thm"><span class="entity_def" id="NEMonad.neM.neM_IITN_neM.Rep_neM_IITN_neM_cases|thm"><span class="entity_def" id="NEMonad.neM.neM_IITN_neM.Abs_neM_IITN_neM_inject|thm"><span class="entity_def" id="NEMonad.neM.neM_IITN_neM.Rep_neM_IITN_neM_inject|thm"><span class="entity_def" id="NEMonad.neM.neM_IITN_neM.Abs_neM_IITN_neM_inverse|thm"><span class="entity_def" id="NEMonad.neM.neM_IITN_neM.Rep_neM_IITN_neM_inverse|thm"><span class="entity_def" id="NEMonad.neM.neM_IITN_neM.Rep_neM_IITN_neM|thm"><span class="entity_def" id="NEMonad.neM.neM_IITN_neM.type_definition_neM_IITN_neM|thm"><span class="entity_def" id="NEMonad.arity_type_neM_IITN_neM|thm"><span class="entity_def" id="NEMonad.neM.min_alg_neM_def|thm"><span class="entity_def" id="NEMonad.neM.mor_neM_def|thm"><span class="entity_def" id="NEMonad.neM.alg_neM_def|thm"><span class="entity_def" id="NEMonad.pre_neM.neM.set_pre_neM_def|thm"><span class="entity_def" id="NEMonad.pre_neM.neM.rel_pre_neM_def|thm"><span class="entity_def" id="NEMonad.pre_neM.neM.map_pre_neM_def|thm"><span class="entity_def" id="NEMonad.neM.arity_typerep_neM_pre_neM_bdT|thm"><span class="entity_def" id="NEMonad.neM.typerep_neM_pre_neM_bdT_def|thm"><span class="entity_def" id="NEMonad.neM.typerep_neM_pre_neM_bdT_inst.typerep_neM_pre_neM_bdT|thm"><span class="entity_def" id="NEMonad.neM.neM_pre_neM_bdT.Abs_neM_pre_neM_bdT_induct|thm"><span class="entity_def" id="NEMonad.neM.neM_pre_neM_bdT.Rep_neM_pre_neM_bdT_induct|thm"><span class="entity_def" id="NEMonad.neM.neM_pre_neM_bdT.Abs_neM_pre_neM_bdT_cases|thm"><span class="entity_def" id="NEMonad.neM.neM_pre_neM_bdT.Rep_neM_pre_neM_bdT_cases|thm"><span class="entity_def" id="NEMonad.neM.neM_pre_neM_bdT.Abs_neM_pre_neM_bdT_inject|thm"><span class="entity_def" id="NEMonad.neM.neM_pre_neM_bdT.Rep_neM_pre_neM_bdT_inject|thm"><span class="entity_def" id="NEMonad.neM.neM_pre_neM_bdT.Abs_neM_pre_neM_bdT_inverse|thm"><span class="entity_def" id="NEMonad.neM.neM_pre_neM_bdT.Rep_neM_pre_neM_bdT_inverse|thm"><span class="entity_def" id="NEMonad.neM.neM_pre_neM_bdT.Rep_neM_pre_neM_bdT|thm"><span class="entity_def" id="NEMonad.neM.neM_pre_neM_bdT.type_definition_neM_pre_neM_bdT|thm"><span class="entity_def" id="NEMonad.arity_type_neM_pre_neM_bdT|thm"><span class="entity_def" id="NEMonad.full_exhaustive_neM_def|axiom"><span class="entity_def" id="NEMonad.full_exhaustive_neM_inst.full_exhaustive_neM_def|axiom"><span class="entity_def" id="NEMonad.random_neM_def_raw|axiom"><span class="entity_def" id="NEMonad.random_neM_inst.random_neM_def|axiom"><span class="entity_def" id="NEMonad.random_aux_neM_def|axiom"><span class="entity_def" id="NEMonad.neM.size_neM_overloaded_def|axiom"><span class="entity_def" id="NEMonad.size_neM_inst.size_neM_def|axiom"><span class="entity_def" id="NEMonad.neM.size_neM_def|axiom"><span class="entity_def" id="NEMonad.neM.rec_neM_def|axiom"><span class="entity_def" id="NEMonad.equal_neM_def_raw|axiom"><span class="entity_def" id="NEMonad.equal_neM_inst.equal_neM_def|axiom"><span class="entity_def" id="NEMonad.partial_term_of_neM_triv_raw|axiom"><span class="entity_def" id="NEMonad.partial_term_of_neM_inst.partial_term_of_neM_def|axiom"><span class="entity_def" id="NEMonad.term_of_neM_triv_raw|axiom"><span class="entity_def" id="NEMonad.term_of_neM_inst.term_of_neM_def|axiom"><span class="entity_def" id="NEMonad.neM.the_spec_def_raw|axiom"><span class="entity_def" id="NEMonad.neM.case_neM_def|axiom"><span class="entity_def" id="NEMonad.neM.FAIL_def|axiom"><span class="entity_def" id="NEMonad.neM.SPEC_def|axiom"><span class="entity_def" id="NEMonad.neM.ctor_rec_neM_def|axiom"><span class="entity_def" id="NEMonad.neM.dtor_neM_def|axiom"><span class="entity_def" id="NEMonad.neM.ctor_fold_neM_def|axiom"><span class="entity_def" id="NEMonad.neM.ctor_neM_def|axiom"><span class="entity_def" id="NEMonad.typerep_neM_def_raw|axiom"><span class="entity_def" id="NEMonad.typerep_neM_inst.typerep_neM_def|axiom"><span class="entity_def" id="NEMonad.neM.type_definition_neM|axiom"><span class="entity_def" id="NEMonad.arity_type_neM|axiom"><span class="entity_def" id="NEMonad.neM.str_init_neM_def|axiom"><span class="entity_def" id="NEMonad.neM.typerep_neM_IITN_neM_def_raw|axiom"><span class="entity_def" id="NEMonad.neM.typerep_neM_IITN_neM_inst.typerep_neM_IITN_neM_def|axiom"><span class="entity_def" id="NEMonad.neM.neM_IITN_neM.type_definition_neM_IITN_neM|axiom"><span class="entity_def" id="NEMonad.arity_type_neM_IITN_neM|axiom"><span class="entity_def" id="NEMonad.neM.min_alg_neM_def|axiom"><span class="entity_def" id="NEMonad.neM.mor_neM_def|axiom"><span class="entity_def" id="NEMonad.neM.alg_neM_def|axiom"><span class="entity_def" id="NEMonad.pre_neM.neM.wit_pre_neM_def|axiom"><span class="entity_def" id="NEMonad.pre_neM.neM.pred_pre_neM_def|axiom"><span class="entity_def" id="NEMonad.pre_neM.neM.rel_pre_neM_def|axiom"><span class="entity_def" id="NEMonad.pre_neM.neM.bd_pre_neM_def|axiom"><span class="entity_def" id="NEMonad.pre_neM.neM.set_pre_neM_def|axiom"><span class="entity_def" id="NEMonad.pre_neM.neM.map_pre_neM_def|axiom"><span class="entity_def" id="NEMonad.neM.typerep_neM_pre_neM_bdT_def_raw|axiom"><span class="entity_def" id="NEMonad.neM.typerep_neM_pre_neM_bdT_inst.typerep_neM_pre_neM_bdT_def|axiom"><span class="entity_def" id="NEMonad.neM.neM_pre_neM_bdT.type_definition_neM_pre_neM_bdT|axiom"><span class="entity_def" id="NEMonad.arity_type_neM_pre_neM_bdT|axiom"><span class="entity_def" id="NEMonad.full_exhaustive_neM_inst.full_exhaustive_neM|const"><span class="entity_def" id="NEMonad.random_neM_inst.random_neM|const"><span class="entity_def" id="NEMonad.random_aux_neM|const"><span class="entity_def" id="NEMonad.size_neM_inst.size_neM|const"><span class="entity_def" id="NEMonad.neM.size_neM|const"><span class="entity_def" id="NEMonad.equal_neM_inst.equal_neM|const"><span class="entity_def" id="NEMonad.partial_term_of_neM_inst.partial_term_of_neM|const"><span class="entity_def" id="NEMonad.term_of_neM_inst.term_of_neM|const"><span class="entity_def" id="NEMonad.neM.case_neM|const"><span class="entity_def" id="NEMonad.typerep_neM_inst.typerep_neM|const"><span class="entity_def" id="NEMonad.neM.Abs_neM|const"><span class="entity_def" id="NEMonad.neM.Rep_neM|const"><span class="entity_def" id="NEMonad.neM.typerep_neM_IITN_neM_inst.typerep_neM_IITN_neM|const"><span class="entity_def" id="NEMonad.neM.neM_IITN_neM.Abs_neM_IITN_neM|const"><span class="entity_def" id="NEMonad.neM.neM_IITN_neM.Rep_neM_IITN_neM|const"><span class="entity_def" id="NEMonad.neM.mor_neM|const"><span class="entity_def" id="NEMonad.neM.alg_neM|const"><span class="entity_def" id="NEMonad.neM.typerep_neM_pre_neM_bdT_inst.typerep_neM_pre_neM_bdT|const"><span class="entity_def" id="NEMonad.neM.neM_pre_neM_bdT.Abs_neM_pre_neM_bdT|const"><span class="entity_def" id="NEMonad.neM.neM_pre_neM_bdT.Rep_neM_pre_neM_bdT|const"><span class="entity_def" id="NEMonad.neM.neM_IITN_neM|type"><span>datatype</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><span class="entity_def" id="NEMonad.neM.rec_neM|const"><span class="entity_def" id="NEMonad.neM.ctor_rec_neM|const"><span class="entity_def" id="NEMonad.neM.dtor_neM|const"><span class="entity_def" id="NEMonad.neM.ctor_fold_neM|const"><span class="entity_def" id="NEMonad.neM.ctor_neM|const"><span class="entity_def" id="NEMonad.neM.str_init_neM|const"><span class="entity_def" id="NEMonad.neM.min_alg_neM|const"><span class="entity_def" id="NEMonad.pre_neM.neM.wit_pre_neM|const"><span class="entity_def" id="NEMonad.pre_neM.neM.pred_pre_neM|const"><span class="entity_def" id="NEMonad.pre_neM.neM.rel_pre_neM|const"><span class="entity_def" id="NEMonad.pre_neM.neM.bd_pre_neM|const"><span class="entity_def" id="NEMonad.pre_neM.neM.set_pre_neM|const"><span class="entity_def" id="NEMonad.pre_neM.neM.map_pre_neM|const"><span class="entity_def" id="NEMonad.neM|type"><span class="entity_def" id="NEMonad.neM.neM_pre_neM_bdT|type"><span>neM</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="main"><span>=</span></span><span> 
    </span><span class="entity_def" id="NEMonad.neM.SPEC|const"><span>SPEC</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="entity"><span class="entity_def" id="NEMonad.neM.the_spec|const"><span>the_spec</span></span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a><span>"</span></span></span><span class="main"><span>)</span></span><span> </span><span class="comment1"><span>― ‹May return any value that satisfies a predicate›</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity_def" id="NEMonad.neM.FAIL|const"><span>FAIL</span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span>fail<span class="hidden">⇩</span><sub>n</sub><span class="hidden">⇩</span><sub>e</sub></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>"</span></span><span class="main"><span>)</span></span><span>  </span><span class="comment1"><span>― ‹May fail›</span></span><span>

  </span><span class="keyword1"><span class="command"><span class="entity_def" id="NEMonad.map_neM.elims|fact"><span class="entity_def" id="NEMonad.map_neM.induct|fact"><span class="entity_def" id="NEMonad.map_neM.simps|fact"><span class="entity_def" id="NEMonad.map_neM.pelims|fact"><span class="entity_def" id="NEMonad.map_neM.cases|fact"><span class="entity_def" id="NEMonad.map_neM.termination|fact"><span class="entity_def" id="NEMonad.map_neM.pinduct|fact"><span class="entity_def" id="NEMonad.map_neM.psimps|fact"><span class="entity_def" id="NEMonad.map_neM_rel.inducts|fact"><span class="entity_def" id="NEMonad.map_neM_rel.simps|fact"><span class="entity_def" id="NEMonad.map_neM_rel.induct|fact"><span class="entity_def" id="NEMonad.map_neM_rel.cases|fact"><span class="entity_def" id="NEMonad.map_neM_rel.intros|fact"><span class="entity_def" id="NEMonad.map_neM_graph.inducts|fact"><span class="entity_def" id="NEMonad.map_neM_graph.simps|fact"><span class="entity_def" id="NEMonad.map_neM_graph.induct|fact"><span class="entity_def" id="NEMonad.map_neM_graph.cases|fact"><span class="entity_def" id="NEMonad.map_neM_graph.intros|fact"><span class="entity_def" id="NEMonad.map_neM.elims|thm"><span class="entity_def" id="NEMonad.map_neM.induct|thm"><span class="entity_def" id="NEMonad.map_neM.simps(2)|thm"><span class="entity_def" id="NEMonad.map_neM.simps(1)|thm"><span class="entity_def" id="NEMonad.map_neM.pelims|thm"><span class="entity_def" id="NEMonad.map_neM.cases|thm"><span class="entity_def" id="NEMonad.map_neM.termination|thm"><span class="entity_def" id="NEMonad.map_neM.pinduct|thm"><span class="entity_def" id="NEMonad.map_neM.psimps(2)|thm"><span class="entity_def" id="NEMonad.map_neM.psimps(1)|thm"><span class="entity_def" id="NEMonad.map_neM_rel.inducts|thm"><span class="entity_def" id="NEMonad.map_neM_rel.simps|thm"><span class="entity_def" id="NEMonad.map_neM_rel.induct|thm"><span class="entity_def" id="NEMonad.map_neM_rel.cases|thm"><span class="entity_def" id="NEMonad.map_neM_graph.inducts|thm"><span class="entity_def" id="NEMonad.map_neM_graph.simps|thm"><span class="entity_def" id="NEMonad.map_neM_graph.induct|thm"><span class="entity_def" id="NEMonad.map_neM_graph.cases|thm"><span class="entity_def" id="NEMonad.map_neM_graph.intros(2)|thm"><span class="entity_def" id="NEMonad.map_neM_graph.intros(1)|thm"><span class="entity_def" id="NEMonad.map_neM_def|axiom"><span class="entity_def" id="NEMonad.map_neM_rel_def|axiom"><span class="entity_def" id="NEMonad.map_neM_sumC_def|axiom"><span class="entity_def" id="NEMonad.map_neM_graph_def|axiom"><span class="entity_def" id="NEMonad.map_neM_dom|const"><span class="entity_def" id="NEMonad.map_neM_rel|const"><span class="entity_def" id="NEMonad.map_neM_sumC|const"><span class="entity_def" id="NEMonad.map_neM_graph|const"><span>fun</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="NEMonad.map_neM|const"><span>map_neM</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>map_neM</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.SPEC|const"><span>SPEC</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>P</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>P</span></span></span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>y</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>map_neM</span></span><span> </span><span class="main"><span class="bound"><span class="entity"><span>_</span></span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span>"</span></span></span><span>  
  
  
  
  </span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Pointwise Reasoning›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Many theorems about the result monad can easily be 
    solved by transforming them to pointwise proposition over
    possible results.›</span></span></span><span>
  
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="NEMonad.is_fail_def|fact"><span class="entity_def" id="NEMonad.is_fail_def|thm"><span class="entity_def" id="NEMonad.is_fail_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="NEMonad.is_fail|const"><span>is_fail</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="NEMonad.is_res_def|fact"><span class="entity_def" id="NEMonad.is_res_def|thm"><span class="entity_def" id="NEMonad.is_res_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="NEMonad.is_res|const"><span>is_res</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.the_spec|const"><span>the_spec</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.pw_basic|fact"><span class="entity_def" id="NEMonad.pw_basic(3)|thm"><span class="entity_def" id="NEMonad.pw_basic(2)|thm"><span class="entity_def" id="NEMonad.pw_basic(1)|thm"><span>pw_basic</span></span></span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.SPEC|const"><span>SPEC</span></a><span> </span><span class="free"><span>P</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.is_fail|const"><span>is_fail</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res_def|fact"><span>is_res_def</span></a><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_fail_def|fact"><span>is_fail_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.pw_eq_iff|fact"><span class="entity_def" id="NEMonad.pw_eq_iff|thm"><span>pw_eq_iff</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span>m'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.is_fail|const"><span>is_fail</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_fail|const"><span>is_fail</span></a><span> </span><span class="free"><span>m'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="free"><span>m'</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="free"><span>m</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="free"><span>m'</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_basic|fact"><span>pw_basic</span></a><span class="main"><span>)</span></span><span>
        

  </span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Automation›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹We first rewrite with initialization rules, that convert
    a property to a pointwise property, and then with 
    simplification rules, which syntactically decompose pointwise 
    properties.
  ›</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>named_theorems</span></span></span><span> </span><span class="entity_def" id="NEMonad.pw_init|attribute"><span class="entity_def" id="NEMonad.pw_init|fact"><span>pw_init</span></span></span><span> </span><span class="quoted"><span>‹Pointwise reasoning: initialization›</span></span><span>
  </span><span class="keyword1"><span class="command"><span>named_theorems</span></span></span><span> </span><span class="entity_def" id="NEMonad.pw_simp|attribute"><span class="entity_def" id="NEMonad.pw_simp|fact"><span>pw_simp</span></span></span><span> </span><span class="quoted"><span>‹Pointwise reasoning: simplification›</span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_simp|attribute"><span class="operator"><span>pw_simp</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_basic|fact"><span>pw_basic</span></a><span>
  </span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_init|attribute"><span class="operator"><span>pw_init</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_eq_iff|fact"><span>pw_eq_iff</span></a><span>
  
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="NEMonad.pw.pw|method"><span>method</span></span></span></span><span> </span><span class="entity_def" id="NEMonad.pw|method"><span>pw</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>only</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_init|fact"><span class="dynamic"><span class="dynamic"><span>pw_init</span></span></span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_simp|fact"><span class="dynamic"><span class="dynamic"><span>pw_simp</span></span></span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="NEMonad.pw&apos;.pw&apos;|method"><span>method</span></span></span></span><span> </span><span class="entity_def" id="NEMonad.pw&apos;|method"><span>pw'</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>only</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_init|fact"><span class="dynamic"><span class="dynamic"><span>pw_init</span></span></span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_simp|fact"><span class="dynamic"><span class="dynamic"><span>pw_simp</span></span></span></a><span class="main"><span>)</span></span><span>
      
  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.pw_map_neM|fact"><span class="entity_def" id="NEMonad.pw_map_neM(2)|thm"><span class="entity_def" id="NEMonad.pw_map_neM(1)|thm"><span>pw_map_neM</span></span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_simp|attribute"><span class="operator"><span>pw_simp</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.map_neM|const"><span>map_neM</span></a><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_fail|const"><span>is_fail</span></a><span> </span><span class="free"><span>m</span></span><span>"</span></span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.map_neM|const"><span>map_neM</span></a><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>m</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>y</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="free"><span>m</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_fail_def|fact"><span>is_fail_def</span></a><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res_def|fact"><span>is_res_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="free"><span>m</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_fail_def|fact"><span>is_fail_def</span></a><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res_def|fact"><span>is_res_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.pw_Let|fact"><span class="entity_def" id="NEMonad.pw_Let(2)|thm"><span class="entity_def" id="NEMonad.pw_Let(1)|thm"><span>pw_Let</span></span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_simp|attribute"><span class="operator"><span>pw_simp</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Let|const"><span>Let</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_fail|const"><span>is_fail</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Let|const"><span>Let</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>r</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>r</span></span><span>"</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span class="main"><span class="keyword3"><span>+</span></span></span><span>
    
    
  </span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Basic Combinators›</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Return and Bind›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Deterministically return a result›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="NEMonad.RETURN_def|fact"><span class="entity_def" id="NEMonad.RETURN_def|thm"><span class="entity_def" id="NEMonad.RETURN_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="NEMonad.RETURN|const"><span>RETURN</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>r</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  
  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Sequential composition: apply </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>f›</span></span></span><span> to every possible result of </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>m›</span></span></span><span>.›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="NEMonad.BIND_def|fact"><span class="entity_def" id="NEMonad.BIND_def|thm"><span class="entity_def" id="NEMonad.BIND_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="NEMonad.BIND|const"><span>BIND</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>case</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="keyword1"><span>of</span></span><span> 
    SPEC </span><span class="bound"><span>P</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="bound"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span>
              </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>r</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>Q</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="bound"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.SPEC|const"><span>SPEC</span></a><span> </span><span class="bound"><span>Q</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>Q</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> FAIL </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span>"</span></span></span><span>

  
  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Parallel composition: pair of results. 
    Note, this is subtly different from sequential composition and returning the pair,
    in case that the first result is empty, and the second one fails!
  ›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="NEMonad.PAR_def|fact"><span class="entity_def" id="NEMonad.PAR_def|thm"><span class="entity_def" id="NEMonad.PAR_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="NEMonad.PAR|const"><span>PAR</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>case</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span></span></span><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>of</span></span><span>
    </span><span class="main"><span>(</span></span><span>SPEC </span><span class="bound"><span>P<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span> SPEC </span><span class="bound"><span>P<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Basic_BNFs.html#Basic_BNFs.pred_prod|const"><span>pred_prod</span></a><span> </span><span class="bound"><span>P<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>P<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="main"><span class="bound"><span>_</span></span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span>  
  "</span></span></span><span>
  
  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.BIND_simps|fact"><span class="entity_def" id="NEMonad.BIND_simps(2)|thm"><span class="entity_def" id="NEMonad.BIND_simps(1)|thm"><span>BIND_simps</span></span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.BIND|const"><span>BIND</span></a><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span>"</span></span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.BIND|const"><span>BIND</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.SPEC|const"><span>SPEC</span></a><span> </span><span class="free"><span>P</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span>
      </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>r</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>Q</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.SPEC|const"><span>SPEC</span></a><span> </span><span class="bound"><span>Q</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>Q</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.BIND_def|fact"><span>BIND_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
  
  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.pw_RETURN|fact"><span class="entity_def" id="NEMonad.pw_RETURN(2)|thm"><span class="entity_def" id="NEMonad.pw_RETURN(1)|thm"><span>pw_RETURN</span></span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_simp|attribute"><span class="operator"><span>pw_simp</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.RETURN|const"><span>RETURN</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span>"</span></span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.RETURN|const"><span>RETURN</span></a><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="free"><span>x</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span>y</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.RETURN_def|fact"><span>RETURN_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span class="main"><span class="keyword3"><span>+</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.pw_BIND|fact"><span class="entity_def" id="NEMonad.pw_BIND(2)|thm"><span class="entity_def" id="NEMonad.pw_BIND(1)|thm"><span>pw_BIND</span></span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_simp|attribute"><span class="operator"><span>pw_simp</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.BIND|const"><span>BIND</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_fail|const"><span>is_fail</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>y</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_fail|const"><span>is_fail</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.BIND|const"><span>BIND</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>y</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><a class="entity_ref" href="NEMonad.html#NEMonad.is_fail|const"><span>is_fail</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>y</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.BIND_def|fact"><span>BIND_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_simp|fact"><span class="dynamic"><span class="dynamic"><span>pw_simp</span></span></span></a><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_fail_def|fact"><span>is_fail_def</span></a><span> </span><span class="quasi_keyword"><span>split</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.split|fact"><span>neM.split</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Meson/meson_tactic.ML.html#Meson.meson|method"><span class="operator"><span>meson</span></span></a><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res_def|fact"><span>is_res_def</span></a><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.exhaust_sel|fact"><span>neM.exhaust_sel</span></a><span class="main"><span>)</span></span><span>

    
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.pw_PAR|fact"><span class="entity_def" id="NEMonad.pw_PAR(2)|thm"><span class="entity_def" id="NEMonad.pw_PAR(1)|thm"><span>pw_PAR</span></span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_simp|attribute"><span class="operator"><span>pw_simp</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.PAR|const"><span>PAR</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_fail|const"><span>is_fail</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_fail|const"><span>is_fail</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span>"</span></span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.PAR|const"><span>PAR</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>rr</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>case</span></span><span> </span><span class="free"><span>rr</span></span><span> </span><span class="keyword1"><span>of</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.PAR_def|fact"><span>PAR_def</span></a><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_fail_def|fact"><span>is_fail_def</span></a><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res_def|fact"><span>is_res_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
    
    

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">const</span><span class="hidden">&gt;</span></span></span><span>‹</span><a class="entity_ref" href="NEMonad.html#NEMonad.RETURN|const"><span>RETURN</span></a><span>›</span></span><span> and </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">const</span><span class="hidden">&gt;</span></span></span><span>‹</span><a class="entity_ref" href="NEMonad.html#NEMonad.BIND|const"><span>BIND</span></a><span>›</span></span><span> satisfy the monad laws:›</span></span></span><span>  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.return_bind|fact"><span class="entity_def" id="NEMonad.return_bind|thm"><span>return_bind</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.BIND|const"><span>BIND</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.RETURN|const"><span>RETURN</span></a><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.bind_return|fact"><span class="entity_def" id="NEMonad.bind_return|thm"><span>bind_return</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.BIND|const"><span>BIND</span></a><span> </span><span class="free"><span>m</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>m</span></span><span>"</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.bind_bind|fact"><span class="entity_def" id="NEMonad.bind_bind|thm"><span>bind_bind</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.BIND|const"><span>BIND</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.BIND|const"><span>BIND</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>g</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.BIND|const"><span>BIND</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.BIND|const"><span>BIND</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>g</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹There are also laws for the interaction of </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">const</span><span class="hidden">&gt;</span></span></span><span>‹</span><a class="entity_ref" href="NEMonad.html#NEMonad.BIND|const"><span>BIND</span></a><span>›</span></span><span> and </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">const</span><span class="hidden">&gt;</span></span></span><span>‹</span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span>›</span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.fail_bind|fact"><span class="entity_def" id="NEMonad.fail_bind|thm"><span>fail_bind</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.BIND|const"><span>BIND</span></a><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
  
  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Note that </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span>‹</span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a><span class="main"><span>)</span></span><span>›</span></span></span><span> is special, in that it specifies a program
    with no possible results. It's the dual to </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">const</span><span class="hidden">&gt;</span></span></span><span>‹</span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span>›</span></span><span>. We call it </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>EMPTY›</span></span></span><span>: ›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>abbreviation</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="NEMonad.EMPTY|const"><span>EMPTY</span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>  
    
  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">const</span><span class="hidden">&gt;</span></span></span><span>‹</span><a class="entity_ref" href="NEMonad.html#NEMonad.EMPTY|const"><span>EMPTY</span></a><span>›</span></span><span> can be an un-intuitive corner-case for some rules, 
    like the following, that only holds for </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span>‹</span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><a class="entity_ref" href="NEMonad.html#NEMonad.EMPTY|const"><span>EMPTY</span></a><span>›</span></span></span><span>:›</span></span></span><span>  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.bind_fail|fact"><span class="entity_def" id="NEMonad.bind_fail|thm"><span>bind_fail</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.BIND|const"><span>BIND</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><a class="entity_ref" href="NEMonad.html#NEMonad.EMPTY|const"><span>EMPTY</span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.bind_empty|fact"><span class="entity_def" id="NEMonad.bind_empty|thm"><span>bind_empty</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.BIND|const"><span>BIND</span></a><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.EMPTY|const"><span>EMPTY</span></a><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.EMPTY|const"><span>EMPTY</span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Parallel can be expressed by sequential composition, except for the extreme case where
    the first component is empty, and the second one fails. 
    In this case, due to the sequential nature of BIND, the failing component will never be executed,
    and the result will be empty. For parallel composition, though, both components will be executed,
    and the failure will propagate.
  ›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.PAR_as_BIND_iff|fact"><span class="entity_def" id="NEMonad.PAR_as_BIND_iff|thm"><span>PAR_as_BIND_iff</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.PAR|const"><span>PAR</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.BIND|const"><span>BIND</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.BIND|const"><span>BIND</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><a class="entity_ref" href="NEMonad.html#NEMonad.EMPTY|const"><span>EMPTY</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.PAR_as_BIND|fact"><span class="entity_def" id="NEMonad.PAR_as_BIND|thm"><span>PAR_as_BIND</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><a class="entity_ref" href="NEMonad.html#NEMonad.EMPTY|const"><span>EMPTY</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.PAR|const"><span>PAR</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.BIND|const"><span>BIND</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.BIND|const"><span>BIND</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹The parallel composition operator is commutative›</span></span></span><span>    
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.PAR_commute|fact"><span class="entity_def" id="NEMonad.PAR_commute|thm"><span>PAR_commute</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.PAR|const"><span>PAR</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.map_neM|const"><span>map_neM</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.swap|const"><span>prod.swap</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.PAR|const"><span>PAR</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>

    
  </span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Syntax›</span></span></span><span>  

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹We establish some syntax›</span></span></span><span>
    
  </span><span class="comment1"><span>(*abbreviation (input) bind_doI where "bind_doI m (λx. f x) ≡ BIND m (λx. f x)"*)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>abbreviation</span></span></span><span> </span><span class="entity"><span class="entity_def" id="NEMonad.then_doI|const"><span>then_doI</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>then_doI</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.BIND|const"><span>BIND</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>nonterminal</span></span></span><span> </span><span class="entity_def" id="offset_7572..7581">doI_binds</span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_7586..7594">doI_bind</span><span>
  </span><span class="keyword1"><span class="command"><span>syntax</span></span></span><span>
    </span><span class="quoted"><span>"_doI_block"</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#offset_7572..7581"><span>doI_binds</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword1"><span>do<span class="hidden">⇩</span><sub>n</sub><span class="hidden">⇩</span><sub>e</sub></span></span><span> </span><span class="keyword1"><span>{</span></span><span class="keyword3"><span>//</span></span><span class="keyword3"><span>(2</span></span><span>  _</span><span class="keyword3"><span>)</span></span><span class="keyword3"><span>//</span></span><span class="keyword1"><span>}</span></span><span>"</span></span><span> </span><span class="main"><span>[</span></span><span>12</span><span class="main"><span>]</span></span><span> 62</span><span class="main"><span>)</span></span><span>
    </span><span class="quoted"><span>"_doI_bind"</span></span><span>  </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>[</span></span><span>pttrn</span><span class="main"><span>,</span></span><span> </span><span class="tfree"><span>'a</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="NEMonad.html#offset_7586..7594"><span>doI_bind</span></a><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword3"><span>(2</span></span><span>_ </span><span class="keyword1"><span>←</span></span><span class="keyword3"><span>/ </span></span><span>_</span><span class="keyword3"><span>)</span></span><span>"</span></span><span> 13</span><span class="main"><span>)</span></span><span>
    </span><span class="quoted"><span>"_doI_let"</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>[</span></span><span>pttrn</span><span class="main"><span>,</span></span><span> </span><span class="tfree"><span>'a</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="NEMonad.html#offset_7586..7594"><span>doI_bind</span></a><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword3"><span>(2</span></span><span class="keyword1"><span>let</span></span><span> _ </span><span class="keyword1"><span>=</span></span><span class="keyword3"><span>/ </span></span><span>_</span><span class="keyword3"><span>)</span></span><span>"</span></span><span> </span><span class="main"><span>[</span></span><span>1000</span><span class="main"><span>,</span></span><span> 13</span><span class="main"><span>]</span></span><span> 13</span><span class="main"><span>)</span></span><span>
    </span><span class="quoted"><span>"_doI_then"</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="NEMonad.html#offset_7586..7594"><span>doI_bind</span></a><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"_"</span></span><span> </span><span class="main"><span>[</span></span><span>14</span><span class="main"><span>]</span></span><span> 13</span><span class="main"><span>)</span></span><span>
    </span><span class="quoted"><span>"_doI_final"</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="NEMonad.html#offset_7572..7581"><span>doI_binds</span></a><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"_"</span></span><span class="main"><span>)</span></span><span>
    </span><span class="quoted"><span>"_doI_cons"</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#offset_7586..7594"><span>doI_bind</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="NEMonad.html#offset_7572..7581"><span>doI_binds</span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="NEMonad.html#offset_7572..7581"><span>doI_binds</span></a><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"_</span><span class="keyword1"><span>;</span></span><span class="keyword3"><span>//</span></span><span>_"</span></span><span> </span><span class="main"><span>[</span></span><span>13</span><span class="main"><span>,</span></span><span> 12</span><span class="main"><span>]</span></span><span> 12</span><span class="main"><span>)</span></span><span>
    </span><span class="comment1"><span>(*"_thenM" :: "['a, 'b] ⇒ 'c" (infixr "⪢" 54)*)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>syntax</span></span></span><span> </span><span class="main"><span>(</span></span><span>ASCII</span><span class="main"><span>)</span></span><span>
    </span><span class="quoted"><span>"_doI_bind"</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>[</span></span><span>pttrn</span><span class="main"><span>,</span></span><span> </span><span class="tfree"><span>'a</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="NEMonad.html#offset_7586..7594"><span>doI_bind</span></a><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword3"><span>(2</span></span><span>_ </span><span class="keyword1"><span>&lt;-</span></span><span class="keyword3"><span>/ </span></span><span>_</span><span class="keyword3"><span>)</span></span><span>"</span></span><span> 13</span><span class="main"><span>)</span></span><span>
    </span><span class="comment1"><span>(*"_thenM" :: "['a, 'b] ⇒ 'c" (infixr "&gt;&gt;" 54)*)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>translations</span></span></span><span>
    </span><span class="quoted"><span>"_doI_block </span><span class="main"><span>(</span></span><span>_doI_cons </span><span class="main"><span>(</span></span><span>_doI_then </span><span class="free"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>_doI_final </span><span class="free"><span>e</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span><span>
      </span><span class="main"><span>⇌</span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>CONST</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.then_doI|const"><span>then_doI</span></a><span> </span><span class="free"><span>t</span></span><span> </span><span class="free"><span>e</span></span><span>"</span></span><span>

    </span><span class="quoted"><span>"_doI_block </span><span class="main"><span>(</span></span><span>_doI_cons </span><span class="main"><span>(</span></span><span>_doI_bind </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>_doI_final </span><span class="free"><span>e</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span><span>
      </span><span class="main"><span>⇌</span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>CONST</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.BIND|const"><span>BIND</span></a><span> </span><span class="free"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="free"><span>p</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>e</span></span><span class="main"><span>)</span></span><span>"</span></span><span>

    </span><span class="quoted"><span>"_doI_block </span><span class="main"><span>(</span></span><span>_doI_cons </span><span class="main"><span>(</span></span><span>_doI_let </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>bs</span></span><span class="main"><span>)</span></span><span>"</span></span><span>
      </span><span class="main"><span>⇌</span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>let</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="keyword1"><span>in</span></span><span> _doI_block </span><span class="free"><span>bs</span></span><span>"</span></span><span>

    </span><span class="quoted"><span>"_doI_block </span><span class="main"><span>(</span></span><span>_doI_cons </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>(</span></span><span>_doI_cons </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>cs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span><span>
      </span><span class="main"><span>⇌</span></span><span> </span><span class="quoted"><span>"_doI_block </span><span class="main"><span>(</span></span><span>_doI_cons </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>(</span></span><span>_doI_final </span><span class="main"><span>(</span></span><span>_doI_block </span><span class="main"><span>(</span></span><span>_doI_cons </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>cs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span><span>

    </span><span class="quoted"><span>"_doI_cons </span><span class="main"><span>(</span></span><span>_doI_let </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>_doI_final </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span>"</span></span><span>
      </span><span class="main"><span>⇌</span></span><span> </span><span class="quoted"><span>"_doI_final </span><span class="main"><span>(</span></span><span class="keyword1"><span>let</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span>"</span></span><span>

    </span><span class="quoted"><span>"_doI_block </span><span class="main"><span>(</span></span><span>_doI_final </span><span class="free"><span>e</span></span><span class="main"><span>)</span></span><span>"</span></span><span> </span><span class="main"><span>⇀</span></span><span> </span><span class="quoted"><span>"</span><span class="free"><span>e</span></span><span>"</span></span><span>
  
    </span><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="keyword1"><span>CONST</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.then_doI|const"><span>then_doI</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span><span> </span><span class="main"><span>⇀</span></span><span> </span><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="keyword1"><span>CONST</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.BIND|const"><span>BIND</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>_</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span><span>
    
   
  </span><span class="keyword1"><span class="command"><span>notation</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword1"><span>return<span class="hidden">⇩</span><sub>n</sub><span class="hidden">⇩</span><sub>e</sub></span></span><span> _"</span></span><span> 20</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>notation</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>binder</span></span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>spec<span class="hidden">⇩</span><sub>n</sub><span class="hidden">⇩</span><sub>e</sub></span></span><span> "</span></span><span> 10</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>notation</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.PAR|const"><span>PAR</span></a><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>infixr</span></span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>∥<span class="hidden">⇩</span><sub>n</sub><span class="hidden">⇩</span><sub>e</sub></span></span><span>"</span></span><span> 50</span><span class="main"><span>)</span></span><span>
  
      
  </span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Assert›</span></span></span><span>    
  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹An assertion returns unit if the predicate holds, and fails otherwise.
    Note that returning unit is the functional way of having a function with no return value (e.g. void in C/C++).
  ›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="NEMonad.ASSERT_def|fact"><span class="entity_def" id="NEMonad.ASSERT_def|thm"><span class="entity_def" id="NEMonad.ASSERT_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="NEMonad.ASSERT|const"><span>ASSERT</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>P</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>P</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="NEMonad.html#NEMonad.RETURN|const"><span>return<span class="hidden">⇩</span><sub>n</sub><span class="hidden">⇩</span><sub>e</sub></span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Unity|const"><span>()</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span>"</span></span></span><span>
  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.pw_ASSERT|fact"><span class="entity_def" id="NEMonad.pw_ASSERT(2)|thm"><span class="entity_def" id="NEMonad.pw_ASSERT(1)|thm"><span>pw_ASSERT</span></span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_simp|attribute"><span class="operator"><span>pw_simp</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="free"><span>P</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>P</span></span><span>"</span></span></span><span>  
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="free"><span>P</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="free"><span>P</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.ASSERT_def|fact"><span>ASSERT_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span class="main"><span class="keyword3"><span>+</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      
  </span><span class="keyword1"><span class="command"><span>notation</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword1"><span>assert<span class="hidden">⇩</span><sub>n</sub><span class="hidden">⇩</span><sub>e</sub></span></span><span> _"</span></span><span> 20</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span class="entity_def" id="NEMonad.ASSUME_def|fact"><span class="entity_def" id="NEMonad.ASSUME_def|thm"><span class="entity_def" id="NEMonad.ASSUME_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="NEMonad.ASSUME|const"><span>ASSUME</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>P</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>P</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="NEMonad.html#NEMonad.RETURN|const"><span>return<span class="hidden">⇩</span><sub>n</sub><span class="hidden">⇩</span><sub>e</sub></span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Unity|const"><span>()</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.EMPTY|const"><span>EMPTY</span></a><span>"</span></span></span><span>
  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.pw_ASSUME|fact"><span class="entity_def" id="NEMonad.pw_ASSUME(2)|thm"><span class="entity_def" id="NEMonad.pw_ASSUME(1)|thm"><span>pw_ASSUME</span></span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_simp|attribute"><span class="operator"><span>pw_simp</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.ASSUME|const"><span>ASSUME</span></a><span> </span><span class="free"><span>P</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span>"</span></span></span><span>  
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.ASSUME|const"><span>ASSUME</span></a><span> </span><span class="free"><span>P</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="free"><span>P</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.ASSUME_def|fact"><span>ASSUME_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span class="main"><span class="keyword3"><span>+</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      
  </span><span class="keyword1"><span class="command"><span>notation</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.ASSUME|const"><span>ASSUME</span></a><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword1"><span>assume<span class="hidden">⇩</span><sub>n</sub><span class="hidden">⇩</span><sub>e</sub></span></span><span> _"</span></span><span> 20</span><span class="main"><span>)</span></span><span>
  

  </span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Recursion›</span></span></span><span>  
  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹For recursion, we define a fixed-point combinator 
    utilizing a chain-complete partial order (CCPO).
    While CCPO's are advanced material, we try to capture the intuition
    below.
  ›</span></span></span><span>
  

  
  </span><span class="keyword1"><span class="command"><span>context</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_9858..9872">interpretation</span></span></span><span> FR</span><span class="main"><span>:</span></span><span> </span><a class="entity_ref" href="Flat_CCPO.html#Flat_CCPO.flat_rec|locale"><span>flat_rec</span></a><span> </span><span class="quoted"><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
  
  </span><span class="comment1"><span>(*    
    text ‹The recursion combinator models recursive functions. 
      The recursive call is the first parameter to the function body, and
      the argument is the second parameter.
    ›
    definition REC :: "(('a ⇒ 'b neM) ⇒ 'a ⇒ 'b neM) ⇒ 'a ⇒ 'b neM" where "REC ≡ FR.REC"
  *)</span></span><span>
        
    </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹The function body must be monotone. Intuitively, this means that 
      it terminates at less arguments if the recursive call terminates at less arguments.
    ›</span></span></span><span>
    
    </span><span class="keyword1"><span class="command"><span>abbreviation</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="NEMonad.nres_mono&apos;|const"><span>nres_mono'</span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="Flat_CCPO.html#Flat_CCPO.gen_is_mono&apos;|const"><span>gen_is_mono'</span></a><span> </span><a class="entity_ref" href="NEMonad.html#offset_9858..9872"><span>FR.le</span></a><span> </span><a class="entity_ref" href="NEMonad.html#offset_9858..9872"><span>FR.le</span></a><span>"</span></span></span><span>
    
    
    </span><span class="comment1"><span>(*
    definition nres_mono :: "(('a ⇒ 'b neM) ⇒ 'a ⇒ 'b neM) ⇒ bool" where "nres_mono = FR.mono"
    *)</span></span><span>
</span><span class="comment1"><span>(*    
    text ‹A recursive function can be unfolded, i.e., the body is inlined once.›
    lemma REC_unfold: "nres_mono F ⟹ REC F = F (REC F)"
      unfolding REC_def nres_mono_def using FR.REC_unfold .

    text ‹Pointwise properties of recursive functions can be proved by well-founded induction 
      on the arguments.›
    lemma REC_wf_induct: 
      assumes WF: "wf V"
      assumes MONO: "nres_mono F"
      assumes STEP: "⋀x D. ⟦⋀y. ⟦(y,x)∈V⟧ ⟹ P y (D y) ⟧ ⟹ P x (F D x)"
      shows "P x (REC F x)"
      using assms unfolding nres_mono_def REC_def 
      using FR.REC_wf_induct by metis

    text ‹For pointwise properties, which hold at non-terminating arguments, we
      can use the following induction scheme, which does not require a well-founded ordering.›
    lemma REC_pointwise_induct:  
      assumes BOT: "⋀x. P x FAIL"
      assumes STEP: "⋀D x. (⋀y. P y (D y)) ⟹ P x (F D x)"
      shows "P x (REC F x)"
      using assms REC_def
      using FR.REC_pointwise_induct by metis
  *)</span></span><span>      
  
    </span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Monotonicity›</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Function bodies have to be monotone, i.e., when invoked with a recursive call 
      that terminates at less arguments, it must terminate at less arguments.
      
      This property can be established syntactically for the standard combinators
      programs are build from.
    ›</span></span></span><span>
    
    </span><span class="comment1"><span>(*
    named_theorems mono ‹Monotonicity theorems for nres› 
    
    ML ‹
      structure NE_Mono_Prover = struct
        fun mono_tac ctxt = let
          val rules = Named_Theorems.get ctxt @{named_theorems mono}
        in 
          REPEAT_ALL_NEW (match_tac ctxt rules ORELSE' assume_tac ctxt)
        end
      end
    ›
    
    method_setup ne_mono = ‹Scan.succeed (SIMPLE_METHOD' o NE_Mono_Prover.mono_tac)›
    *)</span></span><span>
    
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="NEMonad.flat_le_def|fact"><span class="entity_def" id="NEMonad.flat_le_def|thm"><span class="entity_def" id="NEMonad.flat_le_def_raw|axiom"><span class="entity_def" id="offset_12333..12343">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="NEMonad.flat_le|const"><span>flat_le</span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="NEMonad.html#offset_9858..9872"><span>FR.le</span></a><span>"</span></span></span><span>
    
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.pw_flat_le|fact"><span class="entity_def" id="NEMonad.pw_flat_le|thm"><span>pw_flat_le</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_init|attribute"><span class="operator"><span>pw_init</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.flat_le|const"><span>flat_le</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>m'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_fail|const"><span>is_fail</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><a class="entity_ref" href="NEMonad.html#NEMonad.is_fail|const"><span>is_fail</span></a><span> </span><span class="free"><span>m'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="free"><span>m'</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="free"><span>m</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="free"><span>m'</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_simp|fact"><span class="dynamic"><span class="dynamic"><span>pw_simp</span></span></span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#offset_12333..12343"><span>flat_le_def</span></a><span> </span><a class="entity_ref" href="NEMonad.html#offset_9858..9872"><span>FR.le_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
    
    </span><span class="comment1"><span>(*  
    lemma mono_alt: "nres_mono F = (∀x y. fun_ord flat_le x y ⟶ fun_ord flat_le (F x) (F y))"
      unfolding nres_mono_def monotone_def FR.le_def flat_le_def ..
    
    definition nres_mono' :: "(('a ⇒ 'b neM) ⇒ 'c neM) ⇒ bool"
      where "nres_mono' F ≡ ∀D D'. fun_ord flat_le D D' ⟶ flat_le (F D) (F D')"
    *)</span></span><span>
      
    </span><span class="comment1"><span>(*
    lemma nres_monoI[mono]: 
      assumes "⋀x. nres_mono' (λD. F D x)"
      shows "nres_mono F"
      using assms unfolding mono_alt nres_mono'_def fun_ord_def
      by simp
    
    lemma nres_monoD: "nres_mono F ⟹ nres_mono' (λD. F D x)"
      unfolding mono_alt nres_mono'_def fun_ord_def
      by simp
    *)</span></span><span>
      
    </span><span class="comment1"><span>(*
    lemma mono_If[mono]: "
      nres_mono' (λD. F D) ⟹ nres_mono' (λD. G D) ⟹
      nres_mono' (λD. if b then F D else G D)"  
      unfolding nres_mono'_def fun_ord_def
      apply pw
      done
    *)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>thm</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.partial_function_mono|fact"><span class="dynamic"><span class="dynamic"><span>partial_function_mono</span></span></span></a><span>
          
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.mono_BIND|fact"><span class="entity_def" id="NEMonad.mono_BIND|thm"><span>mono_BIND</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.partial_function_mono|attribute"><span class="operator"><span>partial_function_mono</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"
      </span><a class="entity_ref" href="NEMonad.html#NEMonad.nres_mono&apos;|const"><span>nres_mono'</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>D</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>F</span></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> 
      </span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.nres_mono&apos;|const"><span>nres_mono'</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>D</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> 
      </span><a class="entity_ref" href="NEMonad.html#NEMonad.nres_mono&apos;|const"><span>nres_mono'</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>D</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.BIND|const"><span>BIND</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>F</span></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.monotone_def|fact"><span>monotone_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_ord_def|fact"><span>fun_ord_def</span></a><span> </span><a class="entity_ref" href="NEMonad.html#offset_12333..12343"><span>flat_le_def</span></a><span class="main"><span>[</span></span><span class="operator"><span>symmetric</span></span><span class="main"><span>]</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/SMT/smt_systems.ML.html#SMT.smt|method"><span class="operator"><span>smt</span></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> ccfv_threshold</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/SMT/smt_systems.ML.html#SMT.smt|method"><span class="operator"><span>smt</span></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> ccfv_threshold</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/SMT/smt_systems.ML.html#SMT.smt|method"><span class="operator"><span>smt</span></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> ccfv_threshold</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.mono_PAR|fact"><span class="entity_def" id="NEMonad.mono_PAR|thm"><span>mono_PAR</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.partial_function_mono|attribute"><span class="operator"><span>partial_function_mono</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"
      </span><a class="entity_ref" href="NEMonad.html#NEMonad.nres_mono&apos;|const"><span>nres_mono'</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>D</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>F</span></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> 
      </span><a class="entity_ref" href="NEMonad.html#NEMonad.nres_mono&apos;|const"><span>nres_mono'</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>D</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> 
      </span><a class="entity_ref" href="NEMonad.html#NEMonad.nres_mono&apos;|const"><span>nres_mono'</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>D</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.PAR|const"><span>PAR</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>F</span></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>G</span></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.monotone_def|fact"><span>monotone_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_ord_def|fact"><span>fun_ord_def</span></a><span> </span><a class="entity_ref" href="NEMonad.html#offset_12333..12343"><span>flat_le_def</span></a><span class="main"><span>[</span></span><span class="operator"><span>symmetric</span></span><span class="main"><span>]</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="main"><span>)</span></span><span>
     
      
      
    </span><span class="comment1"><span>(*
    lemma mono_REC[mono]: 
      assumes "⋀D. nres_mono (F D)"
      assumes "⋀DD x. nres_mono' (λD. F D DD x)"
      shows "nres_mono' (λD. REC (F D) x)"  
      using assms
      unfolding nres_mono'_def flat_le_def REC_def
      apply clarsimp
      subgoal for D D'
        apply (rule FR.REC_mono[of F D D', unfolded fun_ord_def, rule_format])
        subgoal by (simp add: fun_ord_def nres_mono_def monotone_def)
        subgoal by blast
        done
      done
    *)</span></span><span>  

    </span><span class="comment1"><span>(*      
    lemma mono_case_prod[mono]:
      assumes "⋀a b. nres_mono' (λD. F D a b)"
      shows "nres_mono' (λD. case p of (a,b) ⇒ F D a b)"
      using assms
      apply (cases p) by simp
    
    lemma mono_Let[mono]:
      assumes "⋀x. nres_mono' (λD. F D x)"
      shows "nres_mono' (λD. let x=v in F D x)"
      using assms
      by simp
    *)</span></span><span>  
            
  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
    
  
  </span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Weakest Precondition›</span></span></span><span>
  
  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Weakest precondition: </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>m›</span></span></span><span> does not fail, and all possible results satisfy postcondition </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>Q›</span></span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="NEMonad.wp_def|fact"><span class="entity_def" id="NEMonad.wp_def|thm"><span class="entity_def" id="NEMonad.wp_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_init|attribute"><span class="operator"><span>pw_init</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="NEMonad.wp|const"><span>wp</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Q</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><a class="entity_ref" href="NEMonad.html#NEMonad.is_fail|const"><span>is_fail</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Q</span></span></span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Weakest liberal precondition: if </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>m›</span></span></span><span> does not fail, all possible results satisfy postcondition </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>Q›</span></span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="NEMonad.wlp_def|fact"><span class="entity_def" id="NEMonad.wlp_def|thm"><span class="entity_def" id="NEMonad.wlp_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_init|attribute"><span class="operator"><span>pw_init</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="NEMonad.wlp|const"><span>wlp</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Q</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><a class="entity_ref" href="NEMonad.html#NEMonad.is_fail|const"><span>is_fail</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Q</span></span></span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  
  
  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Consequence rule: weaken postcondition ›</span></span></span><span>  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.wp_cons|fact"><span class="entity_def" id="NEMonad.wp_cons|thm"><span>wp_cons</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.wp|const"><span>wp</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>Q'</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wp|const"><span>wp</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>Q'</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.wlp_cons|fact"><span class="entity_def" id="NEMonad.wlp_cons|thm"><span>wlp_cons</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.wlp|const"><span>wlp</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>Q'</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wlp|const"><span>wlp</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>Q'</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
    
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.wp_imp_wlp|fact"><span class="entity_def" id="NEMonad.wp_imp_wlp|thm"><span>wp_imp_wlp</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.wp|const"><span>wp</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wlp|const"><span>wlp</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>Q</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>  
    
    
  </span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Wp-Calculus›</span></span></span><span>  
  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Syntactic rules for weakest precondition›</span></span></span><span>      
  </span><span class="keyword1"><span class="command"><span>named_theorems</span></span></span><span> </span><span class="entity_def" id="NEMonad.wp_rule|attribute"><span class="entity_def" id="NEMonad.wp_rule|fact"><span>wp_rule</span></span></span><span> </span><span class="quoted"><span>‹Syntactic rules for wp›</span></span><span>
  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.wp_RETURN_iff|fact"><span class="entity_def" id="NEMonad.wp_RETURN_iff|thm"><span>wp_RETURN_iff</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.wp|const"><span>wp</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.RETURN|const"><span>RETURN</span></a><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.wp_BIND_iff|fact"><span class="entity_def" id="NEMonad.wp_BIND_iff|thm"><span>wp_BIND_iff</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.wp|const"><span>wp</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.BIND|const"><span>BIND</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wp|const"><span>wp</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wp|const"><span>wp</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>Q</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.wp_PAR_iff|fact"><span class="entity_def" id="NEMonad.wp_PAR_iff|thm"><span>wp_PAR_iff</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.wp|const"><span>wp</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.PAR|const"><span>PAR</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>Q<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>Q<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wp|const"><span>wp</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>Q<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wp|const"><span>wp</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="bound"><span>Q<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="bound"><span>Q<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>Q<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
    
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.wlp_PAR_iff|fact"><span class="entity_def" id="NEMonad.wlp_PAR_iff|thm"><span>wlp_PAR_iff</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.wlp|const"><span>wlp</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.PAR|const"><span>PAR</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>Q<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>Q<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wlp|const"><span>wlp</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>Q<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wlp|const"><span>wlp</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="bound"><span>Q<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="bound"><span>Q<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>Q<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
    
  </span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.wp_rule|attribute"><span class="operator"><span>wp_rule</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> 
    </span><a class="entity_ref" href="NEMonad.html#NEMonad.wp_RETURN_iff|fact"><span>wp_RETURN_iff</span></a><span class="main"><span>[</span></span><span class="operator"><span>THEN</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iffD2|fact"><span>iffD2</span></a><span class="main"><span>]</span></span><span>  
    </span><a class="entity_ref" href="NEMonad.html#NEMonad.wp_BIND_iff|fact"><span>wp_BIND_iff</span></a><span class="main"><span>[</span></span><span class="operator"><span>THEN</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iffD2|fact"><span>iffD2</span></a><span class="main"><span>]</span></span><span>  

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹We do not include these in wp-rules by default,
    as they will create schematic postconditions›</span></span></span><span>  
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_16436..16441">lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.wp_PAR|fact"><span class="entity_def" id="NEMonad.wp_PAR|thm"><span>wp_PAR</span></span></span><span class="main"><span>:</span></span><span>  
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.wp|const"><span>wp</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>Q<span class="hidden">⇩</span><sub>1</sub></span></span><span>"</span></span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.wp|const"><span>wp</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="free"><span>Q<span class="hidden">⇩</span><sub>2</sub></span></span><span>"</span></span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>Q<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>Q<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.wp|const"><span>wp</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.PAR|const"><span>PAR</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>Q</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#offset_16436..16441"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
    
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_16620..16625">lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.wlp_PAR|fact"><span class="entity_def" id="NEMonad.wlp_PAR|thm"><span>wlp_PAR</span></span></span><span class="main"><span>:</span></span><span>  
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.wlp|const"><span>wlp</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>Q<span class="hidden">⇩</span><sub>1</sub></span></span><span>"</span></span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.wlp|const"><span>wlp</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="free"><span>Q<span class="hidden">⇩</span><sub>2</sub></span></span><span>"</span></span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>Q<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>Q<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.wlp|const"><span>wlp</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.PAR|const"><span>PAR</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>Q</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#offset_16620..16625"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
    
    
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.wp_ASSERT|fact"><span class="entity_def" id="NEMonad.wp_ASSERT|thm"><span>wp_ASSERT</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.wp_rule|attribute"><span class="operator"><span>wp_rule</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>P</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Unity|const"><span>()</span></a></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wp|const"><span>wp</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="free"><span>P</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>Q</span></span><span>"</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.wp_ASSUME|fact"><span class="entity_def" id="NEMonad.wp_ASSUME|thm"><span>wp_ASSUME</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.wp_rule|attribute"><span class="operator"><span>wp_rule</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>P</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Unity|const"><span>()</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wp|const"><span>wp</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.ASSUME|const"><span>ASSUME</span></a><span> </span><span class="free"><span>P</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>Q</span></span><span>"</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
    
            
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.wp_SPEC|fact"><span class="entity_def" id="NEMonad.wp_SPEC|thm"><span>wp_SPEC</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.wp_rule|attribute"><span class="operator"><span>wp_rule</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wp|const"><span>wp</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.SPEC|const"><span>SPEC</span></a><span> </span><span class="free"><span>P</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>Q</span></span><span>"</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
    
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.wp_Let|fact"><span class="entity_def" id="NEMonad.wp_Let|thm"><span>wp_Let</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.wp_rule|attribute"><span class="operator"><span>wp_rule</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span>v</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wp|const"><span>wp</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>Q</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wp|const"><span>wp</span></a><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>=</span></span><span class="free"><span>v</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>Q</span></span><span>"</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
    
    
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.wp_if|fact"><span class="entity_def" id="NEMonad.wp_if|thm"><span>wp_if</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.wp_rule|attribute"><span class="operator"><span>wp_rule</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wp|const"><span>wp</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>Q</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>b</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wp|const"><span>wp</span></a><span> </span><span class="free"><span>m'</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wp|const"><span>wp</span></a><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="free"><span>m'</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>Q</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> 
    
    
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.wp_if_ext|fact"><span class="entity_def" id="NEMonad.wp_if_ext|thm"><span>wp_if_ext</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.wp_rule|attribute"><span class="operator"><span>wp_rule</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span class="free"><span>b</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>P</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>b</span></span><span class="main"><span>⟹</span></span><span class="free"><span>Q</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="free"><span>Q</span></span><span>"</span></span></span><span>   </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.wp_prod_case|fact"><span class="entity_def" id="NEMonad.wp_prod_case|thm"><span>wp_prod_case</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.wp_rule|attribute"><span class="operator"><span>wp_rule</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>b</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="main"><span>(</span></span><span class="bound"><span>a</span></span><span class="main"><span>,</span></span><span class="bound"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wp|const"><span>wp</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>Q</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wp|const"><span>wp</span></a><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>case</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="keyword1"><span>of</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>a</span></span><span class="main"><span>,</span></span><span class="bound"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>Q</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="free"><span>p</span></span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
  
  </span><span class="comment1"><span>(*
  lemma wp_REC: 
    fixes x :: 'a and V :: "'a rel"
    assumes WF: "wf V"
    assumes MONO: "nres_mono F"
    assumes INIT: "P x"
    assumes STEP: "⋀x D. (⋀y. (y, x) ∈ V ⟹ P y ⟹ wp (D y) (Q y)) ⟹ P x ⟹ wp (F D x) (Q x)"
    shows "wp (REC F x) (Q x)"  
  proof -
    have "P x ⟶ wp (REC F x) (Q x)"
      apply (rule REC_wf_induct[OF WF MONO])
      apply (blast intro: STEP)
      done
    with INIT show ?thesis by blast
  qed  
  *)</span></span><span>  
    
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.wlp_FAIL|fact"><span class="entity_def" id="NEMonad.wlp_FAIL|thm"><span>wlp_FAIL</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.wp_rule|attribute"><span class="operator"><span>wp_rule</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.wlp|const"><span>wlp</span></a><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span> </span><span class="free"><span>Q</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.wlp_RETURN_iff|fact"><span class="entity_def" id="NEMonad.wlp_RETURN_iff|thm"><span>wlp_RETURN_iff</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.wlp|const"><span>wlp</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.RETURN|const"><span>RETURN</span></a><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>

    </span><span class="comment1"><span>(*
  lemma wlp_BIND_iff: "wlp (BIND m f) Q ⟷ wlp m (λx. wlp (f x) Q)"  
    oops
    *)</span></span><span>
      
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.wlp_BIND|fact"><span class="entity_def" id="NEMonad.wlp_BIND|thm"><span>wlp_BIND</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.wp_rule|attribute"><span class="operator"><span>wp_rule</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.wlp|const"><span>wlp</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wlp|const"><span>wlp</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>Q</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wlp|const"><span>wlp</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.BIND|const"><span>BIND</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>Q</span></span><span>"</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
    
  </span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.wp_rule|attribute"><span class="operator"><span>wp_rule</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> 
    </span><a class="entity_ref" href="NEMonad.html#NEMonad.wlp_RETURN_iff|fact"><span>wlp_RETURN_iff</span></a><span class="main"><span>[</span></span><span class="operator"><span>THEN</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iffD2|fact"><span>iffD2</span></a><span class="main"><span>]</span></span><span>  

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.wlp_ASSERT|fact"><span class="entity_def" id="NEMonad.wlp_ASSERT|thm"><span>wlp_ASSERT</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.wp_rule|attribute"><span class="operator"><span>wp_rule</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span class="free"><span>P</span></span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>Q</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Unity|const"><span>()</span></a></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wlp|const"><span>wlp</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="free"><span>P</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>Q</span></span><span>"</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.wlp_ASSUME|fact"><span class="entity_def" id="NEMonad.wlp_ASSUME|thm"><span>wlp_ASSUME</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.wp_rule|attribute"><span class="operator"><span>wp_rule</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>P</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Unity|const"><span>()</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wlp|const"><span>wlp</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.ASSUME|const"><span>ASSUME</span></a><span> </span><span class="free"><span>P</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>Q</span></span><span>"</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
    
            
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.wlp_SPEC|fact"><span class="entity_def" id="NEMonad.wlp_SPEC|thm"><span>wlp_SPEC</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.wp_rule|attribute"><span class="operator"><span>wp_rule</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wlp|const"><span>wlp</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.SPEC|const"><span>SPEC</span></a><span> </span><span class="free"><span>P</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>Q</span></span><span>"</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
    
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.wlp_Let|fact"><span class="entity_def" id="NEMonad.wlp_Let|thm"><span>wlp_Let</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.wp_rule|attribute"><span class="operator"><span>wp_rule</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span>v</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wlp|const"><span>wlp</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>Q</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wlp|const"><span>wlp</span></a><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>=</span></span><span class="free"><span>v</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>Q</span></span><span>"</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
    
    
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.wlp_if|fact"><span class="entity_def" id="NEMonad.wlp_if|thm"><span>wlp_if</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.wp_rule|attribute"><span class="operator"><span>wp_rule</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wlp|const"><span>wlp</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>Q</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>b</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wlp|const"><span>wlp</span></a><span> </span><span class="free"><span>m'</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wlp|const"><span>wlp</span></a><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="free"><span>m'</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>Q</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> 
    
    
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.wlp_if_ext|fact"><span class="entity_def" id="NEMonad.wlp_if_ext|thm"><span>wlp_if_ext</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.wp_rule|attribute"><span class="operator"><span>wp_rule</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span class="free"><span>b</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>P</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>b</span></span><span class="main"><span>⟹</span></span><span class="free"><span>Q</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="free"><span>Q</span></span><span>"</span></span></span><span>   </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NEMonad.wlp_prod_case|fact"><span class="entity_def" id="NEMonad.wlp_prod_case|thm"><span>wlp_prod_case</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.wp_rule|attribute"><span class="operator"><span>wp_rule</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>b</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="main"><span>(</span></span><span class="bound"><span>a</span></span><span class="main"><span>,</span></span><span class="bound"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wlp|const"><span>wlp</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>Q</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wlp|const"><span>wlp</span></a><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>case</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="keyword1"><span>of</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>a</span></span><span class="main"><span>,</span></span><span class="bound"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>Q</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="free"><span>p</span></span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
  
  </span><span class="comment1"><span>(*
  lemma wlp_REC: 
    fixes x :: 'a
    assumes INIT: "P x"
    assumes STEP: "⋀x D. (⋀y. P y ⟹ wlp (D y) (Q y)) ⟹ P x ⟹ wlp (F D x) (Q x)"
    shows "wlp (REC F x) (Q x)"  
  proof -
    thm REC_pointwise_induct
    note R = REC_pointwise_induct[where P="λx m. P x ⟶ wlp m (Q x)"]
    have "P x ⟶ wlp (REC F x) (Q x)"
      apply (rule R)
      apply pw
      using STEP by blast
    with INIT show ?thesis by blast
  qed  
  *)</span></span><span>  
    
    
    
      
  </span><span class="comment1"><span>(*    
  subsection ‹Invariant Annotation›
  text ‹We annotate variants and invariants to WHILE-loops and recursions,
    such that we can automatically generate verification conditions.
    ›
  
  definition WHILEI :: "'a rel ⇒ ('a ⇒ bool) ⇒ ('a ⇒ bool neM) ⇒ ('a ⇒ 'a neM) ⇒ 'a ⇒ 'a neM"
    where 
    "WHILEI V I b f s ≡ WHILE (λs. do<span class="hidden">⇩</span><sub>n</sub><span class="hidden">⇩</span><sub>e</sub> { assert<span class="hidden">⇩</span><sub>n</sub><span class="hidden">⇩</span><sub>e</sub> I s; b s }) (λs. do<span class="hidden">⇩</span><sub>n</sub><span class="hidden">⇩</span><sub>e</sub> { assert<span class="hidden">⇩</span><sub>n</sub><span class="hidden">⇩</span><sub>e</sub> I s; f s }) s"
  
  lemma wp_WHILEI[wp_rule]:
    assumes "wf V"
    assumes "I s"
    assumes STEP: "⋀s. ⟦ I s ⟧ ⟹ wp (b s) (λr. if r then wp (f s) (λs'. I s' ∧ (s',s)∈V) else Q s)"
    shows "wp (WHILEI V I b f s) Q"
    using assms(1,2)
    unfolding WHILEI_def
    apply (intro wp_rule wp_WHILE[where I=I] STEP[THEN wp_cons])
    apply assumption+
    apply simp_all
    done
  
  lemma mono_WHILEI[mono]: 
    assumes "⋀DD x. nres_mono' (λD. b D x)"
    assumes "⋀DD x y. nres_mono' (λD. f D x)"
    shows "nres_mono' (λD. WHILEI V I (b D) (f D) s)"
    unfolding WHILEI_def
    by (intro mono assms)
             
  definition RECI :: "'a rel ⇒ ('a ⇒ bool) ⇒ 
    (('a ⇒ 'b nres) ⇒ 'a ⇒ 'b nres) ⇒ 'a ⇒ 'b nres" where 
    "RECI V P F ≡ REC (λD x. do {assert P x; F D x})"  
    
  lemma wp_RECI[wp_rule]: 
    fixes x :: 'a and V :: "'a rel"
    assumes WF: "wf V"
    assumes MONO: "nres_mono F"
    assumes INIT: "P x"
    assumes STEP: "⋀x D. (⋀y. (y, x) ∈ V ⟹ P y ⟹ wp (D y) (Q y)) ⟹ P x ⟹ wp (F D x) (Q x)"
    shows "wp (RECI V P F x) (Q x)"  
    unfolding RECI_def
    apply (rule wp_REC[of V _ P])
    apply fact
    apply (intro mono MONO[THEN nres_monoD])
    apply fact
    apply (intro wp_rule STEP)
    .

    
  lemma mono_RECI[mono]: 
    assumes "⋀D. nres_mono (F D)"
    assumes "⋀DD x. nres_mono' (λD. F D DD x)"
    shows "nres_mono' (λD. RECI V P (F D) x)"  
    unfolding RECI_def
    by (intro mono assms(1)[THEN nres_monoD] assms(2))
  *)</span></span><span>  
    
  </span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Automation›</span></span></span><span>  
  
  </span><span class="keyword1"><span class="command"><span>named_theorems</span></span></span><span> </span><span class="entity_def" id="NEMonad.wp_recursion_rule|attribute"><span class="entity_def" id="NEMonad.wp_recursion_rule|fact"><span>wp_recursion_rule</span></span></span><span> </span><span class="quoted"><span>‹Rule to trigger resolution with premises›</span></span><span>
  
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="NEMonad.wp_basic_step.wp_basic_step|method"><span>method</span></span></span></span><span> </span><span class="entity_def" id="NEMonad.wp_basic_step|method"><span>wp_basic_step</span></span><span> </span><span class="main"><span>=</span></span><span> 
    </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wp_rule|fact"><span class="dynamic"><span class="dynamic"><span>wp_rule</span></span></span></a><span> 
  </span><span class="main"><span class="keyword3"><span>|</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wp_recursion_rule|fact"><span class="dynamic"><span class="dynamic"><span>wp_recursion_rule</span></span></span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span class="main"><span>(</span></span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>|</span></span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.rprems|method"><span class="operator"><span>rprems</span></span></a><span class="main"><span>)</span></span><span>
  </span><span class="main"><span class="keyword3"><span>|</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pf_mono_prover|method"><span class="operator"><span>pf_mono_prover</span></span></a><span>
  
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="NEMonad.wp_step.wp_step|method"><span>method</span></span></span></span><span> </span><span class="entity_def" id="NEMonad.wp_step|method"><span>wp_step</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Eisbach.Eisbach.html#Eisbach.find_goal|method"><span class="operator"><span>find_goal</span></span></a><span> </span><span class="quoted"><span>‹</span><a class="entity_ref" href="NEMonad.html#NEMonad.wp_basic_step|method"><span class="operator"><span>wp_basic_step</span></span></a><span>›</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="NEMonad.wp.wp|method"><span>method</span></span></span></span><span> </span><span class="entity_def" id="NEMonad.wp|method"><span>wp</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wp_step|method"><span class="operator"><span>wp_step</span></span></a><span class="main"><span class="keyword3"><span>+</span></span></span><span>

  
  </span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.wp_recursion_rule|attribute"><span class="operator"><span>wp_recursion_rule</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wp_cons|fact"><span>wp_cons</span></a><span>
      

  </span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Syntax Bundle›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>bundle</span></span></span><span> </span><span class="entity_def" id="NEMonad.monad_syntax_ne|bundle"><span>monad_syntax_ne</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>syntax</span></span></span><span>
      </span><span class="quoted"><span>"_doI_block"</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#offset_7572..7581"><span>doI_binds</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword1"><span>do</span></span><span> </span><span class="keyword1"><span>{</span></span><span class="keyword3"><span>//</span></span><span class="keyword3"><span>(2</span></span><span>  _</span><span class="keyword3"><span>)</span></span><span class="keyword3"><span>//</span></span><span class="keyword1"><span>}</span></span><span>"</span></span><span> </span><span class="main"><span>[</span></span><span>12</span><span class="main"><span>]</span></span><span> 62</span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>notation</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword1"><span>fail</span></span><span>"</span></span><span class="main"><span>)</span></span><span>  
    </span><span class="keyword1"><span class="command"><span>notation</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword1"><span>return</span></span><span> _"</span></span><span> 20</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>notation</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>binder</span></span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>spec</span></span><span> "</span></span><span> 10</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>notation</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword1"><span>assert</span></span><span> _"</span></span><span> 20</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>notation</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.ASSUME|const"><span>ASSUME</span></a><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword1"><span>assume</span></span><span> _"</span></span><span> 20</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>notation</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.PAR|const"><span>PAR</span></a><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>infixr</span></span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>∥</span></span><span>"</span></span><span> 50</span><span class="main"><span>)</span></span><span>
      
  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
  
    
  </span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Summary›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
    We shallowly embed a basic non-deterministic PL.
    The basic combinators are
    
    </span><span class="antiquoted"><span>▪</span></span><span> </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span>‹</span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.SPEC|const"><span>SPEC</span></a><span> </span><span class="free"><span>P</span></span><span>›</span></span></span><span>: Specify any result that satisfies predicate </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>P›</span></span></span><span>. 
      Special cases:
      </span><span class="antiquoted"><span>▪</span></span><span> </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span>‹</span><a class="entity_ref" href="NEMonad.html#NEMonad.EMPTY|const"><span>EMPTY</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a><span class="main"><span>)</span></span><span>›</span></span></span><span>: specifies a program with no results.
      </span><span class="antiquoted"><span>▪</span></span><span> </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span>‹</span><a class="entity_ref" href="NEMonad.html#NEMonad.RETURN|const"><span>RETURN</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>r</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>: specifies a program with the only result </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>x›</span></span></span><span>.
          Syntax for return, with low binding priority: </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span>‹</span><span class="keyword1"><a class="entity_ref" href="NEMonad.html#NEMonad.RETURN|const"><span>return<span class="hidden">⇩</span><sub>n</sub><span class="hidden">⇩</span><sub>e</sub></span></a></span><span> </span><span class="free"><span>x</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span>›</span></span></span><span>.
    </span><span class="antiquoted"><span>▪</span></span><span> </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span>‹</span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span>›</span></span></span><span>: Specifies a failing program. Failure may be due 
      to non-termination or failed assertions.
    </span><span class="antiquoted"><span>▪</span></span><span> </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span>‹</span><a class="entity_ref" href="NEMonad.html#NEMonad.BIND|const"><span>BIND</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>f</span></span><span>›</span></span></span><span>: Sequential composition. Syntax: </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span>‹</span><span class="keyword1"><span>do<span class="hidden">⇩</span><sub>n</sub><span class="hidden">⇩</span><sub>e</sub></span></span><span> </span><span class="main"><span>{</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>←</span></span><span class="free"><span>m</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>}</span></span><span>›</span></span></span><span>
    </span><span class="antiquoted"><span>▪</span></span><span> </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span>‹</span><a class="entity_ref" href="NEMonad.html#NEMonad.PAR|const"><span>PAR</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span>›</span></span></span><span>: Parallel composition. Syntax: </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span>‹</span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="NEMonad.html#NEMonad.PAR|const"><span>∥<span class="hidden">⇩</span><sub>n</sub><span class="hidden">⇩</span><sub>e</sub></span></a></span><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span>›</span></span></span><span>
    
  
    Any combinator from HOL can be used. We provide support (automation, etc.)
    for the following:
    </span><span class="antiquoted"><span>▪</span></span><span> </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span>‹</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span>›</span></span></span><span>
    </span><span class="antiquoted"><span>▪</span></span><span> </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span>‹</span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>=</span></span><span class="free"><span>v</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span>›</span></span></span><span>
    </span><span class="antiquoted"><span>▪</span></span><span> </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span>‹</span><span class="keyword1"><span>case</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="keyword1"><span>of</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>a</span></span><span class="main"><span>,</span></span><span class="bound"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>b</span></span><span>›</span></span></span><span>
    
    Moreover, we support the following derived combinators:
    </span><span class="antiquoted"><span>▪</span></span><span> </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span>‹</span><a class="entity_ref" href="NEMonad.html#NEMonad.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="free"><span>P</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="NEMonad.html#NEMonad.RETURN|const"><span>return<span class="hidden">⇩</span><sub>n</sub><span class="hidden">⇩</span><sub>e</sub></span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Unity|const"><span>()</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span class="main"><span>)</span></span><span>›</span></span></span><span>. 
      Syntax with lower binding priority: </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span>‹</span><span class="keyword1"><a class="entity_ref" href="NEMonad.html#NEMonad.ASSERT|const"><span>assert<span class="hidden">⇩</span><sub>n</sub><span class="hidden">⇩</span><sub>e</sub></span></a></span><span> </span><span class="free"><span>P</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span class="free"><span>Q</span></span><span>›</span></span></span><span>
    
    For each combinator, we need to provide:
      </span><span class="antiquoted"><span>▪</span></span><span> wp-rule
      </span><span class="antiquoted"><span>▪</span></span><span> mono-rule (if higher-order)
      </span><span class="antiquoted"><span>▪</span></span><span> pw-rule (if non-recursive)
      </span><span class="antiquoted"><span>▪</span></span><span> refinement rule (see later theory on refinement)
    
  ›</span></span></span><span>
  
    
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span></pre>
</body>

</html>