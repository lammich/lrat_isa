<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Sorting_PDQ</title>
</head>


<body>
<div class="head">
<h1>Theory Sorting_PDQ</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><a href="Sorting_PDQ.html"><span>Sorting_PDQ</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> </span><a href="Sorting_Setup.html"><span>Sorting_Setup</span></a><span> </span><a href="Sorting_Partially_Sorted.html"><span>Sorting_Partially_Sorted</span></a><span> </span><a href="Sorting_Pdq_Insertion_Sort.html"><span>Sorting_Pdq_Insertion_Sort</span></a><span> </span><a href="Sorting_Heapsort.html"><span>Sorting_Heapsort</span></a><span> </span><a href="Sorting_Log2.html"><span>Sorting_Log2</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Auxiliary Definitions›</span></span></span><span>


  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.slice_split_part|fact"><span class="entity_def" id="Sorting_PDQ.slice_split_part|thm"><span>slice_split_part</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span>m</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>h</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span> </span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.list.Cons|const"><span>#</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="free"><span>m</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.less_imp_le|fact"><span>less_imp_le</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_append|fact"><span>slice_append</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_split_hd|fact"><span>slice_split_hd</span></a><span class="main"><span>)</span></span><span>

  
  </span><span class="comment1"><span>(* The set properties *)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>context</span></span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.weak_ordering|locale"><span>weak_ordering</span></a><span> </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.sorted_wrt_slice_iff_nth_less|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.sorted_wrt_slice_iff_nth_less|thm"><span class="entity_def" id="offset_407..436">sorted_wrt_slice_iff_nth_less</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span>h</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.sorted_wrt|const"><span>sorted_wrt</span></a><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="bound"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.sorted_wrt_iff_nth_less|fact"><span>sorted_wrt_iff_nth_less</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice_nth|fact"><span>slice_nth</span></a><span class="main"><span>)</span></span><span>      
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>full_types</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.diff_add_inverse|fact"><span>diff_add_inverse</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.diff_less_mono|fact"><span>diff_less_mono</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.le_eq_less_or_eq|fact"><span>le_eq_less_or_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.le_trans|fact"><span>le_trans</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat_le_iff_add|fact"><span>nat_le_iff_add</span></a><span class="main"><span>)</span></span><span>
      

    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.range_leq_set_slice_conv|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.range_leq_set_slice_conv(2)|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.range_leq_set_slice_conv(1)|thm"><span class="entity_def" id="offset_760..784">range_leq_set_slice_conv</span></span></span></span><span class="main"><span>:</span></span><span> 
      </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span>pv</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>x</span></span><span class="main"><span>∈</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list.set|const"><span>set</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span class="free"><span>pv</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span><span class="hidden">❙</span><b>≥</b></span></span><span> </span><span class="free"><span>pv</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>x</span></span><span class="main"><span>∈</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list.set|const"><span>set</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span><span class="hidden">❙</span><b>≥</b></span></span><span class="free"><span>pv</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.set_slice_conv|fact"><span>set_slice_conv</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Ball_def|fact"><span>Ball_def</span></a><span class="main"><span>)</span></span><span>
      
      
  
    </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Predicate to express that slice is partitioned›</span></span></span><span>              
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.partitioned_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.partitioned_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.partitioned_def_raw|axiom"><span class="entity_def" id="offset_1086..1096">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.partitioned.cong|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.partitioned.cong|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.partitioned|const"><span class="entity_def" id="offset_1098..1109">partitioned</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>pv</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> 
          </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span>
        </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>pv</span></span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>pv</span></span></span></span><span> 
        </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>{</span></a></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>&lt;..&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span><span class="hidden">❙</span><b>≥</b></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>pv</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.partitioned_alt|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.partitioned_alt|thm"><span class="entity_def" id="offset_1263..1278">partitioned_alt</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#offset_1098..1109"><span>partitioned</span></a><span> </span><span class="free"><span>pv</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> 
          </span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span>
        </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>x</span></span><span class="main"><span>∈</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list.set|const"><span>set</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span>pv</span></span><span class="main"><span>)</span></span><span>
        </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>pv</span></span><span> 
        </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>x</span></span><span class="main"><span>∈</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list.set|const"><span>set</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span><span class="hidden">❙</span><b>≥</b></span></span><span> </span><span class="free"><span>pv</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>    
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_1086..1096"><span>partitioned_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iffI|fact"><span>iffI</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.in_set_conv_nth|fact"><span>in_set_conv_nth</span></a><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice_nth|fact"><span>slice_nth</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_760..784"><span>range_leq_set_slice_conv</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>


    </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Shuffling a partition does not change partitioned property›</span></span></span><span>            
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle_pres_part|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle_pres_part(2)|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle_pres_part(1)|thm"><span class="entity_def" id="offset_1744..1761">shuffle_pres_part</span></span></span></span><span class="main"><span>:</span></span><span>
      </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#offset_1098..1109"><span>partitioned</span></a><span> </span><span class="free"><span>pv</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset|const"><span>slice_eq_mset</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_1098..1109"><span>partitioned</span></a><span> </span><span class="free"><span>pv</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span>"</span></span></span><span>  
      </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#offset_1098..1109"><span>partitioned</span></a><span> </span><span class="free"><span>pv</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset|const"><span>slice_eq_mset</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="free"><span>m</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_1098..1109"><span>partitioned</span></a><span> </span><span class="free"><span>pv</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_1263..1278"><span>partitioned_alt</span></a><span>
      </span><span class="comment1"><span>(* TODO: Clean up proof *)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_alt|fact"><span>slice_eq_mset_alt</span></a><span> </span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_eq_length|fact"><span>slice_eq_mset_eq_length</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.eq_outside_range_nth|fact"><span>eq_outside_range_nth</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_outside_range|fact"><span>slice_eq_outside_range</span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset_eq_setD|fact"><span>mset_eq_setD</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_alt|fact"><span>slice_eq_mset_alt</span></a><span> </span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span>  </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.eq_outside_range_nth|fact"><span>eq_outside_range_nth</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_outside_range|fact"><span>slice_eq_outside_range</span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset_eq_setD|fact"><span>mset_eq_setD</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      

    </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹After sorting the partitions, the whole slice is sorted.›</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_2426..2431">lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.parts_sorted_imp_sorted|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.parts_sorted_imp_sorted|thm"><span class="entity_def" id="offset_2432..2455">parts_sorted_imp_sorted</span></span></span><span class="main"><span>:</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#offset_1098..1109"><span>partitioned</span></a><span> </span><span class="free"><span>pv</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span>"</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.sorted_wrt_lt|const"><span>sorted_wrt_lt</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.sorted_wrt_lt|const"><span>sorted_wrt_lt</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="free"><span>m</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.sorted_wrt_lt|const"><span>sorted_wrt_lt</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_2426..2431"><span>assms</span></a><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_1086..1096"><span>partitioned_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice_nth|fact"><span>slice_nth</span></a><span> </span><span>le_by_lt</span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_407..436"><span>sorted_wrt_slice_iff_nth_less</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>,</span></span></span><span> lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc_leI|fact"><span>Suc_leI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan_iff|fact"><span>atLeastLessThan_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan_iff|fact"><span>greaterThanLessThan_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.linorder_neqE_nat|fact"><span>linorder_neqE_nat</span></a><span> </span><span>local.trans</span><span class="main"><span>)</span></span><span>
      
            
  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>    

  </span><span class="comment1"><span>(*
    Configuration options for Pdqsort
  *)</span></span><span>    
  </span><span class="keyword1"><span class="command"><span>abbreviation</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.is_threshold|const"><span>is_threshold</span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="numeral"><span>16</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span>"</span></span></span><span>  </span><span class="comment1"><span>(* TODO/FIXME: replace by pdq_is_threshold, and remove *)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>abbreviation</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.pdq_is_threshold|const"><span>pdq_is_threshold</span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="numeral"><span>24</span></span><span>"</span></span></span><span>
    
  </span><span class="keyword1"><span class="command"><span>abbreviation</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.ninther_threshold|const"><span>ninther_threshold</span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="numeral"><span>128</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_3173..3180">context</span></span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.weak_ordering|locale"><span>weak_ordering</span></a><span> </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Phases of Quicksort Scheme›</span></span></span><span>
    
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_range_cond_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_range_cond_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_range_cond_def_raw|axiom"><span class="entity_def" id="offset_3254..3264">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_range_cond.cong|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_range_cond.cong|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_range_cond|const"><span class="entity_def" id="offset_3266..3281">part_range_cond</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="main"><span>(</span></span><span>
          </span><span class="main"><span>∃</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∃</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span><span class="hidden">❙</span><b>≥</b></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

    </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Pivot has been selected and moved to front›</span></span></span><span>      
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.R_PV_TO_FRONT_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.R_PV_TO_FRONT_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.R_PV_TO_FRONT_def_raw|axiom"><span class="entity_def" id="offset_3436..3446">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.R_PV_TO_FRONT.cong|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.R_PV_TO_FRONT.cong|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.R_PV_TO_FRONT|const"><span class="entity_def" id="offset_3448..3461">R_PV_TO_FRONT</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs'</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset|const"><span>slice_eq_mset</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs'</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3266..3281"><span>part_range_cond</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs'</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span>"</span></span></span><span>
    
    </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Slice has been partitioned›</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.R_PART_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.R_PART_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.R_PART_def_raw|axiom"><span class="entity_def" id="offset_3596..3606">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.R_PART.cong|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.R_PART.cong|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.R_PART|const"><span class="entity_def" id="offset_3608..3614">R_PART</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>pv</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs'</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset|const"><span>slice_eq_mset</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs'</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_1098..1109"><span>partitioned</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>pv</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs'</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span>"</span></span></span><span>

    </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Left partition has been sorted›</span></span></span><span>    
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.R_SORT_L_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.R_SORT_L_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.R_SORT_L_def_raw|axiom"><span class="entity_def" id="offset_3763..3773">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.R_SORT_L.cong|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.R_SORT_L.cong|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.R_SORT_L|const"><span class="entity_def" id="offset_3775..3783">R_SORT_L</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>pv</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs'</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3608..3614"><span>R_PART</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>pv</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs'</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.sorted_wrt_lt|const"><span>sorted_wrt_lt</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs'</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    
    </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Right partition has been sorted›</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.R_SORT_R_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.R_SORT_R_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.R_SORT_R_def_raw|axiom"><span class="entity_def" id="offset_3915..3925">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.R_SORT_R.cong|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.R_SORT_R.cong|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.R_SORT_R|const"><span class="entity_def" id="offset_3927..3935">R_SORT_R</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>pv</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs'</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3775..3783"><span>R_SORT_L</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>pv</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs'</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.sorted_wrt_lt|const"><span>sorted_wrt_lt</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs'</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

    </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹When right partition has been sorted, the whole slice is already sorted. ›</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.R_SORT_R_sorted|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.R_SORT_R_sorted|thm"><span class="entity_def" id="offset_4121..4136">R_SORT_R_sorted</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#offset_3927..3935"><span>R_SORT_R</span></a><span> </span><span class="free"><span>pv</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset|const"><span>slice_eq_mset</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.sorted_wrt_lt|const"><span>sorted_wrt_lt</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3915..3925"><span>R_SORT_R_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3763..3773"><span>R_SORT_L_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3596..3606"><span>R_PART_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_2432..2455"><span>parts_sorted_imp_sorted</span></a><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Sorting the whole partition, e.g., due to heapsort fallback›</span></span></span><span>      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.R_PART_SORT|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.R_PART_SORT|thm"><span class="entity_def" id="offset_4416..4427">R_PART_SORT</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#offset_3608..3614"><span>R_PART</span></a><span> </span><span class="free"><span>pv</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.slice_sort_spec|const"><span>slice_sort_spec</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>xs''</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset|const"><span>slice_eq_mset</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="bound"><span>xs''</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.sorted_wrt_lt|const"><span>sorted_wrt_lt</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="bound"><span>xs''</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.slice_sort_spec_sem_alt|fact"><span>slice_sort_spec_sem_alt</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3596..3606"><span>R_PART_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_eq_length|fact"><span>slice_eq_mset_eq_length</span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_trans|fact"><span>slice_eq_mset_trans</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

      
    </span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Specifications of Subroutines›</span></span></span><span>
      

    </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Move pivot to front›</span></span></span><span>          
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.pivot_to_front_spec_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.pivot_to_front_spec_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.pivot_to_front_spec_def_raw|axiom"><span class="entity_def" id="offset_4835..4845">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.pivot_to_front_spec.cong|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.pivot_to_front_spec.cong|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.pivot_to_front_spec|const"><span class="entity_def" id="offset_4847..4866">pivot_to_front_spec</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>xs'</span></span><span class="main"><span>.</span></span><span> 
          </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset|const"><span>slice_eq_mset</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="bound"><span>xs'</span></span><span>
        </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3266..3281"><span>part_range_cond</span></a><span> </span><span class="bound"><span>xs'</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span>
      </span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>

    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.pivot_to_front_spec_rl|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.pivot_to_front_spec_rl|thm"><span class="entity_def" id="offset_5038..5060">pivot_to_front_spec_rl</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>h</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_4847..4866"><span>pivot_to_front_spec</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>xs'</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3448..3461"><span>R_PV_TO_FRONT</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="bound"><span>xs'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_4835..4845"><span>pivot_to_front_spec_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3436..3446"><span>R_PV_TO_FRONT_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

    </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Partition›</span></span></span><span>          
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.partition_spec_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.partition_spec_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.partition_spec_def_raw|axiom"><span class="entity_def" id="offset_5268..5278">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.partition_spec.cong|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.partition_spec.cong|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.partition_spec|const"><span class="entity_def" id="offset_5280..5294">partition_spec</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span> 
          </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> 
        </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3266..3281"><span>part_range_cond</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span>
      </span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>alrp</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a><span class="main"><span>,</span></span><span class="bound"><span>m</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs'</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> 
          </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset|const"><span>slice_eq_mset</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="bound"><span>xs'</span></span><span>
        </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="bound"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span>
        </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_1098..1109"><span>partitioned</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>xs'</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="bound"><span>m</span></span><span>
      </span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>

    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.partition_left_spec_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.partition_left_spec_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.partition_left_spec_def_raw|axiom"><span class="entity_def" id="offset_5553..5563">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.partition_left_spec.cong|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.partition_left_spec.cong|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.partition_left_spec|const"><span class="entity_def" id="offset_5565..5584">partition_left_spec</span></span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_5280..5294"><span>partition_spec</span></a><span>"</span></span></span><span> </span><span class="comment1"><span>(* No discrimination required on this abs-level *)</span></span><span>
    
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.partition_spec_rl|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.partition_spec_rl|thm"><span class="entity_def" id="offset_5669..5686">partition_spec_rl</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#offset_3448..3461"><span>R_PV_TO_FRONT</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_5280..5294"><span>partition_spec</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="bound"><span>m</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs'</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3608..3614"><span>R_PART</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>l</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="bound"><span>m</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="bound"><span>xs'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_5268..5278"><span>partition_spec_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3436..3446"><span>R_PV_TO_FRONT_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3596..3606"><span>R_PART_def</span></a><span> 
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_eq_length|fact"><span>slice_eq_mset_eq_length</span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_trans|fact"><span>slice_eq_mset_trans</span></a><span class="main"><span>)</span></span><span>
    
      
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_5973..5978">lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.aux1|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.aux1|thm"><span class="entity_def" id="offset_5979..5983">aux1</span></span></span><span class="main"><span>:</span></span><span> 
      </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_6000..6006">BOUNDS</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>l</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>m</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>h</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs'</span></span><span>"</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_6055..6063">NOT_LESS</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span> </span><span class="free"><span>prev</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>&lt;</b></span></span></span><span> </span><span class="free"><span>pv</span></span><span>"</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_6094..6098">PART</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#offset_1098..1109"><span>partitioned</span></a><span> </span><span class="free"><span>pv</span></span><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span>"</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_6141..6146">LPART</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>∀</span></span><span class="bound"><span>x</span></span><span class="main"><span>∈</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list.set|const"><span>set</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs'</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>prev</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="bound"><span>x</span></span><span>"</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"
       </span><span class="main"><span>⟦</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>l</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3266..3281"><span>part_range_cond</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset|const"><span>slice_eq_mset</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="main"><span>⟧</span></span><span>
       </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.sorted_wrt_lt|const"><span>sorted_wrt_lt</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    
      </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_6055..6063"><span>NOT_LESS</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>pv</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span>prev</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>wo_leI</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    
      </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_6094..6098"><span>PART</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_6414..6426">LEFT_PART_LE</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>xs'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span>pv</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3173..3180"><span>partitioned_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      
      </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_6141..6146"><span>LPART</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_6525..6532">PREV_LE</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>prev</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span>xs'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_5973..5978"><span>assms</span></a><span class="main"><span>(</span></span><span>3</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_760..784"><span>range_leq_set_slice_conv</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
        
      </span><span class="keyword1"><span class="command"><span>{</span></span></span><span>
        </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="skolem"><span>j</span></span><span>
        </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="skolem"><span>i</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="skolem"><span>j</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>m</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>xs'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span>xs'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="skolem"><span>j</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Meson/meson_tactic.ML.html#Meson.meson|method"><span class="operator"><span>meson</span></span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_6414..6426"><span>LEFT_PART_LE</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_6525..6532"><span>PREV_LE</span></a><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>pv</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span>prev</span></span><span>›</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_5973..5978"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan_iff|fact"><span>atLeastLessThan_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.le_less_trans|fact"><span>le_less_trans</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.less_imp_le_nat|fact"><span>less_imp_le_nat</span></a><span> </span><span>local.trans</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>}</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.sorted_wrt_lt|const"><span>sorted_wrt_lt</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_6000..6006"><span>BOUNDS</span></a><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_407..436"><span>sorted_wrt_slice_iff_nth_less</span></a><span> </span><span>le_by_lt</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>    
    
    </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Correctness lemma for the partition-left optimization for many equal elements.›</span></span></span><span>      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.partition_left_spec_rl|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.partition_left_spec_rl|thm"><span class="entity_def" id="offset_7111..7133">partition_left_spec_rl</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><a class="entity_ref" href="Sorting_PDQ.html#offset_3448..3461"><span>R_PV_TO_FRONT</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>l</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="main"><span>(</span></span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>&lt;</b></span></span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>l</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>x</span></span><span class="main"><span>∈</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list.set|const"><span>set</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="main"><span>(</span></span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟧</span></span><span> 
      </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_5565..5584"><span>partition_left_spec</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="bound"><span>m</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs'</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3775..3783"><span>R_SORT_L</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>l</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="bound"><span>m</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="bound"><span>xs'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_5268..5278"><span>partition_spec_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_5553..5563"><span>partition_left_spec_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3436..3446"><span>R_PV_TO_FRONT_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3596..3606"><span>R_PART_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3763..3773"><span>R_SORT_L_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> 
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_eq_length|fact"><span>slice_eq_mset_eq_length</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_nth_outside|fact"><span>slice_eq_mset_nth_outside</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_set_inside|fact"><span>slice_eq_mset_set_inside</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_5979..5983"><span>aux1</span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_trans|fact"><span>slice_eq_mset_trans</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

    </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Shuffle. We only specify that the partitions must contain the same elements.›</span></span></span><span>        
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle_spec_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle_spec_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle_spec_def_raw|axiom"><span class="entity_def" id="offset_7698..7708">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle_spec|const"><span>shuffle_spec</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>unbal</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs'</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> 
        </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.eq_outside_range|const"><span>eq_outside_range</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="bound"><span>xs'</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span>
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="bound"><span>xs'</span></span><span class="main"><span>)</span></span><span>  
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="bound"><span>xs'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span>
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="bound"><span>xs'</span></span><span class="main"><span>)</span></span><span>  
      </span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>

    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle_rule|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle_rule|thm"><span class="entity_def" id="offset_8004..8016">shuffle_rule</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><a class="entity_ref" href="Sorting_PDQ.html#offset_3608..3614"><span>R_PART</span></a><span> </span><span class="free"><span>pv</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_spec|const"><span>shuffle_spec</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="bound"><span>xs'</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3608..3614"><span>R_PART</span></a><span> </span><span class="free"><span>pv</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="bound"><span>xs'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3596..3606"><span>R_PART_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_7698..7708"><span>shuffle_spec_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_1263..1278"><span>partitioned_alt</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_alt|fact"><span>slice_eq_mset_alt</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.eq_outside_rane_lenD|fact"><span>eq_outside_rane_lenD</span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset_eq_setD|fact"><span>mset_eq_setD</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_alt|fact"><span>slice_eq_mset_alt</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.eq_outside_range_def|fact"><span>eq_outside_range_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> xs<span class="hidden">⇩</span><sub>2</sub> 
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/ISABELLE_HOME/src/HOL/Library/rewrite.ML.html#Rewrite.rewrite|method"><span class="operator"><span>rewrite</span></span></a><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>in</span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/HOL-Library.Rewrite.html#Rewrite.rewrite_HOLE|const"><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/HOL-Library.Rewrite.html#Rewrite.rewrite_HOLE|const"><span>⌑</span></a></span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span></a></span><span> </span><span class="main"><span class="main"><span>_</span></span></span><span>"</span></span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.slice_split_part|fact"><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.slice_split_part|fact"><span>slice_split_part</span></a></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.eq_outside_rane_lenD|fact"><span>eq_outside_rane_lenD</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/ISABELLE_HOME/src/HOL/Library/rewrite.ML.html#Rewrite.rewrite|method"><span class="operator"><span>rewrite</span></span></a><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>in</span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span>_</span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/HOL-Library.Rewrite.html#Rewrite.rewrite_HOLE|const"><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/HOL-Library.Rewrite.html#Rewrite.rewrite_HOLE|const"><span>⌑</span></a></span></a></span><span>"</span></span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.slice_split_part|fact"><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.slice_split_part|fact"><span>slice_split_part</span></a></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.eq_outside_rane_lenD|fact"><span>eq_outside_rane_lenD</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

    </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Maybe-Sort: The specification nondeterministically decides whether to sort or not. 
      In any case, the elements are permutated.
    ›</span></span></span><span>          
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.maybe_sort_rule1|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.maybe_sort_rule1|thm"><span class="entity_def" id="offset_8728..8744">maybe_sort_rule1</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#offset_3608..3614"><span>R_PART</span></a><span> </span><span class="free"><span>pv</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span>maybe_sort_spec</span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>m</span></span><span> 
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>r</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs'</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>r</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><a class="entity_ref" href="Sorting_PDQ.html#offset_3775..3783"><span>R_SORT_L</span></a><span> </span><span class="free"><span>pv</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="bound"><span>xs'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3608..3614"><span>R_PART</span></a><span> </span><span class="free"><span>pv</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="bound"><span>xs'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3173..3180"><span>maybe_sort_spec_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3596..3606"><span>R_PART_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3763..3773"><span>R_SORT_L_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_eq_length|fact"><span>slice_eq_mset_eq_length</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Meson/meson_tactic.ML.html#Meson.meson|method"><span class="operator"><span>meson</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.eq_imp_le|fact"><span>eq_imp_le</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.less_imp_le|fact"><span>less_imp_le</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_subslice|fact"><span>slice_eq_mset_subslice</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_trans|fact"><span>slice_eq_mset_trans</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_1744..1761"><span>shuffle_pres_part</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Meson/meson_tactic.ML.html#Meson.meson|method"><span class="operator"><span>meson</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.less_or_eq_imp_le|fact"><span>less_or_eq_imp_le</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_subslice|fact"><span>slice_eq_mset_subslice</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_trans|fact"><span>slice_eq_mset_trans</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_1744..1761"><span>shuffle_pres_part</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.maybe_sort_rule2|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.maybe_sort_rule2|thm"><span class="entity_def" id="offset_9328..9344">maybe_sort_rule2</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#offset_3775..3783"><span>R_SORT_L</span></a><span> </span><span class="free"><span>pv</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span>maybe_sort_spec</span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="free"><span>m</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>h</span></span><span> 
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>r</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs'</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>r</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><a class="entity_ref" href="Sorting_PDQ.html#offset_3927..3935"><span>R_SORT_R</span></a><span> </span><span class="free"><span>pv</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="bound"><span>xs'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="bound"><span>r</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3775..3783"><span>R_SORT_L</span></a><span> </span><span class="free"><span>pv</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="bound"><span>xs'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3173..3180"><span>maybe_sort_spec_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3596..3606"><span>R_PART_def</span></a><span>  </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3763..3773"><span>R_SORT_L_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3915..3925"><span>R_SORT_R_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_eq_length|fact"><span>slice_eq_mset_eq_length</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_eq_outside|fact"><span>slice_eq_mset_eq_outside</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Meson/meson_tactic.ML.html#Meson.meson|method"><span class="operator"><span>meson</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.le_SucI|fact"><span>le_SucI</span></a><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.nat_in_between_eq|fact"><span>nat_in_between_eq</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order.strict_implies_order|fact"><span>order.strict_implies_order</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_subslice|fact"><span>slice_eq_mset_subslice</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_trans|fact"><span>slice_eq_mset_trans</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_1744..1761"><span>shuffle_pres_part</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span> 
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Meson/meson_tactic.ML.html#Meson.meson|method"><span class="operator"><span>meson</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.le_SucI|fact"><span>le_SucI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.le_refl|fact"><span>le_refl</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.less_imp_le_nat|fact"><span>less_imp_le_nat</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_subslice|fact"><span>slice_eq_mset_subslice</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_trans|fact"><span>slice_eq_mset_trans</span></a><span class="main"><span>)</span></span><span> 
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_1744..1761"><span>shuffle_pres_part</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span> 
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
    
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.sort_rule1|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.sort_rule1|thm"><span class="entity_def" id="offset_10067..10077">sort_rule1</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#offset_3608..3614"><span>R_PART</span></a><span> </span><span class="free"><span>pv</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.slice_sort_spec|const"><span>slice_sort_spec</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>m</span></span><span>
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>xs'</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3775..3783"><span>R_SORT_L</span></a><span> </span><span class="free"><span>pv</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="bound"><span>xs'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.slice_sort_spec_sem_alt|fact"><span>slice_sort_spec_sem_alt</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3596..3606"><span>R_PART_def</span></a><span>  </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3763..3773"><span>R_SORT_L_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3915..3925"><span>R_SORT_R_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_eq_length|fact"><span>slice_eq_mset_eq_length</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_eq_outside|fact"><span>slice_eq_mset_eq_outside</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Meson/meson_tactic.ML.html#Meson.meson|method"><span class="operator"><span>meson</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.le_refl|fact"><span>le_refl</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.less_imp_le_nat|fact"><span>less_imp_le_nat</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_subslice|fact"><span>slice_eq_mset_subslice</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_trans|fact"><span>slice_eq_mset_trans</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_1744..1761"><span>shuffle_pres_part</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.sort_again_rule1|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.sort_again_rule1|thm"><span>sort_again_rule1</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#offset_3775..3783"><span>R_SORT_L</span></a><span> </span><span class="free"><span>pv</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.slice_sort_spec|const"><span>slice_sort_spec</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>m</span></span><span>
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>xs'</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3775..3783"><span>R_SORT_L</span></a><span> </span><span class="free"><span>pv</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="bound"><span>xs'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.slice_sort_spec_sem_alt|fact"><span>slice_sort_spec_sem_alt</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3596..3606"><span>R_PART_def</span></a><span>  </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3763..3773"><span>R_SORT_L_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3915..3925"><span>R_SORT_R_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_eq_length|fact"><span>slice_eq_mset_eq_length</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_eq_outside|fact"><span>slice_eq_mset_eq_outside</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Meson/meson_tactic.ML.html#Meson.meson|method"><span class="operator"><span>meson</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.le_refl|fact"><span>le_refl</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.less_imp_le_nat|fact"><span>less_imp_le_nat</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_subslice|fact"><span>slice_eq_mset_subslice</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_trans|fact"><span>slice_eq_mset_trans</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_1744..1761"><span>shuffle_pres_part</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
            
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.sort_rule2|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.sort_rule2|thm"><span class="entity_def" id="offset_11030..11040">sort_rule2</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#offset_3775..3783"><span>R_SORT_L</span></a><span> </span><span class="free"><span>pv</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.slice_sort_spec|const"><span>slice_sort_spec</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="free"><span>m</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>h</span></span><span>
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>xs'</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3927..3935"><span>R_SORT_R</span></a><span> </span><span class="free"><span>pv</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="bound"><span>xs'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.slice_sort_spec_sem_alt|fact"><span>slice_sort_spec_sem_alt</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3596..3606"><span>R_PART_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3763..3773"><span>R_SORT_L_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3915..3925"><span>R_SORT_R_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_eq_length|fact"><span>slice_eq_mset_eq_length</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_eq_outside|fact"><span>slice_eq_mset_eq_outside</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Meson/meson_tactic.ML.html#Meson.meson|method"><span class="operator"><span>meson</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.le_Suc_eq|fact"><span>le_Suc_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.less_imp_le_nat|fact"><span>less_imp_le_nat</span></a><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.nat_in_between_eq|fact"><span>nat_in_between_eq</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_subslice|fact"><span>slice_eq_mset_subslice</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_trans|fact"><span>slice_eq_mset_trans</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_1744..1761"><span>shuffle_pres_part</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
            
      
    </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Fallback sorting. Will be instantiated by Heapsort later.›</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.fallback_sort_spec_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.fallback_sort_spec_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.fallback_sort_spec_def_raw|axiom"><span class="entity_def" id="offset_11612..11622">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.fallback_sort_spec.cong|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.fallback_sort_spec.cong|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.fallback_sort_spec|const"><span class="entity_def" id="offset_11624..11642">fallback_sort_spec</span></span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.slice_sort_spec|const"><span>slice_sort_spec</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span>"</span></span></span><span>      
      

    </span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Abstract Pdqsort›</span></span></span><span>          
    </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Recursive Pdqsort function.›</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.pdqsort_aux_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.pdqsort_aux_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.pdqsort_aux_def_raw|axiom"><span class="entity_def" id="offset_11768..11778">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.pdqsort_aux.cong|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.pdqsort_aux.cong|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.pdqsort_aux|const"><span class="entity_def" id="offset_11780..11791">pdqsort_aux</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>leftmost</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/RefineG_Recursion.html#RefineG_Recursion.RECT|const"><span>RECT</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>pdqsort_aux</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>leftmost</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>l</span></span><span class="main"><span>,</span></span><span class="bound"><span>h</span></span><span class="main"><span>,</span></span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="bound"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="bound"><span>leftmost</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="bound"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>x</span></span><span class="main"><span>∈</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list.set|const"><span>set</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="bound"><span>l</span></span><span> </span><span class="bound"><span>h</span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="main"><span>(</span></span><span class="bound"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      
      </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="bound"><span>l</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.pdq_is_threshold|const"><span>pdq_is_threshold</span></a><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> 
        </span><span>pdq_guarded_sort_spec</span><span> </span><span class="bound"><span>leftmost</span></span><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="bound"><span>h</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
        </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_4847..4866"><span>pivot_to_front_spec</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="bound"><span>h</span></span><span class="main"><span>;</span></span><span>

        </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
        </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="bound"><span>leftmost</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="bound"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>         
        </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="bound"><span>leftmost</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="main"><span>(</span></span><span class="bound"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>&lt;</b></span></span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>l</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
          </span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="bound"><span>m</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_5565..5584"><span>partition_left_spec</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="bound"><span>h</span></span><span class="main"><span>;</span></span><span>
          </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>h</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
          </span><span class="bound"><span>pdqsort_aux</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>,</span></span><span class="bound"><span>h</span></span><span class="main"><span>,</span></span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span>
        </span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
          </span><span class="main"><span>(</span></span><span class="bound"><span>alrp</span></span><span class="main"><span>,</span></span><span class="bound"><span>m</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_5280..5294"><span>partition_spec</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="bound"><span>h</span></span><span class="main"><span>;</span></span><span>
          </span><span class="main"><span>(</span></span><span class="bound"><span>unbal</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_spec|const"><span>shuffle_spec</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="bound"><span>h</span></span><span> </span><span class="bound"><span>m</span></span><span class="main"><span>;</span></span><span>
          
          </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
          </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>d</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="bound"><span>unbal</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="bound"><span>d</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
          
          </span><span class="main"><span>(</span></span><span class="bound"><span>didsort</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> 
            </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="bound"><span>d</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_11624..11642"><span>fallback_sort_spec</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="bound"><span>h</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>
            </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="bound"><span>alrp</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="bound"><span>unbal</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
              </span><span class="main"><span>(</span></span><span class="bound"><span>r</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><span>maybe_sort_spec</span><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="bound"><span>m</span></span><span class="main"><span>;</span></span><span>
              </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
                </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>h</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
                </span><span>maybe_sort_spec</span><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>h</span></span><span>
              </span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span>
            </span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
            
          </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="bound"><span>didsort</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>xs</span></span><span> 
          </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span> </span><span class="comment1"><span>⌦‹TODO: Test optimization of not sorting left partition again, if maybe_sort sorted it›</span></span><span>
            </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><span class="bound"><span>pdqsort_aux</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>leftmost</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>l</span></span><span class="main"><span>,</span></span><span class="bound"><span>m</span></span><span class="main"><span>,</span></span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
            </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>h</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
            </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><span class="bound"><span>pdqsort_aux</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>,</span></span><span class="bound"><span>h</span></span><span class="main"><span>,</span></span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
            </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>xs</span></span><span>
          </span><span class="main"><span>}</span></span><span> 
        </span><span class="main"><span>}</span></span><span>
      </span><span class="main"><span>}</span></span><span>
    
    </span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>leftmost</span></span></span></span><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    

    </span><span class="comment1"><span>(*
      The correctness proof is some manual fiddling with the VCG, 
      but essentially uses the lemmas proved above.
    *)</span></span><span>    
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_13489..13494">lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.pdqsort_aux_correct|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.pdqsort_aux_correct|thm"><span class="entity_def" id="offset_13495..13514">pdqsort_aux_correct</span></span></span><span class="main"><span>:</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span>h</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>leftmost</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>x</span></span><span class="main"><span>∈</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list.set|const"><span>set</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="main"><span>(</span></span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>d</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>  
      </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#offset_11780..11791"><span>pdqsort_aux</span></a><span> </span><span class="free"><span>leftmost</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.slice_sort_spec|const"><span>slice_sort_spec</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_11768..11778"><span>pdqsort_aux_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_11612..11622"><span>fallback_sort_spec_def</span></a><span>
      
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order_trans|fact"><span>order_trans</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/RefineG_Recursion.html#RefineG_Recursion.RECT_rule|fact"><span>RECT_rule</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> 
            V</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Wellfounded.html#Wellfounded.measure|const"><span>measure</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>leftmost</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>l</span></span><span class="main"><span>,</span></span><span class="bound"><span>h</span></span><span class="main"><span>,</span></span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="bound"><span>l</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
        </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> pre</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>leftmost</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>l</span></span><span class="main"><span>,</span></span><span class="bound"><span>h</span></span><span class="main"><span>,</span></span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="bound"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>d</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="bound"><span>leftmost</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="bound"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>x</span></span><span class="main"><span>∈</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list.set|const"><span>set</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="bound"><span>l</span></span><span> </span><span class="bound"><span>h</span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="main"><span>(</span></span><span class="bound"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> M</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>leftmost</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>l</span></span><span class="main"><span>,</span></span><span class="bound"><span>h</span></span><span class="main"><span>,</span></span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.slice_sort_spec|const"><span>slice_sort_spec</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="bound"><span>h</span></span><span>"</span></span></span><span>
        </span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Mono_Prover.html#Refine_Mono_Prover.refine_mono|method"><span class="operator"><span>refine_mono</span></span></a><span class="main"><span>)</span></span><span>

              
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>  
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_13489..13494"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>premises</span></span></span><span> </span><span class="entity_def" id="offset_14184..14189">prems</span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> pdqsort args </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
      
        </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>leftmost</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>xs</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>l</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>h</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>d</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>args</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>leftmost</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>l</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>h</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>d</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="skolem"><span>args</span></span></span><span class="main"><span>)</span></span><span>
      
        </span><span class="keyword1"><span class="command"><span>note</span></span></span><span> </span><span class="entity_def" id="offset_14338..14340">IH</span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_14184..14189"><span>prems</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>note</span></span></span><span> </span><span class="entity_def" id="offset_14365..14373">LEFTMOST</span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_14184..14189"><span>prems</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span>
      
        </span><span class="keyword1"><span class="command"><span>{</span></span></span><span>
          </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>pv</span></span><span> </span><span class="skolem"><span>m</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="skolem"><span>xs'</span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="skolem"><span>d'</span></span><span class="main"><span>::</span></span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a></span><span>
          </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#offset_3775..3783"><span>R_SORT_L</span></a><span> </span><span class="skolem"><span>pv</span></span><span> </span><span class="skolem"><span>l</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="skolem"><span>m</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="skolem"><span>xs'</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="skolem"><span>d'</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>pdqsort</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a><span class="main"><span>,</span></span><span class="skolem"><span>xs'</span></span><span class="main"><span>,</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="skolem"><span>m</span></span><span class="main"><span>,</span></span><span class="skolem"><span>h</span></span><span class="main"><span>,</span></span><span class="skolem"><span>d'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>xs''</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3927..3935"><span>R_SORT_R</span></a><span> </span><span class="skolem"><span>pv</span></span><span> </span><span class="skolem"><span>l</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="skolem"><span>m</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="bound"><span>xs''</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>-</span></span><span>
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order_trans|fact"><span>order_trans</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_14338..14340"><span>IH</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3763..3773"><span>R_SORT_L_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3596..3606"><span>R_PART_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_1263..1278"><span>partitioned_alt</span></a><span class="main"><span>)</span></span><span>
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3763..3773"><span>R_SORT_L_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3596..3606"><span>R_PART_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_1263..1278"><span>partitioned_alt</span></a><span class="main"><span>)</span></span><span>
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_11030..11040"><span>sort_rule2</span></a><span class="main"><span>)</span></span><span>
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_14876..14877">}</span></span></span><span> </span><span class="keyword1"><span class="command"><span>note</span></span></span><span> </span><span class="entity_def" id="offset_14883..14896">rec_sort_r_rl</span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_14876..14877"><span>this</span></a><span>
        
        </span><span class="keyword1"><span class="command"><span>{</span></span></span><span>
          </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>pv</span></span><span> </span><span class="skolem"><span>m</span></span><span> </span><span class="skolem"><span>xs'</span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="skolem"><span>d'</span></span><span class="main"><span>::</span></span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a></span><span>
          </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#offset_3608..3614"><span>R_PART</span></a><span> </span><span class="skolem"><span>pv</span></span><span> </span><span class="skolem"><span>l</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="skolem"><span>m</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="skolem"><span>xs'</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="skolem"><span>d'</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>pdqsort</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>leftmost</span></span><span class="main"><span>,</span></span><span class="skolem"><span>xs'</span></span><span class="main"><span>,</span></span><span class="skolem"><span>l</span></span><span class="main"><span>,</span></span><span class="skolem"><span>m</span></span><span class="main"><span>,</span></span><span class="skolem"><span>d'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>xs''</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3775..3783"><span>R_SORT_L</span></a><span> </span><span class="skolem"><span>pv</span></span><span> </span><span class="skolem"><span>l</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="skolem"><span>m</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="bound"><span>xs''</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>-</span></span><span>
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order_trans|fact"><span>order_trans</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_14338..14340"><span>IH</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_14365..14373"><span>LEFTMOST</span></a><span> 
              </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3596..3606"><span>R_PART_def</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_eq_length|fact"><span>slice_eq_mset_eq_length</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_nth_outside|fact"><span>slice_eq_mset_nth_outside</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_set_inside|fact"><span>slice_eq_mset_set_inside</span></a><span class="main"><span>)</span></span><span> 
              </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>drule</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set_rev_mp|fact"><span>set_rev_mp</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> _ </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.set_slice_subsetI|fact"><span>set_slice_subsetI</span></a><span class="main"><span class="main"><span>,</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="main"><span class="main"><span>_</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>l</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>m</span></span></span><span> </span><span class="main"><span class="main"><span>_</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>l</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>h</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
              </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3763..3773"><span>R_SORT_L_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3596..3606"><span>R_PART_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_1263..1278"><span>partitioned_alt</span></a><span class="main"><span>)</span></span><span>
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_10067..10077"><span>sort_rule1</span></a><span class="main"><span>)</span></span><span>
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_15577..15578">}</span></span></span><span> </span><span class="keyword1"><span class="command"><span>note</span></span></span><span> </span><span class="entity_def" id="offset_15584..15597">rec_sort_l_rl</span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_15577..15578"><span>this</span></a><span>
        
        </span><span class="keyword1"><span class="command"><span>{</span></span></span><span>
          </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>pv</span></span><span> </span><span class="skolem"><span>m</span></span><span> </span><span class="skolem"><span>xs'</span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="skolem"><span>d'</span></span><span class="main"><span>::</span></span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a></span><span>
          </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#offset_3775..3783"><span>R_SORT_L</span></a><span> </span><span class="skolem"><span>pv</span></span><span> </span><span class="skolem"><span>l</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="skolem"><span>m</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="skolem"><span>xs'</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="skolem"><span>d'</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>pdqsort</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>leftmost</span></span><span class="main"><span>,</span></span><span class="skolem"><span>xs'</span></span><span class="main"><span>,</span></span><span class="skolem"><span>l</span></span><span class="main"><span>,</span></span><span class="skolem"><span>m</span></span><span class="main"><span>,</span></span><span class="skolem"><span>d'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>xs''</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3775..3783"><span>R_SORT_L</span></a><span> </span><span class="skolem"><span>pv</span></span><span> </span><span class="skolem"><span>l</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="skolem"><span>m</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="bound"><span>xs''</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_15584..15597"><span>rec_sort_l_rl</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3763..3773"><span>R_SORT_L_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_15874..15875">}</span></span></span><span> </span><span class="keyword1"><span class="command"><span>note</span></span></span><span> </span><span class="entity_def" id="offset_15881..15900">rec_sort_l_again_rl</span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_15874..15875"><span>this</span></a><span>
              
        
        </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/ISABELLE_HOME/src/HOL/Library/rewrite.ML.html#Rewrite.rewrite|method"><span class="operator"><span>rewrite</span></span></a><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>in</span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span>_</span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span></a></span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/HOL-Library.Rewrite.html#Rewrite.rewrite_HOLE|const"><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/HOL-Library.Rewrite.html#Rewrite.rewrite_HOLE|const"><span>⌑</span></a></span></a></span><span>"</span></span></span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.slice_sort_spec_sem_alt|fact"><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.slice_sort_spec_sem_alt|fact"><span>slice_sort_spec_sem_alt</span></a></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="skolem"><span>args</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_5038..5060"><span>pivot_to_front_spec_rl</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_5669..5686"><span>partition_spec_rl</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_7111..7133"><span>partition_left_spec_rl</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_8004..8016"><span>shuffle_rule</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_14365..14373"><span>LEFTMOST</span></a><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_eq_length|fact"><span>slice_eq_mset_eq_length</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.eq_outside_rane_lenD|fact"><span>eq_outside_rane_lenD</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Eisbach.Eisbach.html#Eisbach.all|method"><span class="operator"><span>all</span></span></a><span> </span><span class="quoted"><span>‹</span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span>›</span></span><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> 
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.slice_sort_spec_sem_alt|fact"><span>slice_sort_spec_sem_alt</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3173..3180"><span>pdq_guarded_sort_spec_def</span></a><span class="main"><span>)</span></span><span>
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span>
            </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>unfold_le_to_lt</span><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3436..3446"><span>R_PV_TO_FRONT_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_eq_length|fact"><span>slice_eq_mset_eq_length</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3436..3446"><span>R_PV_TO_FRONT_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_eq_length|fact"><span>slice_eq_mset_eq_length</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> 
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_14883..14896"><span>rec_sort_r_rl</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span>)</span></span><span>
            </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_4121..4136"><span>R_SORT_R_sorted</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_4416..4427"><span>R_PART_SORT</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Eisbach.Eisbach.html#Eisbach.all|method"><span class="operator"><span>all</span></span></a><span> </span><span class="quoted"><span>‹</span><span class="operator"><span>erule</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_8728..8744"><span>maybe_sort_rule1</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>THEN</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order_trans|fact"><span>order_trans</span></a><span class="main"><span class="main"><span>]</span></span></span><span>›</span></span><span class="main"><span>)</span></span><span>
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Eisbach.Eisbach.html#Eisbach.all|method"><span class="operator"><span>all</span></span></a><span> </span><span class="quoted"><span>‹</span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span>›</span></span><span class="main"><span>)</span></span><span>
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span>
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Eisbach.Eisbach.html#Eisbach.all|method"><span class="operator"><span>all</span></span></a><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="operator"><span>erule</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_9328..9344"><span>maybe_sort_rule2</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>THEN</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order_trans|fact"><span>order_trans</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span>›</span></span><span class="main"><span>)</span></span><span>
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Eisbach.Eisbach.html#Eisbach.all|method"><span class="operator"><span>all</span></span></a><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span>›</span></span><span class="main"><span>)</span></span><span>
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_4121..4136"><span>R_SORT_R_sorted</span></a><span class="main"><span>)</span></span><span>
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
              </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_15881..15900"><span>rec_sort_l_again_rl</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span>)</span></span><span>
              </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_14883..14896"><span>rec_sort_r_rl</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span>)</span></span><span>
              </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_4121..4136"><span>R_SORT_R_sorted</span></a><span class="main"><span>)</span></span><span>
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
              </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_15584..15597"><span>rec_sort_l_rl</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span>)</span></span><span>
              </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_14883..14896"><span>rec_sort_r_rl</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span>)</span></span><span>
              </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_4121..4136"><span>R_SORT_R_sorted</span></a><span class="main"><span>)</span></span><span>
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjI|fact"><span>conjI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.impI|fact"><span>impI</span></a><span class="main"><span>)</span></span><span>  
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
              </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_15584..15597"><span>rec_sort_l_rl</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
              </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_14883..14896"><span>rec_sort_r_rl</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
              </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_4121..4136"><span>R_SORT_R_sorted</span></a><span class="main"><span>)</span></span><span>
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
              </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_15584..15597"><span>rec_sort_l_rl</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span>)</span></span><span>
              </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_14883..14896"><span>rec_sort_r_rl</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span>)</span></span><span>
              </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_4121..4136"><span>R_SORT_R_sorted</span></a><span class="main"><span>)</span></span><span>
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>      
      

    </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Main Pdqsort function. Just a wrapper for the recursive function, 
      initializing the maximum number of bad partitions before switching to fallback sorting.›</span></span></span><span>        
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.pdqsort_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.pdqsort_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.pdqsort_def_raw|axiom"><span class="entity_def" id="offset_18302..18312">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.pdqsort.cong|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.pdqsort.cong|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.pdqsort|const"><span class="entity_def" id="offset_18314..18321">pdqsort</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>size</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>;</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>size</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_11780..11791"><span>pdqsort_aux</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="HOL-Library.Discrete.html#Discrete.log|const"><span>Discrete.log</span></a><span> </span><span class="bound"><span>size</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>  
      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.pdqsort_correct|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.pdqsort_correct|thm"><span>pdqsort_correct</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#offset_18314..18321"><span>pdqsort</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.slice_sort_spec|const"><span>slice_sort_spec</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_18580..18591">log_pos_aux</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="HOL-Library.Discrete.html#Discrete.log|const"><span>Discrete.log</span></a><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="HOL-Library.Discrete.html#Discrete.log_rec|fact"><span>log_rec</span></a><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> 
        
      </span><span class="keyword1"><span class="command"><span>{</span></span></span><span>
        </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span>h</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_18302..18312"><span>pdqsort_def</span></a><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="free"><span>l</span></span><span>"</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_13495..13514"><span>pdqsort_aux_correct</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_18580..18591"><span>log_pos_aux</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.slice_sort_spec_def|fact"><span>slice_sort_spec_def</span></a><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.sort_spec_def|fact"><span>sort_spec_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.sorted_wrt01|fact"><span>sorted_wrt01</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>}</span></span></span><span> </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.slice_sort_spec_def|fact"><span>slice_sort_spec_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>only</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>    
      
    
    </span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Implementation of Subroutines›</span></span></span><span>
    
    
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.sort_two_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.sort_two_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.sort_two_def_raw|axiom"><span class="entity_def" id="offset_19183..19193">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.sort_two.cong|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.sort_two.cong|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.sort_two|const"><span class="entity_def" id="offset_19195..19203">sort_two</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>j</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>j</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="free"><span class="bound"><span class="entity"><span>j</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.monadic_If|const"><span>if<span class="hidden">⇩</span><sub>N</sub></span></a></span><span> </span><span>mop_cmp_idxs</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>j</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.monadic_If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/IICF_List.html#IICF_List.mop_list_swap|const"><span>mop_list_swap</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>j</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.monadic_If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span>
      
      </span><span class="comment1"><span>⌦‹if (xs!j <span class="hidden">❙</span><b>&lt;</b> xs!i) then mop_list_swap xs i j else RETURN xs›</span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>              
    
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.sort_three_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.sort_three_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.sort_three_def_raw|axiom"><span class="entity_def" id="offset_19444..19454">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.sort_three.cong|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.sort_three.cong|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.sort_three|const"><span class="entity_def" id="offset_19456..19466">sort_three</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>j</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_19195..19203"><span>sort_two</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>j</span></span></span></span><span class="main"><span>;</span></span><span>
      </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_19195..19203"><span>sort_two</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>j</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span class="main"><span>;</span></span><span>
      </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_19195..19203"><span>sort_two</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>j</span></span></span></span><span class="main"><span>;</span></span><span>
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>xs</span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>              

    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.sort_three_rule|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.sort_three_rule|thm"><span class="entity_def" id="offset_19616..19631">sort_three_rule</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span>
      </span><span class="main"><span>{</span></span><span class="free"><span>i</span></span><span class="main"><span>,</span></span><span class="free"><span>j</span></span><span class="main"><span>,</span></span><span class="free"><span>k</span></span><span class="main"><span>}</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="free"><span>j</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="free"><span>k</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="free"><span>k</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span>
    </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_19456..19466"><span>sort_three</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>j</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>xs'</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset|const"><span>slice_eq_mset</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="bound"><span>xs'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>xs'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>i</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="bound"><span>xs'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>xs'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>j</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="bound"><span>xs'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>k</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>l</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.uminus_class.uminus|const"><span>-</span></a></span><span class="main"><span>{</span></span><span class="free"><span>i</span></span><span class="main"><span>,</span></span><span class="free"><span>j</span></span><span class="main"><span>,</span></span><span class="free"><span>k</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="bound"><span>xs'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>l</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_19444..19454"><span>sort_three_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_19183..19193"><span>sort_two_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap_nth|fact"><span>swap_nth</span></a><span> </span><span>unfold_le_to_lt</span><span> </span><span class="quasi_keyword"><span>split</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.if_splits|fact"><span>if_splits</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>unfold_lt_to_le</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      
    
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.three_sorted_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.three_sorted_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.three_sorted_def_raw|axiom"><span class="entity_def" id="offset_20011..20021">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.three_sorted.cong|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.three_sorted.cong|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.three_sorted|const"><span class="entity_def" id="offset_20023..20035">three_sorted</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>j</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="main"><span>{</span></span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>j</span></span></span></span><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>j</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>j</span></span></span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span>"</span></span></span><span>

    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_20109..20114">lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.sort_three_sorted_rl|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.sort_three_sorted_rl|thm"><span class="entity_def" id="offset_20115..20135">sort_three_sorted_rl</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#offset_19456..19466"><span>sort_three</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>j</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset|const"><span>slice_eq_mset</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_20023..20035"><span>three_sorted</span></a><span> </span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>j</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
      </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="free"><span>i</span></span><span class="main"><span>,</span></span><span class="free"><span>j</span></span><span class="main"><span>,</span></span><span class="free"><span>k</span></span><span class="main"><span>}</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="free"><span>j</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="free"><span>k</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="free"><span>k</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>h</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>j</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list|type"><span>list</span></a><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_20109..20114"><span>that</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_19616..19631"><span>sort_three_rule</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> l</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="free"><span>l</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> h</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="free"><span>h</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_eq_length|fact"><span>slice_eq_mset_eq_length</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_20011..20021"><span>three_sorted_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
    
        
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.three_sorted_imp_part_range_cond|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.three_sorted_imp_part_range_cond|thm"><span class="entity_def" id="offset_20541..20573">three_sorted_imp_part_range_cond</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_20023..20035"><span>three_sorted</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>i</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>k</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>h</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>h</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3266..3281"><span>part_range_cond</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_20011..20021"><span>three_sorted_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3254..3264"><span>part_range_cond_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.three_sorted_swap_imp_part_range_cond|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.three_sorted_swap_imp_part_range_cond|thm"><span class="entity_def" id="offset_20720..20757">three_sorted_swap_imp_part_range_cond</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_20023..20035"><span>three_sorted</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>j</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="free"><span>j</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="free"><span>k</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>i</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>j</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>k</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>h</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>h</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>h</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3266..3281"><span>part_range_cond</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap|const"><span>swap</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>j</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_20011..20021"><span>three_sorted_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3254..3264"><span>part_range_cond_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap_nth|fact"><span>swap_nth</span></a><span class="main"><span>)</span></span><span>
          
                  
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.move_pivot_to_front_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.move_pivot_to_front_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.move_pivot_to_front_def_raw|axiom"><span class="entity_def" id="offset_20988..20998">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.move_pivot_to_front.cong|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.move_pivot_to_front.cong|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.move_pivot_to_front|const"><span class="entity_def" id="offset_21000..21019">move_pivot_to_front</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>size</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>;</span></span><span>
      </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>s2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="bound"><span>size</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.divide_class.divide|const"><span>div</span></a></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>;</span></span><span>

      </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>size</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.ninther_threshold|const"><span>ninther_threshold</span></a><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
        </span><span class="comment1"><span>⌦‹ASSERT (l+s2+1&lt;h ∧ h≥3 ∧ s2≥1 ∧ s2&lt;h );›</span></span><span>
        </span><span class="bound"><span>xs</span></span><span class="main"><span>←</span></span><a class="entity_ref" href="Sorting_PDQ.html#offset_19456..19466"><span>sort_three</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span>              </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="bound"><span>s2</span></span><span class="main"><span>)</span></span><span>       </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
        </span><span class="bound"><span>xs</span></span><span class="main"><span>←</span></span><a class="entity_ref" href="Sorting_PDQ.html#offset_19456..19466"><span>sort_three</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span>        </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>s2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
        </span><span class="bound"><span>xs</span></span><span class="main"><span>←</span></span><a class="entity_ref" href="Sorting_PDQ.html#offset_19456..19466"><span>sort_three</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>        </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>s2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="numeral"><span>3</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
        </span><span class="bound"><span>xs</span></span><span class="main"><span>←</span></span><a class="entity_ref" href="Sorting_PDQ.html#offset_19456..19466"><span>sort_three</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>s2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="bound"><span>s2</span></span><span class="main"><span>)</span></span><span>       </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>s2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
        </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/IICF_List.html#IICF_List.mop_list_swap|const"><span>mop_list_swap</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="bound"><span>s2</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
        </span><span class="comment1"><span>⌦‹ASSERT (xs!l <span class="hidden">❙</span><b>≤</b> xs!(l + (s2 + 1)) ∧ xs!(l + (s2 - 1)) <span class="hidden">❙</span><b>≤</b> xs!l);›</span></span><span>
        </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>xs</span></span><span>
      </span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
        </span><span class="comment1"><span>⌦‹ASSERT (l+s2 ≠ h-1 ∧ l+s2&lt;h ∧ h&gt;0);›</span></span><span>
        </span><a class="entity_ref" href="Sorting_PDQ.html#offset_19456..19466"><span>sort_three</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="bound"><span>s2</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>}</span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    
    
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.move_pivot_to_front_refine|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.move_pivot_to_front_refine|thm"><span class="entity_def" id="offset_21743..21769">move_pivot_to_front_refine</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#offset_21000..21019"><span>move_pivot_to_front</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_4847..4866"><span>pivot_to_front_spec</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_20988..20998"><span>move_pivot_to_front_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_4835..4845"><span>pivot_to_front_spec_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_20115..20135"><span>sort_three_sorted_rl</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> l</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="free"><span>l</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> h</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="free"><span>h</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span> 
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Eisbach.Eisbach.html#Eisbach.all|method"><span class="operator"><span>all</span></span></a><span> </span><span class="quoted"><span>‹</span><span class="operator"><span>elim</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjE|fact"><span>conjE</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span>›</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>supply</span></span></span></span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/lin_arith.ML.html#Fields.linarith_split_limit|attribute"><span class="operator"><span>linarith_split_limit</span></span></a><span> </span><span class="main"><span class="main"><span>=</span></span></span><span> 15</span><span class="main"><span>]</span></span><span class="main"><span>]</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_trans|fact"><span>slice_eq_mset_trans</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>erule</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_20720..20757"><span>three_sorted_swap_imp_part_range_cond</span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>erule</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_20541..20573"><span>three_sorted_imp_part_range_cond</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>    

      
      
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle_left_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle_left_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle_left_def_raw|axiom"><span class="entity_def" id="offset_22398..22408">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle_left|const"><span>shuffle_left</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>j</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="free"><span class="bound"><span class="entity"><span>j</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/IICF_List.html#IICF_List.mop_list_swap|const"><span>mop_list_swap</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>j</span></span></span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle_right_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle_right_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle_right_def_raw|axiom"><span class="entity_def" id="offset_22480..22490">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle_right|const"><span>shuffle_right</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>j</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="free"><span class="bound"><span class="entity"><span>j</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/IICF_List.html#IICF_List.mop_list_swap|const"><span>mop_list_swap</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>j</span></span></span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>  
      
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle_def_raw|axiom"><span class="entity_def" id="offset_22570..22580">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle|const"><span>shuffle</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>size</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>;</span></span><span>
      </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>l_size</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>;</span></span><span>
      </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>r_size</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>highly_unbal</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="bound"><span>l_size</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="bound"><span>size</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.divide_class.divide|const"><span>div</span></a></span><span> </span><span class="numeral"><span>8</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="bound"><span>r_size</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="bound"><span>size</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.divide_class.divide|const"><span>div</span></a></span><span> </span><span class="numeral"><span>8</span></span><span class="main"><span>;</span></span><span>
    
      </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="bound"><span>highly_unbal</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
        </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="bound"><span>l_size</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>≥</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.is_threshold|const"><span>is_threshold</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>  </span><span class="comment1"><span>⌦‹FIXME: This should be pdq_is_threshold!›</span></span><span>
</span><span class="comment1"><span>⌦‹          ASSERT (l + l_size div 4 &lt; h ∧ m&gt;0 ∧ m≥l_size div 4);
›</span></span><span>          </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_left|const"><span>shuffle_left</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="bound"><span>l_size</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.divide_class.divide|const"><span>div</span></a></span><span> </span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
          </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_left|const"><span>shuffle_left</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="bound"><span>l_size</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.divide_class.divide|const"><span>div</span></a></span><span> </span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
          
          </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="bound"><span>l_size</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.ninther_threshold|const"><span>ninther_threshold</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
</span><span class="comment1"><span>⌦‹            ASSERT (
                l+1≤h ∧ l_size div 4 + 1≤h ∧ l + (l_size div 4 + 1)≤h 
              ∧ l+2≤h ∧ l_size div 4 + 2≤h ∧ l + (l_size div 4 + 2)≤h
              ∧ m≥2 ∧ m≥3 ∧ m≥l_size div 4 + 1 ∧ m≥l_size div 4 + 2);
›</span></span><span>            
            </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_left|const"><span>shuffle_left</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>l_size</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.divide_class.divide|const"><span>div</span></a></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
            </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_left|const"><span>shuffle_left</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>l_size</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.divide_class.divide|const"><span>div</span></a></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
            </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_left|const"><span>shuffle_left</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>l_size</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.divide_class.divide|const"><span>div</span></a></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
            </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_left|const"><span>shuffle_left</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="numeral"><span>3</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>l_size</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.divide_class.divide|const"><span>div</span></a></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
            </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>xs</span></span><span>
          </span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>xs</span></span><span>
        </span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>;</span></span><span>
        </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="bound"><span>r_size</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>≥</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.is_threshold|const"><span>is_threshold</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>  </span><span class="comment1"><span>⌦‹FIXME: This should be pdq_is_threshold!›</span></span><span>
 </span><span class="comment1"><span>⌦‹         ASSERT (m+1≤h ∧ m + 1 + r_size div 4≤h ∧ h≥1 ∧ h≥r_size div 4);
 ›</span></span><span>         </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_right|const"><span>shuffle_right</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="bound"><span>r_size</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.divide_class.divide|const"><span>div</span></a></span><span> </span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
          </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_right|const"><span>shuffle_right</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="bound"><span>r_size</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.divide_class.divide|const"><span>div</span></a></span><span> </span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
          </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="bound"><span>r_size</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.ninther_threshold|const"><span>ninther_threshold</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
  </span><span class="comment1"><span>⌦‹          ASSERT (m+2≤h ∧ 1 + r_size div 4≤h ∧ 2 + r_size div 4≤h ∧ 3 + r_size div 4≤h 
                  ∧ h≥2 ∧ h≥3 ∧ h≥(1 + r_size div 4) ∧ h≥(2 + r_size div 4) );
  ›</span></span><span>          </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_right|const"><span>shuffle_right</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="bound"><span>r_size</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.divide_class.divide|const"><span>div</span></a></span><span> </span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
            </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_right|const"><span>shuffle_right</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="numeral"><span>3</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="bound"><span>r_size</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.divide_class.divide|const"><span>div</span></a></span><span> </span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
            </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_right|const"><span>shuffle_right</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="bound"><span>r_size</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.divide_class.divide|const"><span>div</span></a></span><span> </span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>  
            </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_right|const"><span>shuffle_right</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="numeral"><span>3</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="bound"><span>r_size</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.divide_class.divide|const"><span>div</span></a></span><span> </span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>          
            </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>xs</span></span><span>
          </span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>xs</span></span><span>
        </span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>;</span></span><span>
        </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span>
        </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>
      
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffled_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffled_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffled_def_raw|axiom"><span class="entity_def" id="offset_24698..24708">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffled|const"><span>shuffled</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs'</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span>         
        </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> 
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.eq_outside_range|const"><span>eq_outside_range</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs'</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span>
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs'</span></span></span></span><span class="main"><span>)</span></span><span>  
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs'</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span>
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs'</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    
      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.eq_outside_range_swap|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.eq_outside_range_swap|thm"><span class="entity_def" id="offset_24968..24989">eq_outside_range_swap</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="free"><span>i</span></span><span class="main"><span>,</span></span><span class="free"><span>j</span></span><span class="main"><span>}</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.eq_outside_range|const"><span>eq_outside_range</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap|const"><span>swap</span></a><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>j</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.eq_outside_range|const"><span>eq_outside_range</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.eq_outside_range_def|fact"><span>eq_outside_range_def</span></a><span class="main"><span>)</span></span><span>
    
      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffled_left|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffled_left|thm"><span class="entity_def" id="offset_25145..25158">shuffled_left</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>{</span></span><span class="free"><span>i</span></span><span class="main"><span>,</span></span><span class="free"><span>j</span></span><span class="main"><span>}</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffled|const"><span>shuffled</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffled|const"><span>shuffled</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap|const"><span>swap</span></a><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>j</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_24698..24708"><span>shuffled_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_24968..24989"><span>eq_outside_range_swap</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_swap|fact"><span>slice_swap</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.eq_outside_rane_lenD|fact"><span>eq_outside_rane_lenD</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_swap_outside|fact"><span>slice_swap_outside</span></a><span class="main"><span>)</span></span><span>
      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffled_right|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffled_right|thm"><span class="entity_def" id="offset_25381..25395">shuffled_right</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>{</span></span><span class="free"><span>i</span></span><span class="main"><span>,</span></span><span class="free"><span>j</span></span><span class="main"><span>}</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffled|const"><span>shuffled</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffled|const"><span>shuffled</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap|const"><span>swap</span></a><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>j</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_24698..24708"><span>shuffled_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_24968..24989"><span>eq_outside_range_swap</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_swap|fact"><span>slice_swap</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.eq_outside_rane_lenD|fact"><span>eq_outside_rane_lenD</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_swap_outside|fact"><span>slice_swap_outside</span></a><span class="main"><span>)</span></span><span>
      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle_spec_alt|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle_spec_alt|thm"><span class="entity_def" id="offset_25622..25638">shuffle_spec_alt</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_spec|const"><span>shuffle_spec</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="bound"><span>xs'</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffled|const"><span>shuffled</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="bound"><span>xs'</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_7698..7708"><span>shuffle_spec_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_24698..24708"><span>shuffled_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.pw_eq_iff|fact"><span>pw_eq_iff</span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>
      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffled_refl|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffled_refl|thm"><span class="entity_def" id="offset_25852..25865">shuffled_refl</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffled|const"><span>shuffled</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>   
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_24698..24708"><span>shuffled_def</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.eq_outside_range_triv|fact"><span>eq_outside_range_triv</span></a><span class="main"><span>)</span></span><span>
      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle_left_rl|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle_left_rl|thm"><span class="entity_def" id="offset_25993..26008">shuffle_left_rl</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffled|const"><span>shuffled</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="free"><span>j</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>{</span></span><span class="free"><span>i</span></span><span class="main"><span>,</span></span><span class="free"><span>j</span></span><span class="main"><span>}</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_left|const"><span>shuffle_left</span></a><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>xs''</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffled|const"><span>shuffled</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="bound"><span>xs''</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_22398..22408"><span>shuffle_left_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_25145..25158"><span>shuffled_left</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_24698..24708"><span>shuffled_def</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.eq_outside_rane_lenD|fact"><span>eq_outside_rane_lenD</span></a><span class="main"><span>)</span></span><span>
      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle_right_rl|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle_right_rl|thm"><span class="entity_def" id="offset_26291..26307">shuffle_right_rl</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffled|const"><span>shuffled</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="free"><span>j</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>{</span></span><span class="free"><span>i</span></span><span class="main"><span>,</span></span><span class="free"><span>j</span></span><span class="main"><span>}</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_right|const"><span>shuffle_right</span></a><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>xs''</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffled|const"><span>shuffled</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="bound"><span>xs''</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_22480..22490"><span>shuffle_right_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_25381..25395"><span>shuffled_right</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_24698..24708"><span>shuffled_def</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.eq_outside_rane_lenD|fact"><span>eq_outside_rane_lenD</span></a><span class="main"><span>)</span></span><span>
      
      
    
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle_correct|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle_correct|thm"><span class="entity_def" id="offset_26609..26624">shuffle_correct</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle|const"><span>shuffle</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_spec|const"><span>shuffle_spec</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span>"</span></span></span><span>       
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_25622..25638"><span>shuffle_spec_alt</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_22570..22580"><span>shuffle_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subgoal_tac</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffled|const"><span>shuffled</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_25852..25865"><span>shuffled_refl</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Eisbach.Eisbach.html#Eisbach.all|method"><span class="operator"><span>all</span></span></a><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="operator"><span>thin_tac</span></span><span> </span><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="free"><span>m</span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span></a></span><span class="free"><span class="free"><span>l</span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span></a></span><span> </span><span class="main"><span class="main"><span>_</span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span></a></span><span> </span><span class="main"><span class="main"><span>_</span></span></span><span>"</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span>›</span></span><span class="main"><span>)</span></span><span>

      </span><span class="comment1"><span>(* TODO: The splitter is probably getting in the way here! *)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_25993..26008"><span>shuffle_left_rl</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span class="main"><span>)</span></span><span> 
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_25852..25865"><span>shuffled_refl</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>supply</span></span></span></span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/lin_arith.ML.html#Fields.linarith_split_limit|attribute"><span class="operator"><span>linarith_split_limit</span></span></a><span> </span><span class="main"><span class="main"><span>=</span></span></span><span> 25</span><span class="main"><span>]</span></span><span class="main"><span>]</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span>6</span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_26291..26307"><span>shuffle_right_rl</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span class="main"><span>)</span></span><span> 
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_25852..25865"><span>shuffled_refl</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span>6</span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_26291..26307"><span>shuffle_right_rl</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span class="main"><span>)</span></span><span> 
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>  
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_26291..26307"><span>shuffle_right_rl</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span class="main"><span>)</span></span><span> 
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_25852..25865"><span>shuffled_refl</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>      
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>  
    
    
      
    </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
      Some definitions to hide away propositions that would overwhelm the linarith-solver of the simplifier.
    ›</span></span></span><span>  
    </span><span class="comment1"><span>(*
      Elements in between l&lt;..i are smaller than pivot.
        * at beginning of loop, will be i-1, 
        * after swapping, will be i
    *)</span></span><span>  
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.AUX_SMALLER_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.AUX_SMALLER_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.AUX_SMALLER_def_raw|axiom"><span class="entity_def" id="offset_27886..27896">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.AUX_SMALLER|const"><span>AUX_SMALLER</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>C</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>k</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanAtMost|const"><span>{</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanAtMost|const"><span>&lt;..</span></a></span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanAtMost|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>C</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
    
    </span><span class="comment1"><span>(*
      Elements in between j..&lt;h are not smaller than pivot
      
      * at beginning of loop, will be j+1
      * after swapping, will be j
    *)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.AUX_NOTSM_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.AUX_NOTSM_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.AUX_NOTSM_def_raw|axiom"><span class="entity_def" id="offset_28153..28163">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.AUX_NOTSM|const"><span>AUX_NOTSM</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>C</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>j</span></span></span></span><span>   </span><span class="main"><span>≡</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>j</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>j</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>k</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span class="bound"><span class="entity"><span>j</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>C</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    
    
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.RIGHT_GUARD_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.RIGHT_GUARD_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.RIGHT_GUARD_def_raw|axiom"><span class="entity_def" id="offset_28267..28277">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.RIGHT_GUARD|const"><span>RIGHT_GUARD</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>C</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∃</span></span><span class="bound"><span>k</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>{</span></a></span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>&lt;..&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>C</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.LEFT_GUARD_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.LEFT_GUARD_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.LEFT_GUARD_def_raw|axiom"><span class="entity_def" id="offset_28367..28377">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.LEFT_GUARD|const"><span>LEFT_GUARD</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>C</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>j</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∃</span></span><span class="bound"><span>k</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>{</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>&lt;..&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>j</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>C</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    

    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.AUX_SMALLER_init|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.AUX_SMALLER_init|thm"><span class="entity_def" id="offset_28465..28481">AUX_SMALLER_init</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>h</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.AUX_SMALLER|const"><span>AUX_SMALLER</span></a><span> </span><span class="free"><span>C</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_27886..27896"><span>AUX_SMALLER_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
        
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.AUX_NOTSM_init|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.AUX_NOTSM_init|thm"><span class="entity_def" id="offset_28590..28604">AUX_NOTSM_init</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>h</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.AUX_NOTSM|const"><span>AUX_NOTSM</span></a><span> </span><span class="free"><span>C</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>h</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_28153..28163"><span>AUX_NOTSM_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.RIGHT_GUARD_from_prc|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.RIGHT_GUARD_from_prc|thm"><span class="entity_def" id="offset_28701..28721">RIGHT_GUARD_from_prc</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#offset_3266..3281"><span>part_range_cond</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.RIGHT_GUARD|const"><span>RIGHT_GUARD</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3254..3264"><span>part_range_cond_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_28267..28277"><span>RIGHT_GUARD_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>unfold_le_to_lt</span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.LEFT_GUARD_from_prc|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.LEFT_GUARD_from_prc|thm"><span class="entity_def" id="offset_28899..28918">LEFT_GUARD_from_prc</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#offset_3266..3281"><span>part_range_cond</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.LEFT_GUARD|const"><span>LEFT_GUARD</span></a><span> </span><span class="main"><span>(<span class="hidden">❙</span><b>&gt;</b>)</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>h</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3254..3264"><span>part_range_cond_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_28367..28377"><span>LEFT_GUARD_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>unfold_le_to_lt</span><span class="main"><span>)</span></span><span>
      
            
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.LEFT_GUARD_init|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.LEFT_GUARD_init|thm"><span class="entity_def" id="offset_29111..29126">LEFT_GUARD_init</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.AUX_SMALLER|const"><span>AUX_SMALLER</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Not</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>oo</span></a></span><span> </span><span class="free"><span>C</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>;</span></span><span>  </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>j<span class="hidden">⇩</span><sub>0</sub></span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="free"><span>l</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.LEFT_GUARD|const"><span>LEFT_GUARD</span></a><span> </span><span class="free"><span>C</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>j<span class="hidden">⇩</span><sub>0</sub></span></span><span>"</span></span></span><span>        
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_27886..27896"><span>AUX_SMALLER_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_28367..28377"><span>LEFT_GUARD_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span> 
    
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.RIGHT_GUARD_init|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.RIGHT_GUARD_init|thm"><span class="entity_def" id="offset_29320..29336">RIGHT_GUARD_init</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>" </span><span class="main"><span>⟦</span></span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.AUX_NOTSM|const"><span>AUX_NOTSM</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Not</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>∘∘</span></a></span><span> </span><span class="free"><span>C</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="free"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.AUX_SMALLER|const"><span>AUX_SMALLER</span></a><span> </span><span class="free"><span>C</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>i<span class="hidden">⇩</span><sub>0</sub></span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="free"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span> </span><span class="free"><span>h</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.RIGHT_GUARD|const"><span>RIGHT_GUARD</span></a><span> </span><span class="free"><span>C</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>i<span class="hidden">⇩</span><sub>0</sub></span></span><span>"</span></span></span><span>        
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_28153..28163"><span>AUX_NOTSM_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_28267..28277"><span>RIGHT_GUARD_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_27886..27896"><span>AUX_SMALLER_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span> 
            
    
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_29555..29560">lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.PV_SWAP|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.PV_SWAP(2)|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.PV_SWAP(1)|thm"><span class="entity_def" id="offset_29561..29568">PV_SWAP</span></span></span></span><span class="main"><span>:</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.AUX_SMALLER|const"><span>AUX_SMALLER</span></a><span> </span><span class="free"><span>C</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.AUX_NOTSM|const"><span>AUX_NOTSM</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Not</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>oo</span></a></span><span> </span><span class="free"><span>C</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>i</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>j</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span> </span><span class="free"><span>C</span></span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>l</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>C</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>j</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>l</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.AUX_SMALLER|const"><span>AUX_SMALLER</span></a><span> </span><span class="free"><span>C</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap|const"><span>swap</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>j</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>i</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.AUX_NOTSM|const"><span>AUX_NOTSM</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Not</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>oo</span></a></span><span> </span><span class="free"><span>C</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap|const"><span>swap</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>j</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>j</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_29555..29560"><span>assms</span></a><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_27886..27896"><span>AUX_SMALLER_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_28153..28163"><span>AUX_NOTSM_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap_nth|fact"><span>swap_nth</span></a><span class="main"><span>)</span></span><span>
      
          
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.PARTITIONED_FINALLY|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.PARTITIONED_FINALLY|thm"><span class="entity_def" id="offset_29926..29945">PARTITIONED_FINALLY</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="main"><span>(</span></span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>j</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>i</span></span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>&lt;</b></span></span></span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>l</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.AUX_SMALLER|const"><span>AUX_SMALLER</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.AUX_NOTSM|const"><span>AUX_NOTSM</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Not</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>oo</span></a></span><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_1098..1109"><span>partitioned</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>l</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap|const"><span>swap</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3173..3180"><span>partitioned_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_27886..27896"><span>AUX_SMALLER_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_28153..28163"><span>AUX_NOTSM_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap_nth|fact"><span>swap_nth</span></a><span> </span><span>unfold_lt_to_le</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc_leI|fact"><span>Suc_leI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan_iff|fact"><span>atLeastLessThan_iff</span></a><span> </span><span>connex</span><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.order_class.leD|fact"><span>leD</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.linorder_class.le_less_linear|fact"><span>le_less_linear</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.le_neq_implies_less|fact"><span>le_neq_implies_less</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.le_trans|fact"><span>le_trans</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Word_Lib.Many_More.html#Many_More.nat_le_Suc_less_imp|fact"><span>nat_le_Suc_less_imp</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan_iff|fact"><span>atLeastLessThan_iff</span></a><span> </span><span>connex</span><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.order_class.leD|fact"><span>leD</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.linorder_class.leI|fact"><span>leI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.le_neq_implies_less|fact"><span>le_neq_implies_less</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.le_trans|fact"><span>le_trans</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Word_Lib.Many_More.html#Many_More.nat_le_Suc_less_imp|fact"><span>nat_le_Suc_less_imp</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.not_less_eq_eq|fact"><span>not_less_eq_eq</span></a><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.PARTITIONED_FINALLY2|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.PARTITIONED_FINALLY2|thm"><span class="entity_def" id="offset_30460..30480">PARTITIONED_FINALLY2</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="main"><span>(</span></span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>j</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span> </span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>j</span></span><span class="main"><span><span class="hidden">❙</span><b>&gt;</b></span></span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>l</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.AUX_SMALLER|const"><span>AUX_SMALLER</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Not</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>oo</span></a></span><span> </span><span class="main"><span>(<span class="hidden">❙</span><b>&gt;</b>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.AUX_NOTSM|const"><span>AUX_NOTSM</span></a><span> </span><span class="main"><span>(<span class="hidden">❙</span><b>&gt;</b>)</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_1098..1109"><span>partitioned</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>l</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap|const"><span>swap</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>j</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>j</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_3173..3180"><span>partitioned_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_27886..27896"><span>AUX_SMALLER_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_28153..28163"><span>AUX_NOTSM_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>unfold_lt_to_le</span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap_nth|fact"><span>swap_nth</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.safe|method"><span class="operator"><span>safe</span></span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>connex</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Meson/meson_tactic.ML.html#Meson.meson|method"><span class="operator"><span>meson</span></span></a><span> </span><span>connex</span><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.order_class.dual_order.order_iff_strict|fact"><span>dual_order.order_iff_strict</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanAtMost_iff|fact"><span>greaterThanAtMost_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.linorder_class.leI|fact"><span>leI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.less_le_trans|fact"><span>less_le_trans</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Word_Lib.Many_More.html#Many_More.nat_le_Suc_less_imp|fact"><span>nat_le_Suc_less_imp</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Meson/meson_tactic.ML.html#Meson.meson|method"><span class="operator"><span>meson</span></span></a><span> </span><span>connex</span><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.order_class.dual_order.order_iff_strict|fact"><span>dual_order.order_iff_strict</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanAtMost_iff|fact"><span>greaterThanAtMost_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.linorder_class.leI|fact"><span>leI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.less_le_trans|fact"><span>less_le_trans</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Word_Lib.Many_More.html#Many_More.nat_le_Suc_less_imp|fact"><span>nat_le_Suc_less_imp</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      
          
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.mop_C_idx_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.mop_C_idx_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.mop_C_idx_def_raw|axiom"><span class="entity_def" id="offset_31050..31060">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.mop_C_idx|const"><span>mop_C_idx</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>C</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>j</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>j</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>C</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>j</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>}</span></span><span>"</span></span></span><span>           
        

    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.find_next_unguarded_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.find_next_unguarded_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.find_next_unguarded_def_raw|axiom"><span class="entity_def" id="offset_31178..31188">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.find_next_unguarded|const"><span>find_next_unguarded</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>C</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span class="bound"><span class="entity"><span>i<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∃</span></span><span class="bound"><span>si</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>{</span></a></span><span class="free"><span class="bound"><span class="entity"><span>i<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>&lt;..&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>C</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>si</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      </span><a class="entity_ref" href="../Isabelle_LLVM/Refine_Monadic_Add.html#Refine_Monadic_Add.monadic_WHILEIT|const"><span>monadic_WHILEIT</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>j</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>{</span></a></span><span class="free"><span class="bound"><span class="entity"><span>i<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>&lt;..&lt;</span></a></span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>C</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> 
        </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.mop_C_idx|const"><span>mop_C_idx</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>C</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><span>}</span></span><span> </span><span class="main"><span>)</span></span><span> 
        </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> 
        </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>i<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>  

    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.find_next_guarded_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.find_next_guarded_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.find_next_guarded_def_raw|axiom"><span class="entity_def" id="offset_31542..31552">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.find_next_guarded|const"><span>find_next_guarded</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>C</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span class="bound"><span class="entity"><span>i<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      </span><a class="entity_ref" href="../Isabelle_LLVM/Refine_Monadic_Add.html#Refine_Monadic_Add.monadic_WHILEIT|const"><span>monadic_WHILEIT</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>j</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>{</span></a></span><span class="free"><span class="bound"><span class="entity"><span>i<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>&lt;..&lt;</span></a></span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>C</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> 
        </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.mop_C_idx|const"><span>mop_C_idx</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>C</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a><span class="main"><span>)</span></span><span> 
        </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> 
        </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>i<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>  

    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.first_find_next_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.first_find_next_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.first_find_next_def_raw|axiom"><span class="entity_def" id="offset_31900..31910">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.first_find_next|const"><span>first_find_next</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>C</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>j</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>j</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>    
      </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>j</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.find_next_guarded|const"><span>find_next_guarded</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>C</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.find_next_unguarded|const"><span>find_next_unguarded</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>C</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>  
    
        
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.find_prev_unguarded_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.find_prev_unguarded_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.find_prev_unguarded_def_raw|axiom"><span class="entity_def" id="offset_32097..32107">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.find_prev_unguarded|const"><span>find_prev_unguarded</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>C</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>j<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>j<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>j<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∃</span></span><span class="bound"><span>si</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>{</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>&lt;..&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>j<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span class="bound"><span class="entity"><span>C</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>si</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>j<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>≥</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      </span><a class="entity_ref" href="../Isabelle_LLVM/Refine_Monadic_Add.html#Refine_Monadic_Add.monadic_WHILEIT|const"><span>monadic_WHILEIT</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>j</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>j<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>k</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>{</span></a></span><span class="bound"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>&lt;..&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>j<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>C</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> 
        </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>j</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.mop_C_idx|const"><span>mop_C_idx</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>C</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>)</span></span><span> 
        </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>j</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span class="main"><span>(</span></span><span class="bound"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>≥</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> 
        </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>j<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>  
      
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.find_prev_guarded_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.find_prev_guarded_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.find_prev_guarded_def_raw|axiom"><span class="entity_def" id="offset_32443..32453">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.find_prev_guarded|const"><span>find_prev_guarded</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>C</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>j<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>j<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>j<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>j<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>≥</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      </span><a class="entity_ref" href="../Isabelle_LLVM/Refine_Monadic_Add.html#Refine_Monadic_Add.monadic_WHILEIT|const"><span>monadic_WHILEIT</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>j</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>j<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>k</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>{</span></a></span><span class="bound"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>&lt;..&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>j<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>C</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> 
        </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>j</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>j</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.mop_C_idx|const"><span>mop_C_idx</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>C</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a><span> </span><span class="main"><span>)</span></span><span> 
        </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>j</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span class="main"><span>(</span></span><span class="bound"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>≥</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> 
        </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>j<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>  
    
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.first_find_prev_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.first_find_prev_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.first_find_prev_def_raw|axiom"><span class="entity_def" id="offset_32780..32790">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.first_find_prev|const"><span>first_find_prev</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>C</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.find_prev_guarded|const"><span>find_prev_guarded</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>C</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.find_prev_unguarded|const"><span>find_prev_unguarded</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>C</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>  

           
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.find_next_unguarded_rl|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.find_next_unguarded_rl|thm"><span class="entity_def" id="offset_32966..32988">find_next_unguarded_rl</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.AUX_SMALLER|const"><span>AUX_SMALLER</span></a><span> </span><span class="free"><span>C</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>i<span class="hidden">⇩</span><sub>0</sub></span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.RIGHT_GUARD|const"><span>RIGHT_GUARD</span></a><span> </span><span class="free"><span>C</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>i<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="main"><span>⟧</span></span><span>
      </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.find_next_unguarded|const"><span>find_next_unguarded</span></a><span> </span><span class="free"><span>C</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>i<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>i<span class="hidden">⇩</span><sub>0</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.AUX_SMALLER|const"><span>AUX_SMALLER</span></a><span> </span><span class="free"><span>C</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>C</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>l</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_31178..31188"><span>find_next_unguarded_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_27886..27896"><span>AUX_SMALLER_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_28267..28277"><span>RIGHT_GUARD_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_31050..31060"><span>mop_C_idx_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.monadic_WHILEIT_rule|fact"><span>monadic_WHILEIT_rule</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> R</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Wellfounded.html#Wellfounded.measure|const"><span>measure</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.safe|method"><span class="operator"><span>safe</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc_lessI|fact"><span>Suc_lessI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan_iff|fact"><span>greaterThanLessThan_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.less_antisym|fact"><span>less_antisym</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan_iff|fact"><span>greaterThanLessThan_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.less_SucE|fact"><span>less_SucE</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.find_next_guarded_rl|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.find_next_guarded_rl|thm"><span class="entity_def" id="offset_33611..33631">find_next_guarded_rl</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.AUX_SMALLER|const"><span>AUX_SMALLER</span></a><span> </span><span class="free"><span>C</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>i<span class="hidden">⇩</span><sub>0</sub></span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>i<span class="hidden">⇩</span><sub>0</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>h</span></span><span> </span><span class="main"><span>⟧</span></span><span>
      </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.find_next_guarded|const"><span>find_next_guarded</span></a><span> </span><span class="free"><span>C</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>i<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>i<span class="hidden">⇩</span><sub>0</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.AUX_SMALLER|const"><span>AUX_SMALLER</span></a><span> </span><span class="free"><span>C</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>C</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>l</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>)</span></span><span> </span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_31542..31552"><span>find_next_guarded_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_27886..27896"><span>AUX_SMALLER_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_28267..28277"><span>RIGHT_GUARD_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_31050..31060"><span>mop_C_idx_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.monadic_WHILEIT_rule|fact"><span>monadic_WHILEIT_rule</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> R</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Wellfounded.html#Wellfounded.measure|const"><span>measure</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span> </span><span class="quasi_keyword"><span>elim</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.less_SucE|fact"><span>less_SucE</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>  
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      
   </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.first_find_next_rl|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.first_find_next_rl|thm"><span class="entity_def" id="offset_34090..34108">first_find_next_rl</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.AUX_NOTSM|const"><span>AUX_NOTSM</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Not</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>oo</span></a></span><span> </span><span class="free"><span>C</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>i<span class="hidden">⇩</span><sub>0</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>h</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.AUX_SMALLER|const"><span>AUX_SMALLER</span></a><span> </span><span class="free"><span>C</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>i<span class="hidden">⇩</span><sub>0</sub></span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>i<span class="hidden">⇩</span><sub>0</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span>
      </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.first_find_next|const"><span>first_find_next</span></a><span> </span><span class="free"><span>C</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>j</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>i<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>i<span class="hidden">⇩</span><sub>0</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.AUX_SMALLER|const"><span>AUX_SMALLER</span></a><span> </span><span class="free"><span>C</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>C</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>l</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_31900..31910"><span>first_find_next_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_33611..33631"><span>find_next_guarded_rl</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_32966..32988"><span>find_next_unguarded_rl</span></a><span class="main"><span>)</span></span><span> 
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_29320..29336"><span>RIGHT_GUARD_init</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_28153..28163"><span>AUX_NOTSM_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      
      
            
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.find_prev_unguarded_rl|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.find_prev_unguarded_rl|thm"><span class="entity_def" id="offset_34555..34577">find_prev_unguarded_rl</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.AUX_NOTSM|const"><span>AUX_NOTSM</span></a><span> </span><span class="free"><span>C</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>j<span class="hidden">⇩</span><sub>0</sub></span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.LEFT_GUARD|const"><span>LEFT_GUARD</span></a><span> </span><span class="free"><span>C</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>j<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span>
      </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.find_prev_unguarded|const"><span>find_prev_unguarded</span></a><span> </span><span class="free"><span>C</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>j<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>j</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>j<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.AUX_NOTSM|const"><span>AUX_NOTSM</span></a><span> </span><span class="free"><span>C</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>C</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>l</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_32097..32107"><span>find_prev_unguarded_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_28153..28163"><span>AUX_NOTSM_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_28367..28377"><span>LEFT_GUARD_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_31050..31060"><span>mop_C_idx_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.monadic_WHILEIT_rule|fact"><span>monadic_WHILEIT_rule</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> R</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Wellfounded.html#Wellfounded.measure|const"><span>measure</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.safe|method"><span class="operator"><span>safe</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>full_types</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan_iff|fact"><span>greaterThanLessThan_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.order_class.leD|fact"><span>leD</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.linorder_class.le_less_linear|fact"><span>le_less_linear</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.le_neq_implies_less|fact"><span>le_neq_implies_less</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Word_Lib.Many_More.html#Many_More.nat_le_Suc_less_imp|fact"><span>nat_le_Suc_less_imp</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan_iff|fact"><span>greaterThanLessThan_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.order_class.leD|fact"><span>leD</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.linorder_neqE_nat|fact"><span>linorder_neqE_nat</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Word_Lib.Many_More.html#Many_More.nat_le_Suc_less_imp|fact"><span>nat_le_Suc_less_imp</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      

    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.find_prev_guarded_rl|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.find_prev_guarded_rl|thm"><span class="entity_def" id="offset_35316..35336">find_prev_guarded_rl</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.AUX_NOTSM|const"><span>AUX_NOTSM</span></a><span> </span><span class="free"><span>C</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>j<span class="hidden">⇩</span><sub>0</sub></span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>j<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span>
      </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.find_prev_guarded|const"><span>find_prev_guarded</span></a><span> </span><span class="free"><span>C</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>j<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>j</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>j<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.AUX_NOTSM|const"><span>AUX_NOTSM</span></a><span> </span><span class="free"><span>C</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>C</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>l</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_32443..32453"><span>find_prev_guarded_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_28153..28163"><span>AUX_NOTSM_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_28367..28377"><span>LEFT_GUARD_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_31050..31060"><span>mop_C_idx_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.monadic_WHILEIT_rule|fact"><span>monadic_WHILEIT_rule</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> R</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Wellfounded.html#Wellfounded.measure|const"><span>measure</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc_le_lessD|fact"><span>Suc_le_lessD</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan_iff|fact"><span>atLeastLessThan_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.atLeastSucLessThan_greaterThanLessThan|fact"><span>atLeastSucLessThan_greaterThanLessThan</span></a><span> 
              </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan_iff|fact"><span>greaterThanLessThan_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.order_class.leD|fact"><span>leD</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.linorder_class.le_less_linear|fact"><span>le_less_linear</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.less_imp_diff_less|fact"><span>less_imp_diff_less</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Word_Lib.Many_More.html#Many_More.nat_le_Suc_less_imp|fact"><span>nat_le_Suc_less_imp</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat_neq_iff|fact"><span>nat_neq_iff</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      
      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.first_find_prev_rl|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.first_find_prev_rl|thm"><span class="entity_def" id="offset_35969..35987">first_find_prev_rl</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.AUX_SMALLER|const"><span>AUX_SMALLER</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Not</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>oo</span></a></span><span> </span><span class="free"><span>C</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>i</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.AUX_NOTSM|const"><span>AUX_NOTSM</span></a><span> </span><span class="free"><span>C</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>j<span class="hidden">⇩</span><sub>0</sub></span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>j<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span>
      </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.first_find_prev|const"><span>first_find_prev</span></a><span> </span><span class="free"><span>C</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>j<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>j</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>j<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.AUX_NOTSM|const"><span>AUX_NOTSM</span></a><span> </span><span class="free"><span>C</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>C</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>l</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_32780..32790"><span>first_find_prev_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_35316..35336"><span>find_prev_guarded_rl</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_34555..34577"><span>find_prev_unguarded_rl</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span class="main"><span>)</span></span><span> 
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_29111..29126"><span>LEFT_GUARD_init</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
 
       
      
           
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_right_invar_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_right_invar_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_right_invar_def_raw|axiom"><span class="entity_def" id="offset_36395..36405">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_right_invar.cong|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_right_invar.cong|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_right_invar|const"><span class="entity_def" id="offset_36407..36423">part_right_invar</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> 
        </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset|const"><span>slice_eq_mset</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="bound"><span>xs</span></span><span>
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span>  
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="bound"><span>xs</span></span><span>
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>j</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>{</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>&lt;..&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>}</span></a></span><span>
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.AUX_SMALLER|const"><span>AUX_SMALLER</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.AUX_NOTSM|const"><span>AUX_NOTSM</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Not</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>oo</span></a></span><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>&lt;</b></span></span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>j</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>&lt;</b></span></span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>)</span></span><span>
      "</span></span></span><span>

    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_36700..36705">lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_right_invar_boundsD|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_right_invar_boundsD(7)|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_right_invar_boundsD(6)|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_right_invar_boundsD(5)|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_right_invar_boundsD(4)|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_right_invar_boundsD(3)|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_right_invar_boundsD(2)|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_right_invar_boundsD(1)|thm"><span class="entity_def" id="offset_36706..36730">part_right_invar_boundsD</span></span></span></span></span></span></span></span></span><span class="main"><span>:</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#offset_36407..36423"><span>part_right_invar</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><span>,</span></span><span class="free"><span>i</span></span><span class="main"><span>,</span></span><span class="free"><span>j</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
      </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>l</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>h</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>l</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>l</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_36700..36705"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_36395..36405"><span>part_right_invar_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_27886..27896"><span>AUX_SMALLER_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_28153..28163"><span>AUX_NOTSM_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_eq_length|fact"><span>slice_eq_mset_eq_length</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_37069..37074">lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_right_invar_pres|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_right_invar_pres(4)|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_right_invar_pres(3)|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_right_invar_pres(2)|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_right_invar_pres(1)|thm"><span class="entity_def" id="offset_37075..37096">part_right_invar_pres</span></span></span></span></span></span><span class="main"><span>:</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#offset_36407..36423"><span>part_right_invar</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><span>,</span></span><span class="free"><span>i</span></span><span class="main"><span>,</span></span><span class="free"><span>j</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>j</span></span><span>"</span></span></span><span>  
      </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.AUX_SMALLER|const"><span>AUX_SMALLER</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap|const"><span>swap</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>j</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>i</span></span><span>"</span></span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.RIGHT_GUARD|const"><span>RIGHT_GUARD</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap|const"><span>swap</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>j</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>i</span></span><span>"</span></span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.AUX_NOTSM|const"><span>AUX_NOTSM</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Not</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>oo</span></a></span><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap|const"><span>swap</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>j</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>j</span></span><span>"</span></span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.LEFT_GUARD|const"><span>LEFT_GUARD</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Not</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>oo</span></a></span><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap|const"><span>swap</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>j</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>j</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_37069..37074"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_36395..36405"><span>part_right_invar_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>-</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_29561..29568"><span>PV_SWAP</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_28267..28277"><span>RIGHT_GUARD_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap_nth|fact"><span>swap_nth</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_29561..29568"><span>PV_SWAP</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_28367..28377"><span>LEFT_GUARD_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap_nth|fact"><span>swap_nth</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      

    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.mop_list_safe_swap|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.mop_list_safe_swap|thm"><span class="entity_def" id="offset_37671..37689">mop_list_safe_swap</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/IICF_List.html#IICF_List.mop_list_swap|const"><span>mop_list_swap</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="free"><span>j</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/IICF_List.html#IICF_List.mop_list_swap|const"><span>mop_list_swap</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>j</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>}</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.pw_eq_iff|fact"><span>pw_eq_iff</span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>
            
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.partition_right_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.partition_right_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.partition_right_def_raw|axiom"><span class="entity_def" id="offset_37874..37884">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.partition_right.cong|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.partition_right.cong|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.partition_right|const"><span class="entity_def" id="offset_37886..37901">partition_right</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      
      </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.find_next_unguarded|const"><span>find_next_unguarded</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>;</span></span><span>
      
      </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.first_find_prev|const"><span>first_find_prev</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Not</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>oo</span></a></span><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><span>;</span></span><span>

      </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>alrp</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>≥</span></a></span><span class="bound"><span>j</span></span><span class="main"><span>;</span></span><span>
      
      </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>←</span></span><span> 
        </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_While.html#Refine_While.WHILEIT|const"><span>WHILEIT</span></a><span> 
          </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_PDQ.html#offset_36407..36423"><span>part_right_invar</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><span>)</span></span><span> 
          </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span> 
          </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
            </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
            </span><span class="bound"><span>xs</span></span><span class="main"><span>←</span></span><a class="entity_ref" href="../Isabelle_LLVM/IICF_List.html#IICF_List.mop_list_swap|const"><span>mop_list_swap</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>;</span></span><span>
            </span><span class="bound"><span>i</span></span><span class="main"><span>←</span></span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.find_next_unguarded|const"><span>find_next_unguarded</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>;</span></span><span>
            </span><span class="bound"><span>j</span></span><span class="main"><span>←</span></span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.find_prev_unguarded|const"><span>find_prev_unguarded</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Not</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>oo</span></a></span><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>;</span></span><span>
            </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span>
          </span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> 
          </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>≥</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>          
      </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/IICF_List.html#IICF_List.mop_list_swap|const"><span>mop_list_swap</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>k</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>k</span></span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>&lt;</b></span></span></span><span class="bound"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="main"><span>(</span></span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><span class="comment1"><span>― ‹Not required by high-level spec, but to ensure that left side contains only truly smaller elements›</span></span><span>
      
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>alrp</span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>  
      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.bincond_double_neg|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.bincond_double_neg|thm"><span>bincond_double_neg</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Not</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>oo</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Not</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>oo</span></a></span><span> </span><span class="free"><span>C</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>C</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.ext|fact"><span>ext</span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
    
    
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.partition_right_correct|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.partition_right_correct|thm"><span class="entity_def" id="offset_38820..38843">partition_right_correct</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#offset_37886..37901"><span>partition_right</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_5280..5294"><span>partition_spec</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span>"</span></span></span><span>            
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_37874..37884"><span>partition_right_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_5268..5278"><span>partition_spec_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_32966..32988"><span>find_next_unguarded_rl</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_35969..35987"><span>first_find_prev_rl</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> h</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="free"><span>h</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_34555..34577"><span>find_prev_unguarded_rl</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> h</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="free"><span>h</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span>  </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_While.html#Refine_While.while.WHILEIT_rule|fact"><span>WHILEIT_rule</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> R</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Wellfounded.html#Wellfounded.measure|const"><span>measure</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Eisbach.Eisbach.html#Eisbach.all|method"><span class="operator"><span>all</span></span></a><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="operator"><span>elim</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjE|fact"><span>conjE</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span>›</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="main"><span>)</span></span><span>
      
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_28465..28481"><span>AUX_SMALLER_init</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_28590..28604"><span>AUX_NOTSM_init</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_28701..28721"><span>RIGHT_GUARD_from_prc</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_36706..36730"><span>part_right_invar_boundsD</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_37075..37096"><span>part_right_invar_pres</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_36395..36405"><span>part_right_invar_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> 
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_36395..36405"><span>part_right_invar_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> 
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_36395..36405"><span>part_right_invar_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_36395..36405"><span>part_right_invar_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_27886..27896"><span>AUX_SMALLER_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap_nth|fact"><span>swap_nth</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_36395..36405"><span>part_right_invar_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_27886..27896"><span>AUX_SMALLER_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>erule</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_29926..29945"><span>PARTITIONED_FINALLY</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_36395..36405"><span>part_right_invar_def</span></a><span> 
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>  

      
      
      
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_left_invar_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_left_invar_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_left_invar_def_raw|axiom"><span class="entity_def" id="offset_39813..39823">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_left_invar.cong|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_left_invar.cong|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_left_invar|const"><span class="entity_def" id="offset_39825..39840">part_left_invar</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> 
        </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset|const"><span>slice_eq_mset</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="bound"><span>xs</span></span><span>
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span>  
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="bound"><span>xs</span></span><span>
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>j</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>{</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>&lt;..&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>}</span></a></span><span>
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.AUX_SMALLER|const"><span>AUX_SMALLER</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Not</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>oo</span></a></span><span> </span><span class="main"><span>(<span class="hidden">❙</span><b>&gt;</b>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.AUX_NOTSM|const"><span>AUX_NOTSM</span></a><span> </span><span class="main"><span>(<span class="hidden">❙</span><b>&gt;</b>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>j</span></span><span> </span><span class="main"><span><span class="hidden">❙</span><b>&gt;</b></span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span><span class="hidden">❙</span><b>&gt;</b></span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>)</span></span><span>
      "</span></span></span><span>

    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_40117..40122">lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_left_invar_boundsD|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_left_invar_boundsD(9)|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_left_invar_boundsD(8)|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_left_invar_boundsD(7)|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_left_invar_boundsD(6)|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_left_invar_boundsD(5)|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_left_invar_boundsD(4)|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_left_invar_boundsD(3)|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_left_invar_boundsD(2)|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_left_invar_boundsD(1)|thm"><span class="entity_def" id="offset_40123..40146">part_left_invar_boundsD</span></span></span></span></span></span></span></span></span></span></span><span class="main"><span>:</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#offset_39825..39840"><span>part_left_invar</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><span>,</span></span><span class="free"><span>i</span></span><span class="main"><span>,</span></span><span class="free"><span>j</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
      </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>l</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>h</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>l</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>l</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span>j</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>h</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_40117..40122"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_39813..39823"><span>part_left_invar_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_27886..27896"><span>AUX_SMALLER_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_28153..28163"><span>AUX_NOTSM_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_eq_length|fact"><span>slice_eq_mset_eq_length</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_40495..40500">lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_left_invar_pres|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_left_invar_pres(4)|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_left_invar_pres(3)|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_left_invar_pres(2)|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.part_left_invar_pres(1)|thm"><span class="entity_def" id="offset_40501..40521">part_left_invar_pres</span></span></span></span></span></span><span class="main"><span>:</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#offset_39825..39840"><span>part_left_invar</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><span>,</span></span><span class="free"><span>i</span></span><span class="main"><span>,</span></span><span class="free"><span>j</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>j</span></span><span>"</span></span></span><span>  
      </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.AUX_SMALLER|const"><span>AUX_SMALLER</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Not</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>oo</span></a></span><span> </span><span class="main"><span>(<span class="hidden">❙</span><b>&gt;</b>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap|const"><span>swap</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>j</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>i</span></span><span>"</span></span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.RIGHT_GUARD|const"><span>RIGHT_GUARD</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Not</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>oo</span></a></span><span> </span><span class="main"><span>(<span class="hidden">❙</span><b>&gt;</b>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap|const"><span>swap</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>j</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>i</span></span><span>"</span></span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.AUX_NOTSM|const"><span>AUX_NOTSM</span></a><span> </span><span class="main"><span>(<span class="hidden">❙</span><b>&gt;</b>)</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap|const"><span>swap</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>j</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>j</span></span><span>"</span></span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.LEFT_GUARD|const"><span>LEFT_GUARD</span></a><span> </span><span class="main"><span>(<span class="hidden">❙</span><b>&gt;</b>)</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap|const"><span>swap</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>j</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>j</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_40495..40500"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_39813..39823"><span>part_left_invar_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>-</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_29561..29568"><span>PV_SWAP</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_28267..28277"><span>RIGHT_GUARD_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap_nth|fact"><span>swap_nth</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_29561..29568"><span>PV_SWAP</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_28367..28377"><span>LEFT_GUARD_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap_nth|fact"><span>swap_nth</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      
      
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.partition_left_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.partition_left_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.partition_left_def_raw|axiom"><span class="entity_def" id="offset_41097..41107">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.partition_left.cong|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.partition_left.cong|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.partition_left|const"><span class="entity_def" id="offset_41109..41123">partition_left</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      
      </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.find_prev_unguarded|const"><span>find_prev_unguarded</span></a><span> </span><span class="main"><span>(<span class="hidden">❙</span><b>&gt;</b>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><span>;</span></span><span>
      
      </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.first_find_next|const"><span>first_find_next</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Not</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>oo</span></a></span><span> </span><span class="main"><span>(<span class="hidden">❙</span><b>&gt;</b>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>;</span></span><span>

      </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>←</span></span><span> 
        </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_While.html#Refine_While.WHILEIT|const"><span>WHILEIT</span></a><span> 
          </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_PDQ.html#offset_39825..39840"><span>part_left_invar</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><span>)</span></span><span> 
          </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span> 
          </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
            </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
            </span><span class="bound"><span>xs</span></span><span class="main"><span>←</span></span><a class="entity_ref" href="../Isabelle_LLVM/IICF_List.html#IICF_List.mop_list_swap|const"><span>mop_list_swap</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>;</span></span><span>
            </span><span class="bound"><span>j</span></span><span class="main"><span>←</span></span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.find_prev_unguarded|const"><span>find_prev_unguarded</span></a><span> </span><span class="main"><span>(<span class="hidden">❙</span><b>&gt;</b>)</span></span><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>;</span></span><span>
            </span><span class="bound"><span>i</span></span><span class="main"><span>←</span></span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.find_next_unguarded|const"><span>find_next_unguarded</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Not</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>oo</span></a></span><span> </span><span class="main"><span>(<span class="hidden">❙</span><b>&gt;</b>)</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>;</span></span><span>
            </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span>
          </span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> 
          </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/IICF_List.html#IICF_List.mop_list_swap|const"><span>mop_list_swap</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>;</span></span><span>
      
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>k</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>{</span></a></span><span class="bound"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>&lt;..&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>k</span></span><span class="main"><span><span class="hidden">❙</span><b>&gt;</b></span></span><span class="bound"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><span class="comment1"><span>― ‹Not required by high-level spec, but to ensure that right side contains only truly greater elements›</span></span><span>
      
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a><span class="main"><span>,</span></span><span class="bound"><span>j</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>  
      
      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.partition_left_correct|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.partition_left_correct|thm"><span class="entity_def" id="offset_41916..41938">partition_left_correct</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#offset_41109..41123"><span>partition_left</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_5565..5584"><span>partition_left_spec</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span>"</span></span></span><span>            
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_41097..41107"><span>partition_left_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_5268..5278"><span>partition_spec_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_5553..5563"><span>partition_left_spec_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_32966..32988"><span>find_next_unguarded_rl</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_34090..34108"><span>first_find_next_rl</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> h</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="free"><span>h</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_34555..34577"><span>find_prev_unguarded_rl</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> h</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="free"><span>h</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span>  </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_While.html#Refine_While.while.WHILEIT_rule|fact"><span>WHILEIT_rule</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> R</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Wellfounded.html#Wellfounded.measure|const"><span>measure</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Eisbach.Eisbach.html#Eisbach.all|method"><span class="operator"><span>all</span></span></a><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="operator"><span>elim</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjE|fact"><span>conjE</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span>›</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_28465..28481"><span>AUX_SMALLER_init</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_28590..28604"><span>AUX_NOTSM_init</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_28899..28918"><span>LEFT_GUARD_from_prc</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_40123..40146"><span>part_left_invar_boundsD</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_40501..40521"><span>part_left_invar_pres</span></a><span class="main"><span>)</span></span><span>  
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_39813..39823"><span>part_left_invar_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_28153..28163"><span>AUX_NOTSM_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>        
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_39813..39823"><span>part_left_invar_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_28153..28163"><span>AUX_NOTSM_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>        
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_39813..39823"><span>part_left_invar_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_28153..28163"><span>AUX_NOTSM_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap_nth|fact"><span>swap_nth</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_39813..39823"><span>part_left_invar_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_28153..28163"><span>AUX_NOTSM_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_39813..39823"><span>part_left_invar_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>erule</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_30460..30480"><span>PARTITIONED_FINALLY2</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_39813..39823"><span>part_left_invar_def</span></a><span> 
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>  
      

    </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹We use the guarded arithmetic operations on natural numbers, to avoid to many
      in-bounds conditions to be visible to the simplifier ... this would make the simplifier
      extremely slow when invoked from within Sepref in the next step.
    ›</span></span></span><span>  
      
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle2_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle2_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle2_def_raw|axiom"><span class="entity_def" id="offset_43214..43224">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle2|const"><span>shuffle2</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><span class="bound"><span>size</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_sub|const"><span>mop_nat_sub</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>;</span></span><span>
      </span><span class="bound"><span>l_size</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_sub|const"><span>mop_nat_sub</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>;</span></span><span>
      </span><span class="bound"><span>t_m1</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_add_bnd|const"><span>mop_nat_add_bnd</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>;</span></span><span>
      </span><span class="bound"><span>r_size</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_sub|const"><span>mop_nat_sub</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="bound"><span>t_m1</span></span><span class="main"><span>;</span></span><span>
      </span><span class="bound"><span>t_sd8</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_div|const"><span>mop_nat_div</span></a><span> </span><span class="bound"><span>size</span></span><span> </span><span class="numeral"><span>8</span></span><span class="main"><span>;</span></span><span>
      
      </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>highly_unbal</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="bound"><span>l_size</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="bound"><span>t_sd8</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="bound"><span>r_size</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="bound"><span>t_sd8</span></span><span class="main"><span>;</span></span><span>
    
      </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="bound"><span>highly_unbal</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
        </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="bound"><span>l_size</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>≥</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.is_threshold|const"><span>is_threshold</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
          </span><span class="bound"><span>t_lsd4</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_div|const"><span>mop_nat_div</span></a><span> </span><span class="bound"><span>l_size</span></span><span> </span><span class="numeral"><span>4</span></span><span class="main"><span>;</span></span><span>
          </span><span class="bound"><span>i_lls4</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_add_bnd|const"><span>mop_nat_add_bnd</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="bound"><span>t_lsd4</span></span><span class="main"><span>;</span></span><span> </span><span class="comment1"><span>⌦‹l + l_size div 4›</span></span><span>
          </span><span class="bound"><span>i_mm1</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_sub|const"><span>mop_nat_sub</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>;</span></span><span> </span><span class="comment1"><span>⌦‹m-1›</span></span><span>
          </span><span class="bound"><span>i_mmls4</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_sub|const"><span>mop_nat_sub</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="bound"><span>t_lsd4</span></span><span class="main"><span>;</span></span><span> </span><span class="comment1"><span>⌦‹m - l_size div 4›</span></span><span>
          
          </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_left|const"><span>shuffle_left</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="bound"><span>i_lls4</span></span><span class="main"><span>;</span></span><span>
          </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_left|const"><span>shuffle_left</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>i_mm1</span></span><span> </span><span class="bound"><span>i_mmls4</span></span><span class="main"><span>;</span></span><span>
          
          </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="bound"><span>l_size</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.ninther_threshold|const"><span>ninther_threshold</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
            </span><span class="bound"><span>i_l1</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_add_bnd|const"><span>mop_nat_add_bnd</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>;</span></span><span>
            </span><span class="bound"><span>i_l2</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_add_bnd|const"><span>mop_nat_add_bnd</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>;</span></span><span>
            </span><span class="bound"><span>i_mm2</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_sub|const"><span>mop_nat_sub</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>;</span></span><span>
            </span><span class="bound"><span>i_mm3</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_sub|const"><span>mop_nat_sub</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="numeral"><span>3</span></span><span class="main"><span>;</span></span><span>
            
            </span><span class="bound"><span>i_lls41</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_add_bnd|const"><span>mop_nat_add_bnd</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="bound"><span>i_lls4</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>;</span></span><span>
            </span><span class="bound"><span>i_lls42</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_add_bnd|const"><span>mop_nat_add_bnd</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="bound"><span>i_lls4</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>;</span></span><span>
            </span><span class="bound"><span>i_mmls41</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_sub|const"><span>mop_nat_sub</span></a><span> </span><span class="bound"><span>i_mmls4</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>;</span></span><span>             
            </span><span class="bound"><span>i_mmls42</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_sub|const"><span>mop_nat_sub</span></a><span> </span><span class="bound"><span>i_mmls4</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>;</span></span><span>             
          
            </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_left|const"><span>shuffle_left</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>i_l1</span></span><span> </span><span class="bound"><span>i_lls41</span></span><span class="main"><span>;</span></span><span>
            </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_left|const"><span>shuffle_left</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>i_l2</span></span><span> </span><span class="bound"><span>i_lls42</span></span><span class="main"><span>;</span></span><span>
            </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_left|const"><span>shuffle_left</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>i_mm2</span></span><span> </span><span class="bound"><span>i_mmls41</span></span><span class="main"><span>;</span></span><span>
            </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_left|const"><span>shuffle_left</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>i_mm3</span></span><span> </span><span class="bound"><span>i_mmls42</span></span><span class="main"><span>;</span></span><span>
            </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>xs</span></span><span>
          </span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>xs</span></span><span>
        </span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>;</span></span><span>
        </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="bound"><span>r_size</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>≥</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.is_threshold|const"><span>is_threshold</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
          </span><span class="bound"><span>i_m1</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_add_bnd|const"><span>mop_nat_add_bnd</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>;</span></span><span>
          </span><span class="bound"><span>i_h1</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_sub|const"><span>mop_nat_sub</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>;</span></span><span>
          
          </span><span class="bound"><span>t_rsd4</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_div|const"><span>mop_nat_div</span></a><span> </span><span class="bound"><span>r_size</span></span><span> </span><span class="numeral"><span>4</span></span><span class="main"><span>;</span></span><span>
          </span><span class="bound"><span>i_mp1</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_add_bnd|const"><span>mop_nat_add_bnd</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="bound"><span>i_m1</span></span><span> </span><span class="bound"><span>t_rsd4</span></span><span class="main"><span>;</span></span><span>
          </span><span class="bound"><span>i_hm</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_sub|const"><span>mop_nat_sub</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="bound"><span>t_rsd4</span></span><span class="main"><span>;</span></span><span>
        
          </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_right|const"><span>shuffle_right</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>i_m1</span></span><span> </span><span class="bound"><span>i_mp1</span></span><span class="main"><span>;</span></span><span>
          </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_right|const"><span>shuffle_right</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>i_h1</span></span><span> </span><span class="bound"><span>i_hm</span></span><span class="main"><span>;</span></span><span>
          </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="bound"><span>r_size</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.ninther_threshold|const"><span>ninther_threshold</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
          
            </span><span class="bound"><span>i_m2</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_add_bnd|const"><span>mop_nat_add_bnd</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>;</span></span><span>
            </span><span class="bound"><span>i_m3</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_add_bnd|const"><span>mop_nat_add_bnd</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="numeral"><span>3</span></span><span class="main"><span>;</span></span><span>
            </span><span class="bound"><span>i_h2</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_sub|const"><span>mop_nat_sub</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>;</span></span><span>
            </span><span class="bound"><span>i_h3</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_sub|const"><span>mop_nat_sub</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="numeral"><span>3</span></span><span class="main"><span>;</span></span><span>
            </span><span class="bound"><span>i_hm1</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_sub|const"><span>mop_nat_sub</span></a><span> </span><span class="bound"><span>i_hm</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>;</span></span><span>
            </span><span class="bound"><span>i_hm2</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_sub|const"><span>mop_nat_sub</span></a><span> </span><span class="bound"><span>i_hm</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>;</span></span><span>
            </span><span class="bound"><span>i_mp2</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_add_bnd|const"><span>mop_nat_add_bnd</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="bound"><span>i_mp1</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>;</span></span><span>
            </span><span class="bound"><span>i_mp3</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_add_bnd|const"><span>mop_nat_add_bnd</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="bound"><span>i_mp1</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>;</span></span><span>
          
            </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_right|const"><span>shuffle_right</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>i_m2</span></span><span> </span><span class="bound"><span>i_mp2</span></span><span class="main"><span>;</span></span><span>
            </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_right|const"><span>shuffle_right</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>i_m3</span></span><span> </span><span class="bound"><span>i_mp3</span></span><span class="main"><span>;</span></span><span>
            </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_right|const"><span>shuffle_right</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>i_h2</span></span><span> </span><span class="bound"><span>i_hm1</span></span><span class="main"><span>;</span></span><span>  
            </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_right|const"><span>shuffle_right</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>i_h3</span></span><span> </span><span class="bound"><span>i_hm2</span></span><span class="main"><span>;</span></span><span>          
            </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>xs</span></span><span>
          </span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>xs</span></span><span>
        </span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>;</span></span><span>
        </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span>
        </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>
      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle2_aux|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle2_aux|thm"><span>shuffle2_aux</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.ninther_threshold|const"><span>ninther_threshold</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>l</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>h</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>m</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>h</span></span><span class="main"><span>⟧</span></span><span>  </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>l</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.divide_class.divide|const"><span>div</span></a></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>h</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
    
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.mop_nat_simps|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.mop_nat_simps(3)|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.mop_nat_simps(2)|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.mop_nat_simps(1)|thm"><span class="entity_def" id="offset_45873..45886">mop_nat_simps</span></span></span></span></span><span class="main"><span>:</span></span><span>
      </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="free"><span>b</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span>h</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_add_bnd|const"><span>mop_nat_add_bnd</span></a><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_sub|const"><span>mop_nat_sub</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_div|const"><span>mop_nat_div</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.divide_class.divide|const"><span>div</span></a></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_defs|fact"><span class="dynamic"><span class="dynamic"><span>mop_nat_defs</span></span></span></a><span class="main"><span>)</span></span><span>
      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle2_refine|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.shuffle2_refine|thm"><span class="entity_def" id="offset_46091..46106">shuffle2_refine</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle2|const"><span>shuffle2</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle|const"><span>shuffle</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>m</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>

      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_46171..46172">A</span><span class="main"><span>:</span></span><span> 
        </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_right|const"><span>shuffle_right</span></a><span class="main"><span>,</span></span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_right|const"><span>shuffle_right</span></a><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.nat_rel|const"><span>nat_rel</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.nat_rel|const"><span>nat_rel</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="main"><span>⟨</span></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span> 
        </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_left|const"><span>shuffle_left</span></a><span class="main"><span>,</span></span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_left|const"><span>shuffle_left</span></a><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.nat_rel|const"><span>nat_rel</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.nat_rel|const"><span>nat_rel</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="main"><span>⟨</span></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_relI|fact"><span>nres_relI</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>note</span></span></span><span> </span><span class="entity_def" id="offset_46377..46378">A</span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_46171..46172"><span>A</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.param_fo|attribute"><span class="operator"><span>param_fo</span></span></a><span class="main"><span>]</span></span><span>  
        
        
      </span><span class="keyword1"><span class="command"><span>{</span></span></span><span>
        </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span>h</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span>m</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span>h</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_43214..43224"><span>shuffle2_def</span></a><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>split</span></span><span> </span><span class="quasi_keyword"><span>del</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.if_split|fact"><span>if_split</span></a><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Let_def|fact"><span>Let_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_45873..45886"><span>mop_nat_simps</span></a><span> </span><span class="quasi_keyword"><span>cong</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.if_cong|fact"><span>if_cong</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_22570..22580"><span>shuffle_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Let_def|fact"><span>Let_def</span></a><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>named_ss</span></span><span> </span><span>Main_ss</span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quasi_keyword"><span>split</span></span><span> </span><span class="quasi_keyword"><span>del</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.if_split|fact"><span>if_split</span></a><span> </span><span class="quasi_keyword"><span>cong</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.if_cong|fact"><span>if_cong</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/splitter.ML.html#HOL.split|method"><span class="operator"><span>split</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.if_split|fact"><span>if_split</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjI|fact"><span>conjI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.impI|fact"><span>impI</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>only</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.if_True|fact"><span>if_True</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.if_False|fact"><span>if_False</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/splitter.ML.html#HOL.split|method"><span class="operator"><span>split</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.if_split|fact"><span>if_split</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjI|fact"><span>conjI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.impI|fact"><span>impI</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>only</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.if_True|fact"><span>if_True</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.if_False|fact"><span>if_False</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Eisbach.Eisbach.html#Eisbach.all|method"><span class="operator"><span>all</span></span></a><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.ninther_threshold|const"><span>ninther_threshold</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>l</span></span><span>"</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>only</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.if_True|fact"><span>if_True</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.if_False|fact"><span>if_False</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span>›</span></span><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Eisbach.Eisbach.html#Eisbach.all|method"><span class="operator"><span>all</span></span></a><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.is_threshold|const"><span>is_threshold</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="free"><span>m</span></span><span>"</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>only</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.if_True|fact"><span>if_True</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.if_False|fact"><span>if_False</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span>›</span></span><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Eisbach.Eisbach.html#Eisbach.all|method"><span class="operator"><span>all</span></span></a><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.ninther_threshold|const"><span>ninther_threshold</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="free"><span>m</span></span><span>"</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>only</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.if_True|fact"><span>if_True</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.if_False|fact"><span>if_False</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span>›</span></span><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.algebra_simps|fact"><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span></a><span> </span><span class="quasi_keyword"><span>del</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.One_nat_def|fact"><span>One_nat_def</span></a><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc_eq_plus1|fact"><span>Suc_eq_plus1</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_IdD|fact"><span>refine_IdD</span></a><span class="main"><span>)</span></span><span> 
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_rcg|method"><span class="operator"><span>refine_rcg</span></span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_46377..46378"><span>A</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>THEN</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_relD|fact"><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_relD|fact"><span>nres_relD</span></a></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.IdI|fact"><span>IdI</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_IdD|fact"><span>refine_IdD</span></a><span class="main"><span>)</span></span><span> 
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_rcg|method"><span class="operator"><span>refine_rcg</span></span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_46377..46378"><span>A</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>THEN</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_relD|fact"><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_relD|fact"><span>nres_relD</span></a></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.IdI|fact"><span>IdI</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_IdD|fact"><span>refine_IdD</span></a><span class="main"><span>)</span></span><span> 
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_rcg|method"><span class="operator"><span>refine_rcg</span></span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_46377..46378"><span>A</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>THEN</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_relD|fact"><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_relD|fact"><span>nres_relD</span></a></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.IdI|fact"><span>IdI</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>          
      </span><span class="keyword1"><span class="command"><span>}</span></span></span><span> </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_22570..22580"><span>shuffle_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>only</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span> 
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>            

    </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Again, we replace the nat arithmetic by assertion-guarded operations, to avoid 
      overwhelming the simplifier.›</span></span></span><span>    
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.move_pivot_to_front2_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.move_pivot_to_front2_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.move_pivot_to_front2_def_raw|axiom"><span class="entity_def" id="offset_47811..47821">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.move_pivot_to_front2.cong|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.move_pivot_to_front2.cong|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.move_pivot_to_front2|const"><span class="entity_def" id="offset_47823..47843">move_pivot_to_front2</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      
      </span><span class="bound"><span>size</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_sub|const"><span>mop_nat_sub</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>;</span></span><span>
      </span><span class="bound"><span>s2</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_div|const"><span>mop_nat_div</span></a><span> </span><span class="bound"><span>size</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>;</span></span><span>
      
      </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>size</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.ninther_threshold|const"><span>ninther_threshold</span></a><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
        </span><span class="comment1"><span>⌦‹ASSERT (l+s2+1&lt;h ∧ h≥3 ∧ s2≥1 ∧ s2&lt;h );›</span></span><span>
        </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="numeral"><span>2</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="bound"><span>s2</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="bound"><span>s2</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>≥</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>≥</span></a></span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
        </span><span class="bound"><span>xs</span></span><span class="main"><span>←</span></span><a class="entity_ref" href="Sorting_PDQ.html#offset_19456..19466"><span>sort_three</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span>              </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="bound"><span>s2</span></span><span class="main"><span>)</span></span><span>      </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
        </span><span class="bound"><span>xs</span></span><span class="main"><span>←</span></span><a class="entity_ref" href="Sorting_PDQ.html#offset_19456..19466"><span>sort_three</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span>        </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="bound"><span>s2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
        </span><span class="bound"><span>xs</span></span><span class="main"><span>←</span></span><a class="entity_ref" href="Sorting_PDQ.html#offset_19456..19466"><span>sort_three</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>        </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="bound"><span>s2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="numeral"><span>3</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
        </span><span class="bound"><span>xs</span></span><span class="main"><span>←</span></span><a class="entity_ref" href="Sorting_PDQ.html#offset_19456..19466"><span>sort_three</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="bound"><span>s2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="bound"><span>s2</span></span><span class="main"><span>)</span></span><span>       </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="bound"><span>s2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
        </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="bound"><span>s2</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
        </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/IICF_List.html#IICF_List.mop_list_swap|const"><span>mop_list_swap</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="bound"><span>s2</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
        </span><span class="comment1"><span>⌦‹ASSERT (xs!l <span class="hidden">❙</span><b>≤</b> xs!(l + (s2 + 1)) ∧ xs!(l + (s2 - 1)) <span class="hidden">❙</span><b>≤</b> xs!l);›</span></span><span>
        </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>xs</span></span><span>
      </span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
        </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="bound"><span>s2</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>≥</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
        </span><a class="entity_ref" href="Sorting_PDQ.html#offset_19456..19466"><span>sort_three</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="bound"><span>s2</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>}</span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    

    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.move_pivot_to_front2_refine|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.move_pivot_to_front2_refine|thm"><span class="entity_def" id="offset_48639..48666">move_pivot_to_front2_refine</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#offset_47823..47843"><span>move_pivot_to_front2</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_21000..21019"><span>move_pivot_to_front</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span>"</span></span></span><span>    
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_47811..47821"><span>move_pivot_to_front2_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_20988..20998"><span>move_pivot_to_front_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Let_def|fact"><span>Let_def</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.mop_nat_defs|fact"><span class="dynamic"><span class="dynamic"><span>mop_nat_defs</span></span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>split</span></span><span> </span><span class="quasi_keyword"><span>del</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.if_split|fact"><span>if_split</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_IdD|fact"><span>refine_IdD</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_rcg|method"><span class="operator"><span>refine_rcg</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Heuristics.html#Refine_Heuristics.refine_dref_type|method"><span class="operator"><span>refine_dref_type</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
    

    </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹We explicitly introduce evaluation order of conditions that must be short-circuited.›</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.weak_ordering.pdqsort_aux2_def|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.pdqsort_aux2_def|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.pdqsort_aux2_def_raw|axiom"><span class="entity_def" id="offset_49078..49088">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_PDQ.weak_ordering.pdqsort_aux2.cong|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.pdqsort_aux2.cong|thm"><span class="entity_def" id="Sorting_PDQ.weak_ordering.pdqsort_aux2|const"><span class="entity_def" id="offset_49090..49102">pdqsort_aux2</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>leftmost</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/RefineG_Recursion.html#RefineG_Recursion.RECT|const"><span>RECT</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>pdqsort_aux</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>leftmost</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>l</span></span><span class="main"><span>,</span></span><span class="bound"><span>h</span></span><span class="main"><span>,</span></span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="bound"><span>h</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      
      </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="bound"><span>l</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.pdq_is_threshold|const"><span>pdq_is_threshold</span></a><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> 
        </span><span>pdq_guarded_sort_spec</span><span> </span><span class="bound"><span>leftmost</span></span><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="bound"><span>h</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
        </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_4847..4866"><span>pivot_to_front_spec</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="bound"><span>h</span></span><span class="main"><span>;</span></span><span>

        </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="bound"><span>leftmost</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="bound"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>         
        </span><span class="keyword1"><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.monadic_If|const"><span>if<span class="hidden">⇩</span><sub>N</sub></span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="bound"><span>leftmost</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>≥</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><span class="bound"><span>b</span></span><span class="main"><span>←</span></span><span>mop_cmp_idxs</span><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>l</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="bound"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>}</span></span><span> </span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.monadic_If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
          </span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="bound"><span>m</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_5565..5584"><span>partition_left_spec</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="bound"><span>h</span></span><span class="main"><span>;</span></span><span>
          </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>h</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
          </span><span class="bound"><span>pdqsort_aux</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>,</span></span><span class="bound"><span>h</span></span><span class="main"><span>,</span></span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span>
        </span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.monadic_If|const"><span>else</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
          </span><span class="main"><span>(</span></span><span class="bound"><span>alrp</span></span><span class="main"><span>,</span></span><span class="bound"><span>m</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_5280..5294"><span>partition_spec</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="bound"><span>h</span></span><span class="main"><span>;</span></span><span>
          </span><span class="main"><span>(</span></span><span class="bound"><span>unbal</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_spec|const"><span>shuffle_spec</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="bound"><span>h</span></span><span> </span><span class="bound"><span>m</span></span><span class="main"><span>;</span></span><span>
          
          </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
          </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>d</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="bound"><span>unbal</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="bound"><span>d</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
          
          </span><span class="main"><span>(</span></span><span class="bound"><span>didsort</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> 
            </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="bound"><span>d</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_11624..11642"><span>fallback_sort_spec</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="bound"><span>h</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>
            </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="bound"><span>alrp</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="bound"><span>unbal</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
              </span><span class="main"><span>(</span></span><span class="bound"><span>r</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><span>maybe_sort_spec</span><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="bound"><span>m</span></span><span class="main"><span>;</span></span><span>
              </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
                </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>h</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
                </span><span>maybe_sort_spec</span><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>h</span></span><span>
              </span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span>
            </span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
            
          </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="bound"><span>didsort</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>xs</span></span><span> 
          </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span> </span><span class="comment1"><span>⌦‹TODO: Test optimization of not sorting left partition again, if maybe_sort sorted it›</span></span><span>
            </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><span class="bound"><span>pdqsort_aux</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>leftmost</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>l</span></span><span class="main"><span>,</span></span><span class="bound"><span>m</span></span><span class="main"><span>,</span></span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
            </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>h</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
            </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><span class="bound"><span>pdqsort_aux</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>,</span></span><span class="bound"><span>h</span></span><span class="main"><span>,</span></span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
            </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>xs</span></span><span>
          </span><span class="main"><span>}</span></span><span> 
        </span><span class="main"><span>}</span></span><span>
      </span><span class="main"><span>}</span></span><span>
    
    </span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>leftmost</span></span></span></span><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

    </span><span class="comment1"><span>(* TODO: Move. TODO: really refine2? *)</span></span><span>      
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_50636..50641">lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.ifN_refine|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.ifN_refine|thm"><span>ifN_refine</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine2|attribute"><span class="operator"><span>refine2</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="free"><span>b'</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>c</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="main"><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="free"><span>c'</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>d</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="main"><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="free"><span>d'</span></span><span>"</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.monadic_If|const"><span>if<span class="hidden">⇩</span><sub>N</sub></span></a></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.monadic_If|const"><span>then</span></a></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.monadic_If|const"><span>else</span></a></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="main"><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="free"><span>c'</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="free"><span>d'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_50636..50641"><span>assms</span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.if_bind_cond_refine|fact"><span>if_bind_cond_refine</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.weak_ordering.pdqsort_aux2_refine|fact"><span class="entity_def" id="Sorting_PDQ.weak_ordering.pdqsort_aux2_refine|thm"><span class="entity_def" id="offset_50838..50857">pdqsort_aux2_refine</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#offset_49090..49102"><span>pdqsort_aux2</span></a><span> </span><span class="free"><span>leftmost</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_11780..11791"><span>pdqsort_aux</span></a><span> </span><span class="free"><span>leftmost</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>d</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_49078..49088"><span>pdqsort_aux2_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_11768..11778"><span>pdqsort_aux_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_IdD|fact"><span>refine_IdD</span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.if_bind_cond_refine|fact"><span>if_bind_cond_refine</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_rcg|method"><span class="operator"><span>refine_rcg</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Heuristics.html#Refine_Heuristics.refine_dref_type|method"><span class="operator"><span>refine_dref_type</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Eisbach.Eisbach.html#Eisbach.all|method"><span class="operator"><span>all</span></span></a><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>named_ss</span></span><span> </span><span>HOL_ss</span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.prod_rel_simp|fact"><span>prod_rel_simp</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.pair_in_Id_conv|fact"><span>pair_in_Id_conv</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span>›</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Eisbach.Eisbach.html#Eisbach.all|method"><span class="operator"><span>all</span></span></a><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="operator"><span>elim</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjE|fact"><span>conjE</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span>›</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      
          
  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
  
  
  </span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Refinement to Isabelle-LLVM›</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Some boilerplate code for every subroutine.›</span></span></span><span>  
  
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_51353..51360">context</span></span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.sort_impl_context|locale"><span>sort_impl_context</span></a><span> </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>
    
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_first_find_next.mcomb|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_first_find_next.arity|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_first_find_next.itype|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_first_find_next.pat|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_next_g.mcomb|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_next_g.arity|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_next_g.itype|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_next_g.pat|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_next_ug.mcomb|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_next_ug.arity|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_next_ug.itype|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_next_ug.pat|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_prev_ug.mcomb|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_prev_ug.arity|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_prev_ug.itype|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_prev_ug.pat|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_first_find_next.mcomb|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_first_find_next.arity|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_first_find_next.itype|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_first_find_next.pat|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_next_g.mcomb|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_next_g.arity|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_next_g.itype|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_next_g.pat|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_next_ug.mcomb|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_next_ug.arity|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_next_ug.itype|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_next_ug.pat|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_prev_ug.mcomb|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_prev_ug.arity|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_prev_ug.itype|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_prev_ug.pat|thm"><span>sepref_register</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> 
      left_find_prev_ug</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.find_prev_unguarded|const"><span>find_prev_unguarded</span></a><span> </span><span class="main"><span>(<span class="hidden">❙</span><b>&gt;</b>)</span></span><span>"</span></span></span><span>
      left_find_next_ug</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.find_next_unguarded|const"><span>find_next_unguarded</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Not</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>oo</span></a></span><span> </span><span class="main"><span>(<span class="hidden">❙</span><b>&gt;</b>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      left_find_next_g</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.find_next_guarded|const"><span>find_next_guarded</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Not</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>oo</span></a></span><span> </span><span class="main"><span>(<span class="hidden">❙</span><b>&gt;</b>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      left_first_find_next</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.first_find_next|const"><span>first_find_next</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Not</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>oo</span></a></span><span> </span><span class="main"><span>(<span class="hidden">❙</span><b>&gt;</b>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.sort_impl_context.mop_C_idx_unfolds|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.mop_C_idx_unfolds(4)|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.mop_C_idx_unfolds(3)|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.mop_C_idx_unfolds(2)|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.mop_C_idx_unfolds(1)|thm"><span class="entity_def" id="offset_51660..51677">mop_C_idx_unfolds</span></span></span></span></span></span><span class="main"><span>:</span></span><span>
      </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.mop_C_idx|const"><span>mop_C_idx</span></a><span> </span><span class="main"><span>(<span class="hidden">❙</span><b>&gt;</b>)</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span>mop_cmp_idxs</span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>j</span></span><span> </span><span class="free"><span>i</span></span><span>"</span></span></span><span>                                                             
      </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.mop_C_idx|const"><span>mop_C_idx</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Not</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>oo</span></a></span><span> </span><span class="main"><span>(<span class="hidden">❙</span><b>&gt;</b>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span> </span><span class="bound"><span>b</span></span><span class="main"><span>←</span></span><span>mop_cmp_idxs</span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>j</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="bound"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>}</span></span><span>"</span></span></span><span>  
      </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.mop_C_idx|const"><span>mop_C_idx</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span>mop_cmp_idxs</span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>j</span></span><span>"</span></span></span><span>                                                             
      </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.mop_C_idx|const"><span>mop_C_idx</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Not</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>oo</span></a></span><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span> </span><span class="bound"><span>b</span></span><span class="main"><span>←</span></span><span>mop_cmp_idxs</span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>j</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="bound"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>}</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_51353..51360"><span>mop_C_idx_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.pw_eq_iff|fact"><span>pw_eq_iff</span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>
      
      
      
    </span><span class="keyword1"><span class="command"><span>sepref_def</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_prev_ug_impl.cong|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_prev_ug_impl.cong|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_prev_ug_impl|const"><span>left_find_prev_ug_impl</span></span></span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Codegen_Preproc.html#LLVM_Codegen_Preproc.llvm_inline|attribute"><span class="operator"><span>llvm_inline</span></span></a><span class="main"><span>]</span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry2|const"><span>uncurry2</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.find_prev_unguarded|const"><span>find_prev_unguarded</span></a><span> </span><span class="main"><span>(<span class="hidden">❙</span><b>&gt;</b>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>arr_assn</span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefttnd|const"><span>→<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_51353..51360"><span>find_prev_unguarded_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_51660..51677"><span>mop_C_idx_unfolds</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.annot_snat_const|method"><span class="operator"><span>annot_snat_const</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_t|type"><span>size_t</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_prev_ug_impl.refine|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_prev_ug_impl_def|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_prev_ug_impl.refine_raw|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_prev_ug_impl.refine|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_prev_ug_impl_def|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_prev_ug_impl.refine_raw|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_prev_ug_impl_def_raw|axiom"><span>by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref|method"><span class="operator"><span>sepref</span></span></a><span>

    </span><span class="keyword1"><span class="command"><span>sepref_def</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_next_ug_impl.cong|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_next_ug_impl.cong|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_next_ug_impl|const"><span>left_find_next_ug_impl</span></span></span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Codegen_Preproc.html#LLVM_Codegen_Preproc.llvm_inline|attribute"><span class="operator"><span>llvm_inline</span></span></a><span class="main"><span>]</span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry3|const"><span>uncurry3</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.find_next_unguarded|const"><span>find_next_unguarded</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Not</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>oo</span></a></span><span> </span><span class="main"><span>(<span class="hidden">❙</span><b>&gt;</b>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>arr_assn</span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefttnd|const"><span>→<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_51353..51360"><span>find_next_unguarded_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_51660..51677"><span>mop_C_idx_unfolds</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.annot_snat_const|method"><span class="operator"><span>annot_snat_const</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_t|type"><span>size_t</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_next_ug_impl.refine|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_next_ug_impl_def|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_next_ug_impl.refine_raw|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_next_ug_impl.refine|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_next_ug_impl_def|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_next_ug_impl.refine_raw|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_next_ug_impl_def_raw|axiom"><span>by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref|method"><span class="operator"><span>sepref</span></span></a><span>

    </span><span class="keyword1"><span class="command"><span>sepref_def</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_next_g_impl.cong|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_next_g_impl.cong|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_next_g_impl|const"><span>left_find_next_g_impl</span></span></span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Codegen_Preproc.html#LLVM_Codegen_Preproc.llvm_inline|attribute"><span class="operator"><span>llvm_inline</span></span></a><span class="main"><span>]</span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry3|const"><span>uncurry3</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.find_next_guarded|const"><span>find_next_guarded</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Not</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>oo</span></a></span><span> </span><span class="main"><span>(<span class="hidden">❙</span><b>&gt;</b>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>arr_assn</span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefttnd|const"><span>→<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_51353..51360"><span>find_next_guarded_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_51660..51677"><span>mop_C_idx_unfolds</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.annot_snat_const|method"><span class="operator"><span>annot_snat_const</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_t|type"><span>size_t</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_next_g_impl.refine|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_next_g_impl_def|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_next_g_impl.refine_raw|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_next_g_impl.refine|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_next_g_impl_def|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_next_g_impl.refine_raw|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_find_next_g_impl_def_raw|axiom"><span>by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref|method"><span class="operator"><span>sepref</span></span></a><span>
            
    </span><span class="keyword1"><span class="command"><span>sepref_def</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_first_find_next_impl.cong|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_first_find_next_impl.cong|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_first_find_next_impl|const"><span>left_first_find_next_impl</span></span></span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Codegen_Preproc.html#LLVM_Codegen_Preproc.llvm_inline|attribute"><span class="operator"><span>llvm_inline</span></span></a><span class="main"><span>]</span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry4|const"><span>uncurry4</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.first_find_next|const"><span>first_find_next</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Not</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>oo</span></a></span><span> </span><span class="main"><span>(<span class="hidden">❙</span><b>&gt;</b>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>arr_assn</span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefttnd|const"><span>→<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_51353..51360"><span>first_find_next_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.annot_snat_const|method"><span class="operator"><span>annot_snat_const</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_t|type"><span>size_t</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_first_find_next_impl.refine|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_first_find_next_impl_def|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_first_find_next_impl.refine_raw|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_first_find_next_impl.refine|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_first_find_next_impl_def|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_first_find_next_impl.refine_raw|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.left_first_find_next_impl_def_raw|axiom"><span>by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref|method"><span class="operator"><span>sepref</span></span></a><span>
      

    </span><span class="keyword1"><span class="command"><span>sepref_def</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_left_impl.cong|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_left_impl.cong|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_left_impl|const"><span>partition_left_impl</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry2|const"><span>uncurry2</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_41109..41123"><span>partition_left</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span> </span><span>arr_assn</span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfdrop|const"><span><span class="hidden">⇧</span><sup>d</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.bool1_assn|const"><span>bool1_assn</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.prod_assn|const"><span>×<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.prod_assn|const"><span>×<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span>arr_assn</span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="bound"><span>a</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="bound"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="bound"><span>a</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_51353..51360"><span>partition_left_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_left_impl.refine|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_left_impl_def|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_left_impl.refine_raw|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_left_impl.refine|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_left_impl_def|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_left_impl.refine_raw|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_left_impl_def_raw|axiom"><span class="entity_def" id="offset_53751..53753">by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref|method"><span class="operator"><span>sepref</span></span></a><span>
      

    </span><span class="keyword1"><span class="command"><span>thm</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_51353..51360"><span>partition_right_def</span></a><span>  
      
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_first_find_next.mcomb|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_first_find_next.arity|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_first_find_next.itype|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_first_find_next.pat|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_next_g.mcomb|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_next_g.arity|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_next_g.itype|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_next_g.pat|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_next_ug.mcomb|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_next_ug.arity|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_next_ug.itype|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_next_ug.pat|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_prev_ug.mcomb|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_prev_ug.arity|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_prev_ug.itype|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_prev_ug.pat|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_first_find_next.mcomb|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_first_find_next.arity|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_first_find_next.itype|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_first_find_next.pat|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_next_g.mcomb|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_next_g.arity|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_next_g.itype|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_next_g.pat|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_next_ug.mcomb|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_next_ug.arity|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_next_ug.itype|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_next_ug.pat|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_prev_ug.mcomb|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_prev_ug.arity|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_prev_ug.itype|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_prev_ug.pat|thm"><span>sepref_register</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> 
      right_find_prev_ug</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.find_prev_unguarded|const"><span>find_prev_unguarded</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Not</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>oo</span></a></span><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      right_find_next_ug</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.find_next_unguarded|const"><span>find_next_unguarded</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span>"</span></span></span><span>
      right_find_next_g</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.find_prev_guarded|const"><span>find_prev_guarded</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Not</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>oo</span></a></span><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      right_first_find_next</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.first_find_prev|const"><span>first_find_prev</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Not</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>oo</span></a></span><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      
      
    </span><span class="keyword1"><span class="command"><span>sepref_def</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_prev_ug_impl.cong|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_prev_ug_impl.cong|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_prev_ug_impl|const"><span>right_find_prev_ug_impl</span></span></span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Codegen_Preproc.html#LLVM_Codegen_Preproc.llvm_inline|attribute"><span class="operator"><span>llvm_inline</span></span></a><span class="main"><span>]</span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry2|const"><span>uncurry2</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.find_prev_unguarded|const"><span>find_prev_unguarded</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Not</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>oo</span></a></span><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>arr_assn</span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefttnd|const"><span>→<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_51353..51360"><span>find_prev_unguarded_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_51660..51677"><span>mop_C_idx_unfolds</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.annot_snat_const|method"><span class="operator"><span>annot_snat_const</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_t|type"><span>size_t</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_prev_ug_impl.refine|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_prev_ug_impl_def|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_prev_ug_impl.refine_raw|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_prev_ug_impl.refine|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_prev_ug_impl_def|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_prev_ug_impl.refine_raw|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_prev_ug_impl_def_raw|axiom"><span>by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref|method"><span class="operator"><span>sepref</span></span></a><span>

    </span><span class="keyword1"><span class="command"><span>sepref_def</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_next_ug_impl.cong|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_next_ug_impl.cong|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_next_ug_impl|const"><span>right_find_next_ug_impl</span></span></span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Codegen_Preproc.html#LLVM_Codegen_Preproc.llvm_inline|attribute"><span class="operator"><span>llvm_inline</span></span></a><span class="main"><span>]</span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry3|const"><span>uncurry3</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.find_next_unguarded|const"><span>find_next_unguarded</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>arr_assn</span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefttnd|const"><span>→<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_51353..51360"><span>find_next_unguarded_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_51660..51677"><span>mop_C_idx_unfolds</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.annot_snat_const|method"><span class="operator"><span>annot_snat_const</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_t|type"><span>size_t</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_next_ug_impl.refine|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_next_ug_impl_def|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_next_ug_impl.refine_raw|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_next_ug_impl.refine|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_next_ug_impl_def|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_next_ug_impl.refine_raw|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_next_ug_impl_def_raw|axiom"><span>by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref|method"><span class="operator"><span>sepref</span></span></a><span>

    </span><span class="keyword1"><span class="command"><span>sepref_def</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_prev_g_impl.cong|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_prev_g_impl.cong|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_prev_g_impl|const"><span>right_find_prev_g_impl</span></span></span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Codegen_Preproc.html#LLVM_Codegen_Preproc.llvm_inline|attribute"><span class="operator"><span>llvm_inline</span></span></a><span class="main"><span>]</span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry2|const"><span>uncurry2</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.find_prev_guarded|const"><span>find_prev_guarded</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Not</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>oo</span></a></span><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>arr_assn</span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefttnd|const"><span>→<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_51353..51360"><span>find_prev_guarded_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_51660..51677"><span>mop_C_idx_unfolds</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.annot_snat_const|method"><span class="operator"><span>annot_snat_const</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_t|type"><span>size_t</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_prev_g_impl.refine|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_prev_g_impl_def|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_prev_g_impl.refine_raw|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_prev_g_impl.refine|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_prev_g_impl_def|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_prev_g_impl.refine_raw|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_find_prev_g_impl_def_raw|axiom"><span>by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref|method"><span class="operator"><span>sepref</span></span></a><span>
            
    </span><span class="keyword1"><span class="command"><span>sepref_def</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_first_find_prev_impl.cong|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_first_find_prev_impl.cong|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_first_find_prev_impl|const"><span>right_first_find_prev_impl</span></span></span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Codegen_Preproc.html#LLVM_Codegen_Preproc.llvm_inline|attribute"><span class="operator"><span>llvm_inline</span></span></a><span class="main"><span>]</span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry3|const"><span>uncurry3</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.first_find_prev|const"><span>first_find_prev</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Not</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>oo</span></a></span><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>arr_assn</span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefttnd|const"><span>→<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_51353..51360"><span>first_find_prev_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.annot_snat_const|method"><span class="operator"><span>annot_snat_const</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_t|type"><span>size_t</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_first_find_prev_impl.refine|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_first_find_prev_impl_def|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_first_find_prev_impl.refine_raw|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_first_find_prev_impl.refine|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_first_find_prev_impl_def|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_first_find_prev_impl.refine_raw|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.right_first_find_prev_impl_def_raw|axiom"><span>by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref|method"><span class="operator"><span>sepref</span></span></a><span>
      
    </span><span class="keyword1"><span class="command"><span>sepref_def</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_right_impl.cong|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_right_impl.cong|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_right_impl|const"><span>partition_right_impl</span></span></span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Codegen_Preproc.html#LLVM_Codegen_Preproc.llvm_inline|attribute"><span class="operator"><span>llvm_inline</span></span></a><span class="main"><span>]</span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry2|const"><span>uncurry2</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_37886..37901"><span>partition_right</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span> </span><span>arr_assn</span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfdrop|const"><span><span class="hidden">⇧</span><sup>d</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.bool1_assn|const"><span>bool1_assn</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.prod_assn|const"><span>×<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.prod_assn|const"><span>×<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span>arr_assn</span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="bound"><span>a</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="bound"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="bound"><span>a</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_51353..51360"><span>partition_right_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/ISABELLE_HOME/src/HOL/Library/rewrite.ML.html#Rewrite.rewrite|method"><span class="operator"><span>rewrite</span></span></a><span> </span><span class="quasi_keyword"><span>at</span></span><span> </span><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/IICF_List.html#IICF_List.mop_list_swap|const"><a class="entity_ref" href="../Isabelle_LLVM/IICF_List.html#IICF_List.mop_list_swap|const"><span>mop_list_swap</span></a></a><span> </span><span class="main"><span class="main"><span>_</span></span></span><span> </span><span class="main"><span class="main"><span>_</span></span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span class="main"><span class="main"><span>_</span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span></a></span><span class="main"><span class="main"><span>)</span></span></span><span>"</span></span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_37671..37689"><a class="entity_ref" href="Sorting_PDQ.html#offset_37671..37689"><span>mop_list_safe_swap</span></a></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.annot_snat_const|method"><span class="operator"><span>annot_snat_const</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_t|type"><span>size_t</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_right_impl.refine|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_right_impl_def|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_right_impl.refine_raw|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_right_impl.refine|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_right_impl_def|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_right_impl.refine_raw|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_right_impl_def_raw|axiom"><span class="entity_def" id="offset_55755..55757">by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref|method"><span class="operator"><span>sepref</span></span></a><span>

    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.shuffle2.mcomb|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.shuffle2.arity|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.shuffle2.itype|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.shuffle2.mcomb|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.shuffle2.arity|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.shuffle2.itype|thm"><span>sepref_register</span></span></span></span></span></span></span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle2|const"><span>shuffle2</span></a></span><span>  
      
    </span><span class="keyword1"><span class="command"><span>sepref_def</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.shuffle_impl|const"><span>shuffle_impl</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Codegen_Preproc.html#LLVM_Codegen_Preproc.llvm_inline|attribute"><span class="operator"><span>llvm_inline</span></span></a><span class="main"><span>]</span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry3|const"><span>uncurry3</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle2|const"><span>shuffle2</span></a><span>"</span></span></span><span>   
      </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span> </span><span>arr_assn</span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfdrop|const"><span><span class="hidden">⇧</span><sup>d</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.bool1_assn|const"><span>bool1_assn</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.prod_assn|const"><span>×<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span>arr_assn</span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="bound"><span>a</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="bound"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="bound"><span>a</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_51353..51360"><span>shuffle2_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_51353..51360"><span>shuffle_left_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_51353..51360"><span>shuffle_right_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.annot_snat_const|method"><span class="operator"><span>annot_snat_const</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_t|type"><span>size_t</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.shuffle_impl.refine|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.shuffle_impl_def|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.shuffle_impl.refine_raw|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.shuffle_impl.refine|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.shuffle_impl_def|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.shuffle_impl.refine_raw|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.shuffle_impl_def_raw|axiom"><span class="entity_def" id="offset_56140..56142">by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref|method"><span class="operator"><span>sepref</span></span></a><span>
            
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.sort_three.mcomb|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.sort_three.arity|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.sort_three.itype|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.sort_three.pat|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.sort_three.mcomb|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.sort_three.arity|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.sort_three.itype|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.sort_three.pat|thm"><span>sepref_register</span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="Sorting_PDQ.html#offset_19456..19466"><span>sort_three</span></a></span><span>  
      
    </span><span class="keyword1"><span class="command"><span>sepref_def</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.sort_three_impl.cong|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.sort_three_impl.cong|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.sort_three_impl|const"><span>sort_three_impl</span></span></span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Codegen_Preproc.html#LLVM_Codegen_Preproc.llvm_inline|attribute"><span class="operator"><span>llvm_inline</span></span></a><span class="main"><span>]</span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry3|const"><span>uncurry3</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_19456..19466"><span>sort_three</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>   
      </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span> </span><span>arr_assn</span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfdrop|const"><span><span class="hidden">⇧</span><sup>d</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>→</span></a></span><span> </span><span>arr_assn</span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="bound"><span>a</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="bound"><span>a</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_51353..51360"><span>sort_three_def</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_51353..51360"><span>sort_two_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.sort_three_impl.refine|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.sort_three_impl_def|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.sort_three_impl.refine_raw|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.sort_three_impl.refine|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.sort_three_impl_def|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.sort_three_impl.refine_raw|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.sort_three_impl_def_raw|axiom"><span>by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref|method"><span class="operator"><span>sepref</span></span></a><span>
      
    </span><span class="keyword1"><span class="command"><span>sepref_def</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.move_pivot_to_front_impl.cong|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.move_pivot_to_front_impl.cong|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.move_pivot_to_front_impl|const"><span>move_pivot_to_front_impl</span></span></span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Codegen_Preproc.html#LLVM_Codegen_Preproc.llvm_inline|attribute"><span class="operator"><span>llvm_inline</span></span></a><span class="main"><span>]</span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry2|const"><span>uncurry2</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_47823..47843"><span>move_pivot_to_front2</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span> </span><span>arr_assn</span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfdrop|const"><span><span class="hidden">⇧</span><sup>d</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>→</span></a></span><span> </span><span>arr_assn</span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="bound"><span>a</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="bound"><span>a</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_51353..51360"><span>move_pivot_to_front2_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.annot_snat_const|method"><span class="operator"><span>annot_snat_const</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_t|type"><span>size_t</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.move_pivot_to_front_impl.refine|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.move_pivot_to_front_impl_def|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.move_pivot_to_front_impl.refine_raw|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.move_pivot_to_front_impl.refine|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.move_pivot_to_front_impl_def|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.move_pivot_to_front_impl.refine_raw|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.move_pivot_to_front_impl_def_raw|axiom"><span class="entity_def" id="offset_56794..56796">by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref|method"><span class="operator"><span>sepref</span></span></a><span>
      

    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.fallback_sort_spec.mcomb|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.fallback_sort_spec.arity|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.fallback_sort_spec.itype|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.fallback_sort_spec.pat|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.shuffle_spec.mcomb|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.shuffle_spec.arity|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.shuffle_spec.itype|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_spec.mcomb|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_spec.arity|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_spec.itype|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_spec.pat|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_left_spec.mcomb|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_left_spec.arity|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_left_spec.itype|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_left_spec.pat|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pivot_to_front_spec.mcomb|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pivot_to_front_spec.arity|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pivot_to_front_spec.itype|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pivot_to_front_spec.pat|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.fallback_sort_spec.mcomb|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.fallback_sort_spec.arity|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.fallback_sort_spec.itype|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.fallback_sort_spec.pat|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.shuffle_spec.mcomb|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.shuffle_spec.arity|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.shuffle_spec.itype|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_spec.mcomb|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_spec.arity|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_spec.itype|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_spec.pat|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_left_spec.mcomb|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_left_spec.arity|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_left_spec.itype|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_left_spec.pat|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pivot_to_front_spec.mcomb|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pivot_to_front_spec.arity|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pivot_to_front_spec.itype|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pivot_to_front_spec.pat|thm"><span>sepref_register</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="Sorting_PDQ.html#offset_4847..4866"><span>pivot_to_front_spec</span></a></span><span> </span><span class="quoted"><a class="entity_ref" href="Sorting_PDQ.html#offset_5565..5584"><span>partition_left_spec</span></a></span><span> </span><span class="quoted"><a class="entity_ref" href="Sorting_PDQ.html#offset_5280..5294"><span>partition_spec</span></a></span><span> </span><span class="quoted"><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_spec|const"><span>shuffle_spec</span></a></span><span> </span><span class="quoted"><a class="entity_ref" href="Sorting_PDQ.html#offset_11624..11642"><span>fallback_sort_spec</span></a></span><span>
    
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.sort_impl_context.move_pivot_to_front2_refine&apos;|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.move_pivot_to_front2_refine&apos;|thm"><span class="entity_def" id="offset_56934..56962">move_pivot_to_front2_refine'</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_47823..47843"><span>move_pivot_to_front2</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_4847..4866"><span>pivot_to_front_spec</span></a><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span class="main"><span>⟨</span></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span> 
      </span><span class="keyword1"><span class="command"><span>note</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_48639..48666"><span>move_pivot_to_front2_refine</span></a><span> </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>note</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_21743..21769"><span>move_pivot_to_front_refine</span></a><span> 
      </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_relI|fact"><span>nres_relI</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_left_refine&apos;|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_left_refine&apos;|thm"><span class="entity_def" id="offset_57214..57236">partition_left_refine'</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_41109..41123"><span>partition_left</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_5565..5584"><span>partition_left_spec</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span class="main"><span>⟨</span></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_41916..41938"><span>partition_left_correct</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_relI|fact"><span>nres_relI</span></a><span class="main"><span>)</span></span><span>
    
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_right_refine&apos;|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.partition_right_refine&apos;|thm"><span class="entity_def" id="offset_57398..57421">partition_right_refine'</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_37886..37901"><span>partition_right</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_5280..5294"><span>partition_spec</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span class="main"><span>⟨</span></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_38820..38843"><span>partition_right_correct</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_relI|fact"><span>nres_relI</span></a><span class="main"><span>)</span></span><span>
      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.sort_impl_context.shuffle_refine&apos;|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.shuffle_refine&apos;|thm"><span class="entity_def" id="offset_57582..57597">shuffle_refine'</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle2|const"><span>shuffle2</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#Sorting_PDQ.weak_ordering.shuffle_spec|const"><span>shuffle_spec</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span class="main"><span>⟨</span></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
      </span><span class="keyword1"><span class="command"><span>note</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_46091..46106"><span>shuffle2_refine</span></a><span> </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>note</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_26609..26624"><span>shuffle_correct</span></a><span> 
      </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_relI|fact"><span>nres_relI</span></a><span class="main"><span>)</span></span><span> 
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.sort_impl_context.heapsort_refine_fbs&apos;|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.heapsort_refine_fbs&apos;|thm"><span class="entity_def" id="offset_57802..57822">heapsort_refine_fbs'</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span>heapsort</span><span class="main"><span>,</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_11624..11642"><span>fallback_sort_spec</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="main"><span>⟨</span></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_51353..51360"><span>fallback_sort_spec_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>heapsort_correct'</span><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.IdI|fact"><span>IdI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.IdI|fact"><span>IdI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.IdI|fact"><span>IdI</span></a><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_relI|fact"><span>nres_relI</span></a><span class="main"><span>)</span></span><span>
            
    </span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.sepref_fr_rules|attribute"><span class="operator"><span>sepref_fr_rules</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> 
      </span><a class="entity_ref" href="Sorting_PDQ.html#offset_56794..56796"><span>move_pivot_to_front_impl.refine</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.FCOMP|attribute"><span class="operator"><span>FCOMP</span></span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_56934..56962"><span>move_pivot_to_front2_refine'</span></a><span class="main"><span>]</span></span><span>
      </span><a class="entity_ref" href="Sorting_PDQ.html#offset_53751..53753"><span>partition_left_impl.refine</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.FCOMP|attribute"><span class="operator"><span>FCOMP</span></span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_57214..57236"><span>partition_left_refine'</span></a><span class="main"><span>]</span></span><span>
      </span><a class="entity_ref" href="Sorting_PDQ.html#offset_55755..55757"><span>partition_right_impl.refine</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.FCOMP|attribute"><span class="operator"><span>FCOMP</span></span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_57398..57421"><span>partition_right_refine'</span></a><span class="main"><span>]</span></span><span>
      </span><a class="entity_ref" href="Sorting_PDQ.html#offset_56140..56142"><span>shuffle_impl.refine</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.FCOMP|attribute"><span class="operator"><span>FCOMP</span></span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_57582..57597"><span>shuffle_refine'</span></a><span class="main"><span>]</span></span><span>
      </span><span>heapsort_hnr</span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.FCOMP|attribute"><span class="operator"><span>FCOMP</span></span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_57802..57822"><span>heapsort_refine_fbs'</span></a><span class="main"><span>]</span></span><span>
    
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort_aux.mcomb|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort_aux.arity|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort_aux.itype|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort_aux.pat|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort_aux.mcomb|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort_aux.arity|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort_aux.itype|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort_aux.pat|thm"><span>sepref_register</span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="Sorting_PDQ.html#offset_11780..11791"><span>pdqsort_aux</span></a></span><span>
    </span><span class="keyword1"><span class="command"><span>sepref_def</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort_aux_impl.cong|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort_aux_impl.cong|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort_aux_impl|const"><span>pdqsort_aux_impl</span></span></span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Codegen_Preproc.html#LLVM_Codegen_Preproc.llvm_inline|attribute"><span class="operator"><span>llvm_inline</span></span></a><span class="main"><span>]</span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry4|const"><span>uncurry4</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_49090..49102"><span>pdqsort_aux2</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.bool1_assn|const"><span>bool1_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span>arr_assn</span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfdrop|const"><span><span class="hidden">⇧</span><sup>d</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>→</span></a></span><span> </span><span>arr_assn</span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="bound"><span>a</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_51353..51360"><span>pdqsort_aux2_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>supply</span></span></span></span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>[</span></span><span class="operator"><span>goals_limit</span></span><span> </span><span class="main"><span class="main"><span>=</span></span></span><span> 1</span><span class="main"><span>]</span></span><span class="main"><span>]</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.annot_snat_const|method"><span class="operator"><span>annot_snat_const</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_t|type"><span>size_t</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/ISABELLE_HOME/src/HOL/Library/rewrite.ML.html#Rewrite.rewrite|method"><span class="operator"><span>rewrite</span></span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.RECT_cp_annot|fact"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.RECT_cp_annot|fact"><span>RECT_cp_annot</span></a></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> CP</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="bound"><span>ai</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="bound"><span>ai</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort_aux_impl.refine|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort_aux_impl_def|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort_aux_impl.refine_raw|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort_aux_impl.refine|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort_aux_impl_def|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort_aux_impl.refine_raw|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort_aux_impl_def_raw|axiom"><span class="entity_def" id="offset_58839..58841">by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref|method"><span class="operator"><span>sepref</span></span></a><span> 
                  
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort_aux2_refine&apos;|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort_aux2_refine&apos;|thm"><span class="entity_def" id="offset_58879..58899">pdqsort_aux2_refine'</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_49090..49102"><span>pdqsort_aux2</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_11780..11791"><span>pdqsort_aux</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="main"><span>⟨</span></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_50838..50857"><span>pdqsort_aux2_refine</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_relI|fact"><span>nres_relI</span></a><span class="main"><span>)</span></span><span>
      
    </span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.sepref_fr_rules|attribute"><span class="operator"><span>sepref_fr_rules</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_58839..58841"><span>pdqsort_aux_impl.refine</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.FCOMP|attribute"><span class="operator"><span>FCOMP</span></span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_58879..58899"><span>pdqsort_aux2_refine'</span></a><span class="main"><span>]</span></span><span>
      
      
      
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort.mcomb|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort.arity|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort.itype|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort.pat|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort.mcomb|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort.arity|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort.itype|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort.pat|thm"><span>sepref_register</span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="Sorting_PDQ.html#offset_18314..18321"><span>pdqsort</span></a></span><span>  
    </span><span class="keyword1"><span class="command"><span>sepref_def</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort_impl.cong|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort_impl.cong|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort_impl|const"><span>pdqsort_impl</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry2|const"><span>uncurry2</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_18314..18321"><span>pdqsort</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span> </span><span>arr_assn</span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfdrop|const"><span><span class="hidden">⇧</span><sup>d</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>→</span></a></span><span> </span><span>arr_assn</span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="bound"><span>a</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="bound"><span>a</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_PDQ.html#offset_51353..51360"><span>pdqsort_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.annot_snat_const|method"><span class="operator"><span>annot_snat_const</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_t|type"><span>size_t</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort_impl.refine|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort_impl_def|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort_impl.refine_raw|fact"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort_impl.refine|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort_impl_def|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort_impl.refine_raw|thm"><span class="entity_def" id="Sorting_PDQ.sort_impl_context.pdqsort_impl_def_raw|axiom"><span>by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref|method"><span class="operator"><span>sepref</span></span></a><span>
  
      
      
  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

  
  
  
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span></pre>
</body>

</html>