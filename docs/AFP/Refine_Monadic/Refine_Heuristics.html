<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Refine_Heuristics</title>
</head>


<body>
<div class="head">
<h1>Theory Refine_Heuristics</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Data Refinement Heuristics›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><a href="Refine_Heuristics.html"><span>Refine_Heuristics</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> </span><a href="Refine_Basic.html"><span>Refine_Basic</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
  This theory contains some heuristics to automatically prove
  data refinement goals that are left over by the refinement condition 
  generator.
›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
  The theorem collection </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>refine_hsimp›</span></span></span><span> contains additional simplifier
  rules that are useful to discharge typical data refinement goals.
›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹
  </span><span class="keyword1"><span class="keyword"><span>structure</span></span></span><span> </span><span class="entity"><span>refine_heuristics_simps</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Named_Thms</span></span><span>
    </span><span class="main"><span>(</span></span><span> </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>binding</span></span><span> </span><span class="entity_def" id="Refine_Heuristics.refine_hsimp|attribute"><span class="entity_def" id="Refine_Heuristics.refine_hsimp|fact"><span>refine_hsimp</span></span></span><span class="antiquote"><span>}</span></span></span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>description</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"Refinement Framework: "</span></span><span> </span><span>^</span><span>
        </span><span class="inner_quoted"><span>"Data refinement heuristics simp rules"</span></span><span> </span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
›</span></span><span>

</span><span class="keyword1"><span class="command"><span>setup</span></span></span><span> </span><span class="quoted"><span>‹</span><span class="entity"><span>refine_heuristics_simps.setup</span></span><span>›</span></span><span>

</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Type Based Heuristics›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
  This heuristics instantiates schematic data refinement relations based
  on their type. Both, the left hand side and right hand side type are
  considered.
›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹The heuristics works by proving goals of the form 
  </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>RELATES ?R›</span></span></span><span>, thereby instantiating </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>?R›</span></span></span><span>.›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Refine_Heuristics.RELATES_def|fact"><span class="entity_def" id="Refine_Heuristics.RELATES_def|thm"><span class="entity_def" id="Refine_Heuristics.RELATES_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Refine_Heuristics.RELATES|const"><span>RELATES</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="tfree"><span>'a</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod|type"><span>×</span></a></span><span class="tfree"><span>'b</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>RELATES</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>R</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_Heuristics.RELATESI|fact"><span class="entity_def" id="Refine_Heuristics.RELATESI|thm"><span>RELATESI</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.RELATES|const"><span>RELATES</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.RELATES_def|fact"><span>RELATES_def</span></a><span class="main"><span>)</span></span><span>


</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹
</span><span class="keyword1"><span class="keyword"><span>structure</span></span></span><span> </span><span class="entity"><span>Refine_dref_type</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>struct</span></span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>structure</span></span></span><span> </span><span class="entity"><span>pattern_rules</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Named_Thms</span></span><span>
    </span><span class="main"><span>(</span></span><span> </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>binding</span></span><span> </span><span class="entity_def" id="Refine_Heuristics.refine_dref_pattern|attribute"><span class="entity_def" id="Refine_Heuristics.refine_dref_pattern|fact"><span>refine_dref_pattern</span></span></span><span class="antiquote"><span>}</span></span></span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>description</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"Refinement Framework: "</span></span><span> </span><span>^</span><span>
        </span><span class="inner_quoted"><span>"Pattern rules to recognize refinement goal"</span></span><span> </span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>structure</span></span></span><span> </span><span class="entity"><span>RELATES_rules</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Named_Thms</span></span><span> </span><span class="main"><span>(</span></span><span> 
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>binding</span></span><span> </span><span class="entity_def" id="Refine_Heuristics.refine_dref_RELATES|attribute"><span class="entity_def" id="Refine_Heuristics.refine_dref_RELATES|fact"><span>refine_dref_RELATES</span></span></span><span class="antiquote"><span>}</span></span></span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>description</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"Refinement Framework: "</span></span><span> </span><span>^</span><span>
        </span><span class="inner_quoted"><span>"Type based heuristics introduction rules"</span></span><span> 
  </span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>


  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>tracing</span></span><span> </span><span class="main"><span>=</span></span><span> 
    </span><span class="entity"><span>Attrib.setup_config_bool</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>binding</span></span><span> </span><span class="entity_def" id="Refine_Heuristics.refine_dref_tracing|attribute"><span>refine_dref_tracing</span></span><span class="antiquote"><span>}</span></span></span></span><span> </span><span class="main"><span>(</span></span><span>K</span><span> </span><span>false</span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

  </span><span class="comment1"><span>(* Check whether term contains schematic variable *)</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> 
    </span><span class="entity"><span>has_schematic</span></span><span> </span><span class="main"><span>(</span></span><span>Var</span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>true</span><span> </span><span class="main"><span>|</span></span><span>
    </span><span class="entity"><span>has_schematic</span></span><span> </span><span class="main"><span>(</span></span><span>Abs</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>_</span></span><span class="main"><span>,</span></span><span class="main"><span>_</span></span><span class="main"><span>,</span></span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>has_schematic</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>|</span></span><span>
    </span><span class="entity"><span>has_schematic</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>t1</span></span><span>$</span><span class="entity"><span>t2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>has_schematic</span></span><span> </span><span class="entity"><span>t1</span></span><span> </span><span class="keyword1"><span class="keyword"><span>orelse</span></span></span><span> </span><span class="entity"><span>has_schematic</span></span><span> </span><span class="entity"><span>t2</span></span><span> </span><span class="main"><span>|</span></span><span>
    </span><span class="entity"><span>has_schematic</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>false</span><span class="main"><span>;</span></span><span>

  </span><span class="comment1"><span>(* Match proof states where the conclusion of some goal has the specified
     shape *)</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>match_goal_shape_tac</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>shape</span></span><span class="main"><span>:</span></span><span>term</span><span class="main"><span>-&gt;</span></span><span>bool</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>ctxt</span></span><span class="main"><span>:</span></span><span class="entity"><span>Proof.context</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span>Thm.nprems_of</span><span> </span><span class="entity"><span>thm</span></span><span> </span><span>&gt;=</span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
        </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>HOLogic.dest_Trueprop</span></span><span> </span><span class="main"><span>(</span></span><span>Logic.concl_of_goal</span><span> </span><span class="main"><span>(</span></span><span>Thm.prop_of</span><span> </span><span class="entity"><span>thm</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
        </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>shape</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span>all_tac</span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span>no_tac</span><span> </span><span class="entity"><span>thm</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span>
      </span><span>no_tac</span><span> </span><span class="entity"><span>thm</span></span><span class="main"><span>;</span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>output_failed_msg</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>failed_t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>failed_t_str</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Pretty.string_of</span><span> 
      </span><span class="main"><span>(</span></span><span>Syntax.pretty_term</span><span> </span><span class="main"><span>(</span></span><span>Config.put</span><span> </span><span>show_types</span><span> </span><span>true</span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>failed_t</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>msg</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"Failed to resolve refinement goal \n  "</span></span><span> </span><span>^</span><span> </span><span class="entity"><span>failed_t_str</span></span><span class="main"><span>;</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span>Config.get</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>tracing</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span>Output.tracing</span><span> </span><span class="entity"><span>msg</span></span><span> </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span class="main"><span>;</span></span><span>
    
  </span><span class="comment1"><span>(* Try to apply patternI-rules, ensure that produced first subgoal
     contains a schematic variable, and then solve it using 
     refine_dref_RELATES-rules. *)</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>type_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>ALL_GOALS_FWD</span></span><span> </span><span class="main"><span>(</span></span><span>TRY</span><span> </span><span>o</span><span> </span><span class="main"><span>(</span></span><span>
      </span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>pattern_rules.get</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span> </span><span>THEN'</span><span>
      </span><span class="entity"><span>match_goal_shape_tac</span></span><span> </span><span class="entity"><span>has_schematic</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span>THEN'</span><span>
      </span><span class="main"><span>(</span></span><span>SOLVED'</span><span> </span><span class="main"><span>(</span></span><span>REPEAT_ALL_NEW</span><span> </span><span class="main"><span>(</span></span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>RELATES_rules.get</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
        </span><span>ORELSE'</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>st</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span> 
          </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>failed_t</span></span><span> </span><span class="main"><span>=</span></span><span> 
            </span><span class="entity"><span>HOLogic.dest_Trueprop</span></span><span> </span><span class="main"><span>(</span></span><span>Logic.concl_of_goal</span><span> </span><span class="main"><span>(</span></span><span>Thm.prop_of</span><span> </span><span class="entity"><span>st</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
          </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>output_failed_msg</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>failed_t</span></span><span class="main"><span>;</span></span><span>
          </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span>no_tac</span><span> </span><span class="entity"><span>st</span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>


</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span class="main"><span>;</span></span><span>
›</span></span><span>

</span><span class="keyword1"><span class="command"><span>setup</span></span></span><span> </span><span class="quoted"><span>‹</span><span class="entity"><span>Refine_dref_type.RELATES_rules.setup</span></span><span>›</span></span><span>
</span><span class="keyword1"><span class="command"><span>setup</span></span></span><span> </span><span class="quoted"><span>‹</span><span class="entity"><span>Refine_dref_type.pattern_rules.setup</span></span><span>›</span></span><span>

</span><span class="keyword1"><span class="command"><span>method_setup</span></span></span><span> </span><span class="entity_def" id="Refine_Heuristics.refine_dref_type|method"><span>refine_dref_type</span></span><span> </span><span class="main"><span>=</span></span><span> 
  </span><span class="quoted"><span>‹</span><span>Scan.lift</span><span> </span><span class="main"><span>(</span></span><span>Args.mode</span><span> </span><span class="inner_quoted"><span>"trace"</span></span><span> </span><span>--</span><span> </span><span>Args.mode</span><span> </span><span class="inner_quoted"><span>"nopost"</span></span><span class="main"><span>)</span></span><span> 
  </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>tracing</span></span><span class="main"><span>,</span></span><span class="entity"><span>nopost</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> 
    </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span> 
        </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>tracing</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span>Config.put</span><span> </span><span class="entity"><span>Refine_dref_type.tracing</span></span><span> </span><span>true</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>;</span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
      </span><span class="entity"><span>SIMPLE_METHOD</span></span><span> </span><span class="main"><span>(</span></span><span>CHANGED</span><span> </span><span class="main"><span>(</span></span><span>
        </span><span class="entity"><span>Refine_dref_type.type_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> 
        </span><span>THEN</span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>nopost</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span>all_tac</span><span> </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span>ALLGOALS</span><span> </span><span class="main"><span>(</span></span><span>TRY</span><span> </span><span>o</span><span> </span><span class="entity"><span>Refine.post_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
›</span></span><span> 
  </span><span class="quoted"><span>"Use type-based heuristics to instantiate data refinement relations"</span></span><span>

</span><span class="comment1"><span>(*method_setup refine_dref_type_only = 
  {* Scan.succeed (fn ctxt =&gt; SIMPLE_METHOD (CHANGED (
    Refine_dref_type.type_tac ctxt))) *} 
  "Use type-based heuristics to instantiate data refinement relations. 
    No postprocessing."*)</span></span><span>

</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Patterns›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
  This section defines the patterns that are recognized as data refinement 
  goals.
›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_Heuristics.RELATESI_memb|fact"><span class="entity_def" id="Refine_Heuristics.RELATESI_memb|thm"><span>RELATESI_memb</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.refine_dref_pattern|attribute"><span class="operator"><span>refine_dref_pattern</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.RELATES|const"><span>RELATES</span></a><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>,</span></span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>,</span></span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_Heuristics.RELATESI_refspec|fact"><span class="entity_def" id="Refine_Heuristics.RELATESI_refspec|thm"><span>RELATESI_refspec</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.refine_dref_pattern|attribute"><span class="operator"><span>refine_dref_pattern</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.RELATES|const"><span>RELATES</span></a><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>S</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="free"><span>S'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>S</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="free"><span>S'</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Allows refine-rules to add </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>RELATES›</span></span></span><span> goals if they introduce hidden relations›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_Heuristics.RELATES_pattern|fact"><span class="entity_def" id="Refine_Heuristics.RELATES_pattern|thm"><span>RELATES_pattern</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.refine_dref_pattern|attribute"><span class="operator"><span>refine_dref_pattern</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.RELATES|const"><span>RELATES</span></a><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.RELATES|const"><span>RELATES</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.refine_hsimp|attribute"><span class="operator"><span>refine_hsimp</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.RELATES_def|fact"><span>RELATES_def</span></a><span> 
    
</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Refinement Relations›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
  In this section, we define some general purpose refinement relations, e.g.,
  for product types and sets.
›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_Heuristics.Id_RELATES|fact"><span class="entity_def" id="Refine_Heuristics.Id_RELATES|thm"><span>Id_RELATES</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.refine_dref_RELATES|attribute"><span class="operator"><span>refine_dref_RELATES</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.RELATES|const"><span>RELATES</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.RELATES_def|fact"><span>RELATES_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_Heuristics.prod_rel_RELATES|fact"><span class="entity_def" id="Refine_Heuristics.prod_rel_RELATES|thm"><span>prod_rel_RELATES</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.refine_dref_RELATES|attribute"><span class="operator"><span>refine_dref_RELATES</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.RELATES|const"><span>RELATES</span></a><span> </span><span class="free"><span>Ra</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.RELATES|const"><span>RELATES</span></a><span> </span><span class="free"><span>Rb</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.RELATES|const"><span>RELATES</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>⟨</span></span><span class="free"><span>Ra</span></span><span class="main"><span>,</span></span><span class="free"><span>Rb</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.prod_rel|const"><span>prod_rel</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.RELATES_def|fact"><span>RELATES_def</span></a><span> </span><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.prod_rel_def|fact"><span>prod_rel_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>declare</span></span></span><span> </span><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.prod_rel_sv|fact"><span>prod_rel_sv</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.refine_hsimp|attribute"><span class="operator"><span>refine_hsimp</span></span></a><span class="main"><span>]</span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_Heuristics.prod_rel_iff|fact"><span class="entity_def" id="Refine_Heuristics.prod_rel_iff|thm"><span>prod_rel_iff</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.refine_hsimp|attribute"><span class="operator"><span>refine_hsimp</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>,</span></span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="main"><span>(</span></span><span class="free"><span>a'</span></span><span class="main"><span>,</span></span><span class="free"><span>b'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="main"><span>⟨</span></span><span class="free"><span>A</span></span><span class="main"><span>,</span></span><span class="free"><span>B</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.prod_rel|const"><span>prod_rel</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>,</span></span><span class="free"><span>a'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span class="main"><span>,</span></span><span class="free"><span>b'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>B</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.prod_rel_def|fact"><span>prod_rel_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.refine_hsimp|attribute"><span class="operator"><span>refine_hsimp</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.prod_rel_id_simp|fact"><span>prod_rel_id_simp</span></a><span> 

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_Heuristics.option_rel_RELATES|fact"><span class="entity_def" id="Refine_Heuristics.option_rel_RELATES|thm"><span>option_rel_RELATES</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.refine_dref_RELATES|attribute"><span class="operator"><span>refine_dref_RELATES</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.RELATES|const"><span>RELATES</span></a><span> </span><span class="free"><span>Ra</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.RELATES|const"><span>RELATES</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>⟨</span></span><span class="free"><span>Ra</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.option_rel|const"><span>option_rel</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.RELATES_def|fact"><span>RELATES_def</span></a><span> </span><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.option_rel_def|fact"><span>option_rel_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>declare</span></span></span><span> </span><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.option_rel_sv|fact"><span>option_rel_sv</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.refine_hsimp|attribute"><span class="operator"><span>refine_hsimp</span></span></a><span class="main"><span>]</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.refine_hsimp|attribute"><span class="operator"><span>refine_hsimp</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.option_rel_id_simp|fact"><span>option_rel_id_simp</span></a><span>

</span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.refine_hsimp|attribute"><span class="operator"><span>refine_hsimp</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.set_rel_sv|fact"><span>set_rel_sv</span></a><span> </span><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.set_rel_csv|fact"><span>set_rel_csv</span></a><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_Heuristics.set_rel_RELATES|fact"><span class="entity_def" id="Refine_Heuristics.set_rel_RELATES|thm"><span>set_rel_RELATES</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.refine_dref_RELATES|attribute"><span class="operator"><span>refine_dref_RELATES</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.RELATES|const"><span>RELATES</span></a><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.RELATES|const"><span>RELATES</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>⟨</span></span><span class="free"><span>R</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.set_rel|const"><span>set_rel</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.RELATES_def|fact"><span>RELATES_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_Heuristics.set_rel_empty_eq|fact"><span class="entity_def" id="Refine_Heuristics.set_rel_empty_eq|thm"><span>set_rel_empty_eq</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>S</span></span><span class="main"><span>,</span></span><span class="free"><span>S'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="main"><span>⟨</span></span><span class="free"><span>X</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.set_rel|const"><span>set_rel</span></a><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="free"><span>S'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.set_rel_def|fact"><span>set_rel_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_Heuristics.set_rel_sngD|fact"><span class="entity_def" id="Refine_Heuristics.set_rel_sngD|thm"><span>set_rel_sngD</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="free"><span>a</span></span><span class="main"><span>}</span></span><span class="main"><span>,</span></span><span class="main"><span>{</span></span><span class="free"><span>b</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="main"><span>⟨</span></span><span class="free"><span>R</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.set_rel|const"><span>set_rel</span></a><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>,</span></span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.set_rel_def|fact"><span>set_rel_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="comment1"><span>(*lemmas [refine_hsimp] = set_rel_empty set_rel_union set_rel_insert
  set_rel_diff*)</span></span><span>

</span><span class="comment1"><span>(*lemmas [refine_hsimp] = prod_set_eq_is_Id*)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_Heuristics.Image_insert|fact"><span class="entity_def" id="Refine_Heuristics.Image_insert|thm"><span>Image_insert</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.refine_hsimp|attribute"><span class="operator"><span>refine_hsimp</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>,</span></span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.single_valued|const"><span>single_valued</span></a><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>R</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Image|const"><span>``</span></a></span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.insert|const"><span>insert</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.insert|const"><span>insert</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>R</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Image|const"><span>``</span></a></span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.single_valuedD|fact"><span>single_valuedD</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.refine_hsimp|attribute"><span class="operator"><span>refine_hsimp</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Image_Un|fact"><span>Image_Un</span></a><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_Heuristics.Image_Diff|fact"><span class="entity_def" id="Refine_Heuristics.Image_Diff|thm"><span>Image_Diff</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.refine_hsimp|attribute"><span class="operator"><span>refine_hsimp</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.single_valued|const"><span>single_valued</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.converse|const"><span>converse</span></a><span> </span><span class="free"><span>R</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>R</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Image|const"><span>``</span></a></span><span class="main"><span>(</span></span><span class="free"><span>A</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="free"><span>B</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>R</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Image|const"><span>``</span></a></span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>R</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Image|const"><span>``</span></a></span><span class="free"><span>B</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.single_valuedD|fact"><span>single_valuedD</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_Heuristics.Image_Inter|fact"><span class="entity_def" id="Refine_Heuristics.Image_Inter|thm"><span>Image_Inter</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.refine_hsimp|attribute"><span class="operator"><span>refine_hsimp</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.single_valued|const"><span>single_valued</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.converse|const"><span>converse</span></a><span> </span><span class="free"><span>R</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>R</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Image|const"><span>``</span></a></span><span class="main"><span>(</span></span><span class="free"><span>A</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>∩</span></a></span><span class="free"><span>B</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>R</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Image|const"><span>``</span></a></span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>∩</span></a></span><span> </span><span class="free"><span>R</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Image|const"><span>``</span></a></span><span class="free"><span>B</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.single_valuedD|fact"><span>single_valuedD</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_Heuristics.list_rel_RELATES|fact"><span class="entity_def" id="Refine_Heuristics.list_rel_RELATES|thm"><span>list_rel_RELATES</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.refine_dref_RELATES|attribute"><span class="operator"><span>refine_dref_RELATES</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.RELATES|const"><span>RELATES</span></a><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.RELATES|const"><span>RELATES</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>⟨</span></span><span class="free"><span>R</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.list_rel|const"><span>list_rel</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.RELATES_def|fact"><span>RELATES_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.refine_hsimp|attribute"><span class="operator"><span>refine_hsimp</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.list_rel_sv_iff|fact"><span>list_rel_sv_iff</span></a><span> </span><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.list_rel_simp|fact"><span>list_rel_simp</span></a><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_Heuristics.RELATES_nres_rel|fact"><span class="entity_def" id="Refine_Heuristics.RELATES_nres_rel|thm"><span>RELATES_nres_rel</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.refine_dref_RELATES|attribute"><span class="operator"><span>refine_dref_RELATES</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.RELATES|const"><span>RELATES</span></a><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.RELATES|const"><span>RELATES</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>⟨</span></span><span class="free"><span>R</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Heuristics.html#Refine_Heuristics.RELATES_def|fact"><span>RELATES_def</span></a><span class="main"><span>)</span></span><span>
  
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span></pre>
</body>

</html>