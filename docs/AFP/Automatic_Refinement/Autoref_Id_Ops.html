<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Autoref_Id_Ops</title>
</head>


<body>
<div class="head">
<h1>Theory Autoref_Id_Ops</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Operation Identification›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><a href="Autoref_Id_Ops.html"><span>Autoref_Id_Ops</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> 
  </span><span class="quoted"><span>"</span><a href="Refine_Lib.html"><span>../Lib/Refine_Lib</span></a><span>"</span></span><span> 
  </span><a href="Autoref_Phases.html"><span>Autoref_Phases</span></a><span>
  </span><a href="Autoref_Data.html"><span>Autoref_Data</span></a><span>
  </span><a href="Autoref_Tagging.html"><span>Autoref_Tagging</span></a><span>
  </span><span class="quoted"><span>"</span><a href="Parametricity.html"><span>../Parametricity/Parametricity</span></a><span>"</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Main Tool›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Autoref_Id_Ops.arity_type_interface|fact"><span class="entity_def" id="Autoref_Id_Ops.arity_type_interface|thm"><span class="entity_def" id="Autoref_Id_Ops.arity_type_interface|axiom"><span>typedecl</span></span></span></span></span></span><span> </span><span class="entity_def" id="Autoref_Id_Ops.interface|type"><span>interface</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Autoref_Id_Ops.intfAPP_def|fact"><span class="entity_def" id="Autoref_Id_Ops.intfAPP_def|thm"><span class="entity_def" id="Autoref_Id_Ops.intfAPP_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Autoref_Id_Ops.intfAPP|const"><span>intfAPP</span></span></span><span> 
  </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.interface|type"><span>interface</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.interface|type"><span>interface</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>_</span></span><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>intfAPP</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>syntax</span></span></span><span> </span><span class="quoted"><span>"_intf_APP"</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>args</span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'b</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword1"><span>⟨</span></span><span>_</span><span class="keyword1"><span>⟩<span class="hidden">⇩</span><sub>i</sub></span></span><span>_"</span></span><span> </span><span class="main"><span>[</span></span><span>0</span><span class="main"><span>,</span></span><span>900</span><span class="main"><span>]</span></span><span> 900</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>translations</span></span></span><span>
  </span><span class="quoted"><span>"</span><span class="main"><span>⟨</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span class="free"><span>xs</span></span><span class="keyword1"><span>⟩<span class="hidden">⇩</span><sub>i</sub></span></span><span class="free"><span>R</span></span><span>"</span></span><span> </span><span class="main"><span>==</span></span><span> </span><span class="quoted"><span>"</span><span class="main"><span>⟨</span></span><span class="free"><span>xs</span></span><span class="keyword1"><span>⟩<span class="hidden">⇩</span><sub>i</sub></span></span><span class="main"><span>(</span></span><span class="keyword1"><span>CONST</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.intfAPP|const"><span>intfAPP</span></a><span> </span><span class="free"><span>R</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span><span>
  </span><span class="quoted"><span>"</span><span class="main"><span>⟨</span></span><span class="free"><span>x</span></span><span class="keyword1"><span>⟩<span class="hidden">⇩</span><sub>i</sub></span></span><span class="free"><span>R</span></span><span>"</span></span><span> </span><span class="main"><span>==</span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>CONST</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.intfAPP|const"><span>intfAPP</span></a><span> </span><span class="free"><span>R</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span><span>

</span><span class="keyword1"><span class="command"><span>consts</span></span></span><span>
  </span><span class="entity_def" id="Autoref_Id_Ops.i_fun|const"><span>i_fun</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.interface|type"><span>interface</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.interface|type"><span>interface</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.interface|type"><span>interface</span></a><span>"</span></span></span><span> 

</span><span class="keyword1"><span class="command"><span>abbreviation</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Autoref_Id_Ops.i_fun_app|const"><span>i_fun_app</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>infixr</span></span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>→<span class="hidden">⇩</span><sub>i</sub></span></span><span>"</span></span><span> 60</span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="bound"><span class="entity"><span>i1</span></span></span></span><span class="keyword1"><span class="free"><span>→<span class="hidden">⇩</span><sub>i</sub></span></span></span><span class="free"><span class="bound"><span class="entity"><span>i2</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="main"><span>⟨</span></span><span class="free"><span class="bound"><span class="entity"><span>i1</span></span></span></span><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>i2</span></span></span></span><span class="keyword1"><span>⟩<span class="hidden">⇩</span><sub>i</sub></span></span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.i_fun|const"><span>i_fun</span></a><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>consts</span></span></span><span> 
  </span><span class="entity_def" id="Autoref_Id_Ops.i_annot|const"><span>i_annot</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.interface|type"><span>interface</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.annot|type"><span>annot</span></a><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>abbreviation</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Autoref_Id_Ops.i_ANNOT|const"><span>i_ANNOT</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.interface|type"><span>interface</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>infixr</span></span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>:::<span class="hidden">⇩</span><sub>i</sub></span></span><span>"</span></span><span> 10</span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="bound"><span class="entity"><span>t</span></span></span></span><span class="keyword1"><span class="free"><span>:::<span class="hidden">⇩</span><sub>i</sub></span></span></span><span class="free"><span class="bound"><span class="entity"><span>I</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.ANNOT|const"><span>ANNOT</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>t</span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.i_annot|const"><span>i_annot</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>I</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Declaration of interface-type for constant›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Autoref_Id_Ops.CONST_INTF_def|fact"><span class="entity_def" id="Autoref_Id_Ops.CONST_INTF_def|thm"><span class="entity_def" id="Autoref_Id_Ops.CONST_INTF_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Autoref_Id_Ops.CONST_INTF|const"><span>CONST_INTF</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.interface|type"><span>interface</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>infixr</span></span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>::<span class="hidden">⇩</span><sub>i</sub></span></span><span>"</span></span><span> 10</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="bound"><span class="entity"><span>c</span></span></span></span><span class="keyword1"><span class="free"><span>::<span class="hidden">⇩</span><sub>i</sub></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>I</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span>"</span></span></span><span>


</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
  Predicate for operation identification. </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>ID_OP t t' I›</span></span></span><span> means
  that term </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>t›</span></span></span><span> has been annotated as </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>t'›</span></span></span><span>, and its interface
  is </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>I›</span></span></span><span>.
›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Autoref_Id_Ops.ID_OP_def|fact"><span class="entity_def" id="Autoref_Id_Ops.ID_OP_def|thm"><span class="entity_def" id="Autoref_Id_Ops.ID_OP_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Autoref_Id_Ops.ID_OP|const"><span>ID_OP</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.interface|type"><span>interface</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>ID_OP</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>t</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>t'</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>I</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>t</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span class="bound"><span class="entity"><span>t'</span></span></span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
  Interface inference rules. 
  Caution: Some of these must be applied with custom unification!
›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Autoref_Id_Ops.ID_abs|fact"><span class="entity_def" id="Autoref_Id_Ops.ID_abs|thm"><span>ID_abs</span></span></span><span class="main"><span>:</span></span><span> </span><span class="comment1"><span>― ‹Tag abs first›</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_OP|const"><span>ID_OP</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>I1</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_OP|const"><span>ID_OP</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f'</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>I2</span></span><span> </span><span class="main"><span>⟧</span></span><span> 
  </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_OP|const"><span>ID_OP</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.ABS|const"><span>λ'</span></a></span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.ABS|const"><span>.</span></a></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.ABS|const"><span>λ'</span></a></span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.ABS|const"><span>.</span></a></span><span> </span><span class="free"><span>f'</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>I1</span></span><span class="keyword1"><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.i_fun_app|const"><span>→<span class="hidden">⇩</span><sub>i</sub></span></a></span><span class="free"><span>I2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Autoref_Id_Ops.ID_app|fact"><span class="entity_def" id="Autoref_Id_Ops.ID_app|thm"><span>ID_app</span></span></span><span class="main"><span>:</span></span><span> </span><span class="comment1"><span>― ‹Tag app first›</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><a class="entity_ref" href="Indep_Vars.html#Indep_Vars.INDEP|const"><span>INDEP</span></a><span> </span><span class="free"><span>I1</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_OP|const"><span>ID_OP</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>x'</span></span><span> </span><span class="free"><span>I1</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_OP|const"><span>ID_OP</span></a><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>f'</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>I1</span></span><span class="keyword1"><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.i_fun_app|const"><span>→<span class="hidden">⇩</span><sub>i</sub></span></a></span><span class="free"><span>I2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟧</span></span><span> 
  </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_OP|const"><span>ID_OP</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span class="main"><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f'</span></span><span class="main"><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="free"><span>x'</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>I2</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Autoref_Id_Ops.ID_const|fact"><span class="entity_def" id="Autoref_Id_Ops.ID_const|thm"><span>ID_const</span></span></span><span class="main"><span>:</span></span><span> </span><span class="comment1"><span>― ‹Only if c is constant or free variable›</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.CONST_INTF|const"><span>::<span class="hidden">⇩</span><sub>i</sub></span></a></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_OP|const"><span>ID_OP</span></a><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.OP|const"><span>OP</span></a><span> </span><span class="free"><span>c</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.i_ANNOT|const"><span>:::<span class="hidden">⇩</span><sub>i</sub></span></a></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Autoref_Id_Ops.ID_TAG_def|fact"><span class="entity_def" id="Autoref_Id_Ops.ID_TAG_def|thm"><span class="entity_def" id="Autoref_Id_Ops.ID_TAG_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Autoref_Id_Ops.ID_TAG|const"><span>ID_TAG</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Autoref_Id_Ops.ID_const_any|fact"><span class="entity_def" id="Autoref_Id_Ops.ID_const_any|thm"><span>ID_const_any</span></span></span><span class="main"><span>:</span></span><span> </span><span class="comment1"><span>― ‹Only if no typing for constant exists›</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_OP|const"><span>ID_OP</span></a><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.OP|const"><span>OP</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_TAG|const"><span>ID_TAG</span></a><span> </span><span class="free"><span>c</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.i_ANNOT|const"><span>:::<span class="hidden">⇩</span><sub>i</sub></span></a></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span> 
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Autoref_Id_Ops.ID_const_check_known|fact"><span class="entity_def" id="Autoref_Id_Ops.ID_const_check_known|thm"><span>ID_const_check_known</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.CONST_INTF|const"><span>::<span class="hidden">⇩</span><sub>i</sub></span></a></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_OP|const"><span>ID_OP</span></a><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Autoref_Id_Ops.ID_tagged_OP|fact"><span class="entity_def" id="Autoref_Id_Ops.ID_tagged_OP|thm"><span>ID_tagged_OP</span></span></span><span class="main"><span>:</span></span><span> </span><span class="comment1"><span>― ‹Try first›</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_OP|const"><span>ID_OP</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.OP|const"><span>OP</span></a><span> </span><span class="free"><span>f</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.i_ANNOT|const"><span>:::<span class="hidden">⇩</span><sub>i</sub></span></a></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.OP|const"><span>OP</span></a><span> </span><span class="free"><span>f</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.i_ANNOT|const"><span>:::<span class="hidden">⇩</span><sub>i</sub></span></a></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Autoref_Id_Ops.ID_is_tagged_OP|fact"><span class="entity_def" id="Autoref_Id_Ops.ID_is_tagged_OP|thm"><span>ID_is_tagged_OP</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_OP|const"><span>ID_OP</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.OP|const"><span>OP</span></a><span> </span><span class="free"><span>c</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>t'</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_OP|const"><span>ID_OP</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.OP|const"><span>OP</span></a><span> </span><span class="free"><span>c</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>t'</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Autoref_Id_Ops.ID_tagged_OP_no_annot|fact"><span class="entity_def" id="Autoref_Id_Ops.ID_tagged_OP_no_annot|thm"><span>ID_tagged_OP_no_annot</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>c</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.CONST_INTF|const"><span>::<span class="hidden">⇩</span><sub>i</sub></span></a></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_OP|const"><span>ID_OP</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.OP|const"><span>OP</span></a><span> </span><span class="free"><span>c</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.OP|const"><span>OP</span></a><span> </span><span class="free"><span>c</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.i_ANNOT|const"><span>:::<span class="hidden">⇩</span><sub>i</sub></span></a></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="entity_def" id="Autoref_Id_Ops.ID_tagged|fact"><span class="entity_def" id="Autoref_Id_Ops.ID_tagged(3)|thm"><span class="entity_def" id="Autoref_Id_Ops.ID_tagged(2)|thm"><span class="entity_def" id="Autoref_Id_Ops.ID_tagged(1)|thm"><span>ID_tagged</span></span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_tagged_OP|fact"><span>ID_tagged_OP</span></a><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_abs|fact"><span>ID_abs</span></a><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_app|fact"><span>ID_app</span></a><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Autoref_Id_Ops.ID_annotated|fact"><span class="entity_def" id="Autoref_Id_Ops.ID_annotated(2)|thm"><span class="entity_def" id="Autoref_Id_Ops.ID_annotated(1)|thm"><span>ID_annotated</span></span></span></span><span class="main"><span>:</span></span><span> </span><span class="comment1"><span>― ‹Try second›</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_OP|const"><span>ID_OP</span></a><span> </span><span class="free"><span>t</span></span><span> </span><span class="free"><span>t'</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_OP|const"><span>ID_OP</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>t</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.i_ANNOT|const"><span>:::<span class="hidden">⇩</span><sub>i</sub></span></a></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>t'</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_OP|const"><span>ID_OP</span></a><span> </span><span class="free"><span>t</span></span><span> </span><span class="free"><span>t'</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_OP|const"><span>ID_OP</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.ANNOT|const"><span>ANNOT</span></a><span> </span><span class="free"><span>t</span></span><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.ANNOT|const"><span>ANNOT</span></a><span> </span><span class="free"><span>t'</span></span><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span>


</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_2259..2264">lemma</span></span></span><span> </span><span class="entity_def" id="Autoref_Id_Ops.ID_init|fact"><span class="entity_def" id="Autoref_Id_Ops.ID_init|thm"><span>ID_init</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_OP|const"><span>ID_OP</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>a'</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span class="main"><span>,</span></span><span class="free"><span>a'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span class="main"><span>,</span></span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#offset_2259..2264"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Autoref_Id_Ops.itypeI|fact"><span class="entity_def" id="Autoref_Id_Ops.itypeI|thm"><span>itypeI</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span class="main"><span>::</span></span><span class="tfree"><span>'t</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.CONST_INTF|const"><span>::<span class="hidden">⇩</span><sub>i</sub></span></a></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span>consts</span></span></span><span> </span><span class="entity_def" id="Autoref_Id_Ops.depth_limit_dummy|const"><span>depth_limit_dummy</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="tfree"><span class="quoted"><span class="tfree"><span>'a</span></span></span></span><span>
</span><span class="keyword1"><span class="command"><span>notation</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>output</span></span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.depth_limit_dummy|const"><span>depth_limit_dummy</span></a><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword1"><span>…</span></span><span>"</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹
  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>limit_depth</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>t</span></span><span> </span><span class="keyword1"><span class="keyword"><span>as</span></span></span><span> </span><span>Const</span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>t</span></span><span>
    </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>limit_depth</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>t</span></span><span> </span><span class="keyword1"><span class="keyword"><span>as</span></span></span><span> </span><span>Var</span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>t</span></span><span>
    </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>limit_depth</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>t</span></span><span> </span><span class="keyword1"><span class="keyword"><span>as</span></span></span><span> </span><span>Free</span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>t</span></span><span>
    </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>limit_depth</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>t</span></span><span> </span><span class="keyword1"><span class="keyword"><span>as</span></span></span><span> </span><span>Bound</span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>t</span></span><span>
    </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>limit_depth</span></span><span> </span><span class="inner_numeral"><span>0</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Const</span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>const_name</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.depth_limit_dummy|const"><span>depth_limit_dummy</span></a><span class="antiquote"><span>}</span></span></span><span class="main"><span>,</span></span><span>fastype_of</span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>limit_depth</span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>t</span></span><span> </span><span class="keyword1"><span class="keyword"><span>as</span></span></span><span> </span><span class="main"><span>_</span></span><span>$</span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
        </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>f</span></span><span class="main"><span>,</span></span><span class="entity"><span>args</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>strip_comb</span><span> </span><span class="entity"><span>t</span></span><span>
        </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>limit_depth</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>i</span></span><span> </span><span>-</span><span> </span><span class="inner_numeral"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>f</span></span><span>
        </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>map</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>limit_depth</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>i</span></span><span> </span><span>-</span><span> </span><span class="inner_numeral"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>args</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> 
        </span><span>list_comb</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>f</span></span><span class="main"><span>,</span></span><span class="entity"><span>args</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
    </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>limit_depth</span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="main"><span>(</span></span><span>Abs</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span class="entity"><span>T</span></span><span class="main"><span>,</span></span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Abs</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span class="entity"><span>T</span></span><span class="main"><span>,</span></span><span class="entity"><span>limit_depth</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>i</span></span><span> </span><span>-</span><span> </span><span class="inner_numeral"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>depth_of</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>t</span></span><span> </span><span class="keyword1"><span class="keyword"><span>as</span></span></span><span> </span><span class="main"><span>_</span></span><span>$</span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
        </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>f</span></span><span class="main"><span>,</span></span><span class="entity"><span>args</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>strip_comb</span><span> </span><span class="entity"><span>t</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> 
        </span><span>Integer.max</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>depth_of</span></span><span> </span><span class="entity"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>fold</span><span> </span><span class="main"><span>(</span></span><span>Integer.max</span><span> </span><span>o</span><span> </span><span class="entity"><span>depth_of</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="inner_numeral"><span>0</span></span><span class="main"><span>)</span></span><span> </span><span>+</span><span> </span><span class="inner_numeral"><span>1</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
    </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>depth_of</span></span><span> </span><span class="main"><span>(</span></span><span>Abs</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>_</span></span><span class="main"><span>,</span></span><span class="main"><span>_</span></span><span class="main"><span>,</span></span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>depth_of</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span>+</span><span> </span><span class="inner_numeral"><span>1</span></span><span>
    </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>depth_of</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_numeral"><span>0</span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>depth_of_lhs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>depth_of</span></span><span> </span><span>o</span><span> </span><span>Thm.term_of</span><span> </span><span>o</span><span> </span><span>Thm.lhs_of</span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>depth_of_rhs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>depth_of</span></span><span> </span><span>o</span><span> </span><span>Thm.term_of</span><span> </span><span>o</span><span> </span><span>Thm.rhs_of</span><span>

  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>pretty_rewrite</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="entity"><span>rthm</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>lhsd</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>depth_of_lhs</span></span><span> </span><span class="entity"><span>thm</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Thm.lhs_of</span><span> </span><span class="entity"><span>rthm</span></span><span> </span><span>|&gt;</span><span> </span><span>Thm.term_of</span><span> </span><span>|&gt;</span><span> </span><span class="entity"><span>limit_depth</span></span><span> </span><span class="entity"><span>lhsd</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>rhsd</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>depth_of_rhs</span></span><span> </span><span class="entity"><span>thm</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>t'</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Thm.rhs_of</span><span> </span><span class="entity"><span>rthm</span></span><span> </span><span>|&gt;</span><span> </span><span>Thm.term_of</span><span> </span><span>|&gt;</span><span> </span><span class="entity"><span>limit_depth</span></span><span> </span><span class="entity"><span>rhsd</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
    </span><span>Pretty.block</span><span> </span><span class="main"><span>[</span></span><span>
      </span><span>Syntax.pretty_term</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span> 
      </span><span>Pretty.brk</span><span> </span><span class="inner_numeral"><span>1</span></span><span class="main"><span>,</span></span><span> </span><span>Pretty.str</span><span> </span><span class="inner_quoted"><span>"-&gt;"</span></span><span class="main"><span>,</span></span><span> </span><span>Pretty.brk</span><span> </span><span class="inner_numeral"><span>1</span></span><span class="main"><span>,</span></span><span>
      </span><span>Syntax.pretty_term</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t'</span></span><span>
    </span><span class="main"><span>]</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>


›</span></span><span>

</span><span class="keyword1"><span class="command"><span>ML_val</span></span></span><span> </span><span class="quoted"><span>‹
  </span><span class="entity"><span>depth_of</span></span><span> </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>[</span></span><span class="numeral"><span>2</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.list.Nil|const"><span>[]</span></a></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span class="main"><span>;</span></span><span>

  </span><span class="entity"><span>limit_depth</span></span><span> </span><span class="inner_numeral"><span>2</span></span><span> </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><span class="main"><span>[</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>,</span></span><span class="numeral"><span>2</span></span><span class="main"><span>,</span></span><span class="numeral"><span>3</span></span><span class="main"><span>,</span></span><span class="numeral"><span>4</span></span><span class="main"><span>,</span></span><span class="numeral"><span>5</span></span><span class="main"><span>,</span></span><span class="numeral"><span>6</span></span><span class="main"><span>,</span></span><span class="numeral"><span>7</span></span><span class="main"><span>]</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span>
  </span><span>|&gt;</span><span> </span><span>Thm.cterm_of</span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>context</span></span><span class="antiquote"><span>}</span></span></span></span><span>

›</span></span><span>


</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹
  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>index_rewr_thms</span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>lhs</span></span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span>Thm.concl_of</span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
      </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>mpat</span></span><span> </span><span class="quoted"><span>"</span><span class="var"><span>?lhs</span></span><span> </span><span class="main"><span>==</span></span><span> </span><span class="main"><span>_</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>lhs</span></span><span class="main"><span>]</span></span><span>
    </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>net</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Item_Net.init</span><span> </span><span>Thm.eq_thm_prop</span><span> </span><span class="entity"><span>lhs</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>net</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>fold_rev</span><span> </span><span>Item_Net.update</span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="entity"><span>net</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
    </span><span class="entity"><span>net</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>net_rewr_tac</span></span><span> </span><span class="entity"><span>net</span></span><span> </span><span class="entity"><span>get_pat</span></span><span> </span><span class="entity"><span>frame_conv</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>IF_EXGOAL</span></span><span> </span><span class="main"><span>(</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>st</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>g</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Logic.concl_of_goal</span><span> </span><span class="main"><span>(</span></span><span>Thm.prop_of</span><span> </span><span class="entity"><span>st</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span>|&gt;</span><span> </span><span class="entity"><span>get_pat</span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Item_Net.retrieve</span><span> </span><span class="entity"><span>net</span></span><span> </span><span class="entity"><span>g</span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>cnv</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>map</span><span> 
        </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>CONVERSION</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>frame_conv</span></span><span> </span><span class="main"><span>(</span></span><span>Conv.rewr_conv</span><span> </span><span class="entity"><span>thm</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>thms</span></span><span>
      </span><span>|&gt;</span><span> </span><span class="entity"><span>APPEND_LIST'</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
      </span><span class="entity"><span>cnv</span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="entity"><span>st</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
  </span><span class="main"><span>)</span></span><span>

›</span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹
  </span><span class="keyword1"><span class="keyword"><span>signature</span></span></span><span> </span><span class="entity"><span>AUTOREF_ID_OPS</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>sig</span></span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> id_tac</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>Proof.context</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span class="entity"><span>tactic'</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> id_phase</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>Autoref_Phases.phase</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> mk_const_intf</span><span class="main"><span>:</span></span><span> </span><span>term</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>term</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>term</span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> mk_const_intf_thm</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>Proof.context</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>term</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>term</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>thm</span><span>

    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> dest_const_intf</span><span class="main"><span>:</span></span><span> </span><span>term</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>term</span><span> * </span><span>term</span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> dest_const_intf_thm</span><span class="main"><span>:</span></span><span> </span><span>thm</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>term</span><span> * </span><span>term</span><span>

    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> cfg_trace_intf_unif</span><span class="main"><span>:</span></span><span> </span><span>bool</span><span> </span><span>Config.T</span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> cfg_trace_failed_id</span><span class="main"><span>:</span></span><span> </span><span>bool</span><span> </span><span>Config.T</span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> cfg_ss_id_op</span><span class="main"><span>:</span></span><span> </span><span>bool</span><span> </span><span>Config.T</span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> cfg_trace_patterns</span><span class="main"><span>:</span></span><span> </span><span>bool</span><span> </span><span>Config.T</span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> cfg_use_id_tags</span><span class="main"><span>:</span></span><span> </span><span>bool</span><span> </span><span>Config.T</span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> cfg_trace_id_tags</span><span class="main"><span>:</span></span><span> </span><span>bool</span><span> </span><span>Config.T</span><span>

    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> typ_thms_of_seq</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>Proof.context</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>term</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>thm</span><span> </span><span>Seq.seq</span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> has_typ_thms</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>Proof.context</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>term</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>bool</span><span>

    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> decl_derived_typing</span><span class="main"><span>:</span></span><span> </span><span>bool</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>term</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>term</span><span> 
      </span><span class="main"><span>-&gt;</span></span><span> </span><span>Context.generic</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>Context.generic</span><span>

    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> setup</span><span class="main"><span>:</span></span><span> </span><span>theory</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>theory</span><span>
  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
  

  </span><span class="keyword1"><span class="keyword"><span>structure</span></span></span><span> </span><span class="entity"><span>Autoref_Id_Ops</span></span><span> </span><span class="main"><span>:</span></span><span class="entity"><span>AUTOREF_ID_OPS</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>struct</span></span></span><span>
    </span><span class="keyword3"><span class="keyword"><span>open</span></span></span><span> </span><span>Refine_Util</span><span> </span><span>Autoref_Tagging</span><span>


    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>mk_const_intf</span></span><span> </span><span class="entity"><span>c</span></span><span> </span><span class="entity"><span>I</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>Tc</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>fastype_of</span><span> </span><span class="entity"><span>c</span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>T</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Tc</span></span><span> </span><span>--&gt;</span><span> </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>typ</span></span><span> </span><span class="quoted"><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.interface|type"><span>interface</span></a></span><span class="antiquote"><span>}</span></span></span><span> </span><span>--&gt;</span><span> </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>typ</span></span><span> </span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a></span><span class="antiquote"><span>}</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> 
      </span><span>Const</span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>const_name</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.CONST_INTF|const"><span>CONST_INTF</span></a><span class="antiquote"><span>}</span></span></span><span class="main"><span>,</span></span><span class="entity"><span>T</span></span><span class="main"><span>)</span></span><span>$</span><span class="entity"><span>c</span></span><span>$</span><span class="entity"><span>I</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>mk_const_intf_thm</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>I</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>fT</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>fastype_of</span><span> </span><span class="entity"><span>f</span></span><span> </span><span>|&gt;</span><span> </span><span>Thm.ctyp_of</span><span> </span><span class="entity"><span>ctxt</span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Thm.cterm_of</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>f</span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>I</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Thm.cterm_of</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>I</span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Thm.instantiate'</span><span> </span><span class="main"><span>[</span></span><span>SOME</span><span> </span><span class="entity"><span>fT</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>[</span></span><span>SOME</span><span> </span><span class="entity"><span>f</span></span><span class="main"><span>,</span></span><span> </span><span>SOME</span><span> </span><span class="entity"><span>I</span></span><span class="main"><span>]</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.itypeI|fact"><span>itypeI</span></a><span class="antiquote"><span>}</span></span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
      </span><span class="entity"><span>thm</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>dest_const_intf</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>mpat</span></span><span> </span><span class="quoted"><span>"</span><span class="var"><span>?c</span></span><span class="keyword1"><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.CONST_INTF|const"><span>::<span class="hidden">⇩</span><sub>i</sub></span></a></span><span class="var"><span>?I</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>c</span></span><span class="main"><span>,</span></span><span class="entity"><span>I</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>dest_const_intf</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword3"><span class="keyword"><span>raise</span></span></span><span> </span><span>TERM</span><span> </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"dest_const_intf"</span></span><span class="main"><span>,</span></span><span class="main"><span>[</span></span><span class="entity"><span>t</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>dest_const_intf_thm</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Thm.concl_of</span><span> 
      </span><span>#&gt;</span><span> </span><span class="entity"><span>HOLogic.dest_Trueprop</span></span><span> 
      </span><span>#&gt;</span><span> </span><span class="entity"><span>dest_const_intf</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>LHS_COND'</span></span><span> </span><span class="entity"><span>P</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>CONCL_COND'</span></span><span>
      </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>mpat</span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Trueprop|const"><span>Trueprop</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_OP|const"><span>ID_OP</span></a><span> </span><span class="var"><span>?lhs</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>P</span></span><span> </span><span class="entity"><span>lhs</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>false</span><span class="main"><span>)</span></span><span>
    
    </span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span> </span><span class="keyword3"><span class="keyword"><span>open</span></span></span><span> </span><span>Conv</span><span> </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>id_op_lhs_conv</span></span><span> </span><span class="entity"><span>cnv</span></span><span> </span><span class="entity"><span>ct</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span>Thm.term_of</span><span> </span><span class="entity"><span>ct</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
        </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>mpat</span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_OP|const"><span>ID_OP</span></a><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>_</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>(</span></span><span>fun_conv</span><span> </span><span class="main"><span>(</span></span><span>fun_conv</span><span> </span><span class="main"><span>(</span></span><span>arg_conv</span><span> </span><span class="entity"><span>cnv</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>ct</span></span><span>
      </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword3"><span class="keyword"><span>raise</span></span></span><span> </span><span>CTERM</span><span> </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"id_op_lhs_conv"</span></span><span class="main"><span>,</span></span><span class="main"><span>[</span></span><span class="entity"><span>ct</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>structure</span></span></span><span> </span><span class="entity"><span>intf_types</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Named_Thms</span></span><span> </span><span class="main"><span>(</span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>binding</span></span><span> </span><span class="entity_def" id="Autoref_Id_Ops.autoref_itype|attribute"><span class="entity_def" id="Autoref_Id_Ops.autoref_itype|fact"><span>autoref_itype</span></span></span><span class="antiquote"><span>}</span></span></span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>description</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"Interface type declaration"</span></span><span>
    </span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>structure</span></span></span><span> </span><span class="entity"><span>op_patterns</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Named_Thms</span></span><span> </span><span class="main"><span>(</span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>binding</span></span><span> </span><span class="entity_def" id="Autoref_Id_Ops.autoref_op_pat|attribute"><span class="entity_def" id="Autoref_Id_Ops.autoref_op_pat|fact"><span>autoref_op_pat</span></span></span><span class="antiquote"><span>}</span></span></span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>description</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"Operation patterns"</span></span><span>
    </span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>structure</span></span></span><span> </span><span class="entity"><span>op_patterns_def</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Named_Thms</span></span><span> </span><span class="main"><span>(</span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>binding</span></span><span> </span><span class="entity_def" id="Autoref_Id_Ops.autoref_op_pat_def|attribute"><span class="entity_def" id="Autoref_Id_Ops.autoref_op_pat_def|fact"><span>autoref_op_pat_def</span></span></span><span class="antiquote"><span>}</span></span></span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>description</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"Definitive operation patterns"</span></span><span>
    </span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>cfg_trace_intf_unif</span></span><span> </span><span class="main"><span>=</span></span><span> 
      </span><span class="entity"><span>Attrib.setup_config_bool</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>binding</span></span><span> </span><span class="entity_def" id="Autoref_Id_Ops.autoref_trace_intf_unif|attribute"><span>autoref_trace_intf_unif</span></span><span class="antiquote"><span>}</span></span></span></span><span> </span><span class="main"><span>(</span></span><span>K</span><span> </span><span>false</span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>cfg_trace_failed_id</span></span><span> </span><span class="main"><span>=</span></span><span> 
      </span><span class="entity"><span>Attrib.setup_config_bool</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>binding</span></span><span> </span><span class="entity_def" id="Autoref_Id_Ops.autoref_trace_failed_id|attribute"><span>autoref_trace_failed_id</span></span><span class="antiquote"><span>}</span></span></span></span><span> </span><span class="main"><span>(</span></span><span>K</span><span> </span><span>false</span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>cfg_ss_id_op</span></span><span> </span><span class="main"><span>=</span></span><span> 
      </span><span class="entity"><span>Attrib.setup_config_bool</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>binding</span></span><span> </span><span class="entity_def" id="Autoref_Id_Ops.autoref_ss_id_op|attribute"><span>autoref_ss_id_op</span></span><span class="antiquote"><span>}</span></span></span></span><span> </span><span class="main"><span>(</span></span><span>K</span><span> </span><span>false</span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>cfg_trace_patterns</span></span><span> </span><span class="main"><span>=</span></span><span> 
      </span><span class="entity"><span>Attrib.setup_config_bool</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>binding</span></span><span> </span><span class="entity_def" id="Autoref_Id_Ops.autoref_trace_pat|attribute"><span>autoref_trace_pat</span></span><span class="antiquote"><span>}</span></span></span></span><span> </span><span class="main"><span>(</span></span><span>K</span><span> </span><span>false</span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>cfg_use_id_tags</span></span><span> </span><span class="main"><span>=</span></span><span> 
      </span><span class="entity"><span>Attrib.setup_config_bool</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>binding</span></span><span> </span><span class="entity_def" id="Autoref_Id_Ops.autoref_use_id_tags|attribute"><span>autoref_use_id_tags</span></span><span class="antiquote"><span>}</span></span></span></span><span> </span><span class="main"><span>(</span></span><span>K</span><span> </span><span>false</span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>cfg_trace_id_tags</span></span><span> </span><span class="main"><span>=</span></span><span> 
      </span><span class="entity"><span>Attrib.setup_config_bool</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>binding</span></span><span> </span><span class="entity_def" id="Autoref_Id_Ops.autoref_trace_id_tags|attribute"><span>autoref_trace_id_tags</span></span><span class="antiquote"><span>}</span></span></span></span><span> </span><span class="main"><span>(</span></span><span>K</span><span> </span><span>false</span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>get_typ_net</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Proof_Context.theory_of</span><span> </span><span class="entity"><span>ctxt</span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>typ_net</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>intf_types.get</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
        </span><span>|&gt;</span><span> </span><span class="entity"><span>Refine_Util.subsume_sort</span></span><span> </span><span>Thm.concl_of</span><span> </span><span class="entity"><span>thy</span></span><span>
        </span><span>|&gt;</span><span> </span><span>Tactic.build_net</span><span>
    </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="entity"><span>typ_net</span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>typ_thms_of_seq'</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>typ_net</span></span><span> </span><span class="entity"><span>c</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>idx</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Term.maxidx_of_term</span><span> </span><span class="entity"><span>c</span></span><span> </span><span>+</span><span> </span><span class="inner_numeral"><span>1</span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>typ_thms</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>mk_const_intf</span></span><span> </span><span class="entity"><span>c</span></span><span> </span><span class="main"><span>(</span></span><span>Var</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"I"</span></span><span class="main"><span>,</span></span><span class="entity"><span>idx</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>typ</span></span><span> </span><span class="quoted"><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.interface|type"><span>interface</span></a></span><span class="antiquote"><span>}</span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
        </span><span>|&gt;</span><span> </span><span class="entity"><span>HOLogic.mk_Trueprop</span></span><span>
        </span><span>|&gt;</span><span> </span><span>Thm.cterm_of</span><span> </span><span class="entity"><span>ctxt</span></span><span>
        </span><span>|&gt;</span><span> </span><span>Goal.init</span><span>
        </span><span>|&gt;</span><span> </span><span>resolve_from_net_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>typ_net</span></span><span> </span><span class="inner_numeral"><span>1</span></span><span>
        </span><span>|&gt;</span><span> </span><span>Seq.map</span><span> </span><span>Goal.conclude</span><span>
    </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="entity"><span>typ_thms</span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>typ_thms_of_seq</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>typ_thms_of_seq'</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>get_typ_net</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>has_typ_thms'</span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="entity"><span>typ_net</span></span><span> </span><span class="main"><span>=</span></span><span> 
      </span><span class="entity"><span>typ_thms_of_seq'</span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="entity"><span>typ_net</span></span><span> </span><span>#&gt;</span><span> </span><span>Seq.pull</span><span> </span><span>#&gt;</span><span> </span><span>is_some</span><span>
    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>has_typ_thms</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>has_typ_thms'</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>get_typ_net</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span>
  
    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>id_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Proof_Context.theory_of</span><span> </span><span class="entity"><span>ctxt</span></span><span>

      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>typ_net</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>get_typ_net</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>typ_thms_seq_of</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>typ_thms_of_seq'</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>typ_net</span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>typ_thms_of</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>typ_thms_seq_of</span></span><span> </span><span>#&gt;</span><span> </span><span>Seq.list_of</span><span>

      </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>pretty_typ_thms</span></span><span> </span><span class="entity"><span>l</span></span><span> </span><span class="main"><span>=</span></span><span> 
        </span><span class="entity"><span>l</span></span><span>
        </span><span>|&gt;</span><span> </span><span>map</span><span> </span><span class="main"><span>(</span></span><span>Thm.pretty_thm</span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span>
        </span><span>|&gt;</span><span> </span><span>Pretty.fbreaks</span><span> </span><span>|&gt;</span><span> </span><span>Pretty.block</span><span>


      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>tr_iu</span></span><span> </span><span class="main"><span>=</span></span><span> 
        </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span>Config.get</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>cfg_trace_intf_unif</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span>
          </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>st</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>
            </span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span>Logic.concl_of_goal</span><span> </span><span class="main"><span>(</span></span><span>Thm.prop_of</span><span> </span><span class="entity"><span>st</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
              </span><span class="main"><span>(</span></span><span class="entity"><span>t</span></span><span> </span><span class="keyword1"><span class="keyword"><span>as</span></span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>mpat</span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Trueprop|const"><span>Trueprop</span></a><span> </span><span class="main"><span>(</span></span><span class="var"><span>?c</span></span><span class="keyword1"><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.CONST_INTF|const"><span>::<span class="hidden">⇩</span><sub>i</sub></span></a></span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>(</span></span><span> </span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span class="entity"><span>typ_thms_of</span></span><span> </span><span class="entity"><span>c</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
                </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>)</span></span><span>
              </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>tts</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>Pretty.block</span><span> </span><span class="main"><span>[</span></span><span>
                  </span><span>Pretty.block</span><span> </span><span class="main"><span>[</span></span><span>
                    </span><span>Pretty.str</span><span> </span><span class="inner_quoted"><span>"Interface unification failed:"</span></span><span class="main"><span>,</span></span><span>
                    </span><span>Pretty.brk</span><span> </span><span class="inner_numeral"><span>1</span></span><span class="main"><span>,</span></span><span>
                    </span><span>Syntax.pretty_term</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span>
                  </span><span class="main"><span>]</span></span><span class="main"><span>,</span></span><span> 
                  </span><span>Pretty.fbrk</span><span class="main"><span>,</span></span><span>
                  </span><span>Pretty.str</span><span> </span><span class="inner_quoted"><span>"  "</span></span><span class="main"><span>,</span></span><span>
                  </span><span>Pretty.block</span><span> </span><span class="main"><span>[</span></span><span>
                    </span><span>Pretty.str</span><span> </span><span class="inner_quoted"><span>"Candidates: "</span></span><span class="main"><span>,</span></span><span> 
                    </span><span>Pretty.fbrk</span><span class="main"><span>,</span></span><span>
                    </span><span class="entity"><span>pretty_typ_thms</span></span><span> </span><span class="entity"><span>tts</span></span><span>
                  </span><span class="main"><span>]</span></span><span>
                </span><span class="main"><span>]</span></span><span>
                </span><span>|&gt;</span><span> </span><span>Pretty.string_of</span><span> </span><span>|&gt;</span><span> </span><span>tracing</span><span>
              </span><span class="main"><span>)</span></span><span>
            </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>)</span></span><span>
          </span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><span>Seq.empty</span><span class="main"><span>)</span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span>K</span><span> </span><span>no_tac</span><span>

      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>id_typ</span></span><span> </span><span class="main"><span>=</span></span><span> 
        </span><span>resolve_from_net_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>typ_net</span></span><span>
        </span><span>ORELSE'</span><span> </span><span class="entity"><span>tr_iu</span></span><span>

      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>pat_net</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>op_patterns.get</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> 
        </span><span>|&gt;</span><span> </span><span class="entity"><span>Refine_Util.subsume_sort</span></span><span> </span><span class="main"><span>(</span></span><span>Thm.concl_of</span><span> </span><span>#&gt;</span><span> </span><span>Logic.dest_equals</span><span> </span><span>#&gt;</span><span> </span><span class="main"><span>#</span></span><span class="inner_numeral"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>thy</span></span><span>
        </span><span>|&gt;</span><span> </span><span class="entity"><span>index_rewr_thms</span></span><span>

      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>def_pat_net</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>op_patterns_def.get</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
        </span><span>|&gt;</span><span> </span><span class="entity"><span>Refine_Util.subsume_sort</span></span><span> </span><span class="main"><span>(</span></span><span>Thm.concl_of</span><span> </span><span>#&gt;</span><span> </span><span>Logic.dest_equals</span><span> </span><span>#&gt;</span><span> </span><span class="main"><span>#</span></span><span class="inner_numeral"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>thy</span></span><span>
        </span><span>|&gt;</span><span> </span><span class="entity"><span>index_rewr_thms</span></span><span>

      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>id_abs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>CONVERSION</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>HOL_concl_conv</span></span><span> 
        </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>id_op_lhs_conv</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>mk_ABS_conv</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span>
        </span><span>THEN'</span><span> </span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_abs|fact"><span>ID_abs</span></a><span class="antiquote"><span>}</span></span></span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>id_app</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>CONVERSION</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>HOL_concl_conv</span></span><span> 
        </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>id_op_lhs_conv</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>mk_APP_conv</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span>
        </span><span>THEN'</span><span> </span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_app|fact"><span>ID_app</span></a><span class="antiquote"><span>}</span></span></span></span><span>

      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>id_tag_tac</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
        </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>trace</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Config.get</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>cfg_trace_id_tags</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> 
        </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>trace</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span class="entity"><span>IF_EXGOAL</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>st</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
            </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>tr_tac</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>st'</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
              </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>goal</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Logic.get_goal</span><span> </span><span class="main"><span>(</span></span><span>Thm.prop_of</span><span> </span><span class="entity"><span>st</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>i</span></span><span>
              </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>concl</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Logic.concl_of_goal</span><span> </span><span class="main"><span>(</span></span><span>Thm.prop_of</span><span> </span><span class="entity"><span>st</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>i</span></span><span>
              </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span class="entity"><span>concl</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
                  </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>mpat</span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Trueprop|const"><span>Trueprop</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_OP|const"><span>ID_OP</span></a><span> </span><span class="var"><span>?lhs</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
                    </span><span>tracing</span><span> </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"ID_TAG: "</span></span><span> </span><span>^</span><span> </span><span class="antiquoted"><span class="entity"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>make_string</span></span><span class="antiquote"><span>}</span></span></span></span></span><span> </span><span class="entity"><span>lhs</span></span><span class="main"><span>)</span></span><span> 
                </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>tracing</span><span> </span><span class="inner_quoted"><span>"ID_TAG: LHS???"</span></span><span>

              </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Pretty.block</span><span> </span><span class="main"><span>[</span></span><span>
                </span><span>Pretty.str</span><span> </span><span class="inner_quoted"><span>"ID_TAG: "</span></span><span class="main"><span>,</span></span><span> </span><span>Pretty.brk</span><span> </span><span class="inner_numeral"><span>1</span></span><span class="main"><span>,</span></span><span>
                </span><span>Syntax.pretty_term</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>goal</span></span><span>
              </span><span class="main"><span>]</span></span><span> </span><span>|&gt;</span><span> </span><span>Pretty.string_of</span><span> </span><span>|&gt;</span><span> </span><span>tracing</span><span>
            </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> 
              </span><span>Seq.single</span><span> </span><span class="entity"><span>st'</span></span><span>
            </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
          </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
            </span><span class="main"><span>(</span></span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_const_any|fact"><span>ID_const_any</span></a><span class="antiquote"><span>}</span></span></span></span><span> </span><span>THEN'</span><span> </span><span class="entity"><span>tr_tac</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="entity"><span>st</span></span><span>
          </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span class="main"><span>)</span></span><span> 
        </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span>
          </span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_const_any|fact"><span>ID_const_any</span></a><span class="antiquote"><span>}</span></span></span></span><span>

      </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>id_const</span></span><span> </span><span class="main"><span>=</span></span><span> 
        </span><span class="entity"><span>LHS_COND'</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>is_Const</span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="keyword1"><span class="keyword"><span>orelse</span></span></span><span> </span><span>is_Free</span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span>
        </span><span>THEN'</span><span> </span><span class="main"><span>(</span></span><span>
          </span><span class="main"><span>(</span></span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_const|fact"><span>ID_const</span></a><span class="antiquote"><span>}</span></span></span></span><span> </span><span>THEN'</span><span> </span><span class="entity"><span>id_typ</span></span><span class="main"><span>)</span></span><span> </span><span class="comment1"><span>(* Try to find type *)</span></span><span>
          </span><span>ORELSE'</span><span> </span><span class="main"><span>(</span></span><span>
            </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span>Config.get</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>cfg_use_id_tags</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span>
              </span><span class="entity"><span>CAN'</span></span><span> </span><span class="main"><span>(</span></span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_const_check_known|fact"><span>ID_const_check_known</span></a><span class="antiquote"><span>}</span></span></span></span><span> </span><span>THEN'</span><span> </span><span class="entity"><span>id_typ</span></span><span class="main"><span>)</span></span><span>
              </span><span class="entity"><span>THEN_ELSE'</span></span><span> </span><span class="main"><span>(</span></span><span>
                </span><span>K</span><span> </span><span>no_tac</span><span class="main"><span>,</span></span><span>
                </span><span class="entity"><span>id_tag_tac</span></span><span>
              </span><span class="main"><span>)</span></span><span>
            </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span>K</span><span> </span><span>no_tac</span><span>
          </span><span class="main"><span>)</span></span><span>
        </span><span class="main"><span>)</span></span><span>
  
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>id_tagged</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_tagged|fact"><span>ID_tagged</span></a><span class="antiquote"><span>}</span></span></span></span><span>

      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>id_annotated</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_annotated|fact"><span>ID_annotated</span></a><span class="antiquote"><span>}</span></span></span></span><span>

      </span><span class="comment1"><span>(*
      val traced_rewr_conv = if Config.get ctxt cfg_trace_patterns then
        fn ctxt =&gt; fn thm =&gt; fn ct =&gt; let
          val rthm = Conv.rewr_conv thm ct
          val _ = Pretty.block [
            Pretty.str "Trying (-pat:)", Pretty.brk 1, 
            pretty_rewrite ctxt thm rthm
          ] |&gt; Pretty.string_of |&gt; tracing
        in
          rthm
        end
      else
        K Conv.rewr_conv
      *)</span></span><span>

      </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>get_rewr_pat</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>mpat</span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Trueprop|const"><span>Trueprop</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_OP|const"><span>ID_OP</span></a><span> </span><span class="var"><span>?lhs</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>lhs</span></span><span>
        </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>get_rewr_pat</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>t</span></span><span>
      
      </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>rewr_frame_conv</span></span><span> </span><span class="entity"><span>conv</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>HOL_concl_conv</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>id_op_lhs_conv</span></span><span> </span><span class="entity"><span>conv</span></span><span class="main"><span>)</span></span><span>

      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>def_id_pat</span></span><span> </span><span class="main"><span>=</span></span><span> 
        </span><span>DETERM</span><span> </span><span>o</span><span> </span><span class="entity"><span>net_rewr_tac</span></span><span> </span><span class="entity"><span>def_pat_net</span></span><span> </span><span class="entity"><span>get_rewr_pat</span></span><span> </span><span class="entity"><span>rewr_frame_conv</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
  
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>id_pat</span></span><span> </span><span class="main"><span>=</span></span><span> 
        </span><span class="entity"><span>net_rewr_tac</span></span><span> </span><span class="entity"><span>pat_net</span></span><span> </span><span class="entity"><span>get_rewr_pat</span></span><span> </span><span class="entity"><span>rewr_frame_conv</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
  
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>id_dflt</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>FIRST'</span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>id_app</span></span><span class="main"><span>,</span></span><span class="entity"><span>id_const</span></span><span class="main"><span>,</span></span><span class="entity"><span>id_abs</span></span><span class="main"><span>]</span></span><span>
    
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>id_fail</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span>Config.get</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>cfg_trace_failed_id</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span>
        </span><span class="entity"><span>IF_EXGOAL</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>st</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> 
          </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span> 
            </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>pat</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Logic.concl_of_goal</span><span> </span><span class="main"><span>(</span></span><span>Thm.prop_of</span><span> </span><span class="entity"><span>st</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>i</span></span><span>
                  </span><span>|&gt;</span><span> </span><span class="entity"><span>get_rewr_pat</span></span><span>
            </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Pretty.block</span><span> </span><span class="main"><span>[</span></span><span> 
                </span><span>Pretty.str</span><span> </span><span class="inner_quoted"><span>"Failed to identify: "</span></span><span class="main"><span>,</span></span><span>
                </span><span>Syntax.pretty_term</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>pat</span></span><span>
              </span><span class="main"><span>]</span></span><span>
            </span><span>|&gt;</span><span> </span><span>Pretty.string_of</span><span> </span><span>|&gt;</span><span> </span><span>tracing</span><span>
          </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
            </span><span>Seq.empty</span><span>
          </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
        </span><span class="main"><span>)</span></span><span> 
      </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span>K</span><span> </span><span>no_tac</span><span>

      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>ss</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Config.get</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>cfg_ss_id_op</span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>step_tac</span></span><span> </span><span class="main"><span>=</span></span><span> 
        </span><span>FIRST'</span><span> </span><span class="main"><span>[</span></span><span>
          </span><span>assume_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>,</span></span><span>
          </span><span class="entity"><span>id_tagged</span></span><span class="main"><span>,</span></span><span>
          </span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_is_tagged_OP|fact"><span>ID_is_tagged_OP</span></a><span class="antiquote"><span>}</span></span></span></span><span> </span><span class="entity"><span>THEN_ELSE'</span></span><span> </span><span class="main"><span>(</span></span><span>
            </span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_tagged_OP_no_annot|fact"><span>ID_tagged_OP_no_annot</span></a><span class="antiquote"><span>}</span></span></span></span><span> </span><span>THEN'</span><span> </span><span class="entity"><span>id_typ</span></span><span class="main"><span>,</span></span><span>
            </span><span>FIRST'</span><span> </span><span class="main"><span>[</span></span><span>
              </span><span class="entity"><span>Indep_Vars.indep_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>,</span></span><span>
              </span><span class="entity"><span>id_annotated</span></span><span class="main"><span>,</span></span><span>
              </span><span class="entity"><span>def_id_pat</span></span><span class="main"><span>,</span></span><span>
              </span><span class="entity"><span>id_pat</span></span><span> </span><span>APPEND'</span><span> </span><span class="entity"><span>id_dflt</span></span><span class="main"><span>,</span></span><span>
              </span><span class="entity"><span>id_fail</span></span><span>
            </span><span class="main"><span>]</span></span><span>
          </span><span class="main"><span>)</span></span><span>
        </span><span class="main"><span>]</span></span><span> 

      </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>rec_tac</span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="entity"><span>st</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span>
        </span><span class="entity"><span>step_tac</span></span><span> </span><span class="entity"><span>THEN_ALL_NEW_FWD</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>ss</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span>K</span><span> </span><span>all_tac</span><span> </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="entity"><span>rec_tac</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="entity"><span>st</span></span><span>

    </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
      </span><span class="entity"><span>rec_tac</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>id_analyze</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="entity"><span>j</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>i</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>j</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>id_pretty_failure</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="entity"><span>j</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> 
      </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>j</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span>
        </span><span>Pretty.str</span><span> </span><span class="inner_quoted"><span>"No failure"</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> 
        </span><span>Pretty.str</span><span> </span><span class="inner_quoted"><span>"Interface typing error. Enable tracing for more information"</span></span><span>


    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>id_phase</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{</span></span><span>
      init </span><span class="main"><span>=</span></span><span> </span><span>I</span><span class="main"><span>,</span></span><span>
      tac </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>Seq.INTERVAL</span><span> </span><span class="main"><span>(</span></span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_init|fact"><span>ID_init</span></a><span class="antiquote"><span>}</span></span></span></span><span> </span><span>THEN'</span><span> </span><span class="entity"><span>id_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
      analyze </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>id_analyze</span></span><span class="main"><span>,</span></span><span>
      pretty_failure </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>id_pretty_failure</span></span><span>
    </span><span class="main"><span>}</span></span><span>


    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>decl_derived_typing</span></span><span> </span><span class="entity"><span>overl</span></span><span> </span><span class="entity"><span>c</span></span><span> </span><span class="entity"><span>I</span></span><span> </span><span class="entity"><span>context</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Context.proof_of</span><span> </span><span class="entity"><span>context</span></span><span>

      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>typ_thms</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>intf_types.get</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> 
        </span><span class="comment1"><span>(* TODO: Use net cached in ctxt here! *)</span></span><span>

      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>mk_const_intf_thm</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>c</span></span><span> </span><span class="entity"><span>I</span></span><span>

      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>st</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Thm.cprop_of</span><span> </span><span class="entity"><span>thm</span></span><span> </span><span>|&gt;</span><span> </span><span>Goal.init</span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>has_t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>SOLVED'</span><span> </span><span class="main"><span>(</span></span><span>match_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>typ_thms</span></span><span class="main"><span>)</span></span><span> </span><span class="inner_numeral"><span>1</span></span><span> </span><span class="entity"><span>st</span></span><span> </span><span>|&gt;</span><span> </span><span>Seq.pull</span><span> </span><span>|&gt;</span><span> </span><span>is_some</span><span>
    </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>has_t</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span class="entity"><span>context</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="main"><span>(</span></span><span>
        </span><span>not</span><span> </span><span class="entity"><span>overl</span></span><span> </span><span class="keyword1"><span class="keyword"><span>andalso</span></span></span><span> </span><span class="entity"><span>has_typ_thms</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>c</span></span><span> </span><span class="keyword1"><span class="keyword"><span>andalso</span></span></span><span> </span><span class="main"><span>(</span></span><span>warning</span><span> </span><span class="main"><span>(</span></span><span>
          </span><span>Pretty.block</span><span> </span><span class="main"><span>[</span></span><span>
            </span><span>Pretty.str</span><span> </span><span class="inner_quoted"><span>"Adding overloaded interface type to constant:"</span></span><span class="main"><span>,</span></span><span>
            </span><span>Pretty.brk</span><span> </span><span class="inner_numeral"><span>1</span></span><span class="main"><span>,</span></span><span>
            </span><span>Thm.pretty_thm</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thm</span></span><span>
          </span><span class="main"><span>]</span></span><span> </span><span>|&gt;</span><span> </span><span>Pretty.string_of</span><span>
        </span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><span>true</span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
        </span><span class="entity"><span>intf_types.add_thm</span></span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="entity"><span>context</span></span><span> 
      </span><span class="main"><span>)</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>setup</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>I</span><span>
      </span><span>#&gt;</span><span> </span><span class="entity"><span>intf_types.setup</span></span><span>
      </span><span>#&gt;</span><span> </span><span class="entity"><span>op_patterns.setup</span></span><span>
      </span><span>#&gt;</span><span> </span><span class="entity"><span>op_patterns_def.setup</span></span><span>

  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>


›</span></span><span>

</span><span class="keyword1"><span class="command"><span>setup</span></span></span><span> </span><span class="entity"><span>Autoref_Id_Ops.setup</span></span><span>


</span><span class="keyword1"><span class="command"><span class="entity_def" id="Autoref_Id_Ops.IND_FACT_def|fact"><span class="entity_def" id="Autoref_Id_Ops.IND_FACT_def|thm"><span class="entity_def" id="Autoref_Id_Ops.IND_FACT_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Autoref_Id_Ops.IND_FACT|const"><span>IND_FACT</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.rel_name|type"><span>rel_name</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'c</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod|type"><span>×</span></a></span><span> </span><span class="tfree"><span>'a</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword1"><span>#</span></span><span>_</span><span class="keyword1"><span>=</span></span><span>_"</span></span><span> 10</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="free"><span>#</span></span></span><span class="free"><span class="bound"><span class="entity"><span>name</span></span></span></span><span class="main"><span class="free"><span>=</span></span></span><span class="free"><span class="bound"><span class="entity"><span>R</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Autoref_Id_Ops.REL_INDIRECT|fact"><span class="entity_def" id="Autoref_Id_Ops.REL_INDIRECT|thm"><span>REL_INDIRECT</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.IND_FACT|const"><span>#</span></a></span><span class="free"><span>name</span></span><span class="main"><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.IND_FACT|const"><span>=</span></a></span><span class="free"><span>R</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>


</span><span class="keyword1"><span class="command"><span class="entity_def" id="Autoref_Id_Ops.CNV_ANNOT_def|fact"><span class="entity_def" id="Autoref_Id_Ops.CNV_ANNOT_def|thm"><span class="entity_def" id="Autoref_Id_Ops.CNV_ANNOT_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Autoref_Id_Ops.CNV_ANNOT|const"><span>CNV_ANNOT</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>_</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod|type"><span>×</span></a></span><span class="tfree"><span>'a</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>CNV_ANNOT</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>t</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>t'</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>R</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>t</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span class="bound"><span class="entity"><span>t'</span></span></span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Autoref_Id_Ops.REL_OF_INTF_def|fact"><span class="entity_def" id="Autoref_Id_Ops.REL_OF_INTF_def|thm"><span class="entity_def" id="Autoref_Id_Ops.REL_OF_INTF_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Autoref_Id_Ops.REL_OF_INTF|const"><span>REL_OF_INTF</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.interface|type"><span>interface</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'c</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod|type"><span>×</span></a></span><span class="tfree"><span>'a</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>REL_OF_INTF</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>I</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>R</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Autoref_Id_Ops.REL_OF_INTF_P_def|fact"><span class="entity_def" id="Autoref_Id_Ops.REL_OF_INTF_P_def|thm"><span class="entity_def" id="Autoref_Id_Ops.REL_OF_INTF_P_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> 
  </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Autoref_Id_Ops.REL_OF_INTF_P|const"><span>REL_OF_INTF_P</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>I</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>R</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span>"</span></span></span><span> </span><span class="comment1"><span>― ‹Version to resolve relator arguments›</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Autoref_Id_Ops.CNV_ANNOT|fact"><span class="entity_def" id="Autoref_Id_Ops.CNV_ANNOT(6)|thm"><span class="entity_def" id="Autoref_Id_Ops.CNV_ANNOT(5)|thm"><span class="entity_def" id="Autoref_Id_Ops.CNV_ANNOT(4)|thm"><span class="entity_def" id="Autoref_Id_Ops.CNV_ANNOT(3)|thm"><span class="entity_def" id="Autoref_Id_Ops.CNV_ANNOT(2)|thm"><span class="entity_def" id="Autoref_Id_Ops.CNV_ANNOT(1)|thm"><span>CNV_ANNOT</span></span></span></span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>f</span></span><span> </span><span class="bound"><span>f'</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>a'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.CNV_ANNOT|const"><span>CNV_ANNOT</span></a><span> </span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>a'</span></span><span> </span><span class="free"><span>Ra</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.CNV_ANNOT|const"><span>CNV_ANNOT</span></a><span> </span><span class="bound"><span>f</span></span><span> </span><span class="bound"><span>f'</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Ra</span></span><span class="main"><a class="entity_ref" href="Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span class="free"><span>Rr</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟧</span></span><span> 
    </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.CNV_ANNOT|const"><span>CNV_ANNOT</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>f</span></span><span class="main"><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>f'</span></span><span class="main"><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="bound"><span>a'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Rr</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>f</span></span><span> </span><span class="bound"><span>f'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.CNV_ANNOT|const"><span>CNV_ANNOT</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Ra</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.CNV_ANNOT|const"><span>CNV_ANNOT</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>f'</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>Rr</span></span><span> </span><span class="main"><span>⟧</span></span><span> 
    </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.CNV_ANNOT|const"><span>CNV_ANNOT</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.ABS|const"><span>λ'</span></a></span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.ABS|const"><span>.</span></a></span><span> </span><span class="bound"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.ABS|const"><span>λ'</span></a></span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.ABS|const"><span>.</span></a></span><span> </span><span class="bound"><span>f'</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Ra</span></span><span class="main"><a class="entity_ref" href="Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span class="free"><span>Rr</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>f</span></span><span> </span><span class="bound"><span>f</span></span><span> </span><span class="bound"><span>I</span></span><span> </span><span class="bound"><span>R</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.undefined|const"><span>undefined</span></a><span> </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>''Id tag not yet supported''</span></span><span class="main"><span>,</span></span><span class="bound"><span>f</span></span><span class="main"><span>)</span></span><span class="main"><span>⟧</span></span><span> 
    </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.CNV_ANNOT|const"><span>CNV_ANNOT</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.OP|const"><span>OP</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ID_TAG|const"><span>ID_TAG</span></a><span> </span><span class="bound"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.i_ANNOT|const"><span>:::<span class="hidden">⇩</span><sub>i</sub></span></a></span><span> </span><span class="bound"><span>I</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>f</span></span><span> </span><span class="bound"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>f</span></span><span> </span><span class="bound"><span>I</span></span><span> </span><span class="bound"><span>R</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><a class="entity_ref" href="Indep_Vars.html#Indep_Vars.INDEP|const"><span>INDEP</span></a><span> </span><span class="bound"><span>R</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.REL_OF_INTF|const"><span>REL_OF_INTF</span></a><span> </span><span class="bound"><span>I</span></span><span> </span><span class="bound"><span>R</span></span><span> </span><span class="main"><span>⟧</span></span><span> 
    </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.CNV_ANNOT|const"><span>CNV_ANNOT</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.OP|const"><span>OP</span></a><span> </span><span class="bound"><span>f</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.i_ANNOT|const"><span>:::<span class="hidden">⇩</span><sub>i</sub></span></a></span><span> </span><span class="bound"><span>I</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.OP|const"><span>OP</span></a><span> </span><span class="bound"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.rel_ANNOT|const"><span>:::</span></a></span><span> </span><span class="bound"><span>R</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>t</span></span><span> </span><span class="bound"><span>t'</span></span><span> </span><span class="bound"><span>R</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.CNV_ANNOT|const"><span>CNV_ANNOT</span></a><span> </span><span class="bound"><span>t</span></span><span> </span><span class="bound"><span>t'</span></span><span> </span><span class="bound"><span>R</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.CNV_ANNOT|const"><span>CNV_ANNOT</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>t</span></span><span> </span><span class="main"><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.rel_ANNOT|const"><span>:::</span></a></span><span> </span><span class="bound"><span>R</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>t'</span></span><span> </span><span class="bound"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>t</span></span><span> </span><span class="bound"><span>t'</span></span><span> </span><span class="bound"><span>name</span></span><span> </span><span class="bound"><span>R</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.IND_FACT|const"><span>#</span></a></span><span class="bound"><span>name</span></span><span class="main"><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.IND_FACT|const"><span>=</span></a></span><span class="bound"><span>R</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.CNV_ANNOT|const"><span>CNV_ANNOT</span></a><span> </span><span class="bound"><span>t</span></span><span> </span><span class="bound"><span>t'</span></span><span> </span><span class="bound"><span>R</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.CNV_ANNOT|const"><span>CNV_ANNOT</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>t</span></span><span> </span><span class="main"><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.ind_ANNOT|const"><span>::#</span></a></span><span class="bound"><span>name</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>t'</span></span><span> </span><span class="bound"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span>

</span><span class="keyword1"><span class="command"><span>consts</span></span></span><span> </span><span class="entity_def" id="Autoref_Id_Ops.i_of_rel|const"><span>i_of_rel</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'b</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Autoref_Id_Ops.ROI_P_app|fact"><span class="entity_def" id="Autoref_Id_Ops.ROI_P_app|thm"><span>ROI_P_app</span></span></span><span class="main"><span>:</span></span><span> </span><span class="comment1"><span>― ‹Only if interface is really application›</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.REL_OF_INTF_P|const"><span>REL_OF_INTF_P</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.REL_OF_INTF|const"><span>REL_OF_INTF</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Autoref_Id_Ops.ROI_app|fact"><span class="entity_def" id="Autoref_Id_Ops.ROI_app|thm"><span>ROI_app</span></span></span><span class="main"><span>:</span></span><span> </span><span class="comment1"><span>― ‹Only if interface is really application›</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.REL_OF_INTF|const"><span>REL_OF_INTF</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>R</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.REL_OF_INTF_P|const"><span>REL_OF_INTF_P</span></a><span> </span><span class="free"><span>J</span></span><span> </span><span class="free"><span>S</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.REL_OF_INTF_P|const"><span>REL_OF_INTF_P</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>⟨</span></span><span class="free"><span>I</span></span><span class="keyword1"><span>⟩<span class="hidden">⇩</span><sub>i</sub></span></span><span class="free"><span>J</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>⟨</span></span><span class="free"><span>R</span></span><span class="main"><span>⟩</span></span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Autoref_Id_Ops.ROI_i_of_rel|fact"><span class="entity_def" id="Autoref_Id_Ops.ROI_i_of_rel(2)|thm"><span class="entity_def" id="Autoref_Id_Ops.ROI_i_of_rel(1)|thm"><span>ROI_i_of_rel</span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.REL_OF_INTF_P|const"><span>REL_OF_INTF_P</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.i_of_rel|const"><span>i_of_rel</span></a><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>S</span></span><span>"</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.REL_OF_INTF|const"><span>REL_OF_INTF</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.i_of_rel|const"><span>i_of_rel</span></a><span> </span><span class="free"><span>R</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Autoref_Id_Ops.ROI_const|fact"><span class="entity_def" id="Autoref_Id_Ops.ROI_const(2)|thm"><span class="entity_def" id="Autoref_Id_Ops.ROI_const(1)|thm"><span>ROI_const</span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.REL_OF_INTF_P|const"><span>REL_OF_INTF_P</span></a><span> </span><span class="free"><span>J</span></span><span> </span><span class="free"><span>S</span></span><span>"</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.REL_OF_INTF|const"><span>REL_OF_INTF</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_16330..16335">lemma</span></span></span><span> </span><span class="entity_def" id="Autoref_Id_Ops.ROI_init|fact"><span class="entity_def" id="Autoref_Id_Ops.ROI_init|thm"><span>ROI_init</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.CNV_ANNOT|const"><span>CNV_ANNOT</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>a'</span></span><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span class="main"><span>,</span></span><span class="free"><span>a'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span class="main"><span>,</span></span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#offset_16330..16335"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Autoref_Id_Ops.REL_OF_INTF_I|fact"><span class="entity_def" id="Autoref_Id_Ops.REL_OF_INTF_I|thm"><span>REL_OF_INTF_I</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.REL_OF_INTF|const"><span>REL_OF_INTF</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹
</span><span class="keyword1"><span class="keyword"><span>signature</span></span></span><span> </span><span class="entity"><span>AUTOREF_REL_INF</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>sig</span></span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> roi_tac</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>Proof.context</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span class="entity"><span>tactic'</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> roi_step_tac</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>Proof.context</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span class="entity"><span>tactic'</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> roi_phase</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>Autoref_Phases.phase</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> cfg_sbias</span><span class="main"><span>:</span></span><span> </span><span>int</span><span> </span><span>Config.T</span><span>

  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> setup</span><span class="main"><span>:</span></span><span> </span><span>theory</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>theory</span><span>
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>structure</span></span></span><span> </span><span class="entity"><span>Autoref_Rel_Inf</span></span><span> </span><span class="main"><span>:</span></span><span class="entity"><span>AUTOREF_REL_INF</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>struct</span></span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>cfg_sbias</span></span><span> </span><span class="main"><span>=</span></span><span> 
    </span><span class="entity"><span>Attrib.setup_config_int</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>binding</span></span><span> </span><span class="entity_def" id="Autoref_Id_Ops.autoref_sbias|attribute"><span>autoref_sbias</span></span><span class="antiquote"><span>}</span></span></span></span><span> </span><span class="main"><span>(</span></span><span>K</span><span> </span><span class="inner_numeral"><span>100</span></span><span class="main"><span>)</span></span><span>


  </span><span class="keyword1"><span class="keyword"><span>structure</span></span></span><span> </span><span class="entity"><span>rel_indirect</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Named_Thms</span></span><span> </span><span class="main"><span>(</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>binding</span></span><span> </span><span class="entity_def" id="Autoref_Id_Ops.autoref_rel_indirect|attribute"><span class="entity_def" id="Autoref_Id_Ops.autoref_rel_indirect|fact"><span>autoref_rel_indirect</span></span></span><span class="antiquote"><span>}</span></span></span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>description</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"Indirect relator bindings"</span></span><span>
  </span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>rel_of_intf_thm</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>I</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> 
      </span><span class="entity"><span>roi</span></span><span> </span><span class="main"><span>(</span></span><span>Free</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>n</span></span><span class="main"><span>,</span></span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span> 
        </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Rn</span></span><span class="main"><span>,</span></span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>yield_singleton</span><span> </span><span>Variable.variant_fixes</span><span> </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"R_"</span></span><span> </span><span>^</span><span> </span><span class="entity"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="main"><span>(</span></span><span>Free</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Rn</span></span><span class="main"><span>,</span></span><span>dummyT</span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
    </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>roi</span></span><span> </span><span class="main"><span>(</span></span><span>Const</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>n</span></span><span class="main"><span>,</span></span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span> 
        </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Long_Name.base_name</span><span> </span><span class="entity"><span>n</span></span><span>
        </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Rn</span></span><span class="main"><span>,</span></span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>yield_singleton</span><span> </span><span>Variable.variant_fixes</span><span> </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"R_"</span></span><span> </span><span>^</span><span> </span><span class="entity"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="main"><span>(</span></span><span>Free</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Rn</span></span><span class="main"><span>,</span></span><span>dummyT</span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
    </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>roi</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>mpat</span></span><span> </span><span class="quoted"><span>"</span><span class="main"><span>⟨</span></span><span class="var"><span>?Ia</span></span><span class="keyword1"><span>⟩<span class="hidden">⇩</span><sub>i</sub></span></span><span class="var"><span>?Ib</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span></span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
        </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Ra</span></span><span class="main"><span>,</span></span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>roi</span></span><span> </span><span class="entity"><span>Ia</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
        </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Rb</span></span><span class="main"><span>,</span></span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>roi</span></span><span> </span><span class="entity"><span>Ib</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> 
        </span><span class="main"><span>(</span></span><span>Const</span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>const_name</span></span><span> </span><a class="entity_ref" href="Relators.html#Relators.relAPP|const"><span>relAPP</span></a><span class="antiquote"><span>}</span></span></span><span class="main"><span>,</span></span><span>dummyT</span><span class="main"><span>)</span></span><span>$</span><span class="entity"><span>Rb</span></span><span>$</span><span class="entity"><span>Ra</span></span><span class="main"><span>,</span></span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
    </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>roi</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>mpat</span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.i_of_rel|const"><span>i_of_rel</span></a><span> </span><span class="var"><span>?R</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>roi</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword3"><span class="keyword"><span>raise</span></span></span><span> </span><span>TERM</span><span> </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"rel_of_intf: Unexpected interface"</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>t</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>orig_ctxt</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>I</span></span><span class="main"><span>,</span></span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>yield_singleton</span><span> </span><span class="main"><span>(</span></span><span>Variable.import_terms</span><span> </span><span>true</span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>I</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>roi</span></span><span> </span><span class="entity"><span>I</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>res</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Const</span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>const_name</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.REL_OF_INTF|const"><span>REL_OF_INTF</span></a><span class="antiquote"><span>}</span></span></span><span class="main"><span>,</span></span><span>dummyT</span><span class="main"><span>)</span></span><span>$</span><span class="entity"><span>I</span></span><span>$</span><span class="entity"><span>R</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>res</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Syntax.check_term</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>res</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>res</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>singleton</span><span> </span><span class="main"><span>(</span></span><span>Variable.export_terms</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>orig_ctxt</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>res</span></span><span>
      </span><span>|&gt;</span><span> </span><span class="entity"><span>HOLogic.mk_Trueprop</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>goal_ctxt</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Variable.declare_term</span><span> </span><span class="entity"><span>res</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span>Goal.prove_internal</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>(</span></span><span>Thm.cterm_of</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>res</span></span><span class="main"><span>)</span></span><span>
        </span><span class="main"><span>(</span></span><span>K</span><span> </span><span class="main"><span>(</span></span><span>resolve_tac</span><span> </span><span class="entity"><span>goal_ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.REL_OF_INTF_I|fact"><span>REL_OF_INTF_I</span></a><span class="antiquote"><span>}</span></span></span></span><span> </span><span class="inner_numeral"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>


  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>roi_step_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>ind_net</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>rel_indirect.get</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span>|&gt;</span><span> </span><span>Tactic.build_net</span><span>
  </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
    </span><span class="entity"><span>IF_EXGOAL</span></span><span> </span><span class="main"><span>(</span></span><span>
      </span><span>assume_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span>
      </span><span>ORELSE'</span><span>
      </span><span class="entity"><span>Indep_Vars.indep_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
      </span><span>ORELSE'</span><span> </span><span>resolve_from_net_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>ind_net</span></span><span>
      </span><span>ORELSE'</span><span>
      </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>st</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> 
        </span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span>Logic.concl_of_goal</span><span> </span><span class="main"><span>(</span></span><span>Thm.prop_of</span><span> </span><span class="entity"><span>st</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
          </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>mpat</span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Trueprop|const"><span>Trueprop</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.CNV_ANNOT|const"><span>CNV_ANNOT</span></a><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> </span><span class="main"><span>=&gt;</span></span><span> 
            </span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.CNV_ANNOT|fact"><span>CNV_ANNOT</span></a><span class="antiquote"><span>}</span></span></span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="entity"><span>st</span></span><span>
        </span><span class="main"><span>|</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>mpat</span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Trueprop|const"><span>Trueprop</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.REL_OF_INTF|const"><span>REL_OF_INTF</span></a><span> </span><span class="var"><span>?I</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span></span><span> </span><span class="main"><span>=&gt;</span></span><span> 
            </span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>rel_of_intf_thm</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>I</span></span><span class="main"><span>]</span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="entity"><span>st</span></span><span>
        </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>Seq.empty</span><span>
      

      </span><span class="comment1"><span>(*
        | @{mpat "Trueprop (REL_OF_INTF (⟨_⟩<span class="hidden">⇩</span><sub>i</sub>_) _)"} =&gt; 
            rtac @{thm ROI_P_app} i st
        | @{mpat "Trueprop (REL_OF_INTF_P (⟨_⟩<span class="hidden">⇩</span><sub>i</sub>_) _)"} =&gt; 
            rtac @{thm ROI_app} i st
        | @{mpat "Trueprop (REL_OF_INTF_P (i_of_rel _) _)"} =&gt; 
            resolve_tac ctxt @{thms ROI_i_of_rel} i st
        | @{mpat "Trueprop (REL_OF_INTF (i_of_rel _) _)"} =&gt; 
            resolve_tac ctxt @{thms ROI_i_of_rel} i st
        | _ =&gt; resolve_tac ctxt @{thms ROI_const} i st
      *)</span></span><span>
      </span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>)</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>roi_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span> 
    </span><span class="entity"><span>REPEAT_ALL_NEW_FWD</span></span><span> </span><span class="main"><span>(</span></span><span>DETERM</span><span> </span><span>o</span><span> </span><span class="entity"><span>roi_step_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>roi_analyze</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="entity"><span>j</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>i</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>j</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>roi_pretty_failure</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="entity"><span>j</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>j</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span>
      </span><span>Pretty.str</span><span> </span><span class="inner_quoted"><span>"No failure"</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> 
      </span><span>Pretty.str</span><span> </span><span class="inner_quoted"><span>"Relator inference error"</span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>roi_phase</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{</span></span><span>
    init </span><span class="main"><span>=</span></span><span> </span><span>I</span><span class="main"><span>,</span></span><span>
    tac </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>Seq.INTERVAL</span><span> </span><span class="main"><span>(</span></span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="Autoref_Id_Ops.html#Autoref_Id_Ops.ROI_init|fact"><span>ROI_init</span></a><span class="antiquote"><span>}</span></span></span></span><span> </span><span>THEN'</span><span> </span><span class="entity"><span>roi_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
    analyze </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>roi_analyze</span></span><span class="main"><span>,</span></span><span>
    pretty_failure </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>roi_pretty_failure</span></span><span>
  </span><span class="main"><span>}</span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>setup</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>rel_indirect.setup</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
›</span></span><span>

</span><span class="keyword1"><span class="command"><span>setup</span></span></span><span> </span><span class="entity"><span>Autoref_Rel_Inf.setup</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span></pre>
</body>

</html>