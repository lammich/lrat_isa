<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Autoref_Translate</title>
</head>


<body>
<div class="head">
<h1>Theory Autoref_Translate</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><a href="Autoref_Translate.html"><span>Autoref_Translate</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> </span><a href="Autoref_Fix_Rel.html"><span>Autoref_Fix_Rel</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Definitions›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹APP and ABS Rules›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Autoref_Translate.autoref_ABS|fact"><span class="entity_def" id="Autoref_Translate.autoref_ABS|thm"><span>autoref_ABS</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>Ra</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>Rr</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.ABS|const"><span>λ'</span></a></span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.ABS|const"><span>.</span></a></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>Ra</span></span><span class="main"><a class="entity_ref" href="Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span class="free"><span>Rr</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Autoref_Translate.autoref_APP|fact"><span class="entity_def" id="Autoref_Translate.autoref_APP|thm"><span>autoref_APP</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span class="main"><span>,</span></span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>Ra</span></span><span class="main"><a class="entity_ref" href="Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span class="free"><span>Rr</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span class="free"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>Ra</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span class="main"><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span> </span><span class="free"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>Rr</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Relators.html#Relators.fun_relD|fact"><span>fun_relD</span></a><span class="main"><span>)</span></span><span>
</span><span class="comment1"><span>(*lemma autoref_ANNOT:
  "⟦ (x,x')∈R ⟧ ⟹ (x,x':::R)∈R" by (auto simp: ANNOT_def)
*)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_391..396">lemma</span></span></span><span> </span><span class="entity_def" id="Autoref_Translate.autoref_beta|fact"><span class="entity_def" id="Autoref_Translate.autoref_beta|thm"><span>autoref_beta</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span class="main"><span>,</span></span><span class="free"><span>a</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span class="main"><span>,</span></span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.ABS|const"><span>λ'</span></a></span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.ABS|const"><span>.</span></a></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Autoref_Translate.html#offset_391..396"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

</span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="entity_def" id="Autoref_Translate.dflt_trans_rules|fact"><span class="entity_def" id="Autoref_Translate.dflt_trans_rules(3)|thm"><span class="entity_def" id="Autoref_Translate.dflt_trans_rules(2)|thm"><span class="entity_def" id="Autoref_Translate.dflt_trans_rules(1)|thm"><span>dflt_trans_rules</span></span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Autoref_Translate.html#Autoref_Translate.autoref_beta|fact"><span>autoref_beta</span></a><span> </span><a class="entity_ref" href="Autoref_Translate.html#Autoref_Translate.autoref_ABS|fact"><span>autoref_ABS</span></a><span> </span><a class="entity_ref" href="Autoref_Translate.html#Autoref_Translate.autoref_APP|fact"><span>autoref_APP</span></a><span>

</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Side Conditions›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
  Rules can have prefer and defer side-conditions. Prefer conditions must
  be solvable in order for the rule to apply, and defer conditions must
  hold after the rule has been applied and the recursive translations have been
  performed. Thus, prefer-conditions typically restrict on the abstract 
  expression, while defer conditions restrict the translated expression.

  In order to solve the actual side conditions, we use the 
  </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>Tagged_Solver›</span></span></span><span>-infrastructure. The solvers are applied after 
  the </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>PREFER›</span></span></span><span>/</span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>DEFER›</span></span></span><span> tag has been removed.
›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
  Tag to remove internal stuff from term.
  Before a prefer/defer side condition is evaluated, all terms inside these 
  tags are purged from autoref-specific annotations, i.e., operator-annotations,
  relator annotations, and tagged applications.
›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Autoref_Translate.REMOVE_INTERNAL_def|fact"><span class="entity_def" id="Autoref_Translate.REMOVE_INTERNAL_def|thm"><span class="entity_def" id="Autoref_Translate.REMOVE_INTERNAL_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.autoref_tag_defs|attribute"><span class="operator"><span>autoref_tag_defs</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Autoref_Translate.REMOVE_INTERNAL|const"><span>REMOVE_INTERNAL</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span>"</span></span></span><span> 

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Useful abbreviation to require some property that is not related
  to teh refinement framework›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>abbreviation</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Autoref_Translate.PREFER|const"><span>PREFER</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>nt</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Φ</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="Autoref_Fix_Rel.html#Autoref_Fix_Rel.PREFER_tag|const"><span>PREFER_tag</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>nt</span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Autoref_Translate.html#Autoref_Translate.REMOVE_INTERNAL|const"><span>REMOVE_INTERNAL</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>Φ</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>abbreviation</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Autoref_Translate.DEFER|const"><span>DEFER</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>nt</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Φ</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="Autoref_Fix_Rel.html#Autoref_Fix_Rel.DEFER_tag|const"><span>DEFER_tag</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>nt</span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Autoref_Translate.html#Autoref_Translate.REMOVE_INTERNAL|const"><span>REMOVE_INTERNAL</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>Φ</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Autoref_Translate.REMOVE_INTERNAL_EQ_def|fact"><span class="entity_def" id="Autoref_Translate.REMOVE_INTERNAL_EQ_def|thm"><span class="entity_def" id="Autoref_Translate.REMOVE_INTERNAL_EQ_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Autoref_Translate.REMOVE_INTERNAL_EQ|const"><span>REMOVE_INTERNAL_EQ</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>a</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>b</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>a</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span class="bound"><span class="entity"><span>b</span></span></span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Autoref_Translate.REMOVE_INTERNAL_EQI|fact"><span class="entity_def" id="Autoref_Translate.REMOVE_INTERNAL_EQI|thm"><span>REMOVE_INTERNAL_EQI</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Autoref_Translate.html#Autoref_Translate.REMOVE_INTERNAL_EQ|const"><span>REMOVE_INTERNAL_EQ</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>a</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_1797..1802">lemma</span></span></span><span> </span><span class="entity_def" id="Autoref_Translate.autoref_REMOVE_INTERNAL_EQ|fact"><span class="entity_def" id="Autoref_Translate.autoref_REMOVE_INTERNAL_EQ|thm"><span>autoref_REMOVE_INTERNAL_EQ</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span class="main"><span>,</span></span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Autoref_Translate.html#Autoref_Translate.REMOVE_INTERNAL_EQ|const"><span>REMOVE_INTERNAL_EQ</span></a><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>c'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>c'</span></span><span class="main"><span>,</span></span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Autoref_Translate.html#offset_1797..1802"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹
  </span><span class="keyword1"><span class="keyword"><span>signature</span></span></span><span> </span><span class="entity"><span>AUTOREF_TACTICALS</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>sig</span></span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> is_prefer_cond</span><span class="main"><span>:</span></span><span> </span><span>int</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>thm</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>bool</span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> is_defer_cond</span><span class="main"><span>:</span></span><span> </span><span>int</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>thm</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>bool</span><span>

    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> REPEAT_INTERVAL</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>tactic'</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span class="entity"><span>itactic</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> COND''</span><span class="main"><span>:</span></span><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>thm</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>bool</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span class="entity"><span>tactic'</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span class="entity"><span>tactic'</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span class="entity"><span>tactic'</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> REPEAT_ON_SUBGOAL</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>tactic'</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span class="entity"><span>tactic'</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> IF_SOLVED</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>tactic'</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span class="entity"><span>tactic'</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span class="entity"><span>tactic'</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span class="entity"><span>tactic'</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>structure</span></span></span><span> </span><span class="entity"><span>Autoref_Tacticals</span></span><span> </span><span class="main"><span>:</span></span><span class="entity"><span>AUTOREF_TACTICALS</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>struct</span></span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>is_prefer_cond</span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="entity"><span>st</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span>Logic.concl_of_goal</span><span> </span><span class="main"><span>(</span></span><span>Thm.prop_of</span><span> </span><span class="entity"><span>st</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
        </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>mpat</span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Trueprop|const"><span>Trueprop</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Autoref_Fix_Rel.html#Autoref_Fix_Rel.PREFER_tag|const"><span>PREFER_tag</span></a><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>true</span><span>
      </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>false</span><span>

    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>is_defer_cond</span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="entity"><span>st</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span>Logic.concl_of_goal</span><span> </span><span class="main"><span>(</span></span><span>Thm.prop_of</span><span> </span><span class="entity"><span>st</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
        </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>mpat</span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Trueprop|const"><span>Trueprop</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Autoref_Fix_Rel.html#Autoref_Fix_Rel.DEFER_tag|const"><span>DEFER_tag</span></a><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>true</span><span>
      </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>false</span><span>

    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>REPEAT_INTERVAL</span></span><span> </span><span class="entity"><span>tac</span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="entity"><span>j</span></span><span> </span><span class="entity"><span>st</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Thm.nprems_of</span><span> </span><span class="entity"><span>st</span></span><span> </span><span>-</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>j</span></span><span> </span><span>-</span><span> </span><span class="entity"><span>i</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>r</span></span><span> </span><span class="entity"><span>st</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span>
        </span><span>COND</span><span> 
          </span><span class="main"><span>(</span></span><span>has_fewer_prems</span><span> </span><span class="entity"><span>n</span></span><span class="main"><span>)</span></span><span> 
          </span><span class="main"><span>(</span></span><span>all_tac</span><span class="main"><span>)</span></span><span> 
          </span><span class="main"><span>(</span></span><span class="entity"><span>tac</span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span>THEN_ELSE</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>r</span></span><span class="main"><span>,</span></span><span>all_tac</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
        </span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>st</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
      </span><span class="entity"><span>r</span></span><span> </span><span class="entity"><span>st</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>COND''</span></span><span> </span><span class="entity"><span>cond</span></span><span> </span><span class="entity"><span>tac1</span></span><span> </span><span class="entity"><span>tac2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>IF_EXGOAL</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>st</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> 
      </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>cond</span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="entity"><span>st</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span class="entity"><span>tac1</span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="entity"><span>st</span></span><span> </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="entity"><span>tac2</span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="entity"><span>st</span></span><span>
    </span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>REPEAT_ON_SUBGOAL</span></span><span> </span><span class="entity"><span>tac</span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>REPEAT_INTERVAL</span></span><span> </span><span class="entity"><span>tac</span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="entity"><span>i</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>IF_SOLVED</span></span><span> </span><span class="entity"><span>tac</span></span><span> </span><span class="entity"><span>tac1</span></span><span> </span><span class="entity"><span>tac2</span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="entity"><span>st</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Thm.nprems_of</span><span> </span><span class="entity"><span>st</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
      </span><span class="main"><span>(</span></span><span class="entity"><span>tac</span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span>THEN</span><span> </span><span>COND</span><span> </span><span class="main"><span>(</span></span><span>has_fewer_prems</span><span> </span><span class="entity"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>tac1</span></span><span> </span><span class="entity"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>tac2</span></span><span> </span><span class="entity"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>st</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>


  </span><span class="keyword1"><span class="keyword"><span>signature</span></span></span><span> </span><span class="entity"><span>AUTOREF_TRANSLATE</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>sig</span></span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>type</span></span></span><span> </span><span class="entity"><span>trans_net</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span>int</span><span> * </span><span>thm</span><span class="main"><span>)</span></span><span> </span><span>Net.net</span><span>

    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> add_post_rule</span><span class="main"><span>:</span></span><span> </span><span>thm</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>Context.generic</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>Context.generic</span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> delete_post_rule</span><span class="main"><span>:</span></span><span> </span><span>thm</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>Context.generic</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>Context.generic</span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> get_post_rules</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>Proof.context</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>thm</span><span> </span><span>list</span><span>

    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> compute_trans_net</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>Autoref_Fix_Rel.thm_pairs</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span class="entity"><span>Proof.context</span></span><span>
      </span><span class="main"><span>-&gt;</span></span><span> </span><span class="entity"><span>trans_net</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> side_tac</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>Proof.context</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span class="entity"><span>tactic'</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> side_dbg_tac</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>Proof.context</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span class="entity"><span>tactic'</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> trans_step_only_tac</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>Proof.context</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span class="entity"><span>tactic'</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> trans_dbg_step_tac</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>Proof.context</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span class="entity"><span>tactic'</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> trans_step_tac</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>Proof.context</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span class="entity"><span>tactic'</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> trans_tac</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>Proof.context</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span class="entity"><span>itactic</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> trans_analyze</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>Proof.context</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>int</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>int</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>thm</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>bool</span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> trans_pretty_failure</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>Proof.context</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>int</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>int</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>thm</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>Pretty.T</span><span>

    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> trans_phase</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>Autoref_Phases.phase</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> setup</span><span class="main"><span>:</span></span><span> </span><span>theory</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>theory</span><span>
  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>


  </span><span class="keyword1"><span class="keyword"><span>structure</span></span></span><span> </span><span class="entity"><span>Autoref_Translate</span></span><span> </span><span class="main"><span>:</span></span><span class="entity"><span>AUTOREF_TRANSLATE</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>struct</span></span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>type</span></span></span><span> </span><span class="entity"><span>trans_net</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span>int</span><span> * </span><span>thm</span><span class="main"><span>)</span></span><span> </span><span>Net.net</span><span>


    </span><span class="comment1"><span>(**************************)</span></span><span>
    </span><span class="comment1"><span>(*       Translation      *)</span></span><span>
    </span><span class="comment1"><span>(**************************)</span></span><span>
    
    </span><span class="keyword1"><span class="keyword"><span>structure</span></span></span><span> </span><span class="entity"><span>autoref_post_simps</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Named_Thms</span></span><span> </span><span class="main"><span>(</span></span><span> 
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>binding</span></span><span> </span><span class="entity_def" id="Autoref_Translate.autoref_post_simps|attribute"><span class="entity_def" id="Autoref_Translate.autoref_post_simps|fact"><span>autoref_post_simps</span></span></span><span class="antiquote"><span>}</span></span></span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>description</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"Refinement Framework: "</span></span><span> </span><span>^</span><span>
          </span><span class="inner_quoted"><span>"Automatic refinement post simplification rules"</span></span><span> 
    </span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>add_post_rule</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>autoref_post_simps.add_thm</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>delete_post_rule</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>autoref_post_simps.del_thm</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>get_post_rules</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>autoref_post_simps.get</span></span><span>


    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>compute_trans_net</span></span><span> </span><span class="entity"><span>thm_pairs</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> 
      </span><span class="entity"><span>thm_pairs</span></span><span>
      </span><span>|&gt;</span><span> </span><span>map</span><span> </span><span class="main"><span>#</span></span><span class="inner_numeral"><span>2</span></span><span>
      </span><span>|&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span>@</span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="Autoref_Translate.html#Autoref_Translate.dflt_trans_rules|fact"><span>dflt_trans_rules</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span>
      </span><span>|&gt;</span><span> </span><span>Tactic.build_net</span><span> 

    </span><span class="keyword1"><span class="keyword"><span>structure</span></span></span><span> </span><span class="entity"><span>trans_netD</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Autoref_Data</span></span><span> </span><span class="main"><span>(</span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>type</span></span></span><span> </span><span class="entity"><span>T</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>trans_net</span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>compute</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span> 
        </span><span class="entity"><span>compute_trans_net</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Autoref_Fix_Rel.thm_pairsD_get</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>prereq</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>Autoref_Fix_Rel.thm_pairsD_init</span></span><span class="main"><span>]</span></span><span>
    </span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>REMOVE_INTERNAL_conv</span></span><span> </span><span class="main"><span>=</span></span><span> 
      </span><span>Conv.top_sweep_conv</span><span> </span><span class="main"><span>(</span></span><span>
        </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>ct</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span>Thm.term_of</span><span> </span><span class="entity"><span>ct</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
          </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>mpat</span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="Autoref_Translate.html#Autoref_Translate.REMOVE_INTERNAL|const"><span>REMOVE_INTERNAL</span></a><span> </span><span class="main"><span>_</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> </span><span class="main"><span>=&gt;</span></span><span> 
            </span><span>Conv.rewr_conv</span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="Autoref_Translate.html#Autoref_Translate.REMOVE_INTERNAL_def|fact"><span>REMOVE_INTERNAL_def</span></a><span class="antiquote"><span>}</span></span></span></span><span>
            </span><span>then_conv</span><span> </span><span class="entity"><span>Autoref_Tagging.untag_conv</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
          </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>Conv.no_conv</span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>ct</span></span><span>
      </span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>REMOVE_INTERNAL_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>CONVERSION</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>REMOVE_INTERNAL_conv</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>side_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="Autoref_Fix_Rel.html#Autoref_Fix_Rel.SIDEI|fact"><span>SIDEI</span></a><span class="antiquote"><span>}</span></span></span></span><span>
      </span><span>THEN'</span><span> </span><span class="entity"><span>REMOVE_INTERNAL_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
      </span><span>THEN'</span><span> </span><span class="entity"><span>Tagged_Solver.solve_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>side_dbg_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Config.put</span><span> </span><span class="entity"><span>Tagged_Solver.cfg_keep</span></span><span> </span><span>true</span><span> </span><span class="entity"><span>ctxt</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
      </span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="Autoref_Fix_Rel.html#Autoref_Fix_Rel.SIDEI|fact"><span>SIDEI</span></a><span class="antiquote"><span>}</span></span></span></span><span>
      </span><span>THEN'</span><span> </span><span class="entity"><span>REMOVE_INTERNAL_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
      </span><span>THEN'</span><span> </span><span>TRY</span><span> </span><span>o</span><span> </span><span class="entity"><span>Tagged_Solver.solve_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

    </span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>
      </span><span class="keyword3"><span class="keyword"><span>open</span></span></span><span> </span><span class="entity"><span>Autoref_Tacticals</span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>trans_rule_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>net</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>resolve_from_net_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>net</span></span><span>
        </span><span>THEN_ALL_NEW</span><span> </span><span class="main"><span>(</span></span><span>TRY</span><span> </span><span>o</span><span> </span><span>match_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="Autoref_Fix_Rel.html#Autoref_Fix_Rel.PRIO_TAGI|fact"><span>PRIO_TAGI</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>

    </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
      </span><span class="comment1"><span>(* Do not even attempt to solve side conditions *)</span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>trans_step_only_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
        </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>net</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>trans_netD.get</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
        </span><span class="main"><span>(</span></span><span>
          </span><span class="entity"><span>COND''</span></span><span> </span><span class="entity"><span>is_defer_cond</span></span><span> 
            </span><span class="main"><span>(</span></span><span>K</span><span> </span><span>no_tac</span><span class="main"><span>)</span></span><span>
            </span><span class="main"><span>(</span></span><span>assume_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span>ORELSE'</span><span> </span><span class="entity"><span>trans_rule_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>net</span></span><span class="main"><span>)</span></span><span>
        </span><span class="main"><span>)</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

      </span><span class="comment1"><span>(* Leave unsolved side conditions *)</span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>trans_dbg_step_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
        </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>net</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>trans_netD.get</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
        </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>s_tac</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>side_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span>DETERM</span><span> </span><span>o</span><span> </span><span class="main"><span>(</span></span><span>
        </span><span class="entity"><span>COND''</span></span><span> </span><span class="entity"><span>is_defer_cond</span></span><span> 
          </span><span class="main"><span>(</span></span><span>SOLVED'</span><span> </span><span class="entity"><span>s_tac</span></span><span class="main"><span>)</span></span><span>
          </span><span class="main"><span>(</span></span><span>
            </span><span>assume_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span>
            </span><span>ORELSE'</span><span>
            </span><span class="main"><span>(</span></span><span class="entity"><span>trans_rule_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>net</span></span><span> 
              </span><span class="entity"><span>THEN_ALL_NEW_FWD</span></span><span> 
                </span><span class="entity"><span>COND''</span></span><span> </span><span class="entity"><span>is_prefer_cond</span></span><span>
                  </span><span class="main"><span>(</span></span><span>TRY</span><span> </span><span>o</span><span> </span><span>DETERM</span><span> </span><span>o</span><span> </span><span>SOLVED'</span><span> </span><span class="entity"><span>s_tac</span></span><span class="main"><span>)</span></span><span>
                  </span><span class="main"><span>(</span></span><span>K</span><span> </span><span>all_tac</span><span class="main"><span>)</span></span><span>
            </span><span class="main"><span>)</span></span><span>
          </span><span class="main"><span>)</span></span><span>
        </span><span class="main"><span>)</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

      </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>trans_step_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
        </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>net</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>trans_netD.get</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
        </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>s_tac</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>side_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span>DETERM</span><span> </span><span>o</span><span> </span><span class="main"><span>(</span></span><span>
        </span><span class="entity"><span>COND''</span></span><span> </span><span class="entity"><span>is_defer_cond</span></span><span> 
          </span><span class="main"><span>(</span></span><span>SOLVED'</span><span> </span><span class="entity"><span>s_tac</span></span><span class="main"><span>)</span></span><span>
          </span><span class="main"><span>(</span></span><span>
            </span><span>assume_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span>
            </span><span>ORELSE'</span><span>
            </span><span class="main"><span>(</span></span><span class="entity"><span>trans_rule_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>net</span></span><span> 
              </span><span class="entity"><span>THEN_ALL_NEW_FWD</span></span><span> 
                </span><span class="entity"><span>COND''</span></span><span> </span><span class="entity"><span>is_prefer_cond</span></span><span>
                  </span><span class="main"><span>(</span></span><span>DETERM</span><span> </span><span>o</span><span> </span><span>SOLVED'</span><span> </span><span class="entity"><span>s_tac</span></span><span class="main"><span>)</span></span><span>
                  </span><span class="main"><span>(</span></span><span>K</span><span> </span><span>all_tac</span><span class="main"><span>)</span></span><span>
            </span><span class="main"><span>)</span></span><span>
          </span><span class="main"><span>)</span></span><span>
        </span><span class="main"><span>)</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

      </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>trans_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
        </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>ss</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>put_simpset</span><span> </span><span class="entity"><span>HOL_basic_ss</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
          </span><span>addsimps</span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.APP_def|fact"><span>APP_def</span></a><span> </span><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.PROTECT_def|fact"><span>PROTECT_def</span></a><span> </span><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.ANNOT_def|fact"><span>ANNOT_def</span></a><span class="antiquote"><span>}</span></span></span></span><span>
          </span><span>addsimps</span><span> </span><span class="entity"><span>get_post_rules</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
        </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>trans_opt_tac</span></span><span> </span><span class="main"><span>=</span></span><span> 
          </span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="Autoref_Translate.html#Autoref_Translate.autoref_REMOVE_INTERNAL_EQ|fact"><span>autoref_REMOVE_INTERNAL_EQ</span></a><span class="antiquote"><span>}</span></span></span></span><span> 
          </span><span>THEN'</span><span> 
          </span><span class="entity"><span>IF_SOLVED</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>REPEAT_ON_SUBGOAL</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>trans_step_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
            </span><span class="main"><span>(</span></span><span class="entity"><span>simp_tac</span></span><span> </span><span class="entity"><span>ss</span></span><span> </span><span>THEN'</span><span> </span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="Autoref_Translate.html#Autoref_Translate.REMOVE_INTERNAL_EQI|fact"><span>REMOVE_INTERNAL_EQI</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span>
            </span><span class="main"><span>(</span></span><span>K</span><span> </span><span>all_tac</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
        </span><span>Seq.INTERVAL</span><span> </span><span class="entity"><span>trans_opt_tac</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

    </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>trans_analyze</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="entity"><span>j</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>j</span></span><span> </span><span>&lt;</span><span> </span><span class="entity"><span>i</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>trans_pretty_failure</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="entity"><span>j</span></span><span> </span><span class="entity"><span>st</span></span><span> </span><span class="main"><span>=</span></span><span> 
      </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>j</span></span><span> </span><span>&lt;</span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span>Pretty.str</span><span> </span><span class="inner_quoted"><span>"No failure"</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
        </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>goal</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Logic.get_goal</span><span> </span><span class="main"><span>(</span></span><span>Thm.prop_of</span><span> </span><span class="entity"><span>st</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>i</span></span><span>
        </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>concl</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>strip_all_body</span><span> </span><span class="entity"><span>goal</span></span><span> </span><span>|&gt;</span><span> </span><span>Logic.strip_imp_concl</span><span>

        </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>msg</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span class="entity"><span>concl</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
          </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>mpat</span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Trueprop|const"><span>Trueprop</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Autoref_Fix_Rel.html#Autoref_Fix_Rel.DEFER_tag|const"><span>DEFER_tag</span></a><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> 
            </span><span class="main"><span>=&gt;</span></span><span> </span><span>Pretty.str</span><span> </span><span class="inner_quoted"><span>"Could not solve defered side condition"</span></span><span>
        </span><span class="main"><span>|</span></span><span> </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>mpat</span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Trueprop|const"><span>Trueprop</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>_</span></span><span class="main"><span>,</span></span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> 
            </span><span class="main"><span>=&gt;</span></span><span> </span><span>Pretty.str</span><span> </span><span class="inner_quoted"><span>"Could not refine subterm"</span></span><span>
        </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>Pretty.str</span><span> </span><span class="inner_quoted"><span>"Internal: Unexpected goal"</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> 
        </span><span>Pretty.block</span><span> </span><span class="main"><span>[</span></span><span>
          </span><span class="entity"><span>msg</span></span><span class="main"><span>,</span></span><span>
          </span><span>Pretty.fbrk</span><span class="main"><span>,</span></span><span>
          </span><span>Syntax.pretty_term</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>goal</span></span><span>
        </span><span class="main"><span>]</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>trans_phase</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{</span></span><span>
      init </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>trans_netD.init</span></span><span class="main"><span>,</span></span><span>
      tac </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>trans_tac</span></span><span class="main"><span>,</span></span><span>
      analyze </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>trans_analyze</span></span><span class="main"><span>,</span></span><span>
      pretty_failure </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>trans_pretty_failure</span></span><span>
    </span><span class="main"><span>}</span></span><span>


    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>setup</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>I</span><span>
      </span><span>#&gt;</span><span> </span><span class="entity"><span>autoref_post_simps.setup</span></span><span> 

  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
›</span></span><span>

</span><span class="keyword1"><span class="command"><span>setup</span></span></span><span> </span><span class="entity"><span>Autoref_Translate.setup</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Standard side-tactics›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Preconditions›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Autoref_Translate.PRECOND_tag_def|fact"><span class="entity_def" id="Autoref_Translate.PRECOND_tag_def|thm"><span class="entity_def" id="Autoref_Translate.PRECOND_tag_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.autoref_tag_defs|attribute"><span class="operator"><span>autoref_tag_defs</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Autoref_Translate.PRECOND_tag|const"><span>PRECOND_tag</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>P</span></span></span></span><span> </span><span class="main"><span>==</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>P</span></span></span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Autoref_Translate.PRECOND_tagI|fact"><span class="entity_def" id="Autoref_Translate.PRECOND_tagI|thm"><span>PRECOND_tagI</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>P</span></span><span> </span><span class="main"><span>==&gt;</span></span><span> </span><a class="entity_ref" href="Autoref_Translate.html#Autoref_Translate.PRECOND_tag|const"><span>PRECOND_tag</span></a><span> </span><span class="free"><span>P</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>abbreviation</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Autoref_Translate.SIDE_PRECOND|const"><span>SIDE_PRECOND</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>P</span></span></span></span><span> </span><span class="main"><span>==</span></span><span> </span><a class="entity_ref" href="Autoref_Translate.html#Autoref_Translate.PREFER|const"><span>PREFER</span></a><span> </span><a class="entity_ref" href="Autoref_Translate.html#Autoref_Translate.PRECOND_tag|const"><span>PRECOND_tag</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>P</span></span></span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>declaration</span></span></span><span> </span><span class="quoted"><span>‹
  </span><span class="entity"><span>Tagged_Solver.declare_solver</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="Autoref_Translate.html#Autoref_Translate.PRECOND_tagI|fact"><span>PRECOND_tagI</span></a><span class="antiquote"><span>}</span></span></span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>binding</span></span><span> PRECOND</span><span class="antiquote"><span>}</span></span></span></span><span> 
    </span><span class="inner_quoted"><span>"Refinement: Solve preconditions"</span></span><span> 
    </span><span class="main"><span>(</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>SOLVED'</span><span> </span><span class="main"><span>(</span></span><span>
        </span><span>SELECT_GOAL</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>auto_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>)</span></span><span>
›</span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Optional preconditions›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Autoref_Translate.PRECOND_OPT_tag_def|fact"><span class="entity_def" id="Autoref_Translate.PRECOND_OPT_tag_def|thm"><span class="entity_def" id="Autoref_Translate.PRECOND_OPT_tag_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Autoref_Tagging.html#Autoref_Tagging.autoref_tag_defs|attribute"><span class="operator"><span>autoref_tag_defs</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Autoref_Translate.PRECOND_OPT_tag|const"><span>PRECOND_OPT_tag</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>P</span></span></span></span><span> </span><span class="main"><span>==</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>P</span></span></span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Autoref_Translate.PRECOND_OPT_tagI|fact"><span class="entity_def" id="Autoref_Translate.PRECOND_OPT_tagI|thm"><span>PRECOND_OPT_tagI</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>P</span></span><span> </span><span class="main"><span>==&gt;</span></span><span> </span><a class="entity_ref" href="Autoref_Translate.html#Autoref_Translate.PRECOND_OPT_tag|const"><span>PRECOND_OPT_tag</span></a><span> </span><span class="free"><span>P</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>abbreviation</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Autoref_Translate.SIDE_PRECOND_OPT|const"><span>SIDE_PRECOND_OPT</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>P</span></span></span></span><span> </span><span class="main"><span>==</span></span><span> </span><a class="entity_ref" href="Autoref_Translate.html#Autoref_Translate.PREFER|const"><span>PREFER</span></a><span> </span><a class="entity_ref" href="Autoref_Translate.html#Autoref_Translate.PRECOND_OPT_tag|const"><span>PRECOND_OPT_tag</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>P</span></span></span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>declaration</span></span></span><span> </span><span class="quoted"><span>‹
  </span><span class="entity"><span>Tagged_Solver.declare_solver</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="Autoref_Translate.html#Autoref_Translate.PRECOND_OPT_tagI|fact"><span>PRECOND_OPT_tagI</span></a><span class="antiquote"><span>}</span></span></span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>binding</span></span><span> PRECOND_OPT</span><span class="antiquote"><span>}</span></span></span></span><span> 
    </span><span class="inner_quoted"><span>"Refinement: Solve optional preconditions"</span></span><span> 
    </span><span class="main"><span>(</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>SOLVED'</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>asm_full_simp_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
›</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span></pre>
</body>

</html>