<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Refine_Pfun</title>
</head>


<body>
<div class="head">
<h1>Theory Refine_Pfun</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Partial Function Package Setup›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><a href="Refine_Pfun.html"><span>Refine_Pfun</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> </span><a href="Refine_Basic.html"><span>Refine_Basic</span></a><span> </span><a href="Refine_Det.html"><span>Refine_Det</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
  In this theory, we set up the partial function package to be used 
  with our refinement framework.
›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Nondeterministic Result Monad›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Refine_Pfun.nrec.const_mono|fact"><span class="entity_def" id="Refine_Pfun.nrec.fixp_induct_uc|fact"><span class="entity_def" id="Refine_Pfun.nrec.fixp_rule_uc|fact"><span class="entity_def" id="Refine_Pfun.nrec.mono_body_fixp|fact"><span class="entity_def" id="Refine_Pfun.nrec.ccpo|fact"><span class="entity_def" id="Refine_Pfun.nrec.lub_least|fact"><span class="entity_def" id="Refine_Pfun.nrec.lub_upper|fact"><span class="entity_def" id="Refine_Pfun.nrec.leq_antisym|fact"><span class="entity_def" id="Refine_Pfun.nrec.leq_trans|fact"><span class="entity_def" id="Refine_Pfun.nrec.leq_refl|fact"><span class="entity_def" id="Refine_Pfun.nrec.partial_function_definitions_axioms|fact"><span class="entity_def" id="Refine_Pfun.nrec.mono_body_fixp|thm"><span class="entity_def" id="Refine_Pfun.nrec.ccpo|thm"><span class="entity_def" id="Refine_Pfun.nrec.lub_least|thm"><span class="entity_def" id="Refine_Pfun.nrec.lub_upper|thm"><span class="entity_def" id="Refine_Pfun.nrec.leq_antisym|thm"><span class="entity_def" id="Refine_Pfun.nrec.leq_trans|thm"><span class="entity_def" id="Refine_Pfun.nrec.leq_refl|thm"><span class="entity_def" id="Refine_Pfun.nrec.fixp_induct_uc|thm"><span class="entity_def" id="Refine_Pfun.nrec.fixp_rule_uc|thm"><span class="entity_def" id="Refine_Pfun.nrec.const_mono|thm"><span class="entity_def" id="Refine_Pfun.nrec.partial_function_definitions_axioms|thm"><span class="entity_def" id="Refine_Pfun.nrec.admissible|const"><span class="entity_def" id="Refine_Pfun.nrec.mono_body|const"><span class="entity_def" id="Refine_Pfun.nrec.fixp_fun|const"><span class="entity_def" id="Refine_Pfun.nrec.lub_fun|const"><span class="entity_def" id="Refine_Pfun.nrec.le_fun|const"><span>interpretation</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> nrec</span><span class="main"><span>:</span></span><span>
  </span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.partial_function_definitions|locale"><span>partial_function_definitions</span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>(≤)</span></a></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Complete_Lattices.html#Complete_Lattices.Sup_class.Sup|const"><span>Sup</span></a><span class="main"><span>::</span></span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres|type"><span>nres</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres|type"><span>nres</span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>unfold_locales</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Complete_Lattices.html#Complete_Lattices.complete_lattice_class.Sup_upper|fact"><span>Sup_upper</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Complete_Lattices.html#Complete_Lattices.complete_lattice_class.Sup_least|fact"><span>Sup_least</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_Pfun.nrec_admissible|fact"><span class="entity_def" id="Refine_Pfun.nrec_admissible|thm"><span>nrec_admissible</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Pfun.html#Refine_Pfun.nrec.admissible|const"><span>nrec.admissible</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>f</span></span><span class="main"><span>::</span></span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'b</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres|type"><span>nres</span></a><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span>
  </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>x0</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="bound"><span>f</span></span><span> </span><span class="bound"><span>x0</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x0</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Complete_Partial_Order.html#Complete_Partial_Order.ccpo.admissibleI|fact"><span>ccpo.admissibleI</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>unfold</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_lub_def|fact"><span>fun_lub_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.allI|fact"><span>allI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.impI|fact"><span>impI</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Complete_Lattices.html#Complete_Lattices.complete_lattice_class.Sup_least|fact"><span>Sup_least</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

</span><span class="comment1"><span>(*thm fixp_induct_option

lemma fixp_induct_nrec:
  fixes F :: "'c ⇒ 'c" and
    U :: "'c ⇒ 'b ⇒ 'a nres" and
    C :: "('b ⇒ 'a nres) ⇒ 'c" and
    P :: "'b ⇒ 'a ⇒ bool"
  assumes mono: "⋀x. nrec.mono_body (λf. U (F (C f)) x)"                       
  assumes eq: "f ≡ C (nrec.fixp_fun (λf. U (F (C f))))"
  assumes inverse2: "⋀f. U (C f) = f"
  assumes step: "⋀f x z. (⋀x. U f x = U f x; Q x z) ⟹ Q (U (F (C f))) z"
 (* assumes defined: "RETURN y ≤ U (C f) x"*)
  assumes Q: "⋀x z. Q x z ⟷ z = U f x ∧ U f x ≤ SPEC (P x)"
  shows "Q x z" oops
  (*using step defined
    nrec.fixp_induct_uc[of U F C, OF mono eq inverse2 nrec_admissible]
  unfolding Q oops (*
  by blast*)*)

lemma fixp_induct_nrec':
  fixes F :: "'c ⇒ 'c" and
    U :: "'c ⇒ 'b ⇒ 'a nres" and
    C :: "('b ⇒ 'a nres) ⇒ 'c" and
    P :: "'b ⇒ 'a ⇒ bool"
  assumes mono: "⋀x. nrec_mono (λf. U (F (C f)) x)"
  assumes eq: "f ≡ C (nrec_ffix (λf. U (F (C f))))"
  assumes inverse2: "⋀f. U (C f) = f"
  assumes step: "⋀f x0. (⋀x0. U f x0 ≤ SPEC (P x0)) 
    ⟹ U (F f) x0 ≤ SPEC (P x0)"
  assumes defined: "RETURN y ≤ U f x"
  shows "P x y"
proof -
  note defined
  also have "∀x0. U f x0 ≤ SPEC (P x0)"
    apply (rule nrec.fixp_induct_uc[of U F C, OF mono eq inverse2 
      nrec_admissible])
    using step by blast
  hence "U f x ≤ SPEC (P x)" by simp
  finally show "P x y" by auto
qed
*)</span></span><span>    
</span><span class="comment1"><span>(* TODO/FIXME: Induction rule seems not to work here ! 
    Function package expects induction rule where conclusion is a binary 
    predicate as free variable.
*)</span></span><span>

</span><span class="keyword1"><span class="command"><span>declaration</span></span></span><span> </span><span class="quoted"><span>‹</span><span class="entity"><span>Partial_Function.init</span></span><span> </span><span class="inner_quoted"><span>"nrec"</span></span><span> </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><a class="entity_ref" href="Refine_Pfun.html#Refine_Pfun.nrec.fixp_fun|const"><span>nrec.fixp_fun</span></a></span><span class="antiquote"><span>}</span></span></span><span>
  </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><a class="entity_ref" href="Refine_Pfun.html#Refine_Pfun.nrec.mono_body|const"><span>nrec.mono_body</span></a></span><span class="antiquote"><span>}</span></span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="Refine_Pfun.html#Refine_Pfun.nrec.fixp_rule_uc|fact"><span>nrec.fixp_rule_uc</span></a><span class="antiquote"><span>}</span></span></span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="Refine_Pfun.html#Refine_Pfun.nrec.fixp_induct_uc|fact"><span>nrec.fixp_induct_uc</span></a><span class="antiquote"><span>}</span></span></span></span><span>
  </span><span class="comment1"><span>(*SOME @{thm fixp_induct_nrec}*)</span></span><span> </span><span class="main"><span>(</span></span><span>NONE</span><span class="main"><span>)</span></span><span>›</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_Pfun.bind_mono_pfun|fact"><span class="entity_def" id="Refine_Pfun.bind_mono_pfun|thm"><span>bind_mono_pfun</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.partial_function_mono|attribute"><span class="operator"><span>partial_function_mono</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>C</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'b</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'c</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres|type"><span>nres</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'d</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres|type"><span>nres</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.monotone|const"><span>monotone</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_ord|const"><span>fun_ord</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>(≤)</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>(≤)</span></a></span><span> </span><span class="free"><span>B</span></span><span class="main"><span>;</span></span><span> 
    </span><span class="main"><span>⋀</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.monotone|const"><span>monotone</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_ord|const"><span>fun_ord</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>(≤)</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>(≤)</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>f</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>C</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> 
     </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.monotone|const"><span>monotone</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_ord|const"><span>fun_ord</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>(≤)</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>(≤)</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>f</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.bind|const"><span>bind</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>B</span></span><span> </span><span class="bound"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>C</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>f</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.bind_mono|fact"><span>Refine_Basic.bind_mono</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.monotoneD|fact"><span>monotoneD</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>


</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Deterministic Result Monad›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Refine_Pfun.drec.const_mono|fact"><span class="entity_def" id="Refine_Pfun.drec.fixp_induct_uc|fact"><span class="entity_def" id="Refine_Pfun.drec.fixp_rule_uc|fact"><span class="entity_def" id="Refine_Pfun.drec.mono_body_fixp|fact"><span class="entity_def" id="Refine_Pfun.drec.ccpo|fact"><span class="entity_def" id="Refine_Pfun.drec.lub_least|fact"><span class="entity_def" id="Refine_Pfun.drec.lub_upper|fact"><span class="entity_def" id="Refine_Pfun.drec.leq_antisym|fact"><span class="entity_def" id="Refine_Pfun.drec.leq_trans|fact"><span class="entity_def" id="Refine_Pfun.drec.leq_refl|fact"><span class="entity_def" id="Refine_Pfun.drec.partial_function_definitions_axioms|fact"><span class="entity_def" id="Refine_Pfun.drec.mono_body_fixp|thm"><span class="entity_def" id="Refine_Pfun.drec.ccpo|thm"><span class="entity_def" id="Refine_Pfun.drec.lub_least|thm"><span class="entity_def" id="Refine_Pfun.drec.lub_upper|thm"><span class="entity_def" id="Refine_Pfun.drec.leq_antisym|thm"><span class="entity_def" id="Refine_Pfun.drec.leq_trans|thm"><span class="entity_def" id="Refine_Pfun.drec.leq_refl|thm"><span class="entity_def" id="Refine_Pfun.drec.fixp_induct_uc|thm"><span class="entity_def" id="Refine_Pfun.drec.fixp_rule_uc|thm"><span class="entity_def" id="Refine_Pfun.drec.const_mono|thm"><span class="entity_def" id="Refine_Pfun.drec.partial_function_definitions_axioms|thm"><span class="entity_def" id="Refine_Pfun.drec.admissible|const"><span class="entity_def" id="Refine_Pfun.drec.mono_body|const"><span class="entity_def" id="Refine_Pfun.drec.fixp_fun|const"><span class="entity_def" id="Refine_Pfun.drec.lub_fun|const"><span class="entity_def" id="Refine_Pfun.drec.le_fun|const"><span>interpretation</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> drec</span><span class="main"><span>:</span></span><span>
  </span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.partial_function_definitions|locale"><span>partial_function_definitions</span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>(≤)</span></a></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Complete_Lattices.html#Complete_Lattices.Sup_class.Sup|const"><span>Sup</span></a><span class="main"><span>::</span></span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="Refine_Det.html#Refine_Det.dres|type"><span>dres</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="Refine_Det.html#Refine_Det.dres|type"><span>dres</span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>unfold_locales</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Complete_Lattices.html#Complete_Lattices.complete_lattice_class.Sup_upper|fact"><span>Sup_upper</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Complete_Lattices.html#Complete_Lattices.complete_lattice_class.Sup_least|fact"><span>Sup_least</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_Pfun.drec_admissible|fact"><span class="entity_def" id="Refine_Pfun.drec_admissible|thm"><span>drec_admissible</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Pfun.html#Refine_Pfun.drec.admissible|const"><span>drec.admissible</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>f</span></span><span class="main"><span>::</span></span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'b</span></span><span> </span><a class="entity_ref" href="Refine_Det.html#Refine_Det.dres|type"><span>dres</span></a><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span>
  </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> 
    </span><span class="main"><span>(</span></span><span class="bound"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span> </span><a class="entity_ref" href="Refine_Det.html#Refine_Det.dFAIL|const"><span>dFAIL</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> 
    </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>r</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="bound"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Refine_Det.html#Refine_Det.dres.dRETURN|const"><span>dRETURN</span></a><span> </span><span class="bound"><span>r</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_ord|const"><span>fun_ord</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>(≤)</span></a></span><span> </span><span class="main"><span>::</span></span><span class="tfree"><span>'b</span></span><span> </span><a class="entity_ref" href="Refine_Det.html#Refine_Det.dres|type"><span>dres</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>(≤)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.ext|fact"><span>ext</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_ord_def|fact"><span>fun_ord_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.le_fun_def|fact"><span>le_fun_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.refl|fact"><span>refl</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>A</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>∃</span></span><span class="bound"><span>f</span></span><span class="main"><span>∈</span></span><span class="bound"><span>A</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="bound"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>f</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span class="bound"><span>A</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Complete_Partial_Order.html#Complete_Partial_Order.ccpo.admissibleI|fact"><span>ccpo.admissibleI</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>unfold</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_lub_def|fact"><span>fun_lub_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>drule_tac</span></span><span> x</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="improper"><span>x</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>in</span></span></span></span><span> </span><a class="entity_ref" href="Refine_Misc.html#Refine_Misc.point_chainI|fact"><span>point_chainI</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>erule</span></span><span> </span><a class="entity_ref" href="Refine_Det.html#Refine_Det.dres_Sup_chain_cases|fact"><span>dres_Sup_chain_cases</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>poly_guards_query</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Complete_Lattices.html#Complete_Lattices.complete_lattice_class.SUP_bot_conv|fact"><span>SUP_bot_conv</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>poly_guards_query</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Complete_Lattices.html#Complete_Lattices.complete_lattice_class.SUP_bot_conv|fact"><span>SUP_bot_conv</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>declaration</span></span></span><span> </span><span class="quoted"><span>‹</span><span class="entity"><span>Partial_Function.init</span></span><span> </span><span class="inner_quoted"><span>"drec"</span></span><span> </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><a class="entity_ref" href="Refine_Pfun.html#Refine_Pfun.drec.fixp_fun|const"><span>drec.fixp_fun</span></a></span><span class="antiquote"><span>}</span></span></span><span>
  </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><a class="entity_ref" href="Refine_Pfun.html#Refine_Pfun.drec.mono_body|const"><span>drec.mono_body</span></a></span><span class="antiquote"><span>}</span></span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="Refine_Pfun.html#Refine_Pfun.drec.fixp_rule_uc|fact"><span>drec.fixp_rule_uc</span></a><span class="antiquote"><span>}</span></span></span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="Refine_Pfun.html#Refine_Pfun.drec.fixp_induct_uc|fact"><span>drec.fixp_induct_uc</span></a><span class="antiquote"><span>}</span></span></span></span><span> 
  </span><span>NONE</span><span>›</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_Pfun.drec_bind_mono_pfun|fact"><span class="entity_def" id="Refine_Pfun.drec_bind_mono_pfun|thm"><span>drec_bind_mono_pfun</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.partial_function_mono|attribute"><span class="operator"><span>partial_function_mono</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>C</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'b</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'c</span></span><span> </span><a class="entity_ref" href="Refine_Det.html#Refine_Det.dres|type"><span>dres</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'d</span></span><span> </span><a class="entity_ref" href="Refine_Det.html#Refine_Det.dres|type"><span>dres</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.monotone|const"><span>monotone</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_ord|const"><span>fun_ord</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>(≤)</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>(≤)</span></a></span><span> </span><span class="free"><span>B</span></span><span class="main"><span>;</span></span><span> 
    </span><span class="main"><span>⋀</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.monotone|const"><span>monotone</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_ord|const"><span>fun_ord</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>(≤)</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>(≤)</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>f</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>C</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> 
     </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.monotone|const"><span>monotone</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_ord|const"><span>fun_ord</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>(≤)</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>(≤)</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>f</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Refine_Det.html#Refine_Det.dbind|const"><span>dbind</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>B</span></span><span> </span><span class="bound"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>C</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>f</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_Det.html#Refine_Det.dbind_mono|fact"><span>dbind_mono</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.monotoneD|fact"><span>monotoneD</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span></pre>
</body>

</html>