<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Breadth_First_Search</title>
</head>


<body>
<div class="head">
<h1>Theory Breadth_First_Search</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Breadth First Search›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><a href="Breadth_First_Search.html"><span>Breadth_First_Search</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> </span><span class="quoted"><span>"</span><a href="Refine_Monadic.html"><span>../Refine_Monadic</span></a><span>"</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>
  
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
  This is a slightly modified version of Task~5 of our submission to
  the VSTTE 2011 verification competition 
  (</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>url</span></span><span> </span><a href="https://sites.google.com/site/vstte2012/compet"><span>"https://sites.google.com/site/vstte2012/compet"</span></a><span class="antiquote"><span>}</span></span></span><span>). The task was to
  formalize a breadth-first-search algorithm.
›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
  With Isabelle's locale-construct, we put ourselves into a context where 
  the </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>succ›</span></span></span><span>-function is fixed. 
  We assume finitely branching graphs here, as our
  foreach-construct is only defined for finite sets.
›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Breadth_First_Search.Graph.intro|fact"><span class="entity_def" id="Breadth_First_Search.Graph_def|fact"><span class="entity_def" id="Breadth_First_Search.Graph.intro|thm"><span class="entity_def" id="Breadth_First_Search.Graph_def|thm"><span class="entity_def" id="Breadth_First_Search.Graph_def|axiom"><span>locale</span></span></span></span></span></span></span></span><span> </span><span class="entity_def" id="Breadth_First_Search.Graph|locale"><span class="entity_def" id="Breadth_First_Search.Graph|const"><span>Graph</span></span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>succ</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'vertex</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'vertex</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.intro|attribute"><span class="operator"><span>intro</span></span></a><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>succ</span></span><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>


  </span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Distances in a Graph›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
    We start over by defining the basic notions of paths and shortest paths.
›</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹A path is expressed by the </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>dist›</span></span></span><span>-predicate. Intuitively,
    </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>dist v d v'›</span></span></span><span> means that there is a path of length </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>d›</span></span></span><span>
    between </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>v›</span></span></span><span> and </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>v'›</span></span></span><span>.

    The definition of the </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>dist›</span></span></span><span>-predicate is done inductively, i.e.,
    as the least solution of the following constraints:
›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Breadth_First_Search.Graph.dist.inducts|fact"><span class="entity_def" id="Breadth_First_Search.Graph.dist.simps|fact"><span class="entity_def" id="Breadth_First_Search.Graph.dist.induct|fact"><span class="entity_def" id="Breadth_First_Search.Graph.dist.cases|fact"><span class="entity_def" id="Breadth_First_Search.Graph.dist.intros|fact"><span class="entity_def" id="Breadth_First_Search.Graph.dist.inducts|thm"><span class="entity_def" id="Breadth_First_Search.Graph.dist.simps|thm"><span class="entity_def" id="Breadth_First_Search.Graph.dist.induct|thm"><span class="entity_def" id="Breadth_First_Search.Graph.dist.cases|thm"><span class="entity_def" id="Breadth_First_Search.Graph.dist.intros(2)|thm"><span class="entity_def" id="Breadth_First_Search.Graph.dist.intros(1)|thm"><span class="entity_def" id="Breadth_First_Search.Graph.dist_def|axiom"><span class="entity_def" id="offset_1077..1086">inductive</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Breadth_First_Search.Graph.dist.cong|fact"><span class="entity_def" id="Breadth_First_Search.Graph.dist.cong|thm"><span class="entity_def" id="Breadth_First_Search.Graph.dist|const"><span class="entity_def" id="offset_1087..1091">dist</span></span></span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'vertex</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'vertex</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
    </span><span class="entity_def" id="Breadth_First_Search.Graph.dist.dist_z|fact"><span class="entity_def" id="Breadth_First_Search.Graph.dist.dist_z|thm"><span class="entity_def" id="offset_1138..1144">dist_z</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>dist</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v</span></span></span></span><span>"</span></span></span><span> </span><span class="main"><span>|</span></span><span>
    </span><span class="entity_def" id="Breadth_First_Search.Graph.dist.dist_suc|fact"><span class="entity_def" id="Breadth_First_Search.Graph.dist.dist_suc|thm"><span class="entity_def" id="offset_1165..1173">dist_suc</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span class="free"><span>dist</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>vh</span></span></span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v'</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><span class="free"><span>succ</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>vh</span></span></span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>dist</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v</span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v'</span></span></span></span><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
    Next, we define a predicate that expresses that the shortest path between
    </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>v›</span></span></span><span> and </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>v'›</span></span></span><span> has length </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>d›</span></span></span><span>.
    This is the case if there is a path of length </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>d›</span></span></span><span>, but there
    is no shorter path.
›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Breadth_First_Search.Graph.min_dist_def|fact"><span class="entity_def" id="Breadth_First_Search.Graph.min_dist_def|thm"><span class="entity_def" id="Breadth_First_Search.Graph.min_dist_def_raw|axiom"><span class="entity_def" id="offset_1440..1450">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Breadth_First_Search.Graph.min_dist.cong|fact"><span class="entity_def" id="Breadth_First_Search.Graph.min_dist.cong|thm"><span class="entity_def" id="Breadth_First_Search.Graph.min_dist|const"><span class="entity_def" id="offset_1452..1460">min_dist</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v'</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.Least|const"><span>LEAST</span></a></span><span> </span><span class="bound"><span>d</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.Least|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1087..1091"><span>dist</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>v</span></span></span></span><span> </span><span class="bound"><span>d</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v'</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Breadth_First_Search.Graph.conn_def|fact"><span class="entity_def" id="Breadth_First_Search.Graph.conn_def|thm"><span class="entity_def" id="Breadth_First_Search.Graph.conn_def_raw|axiom"><span class="entity_def" id="offset_1494..1504">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Breadth_First_Search.Graph.conn.cong|fact"><span class="entity_def" id="Breadth_First_Search.Graph.conn.cong|thm"><span class="entity_def" id="Breadth_First_Search.Graph.conn|const"><span class="entity_def" id="offset_1506..1510">conn</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v'</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>d</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1087..1091"><span>dist</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>v</span></span></span></span><span> </span><span class="bound"><span>d</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v'</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Properties›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
    In this subsection, we prove some properties of paths.
›</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="entity_def" id="Breadth_First_Search.Graph.connI|fact"><span class="entity_def" id="Breadth_First_Search.Graph.connI|thm"><span class="entity_def" id="offset_1656..1661">connI</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.intro|attribute"><span class="operator"><span>intro</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Breadth_First_Search.html#offset_1087..1091"><span>dist</span></a><span> </span><span class="free"><span>v</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>v'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1506..1510"><span>conn</span></a><span> </span><span class="free"><span>v</span></span><span> </span><span class="free"><span>v'</span></span><span>"</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="Breadth_First_Search.Graph.connI_id|fact"><span class="entity_def" id="Breadth_First_Search.Graph.connI_id|thm"><span>connI_id</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.intro|attribute"><span class="operator"><span>intro</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Breadth_First_Search.html#offset_1506..1510"><span>conn</span></a><span> </span><span class="free"><span>v</span></span><span> </span><span class="free"><span>v</span></span><span>"</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="Breadth_First_Search.Graph.connI_succ|fact"><span class="entity_def" id="Breadth_First_Search.Graph.connI_succ|thm"><span class="entity_def" id="offset_1744..1754">connI_succ</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.intro|attribute"><span class="operator"><span>intro</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Breadth_First_Search.html#offset_1506..1510"><span>conn</span></a><span> </span><span class="free"><span>v</span></span><span> </span><span class="free"><span>v'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>v''</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><span class="free"><span>succ</span></span><span> </span><span class="free"><span>v'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1506..1510"><span>conn</span></a><span> </span><span class="free"><span>v</span></span><span> </span><span class="free"><span>v''</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1494..1504"><span>conn_def</span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1165..1173"><span>dist_suc</span></a><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1138..1144"><span>dist_z</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Breadth_First_Search.Graph.min_distI2|fact"><span class="entity_def" id="Breadth_First_Search.Graph.min_distI2|thm"><span class="entity_def" id="offset_1865..1875">min_distI2</span></span></span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1506..1510"><span>conn</span></a><span> </span><span class="free"><span>v</span></span><span> </span><span class="free"><span>v'</span></span><span> </span><span class="main"><span>;</span></span><span> </span><span class="main"><span>⋀</span></span><span class="bound"><span>d</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1087..1091"><span>dist</span></a><span> </span><span class="free"><span>v</span></span><span> </span><span class="bound"><span>d</span></span><span> </span><span class="free"><span>v'</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><span>⋀</span></span><span class="bound"><span>d'</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1087..1091"><span>dist</span></a><span> </span><span class="free"><span>v</span></span><span> </span><span class="bound"><span>d'</span></span><span> </span><span class="free"><span>v'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="bound"><span>d</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="bound"><span>d'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="bound"><span>d</span></span><span> </span><span class="main"><span>⟧</span></span><span> 
      </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Breadth_First_Search.html#offset_1452..1460"><span>min_dist</span></a><span> </span><span class="free"><span>v</span></span><span> </span><span class="free"><span>v'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1440..1450"><span>min_dist_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.wellorder_class.LeastI2_wellorder|fact"><span>LeastI2_wellorder</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> Q</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="free"><span>Q</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> a</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>SOME</span></span><span> </span><span class="bound"><span>d</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1087..1091"><span>dist</span></a><span> </span><span class="free"><span>v</span></span><span> </span><span class="bound"><span>d</span></span><span> </span><span class="free"><span>v'</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
       </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1494..1504"><span>conn_def</span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Hilbert_Choice.html#Hilbert_Choice.someI|fact"><span>someI</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Breadth_First_Search.Graph.min_distI_eq|fact"><span class="entity_def" id="Breadth_First_Search.Graph.min_distI_eq|thm"><span>min_distI_eq</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1087..1091"><span>dist</span></a><span> </span><span class="free"><span>v</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>v'</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><span>⋀</span></span><span class="bound"><span>d'</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1087..1091"><span>dist</span></a><span> </span><span class="free"><span>v</span></span><span> </span><span class="bound"><span>d'</span></span><span> </span><span class="free"><span>v'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="bound"><span>d'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1452..1460"><span>min_dist</span></a><span> </span><span class="free"><span>v</span></span><span> </span><span class="free"><span>v'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>d</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.force|method"><span class="operator"><span>force</span></span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1865..1875"><span>min_distI2</span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1494..1504"><span>conn_def</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Two nodes are connected by a path of length </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>0›</span></span></span><span>, 
    iff they are equal.›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Breadth_First_Search.Graph.dist_z_iff|fact"><span class="entity_def" id="Breadth_First_Search.Graph.dist_z_iff|thm"><span>dist_z_iff</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Breadth_First_Search.html#offset_1087..1091"><span>dist</span></a><span> </span><span class="free"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="free"><span>v'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="free"><span>v'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span>v</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>elim</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1077..1086"><span>dist.cases</span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1077..1086"><span>dist.intros</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹The same holds for </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>min_dist›</span></span></span><span>, i.e., 
    the shortest path between two nodes has length </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>0›</span></span></span><span>, 
    iff these nodes are equal.›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Breadth_First_Search.Graph.min_dist_z|fact"><span class="entity_def" id="Breadth_First_Search.Graph.min_dist_z|thm"><span>min_dist_z</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Breadth_First_Search.html#offset_1452..1460"><span>min_dist</span></a><span> </span><span class="free"><span>v</span></span><span> </span><span class="free"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1865..1875"><span>min_distI2</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1138..1144"><span>dist_z</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Breadth_First_Search.Graph.min_dist_z_iff|fact"><span class="entity_def" id="Breadth_First_Search.Graph.min_dist_z_iff|thm"><span class="entity_def" id="offset_2679..2693">min_dist_z_iff</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Breadth_First_Search.html#offset_1506..1510"><span>conn</span></a><span> </span><span class="free"><span>v</span></span><span> </span><span class="free"><span>v'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1452..1460"><span>min_dist</span></a><span> </span><span class="free"><span>v</span></span><span> </span><span class="free"><span>v'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="free"><span>v'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span>v</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1865..1875"><span>min_distI2</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1138..1144"><span>dist_z</span></a><span class="main"><span>)</span></span><span>
    
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Breadth_First_Search.Graph.min_dist_is_dist|fact"><span class="entity_def" id="Breadth_First_Search.Graph.min_dist_is_dist|thm"><span class="entity_def" id="offset_2800..2816">min_dist_is_dist</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Breadth_First_Search.html#offset_1506..1510"><span>conn</span></a><span> </span><span class="free"><span>v</span></span><span> </span><span class="free"><span>v'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1087..1091"><span>dist</span></a><span> </span><span class="free"><span>v</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Breadth_First_Search.html#offset_1452..1460"><span>min_dist</span></a><span> </span><span class="free"><span>v</span></span><span> </span><span class="free"><span>v'</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>v'</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1865..1875"><span>min_distI2</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Breadth_First_Search.Graph.min_dist_minD|fact"><span class="entity_def" id="Breadth_First_Search.Graph.min_dist_minD|thm"><span class="entity_def" id="offset_2898..2911">min_dist_minD</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Breadth_First_Search.html#offset_1087..1091"><span>dist</span></a><span> </span><span class="free"><span>v</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>v'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1452..1460"><span>min_dist</span></a><span> </span><span class="free"><span>v</span></span><span> </span><span class="free"><span>v'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>d</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1865..1875"><span>min_distI2</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹We also provide introduction and destruction rules for the
    pattern </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>min_dist v v' = Suc d›</span></span></span><span>.
›</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Breadth_First_Search.Graph.min_dist_succ|fact"><span class="entity_def" id="Breadth_First_Search.Graph.min_dist_succ|thm"><span class="entity_def" id="offset_3095..3108">min_dist_succ</span></span></span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1506..1510"><span>conn</span></a><span> </span><span class="free"><span>v</span></span><span> </span><span class="free"><span>v'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>v''</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><span class="free"><span>succ</span></span><span> </span><span class="free"><span>v'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1452..1460"><span>min_dist</span></a><span> </span><span class="free"><span>v</span></span><span> </span><span class="free"><span>v''</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Breadth_First_Search.html#offset_1452..1460"><span>min_dist</span></a><span> </span><span class="free"><span>v</span></span><span> </span><span class="free"><span>v'</span></span><span class="main"><span>)</span></span><span> "</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1865..1875"><span>min_distI2</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> v'</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="free"><span>v'</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
       </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>elim</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1077..1086"><span>dist.cases</span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_2898..2911"><span>min_dist_minD</span></a><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1165..1173"><span>dist_suc</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Breadth_First_Search.Graph.min_dist_suc|fact"><span class="entity_def" id="Breadth_First_Search.Graph.min_dist_suc|thm"><span class="entity_def" id="offset_3295..3307">min_dist_suc</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_3321..3322">c</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Breadth_First_Search.html#offset_1506..1510"><span>conn</span></a><span> </span><span class="free"><span>v</span></span><span> </span><span class="free"><span>v'</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Breadth_First_Search.html#offset_1452..1460"><span>min_dist</span></a><span> </span><span class="free"><span>v</span></span><span> </span><span class="free"><span>v'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="free"><span>d</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>v''</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1506..1510"><span>conn</span></a><span> </span><span class="free"><span>v</span></span><span> </span><span class="bound"><span>v''</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>v'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><span class="free"><span>succ</span></span><span> </span><span class="bound"><span>v''</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1452..1460"><span>min_dist</span></a><span> </span><span class="free"><span>v</span></span><span> </span><span class="bound"><span>v''</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>d</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_2800..2816"><span>min_dist_is_dist</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_3321..3322"><span>c</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>]</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Breadth_First_Search.html#offset_1452..1460"><span>min_dist</span></a><span> </span><span class="free"><span>v</span></span><span> </span><span class="free"><span>v'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="free"><span>d</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="var"><span>?thesis</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span>
      </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>dist_suc</span><span> </span><span class="skolem"><span>d'</span></span><span> </span><span class="skolem"><span>v''</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_3095..3108"><span>min_dist_succ</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="free"><span>v</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>v''</span></span></span><span> </span><span class="quoted"><span class="free"><span>v'</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_2898..2911"><span>min_dist_minD</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="free"><span>v</span></span></span><span> </span><span class="quoted"><span class="free"><span>d</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>v''</span></span></span><span class="main"><span>]</span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1656..1661"><span>connI</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_3321..3322"><span>c</span></a><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
    If there is a node with a shortest path of length </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>d›</span></span></span><span>, 
    then, for any </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>d'&lt;d›</span></span></span><span>, there is also a node with a shortest path
    of length </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>d'›</span></span></span><span>.
›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_3887..3892">lemma</span></span></span><span> </span><span class="entity_def" id="Breadth_First_Search.Graph.min_dist_less|fact"><span class="entity_def" id="Breadth_First_Search.Graph.min_dist_less|thm"><span class="entity_def" id="offset_3893..3906">min_dist_less</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Breadth_First_Search.html#offset_1506..1510"><span>conn</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="free"><span>v</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Breadth_First_Search.html#offset_1452..1460"><span>min_dist</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="free"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>d</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>d'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>d</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>v'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1506..1510"><span>conn</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="bound"><span>v'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1452..1460"><span>min_dist</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="bound"><span>v'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>d'</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_3887..3892"><span>assms</span></a><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.induct|method"><span class="operator"><span>induct</span></span></a><span> </span><span class="quoted"><span class="free"><span>d</span></span></span><span> </span><span class="quasi_keyword"><span>arbitrary</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="free"><span>v</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_3295..3307"><span>min_dist_suc</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="free"><span>src</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>v</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>d'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>d</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
    Lemma </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>min_dist_less›</span></span></span><span> can be weakened to </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>d'≤d›</span></span></span><span>.
›</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>corollary</span></span></span><span> </span><span class="entity_def" id="Breadth_First_Search.Graph.min_dist_le|fact"><span class="entity_def" id="Breadth_First_Search.Graph.min_dist_le|thm"><span class="entity_def" id="offset_4243..4254">min_dist_le</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_4268..4269">c</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Breadth_First_Search.html#offset_1506..1510"><span>conn</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="free"><span>v</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_4288..4290">d'</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>d'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1452..1460"><span>min_dist</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="free"><span>v</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>v'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1506..1510"><span>conn</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="bound"><span>v'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1452..1460"><span>min_dist</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="bound"><span>v'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>d'</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_3893..3906"><span>min_dist_less</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_4268..4269"><span>c</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Breadth_First_Search.html#offset_1452..1460"><span>min_dist</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="free"><span>v</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="free"><span>d'</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_4288..4290"><span>d'</span></a><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_4268..4269"><span>c</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.order_class.le_less|fact"><span>le_less</span></a><span class="main"><span>)</span></span><span>
  
  </span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Invariants›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
    In our framework, it is convenient to annotate the invariants and 
    auxiliary assertions into the program. Thus, we have to define the
    invariants first.
›</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
    The invariant for the outer loop is split into two parts:
    The first part already holds before 
    the </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>if C={}›</span></span></span><span> check, the second part only holds again 
    at the end of the loop body.
›</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
    The first part of the invariant, </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>bfs_invar'›</span></span></span><span>,
    intuitively states the following:
    If the loop is not {\em break}ed, then we have:
    \begin{itemize}
      \item The next-node set </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>N›</span></span></span><span> is a subset of </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>V›</span></span></span><span>, and
        the destination node is not contained into </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>V-(C∪N)›</span></span></span><span>,
      \item all nodes in the current-node set </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>C›</span></span></span><span> have a shortest
        path of length </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>d›</span></span></span><span>,
      \item all nodes in the next-node set </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>N›</span></span></span><span> have a shortest path
        of length </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>d+1›</span></span></span><span>,
      \item all nodes in the visited set </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>V›</span></span></span><span> have a shortest path
        of length at most </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>d+1›</span></span></span><span>,
      \item all nodes with a path shorter than </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>d›</span></span></span><span> are already in 
        </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>V›</span></span></span><span>, and
      \item all nodes with a shortest path of length </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>d+1›</span></span></span><span> are either
        in the next-node set </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>N›</span></span></span><span>, or they are undiscovered successors
        of a node in the current-node set.
    \end{itemize}
    
    If the loop has been {\em break}ed, </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>d›</span></span></span><span> is the distance of the
    shortest path between </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>src›</span></span></span><span> and </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>dst›</span></span></span><span>.
›</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Breadth_First_Search.Graph.bfs_invar&apos;_def|fact"><span class="entity_def" id="Breadth_First_Search.Graph.bfs_invar&apos;_def|thm"><span class="entity_def" id="Breadth_First_Search.Graph.bfs_invar&apos;_def_raw|axiom"><span class="entity_def" id="offset_5846..5856">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Breadth_First_Search.Graph.bfs_invar&apos;.cong|fact"><span class="entity_def" id="Breadth_First_Search.Graph.bfs_invar&apos;.cong|thm"><span class="entity_def" id="Breadth_First_Search.Graph.bfs_invar&apos;|const"><span class="entity_def" id="offset_5858..5868">bfs_invar'</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>src</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>dst</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>σ</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>let</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>f</span></span><span class="main"><span>,</span></span><span class="bound"><span>V</span></span><span class="main"><span>,</span></span><span class="bound"><span>C</span></span><span class="main"><span>,</span></span><span class="bound"><span>N</span></span><span class="main"><span>,</span></span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>=</span></span><span class="free"><span class="bound"><span class="entity"><span>σ</span></span></span></span><span> </span><span class="keyword1"><span>in</span></span><span>
    </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="bound"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="main"><span>(</span></span><span>
      </span><span class="bound"><span>N</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span> </span><span class="bound"><span>V</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>dst</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.not_member|const"><span>∉</span></a></span><span> </span><span class="bound"><span>V</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>C</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="bound"><span>N</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span>
      </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>v</span></span><span class="main"><span>∈</span></span><span class="bound"><span>C</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1506..1510"><span>conn</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>src</span></span></span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1452..1460"><span>min_dist</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>src</span></span></span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span>
      </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>v</span></span><span class="main"><span>∈</span></span><span class="bound"><span>N</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1506..1510"><span>conn</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>src</span></span></span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1452..1460"><span>min_dist</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>src</span></span></span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span>
      </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>v</span></span><span class="main"><span>∈</span></span><span class="bound"><span>V</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1506..1510"><span>conn</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>src</span></span></span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1452..1460"><span>min_dist</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>src</span></span></span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span>
      </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>v</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1506..1510"><span>conn</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>src</span></span></span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1452..1460"><span>min_dist</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>src</span></span></span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="bound"><span>d</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><span class="bound"><span>V</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span>
      </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>v</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1506..1510"><span>conn</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>src</span></span></span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1452..1460"><span>min_dist</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>src</span></span></span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="bound"><span>d</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><span class="bound"><span>N</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Complete_Lattices.html#Complete_Lattices.Union|const"><span>⋃</span></a></span><span class="main"><span>(</span></span><span class="free"><span>succ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span class="bound"><span>C</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="bound"><span>V</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span>
    </span><span class="bound"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1506..1510"><span>conn</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>src</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>dst</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1452..1460"><span>min_dist</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>src</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>dst</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="bound"><span>d</span></span><span>
    </span><span class="main"><span>)</span></span><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
    The second part of the invariant, </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>empty_assm›</span></span></span><span>, just states 
    that </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>C›</span></span></span><span> can only be empty if </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>N›</span></span></span><span> is also empty.
›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Breadth_First_Search.Graph.empty_assm_def|fact"><span class="entity_def" id="Breadth_First_Search.Graph.empty_assm_def|thm"><span class="entity_def" id="Breadth_First_Search.Graph.empty_assm_def_raw|axiom"><span class="entity_def" id="offset_6424..6434">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Breadth_First_Search.Graph.empty_assm|const"><span>empty_assm</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>σ</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>let</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>f</span></span><span class="main"><span>,</span></span><span class="bound"><span>V</span></span><span class="main"><span>,</span></span><span class="bound"><span>C</span></span><span class="main"><span>,</span></span><span class="bound"><span>N</span></span><span class="main"><span>,</span></span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>=</span></span><span class="free"><span class="bound"><span class="entity"><span>σ</span></span></span></span><span> </span><span class="keyword1"><span>in</span></span><span>
    </span><span class="bound"><span>C</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="bound"><span>N</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
    Finally, we define the invariant of the outer loop, </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>bfs_invar›</span></span></span><span>, 
    as the conjunction of both parts:
›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Breadth_First_Search.Graph.bfs_invar_def|fact"><span class="entity_def" id="Breadth_First_Search.Graph.bfs_invar_def|thm"><span class="entity_def" id="Breadth_First_Search.Graph.bfs_invar_def_raw|axiom"><span class="entity_def" id="offset_6611..6621">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Breadth_First_Search.Graph.bfs_invar.cong|fact"><span class="entity_def" id="Breadth_First_Search.Graph.bfs_invar.cong|thm"><span class="entity_def" id="Breadth_First_Search.Graph.bfs_invar|const"><span class="entity_def" id="offset_6623..6632">bfs_invar</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>src</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>dst</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>σ</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_5858..5868"><span>bfs_invar'</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>src</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>dst</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>σ</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> 
    </span><a class="entity_ref" href="Breadth_First_Search.html#Breadth_First_Search.Graph.empty_assm|const"><span>empty_assm</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>σ</span></span></span></span><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
    The invariant of the inner foreach-loop states that
    the successors that have already been processed (</span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>succ v - it›</span></span></span><span>),
    have been added to </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>V›</span></span></span><span> and have also been added to 
    </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>N'›</span></span></span><span> if they are not in </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>V›</span></span></span><span>.
›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Breadth_First_Search.Graph.FE_invar_def|fact"><span class="entity_def" id="Breadth_First_Search.Graph.FE_invar_def|thm"><span class="entity_def" id="Breadth_First_Search.Graph.FE_invar_def_raw|axiom"><span class="entity_def" id="offset_6915..6925">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Breadth_First_Search.Graph.FE_invar.cong|fact"><span class="entity_def" id="Breadth_First_Search.Graph.FE_invar.cong|thm"><span class="entity_def" id="Breadth_First_Search.Graph.FE_invar|const"><span class="entity_def" id="offset_6927..6935">FE_invar</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>V</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>N</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>it</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>σ</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>let</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>V'</span></span><span class="main"><span>,</span></span><span class="bound"><span>N'</span></span><span class="main"><span>)</span></span><span class="main"><span>=</span></span><span class="free"><span class="bound"><span class="entity"><span>σ</span></span></span></span><span> </span><span class="keyword1"><span>in</span></span><span> 
    </span><span class="bound"><span>V'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span class="bound"><span class="entity"><span>V</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>succ</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>it</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span>
    </span><span class="bound"><span>N'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span class="bound"><span class="entity"><span>N</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>succ</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>it</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>V</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Algorithm›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
    The following algorithm is a straightforward transcription of the 
    algorithm given in the assignment to the monadic style featured by our 
    framework.
    We briefly explain the (mainly syntactic) differences:
    \begin{itemize}
      \item The initialization of the variables occur after the loop in
          our formulation. This is just a syntactic difference, as our loop
          construct has the form </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>WHILEI I c f σ<span class="hidden">⇩</span><sub>0</sub>›</span></span></span><span>, where </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>σ<span class="hidden">⇩</span><sub>0</sub>›</span></span></span><span>
          is the initial state, and </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>I›</span></span></span><span> is the loop invariant;
      \item We translated the textual specification 
        {\em remove one vertex </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>v›</span></span></span><span> from </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>C›</span></span></span><span>} as accurately as
        possible: The statement </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>v ← SPEC (λv. v∈C)›</span></span></span><span> 
        nondeterministically assigns a node from </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>C›</span></span></span><span> to </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>v›</span></span></span><span>, 
        that is then removed in the next statement;
      \item In our monad, we have no notion of loop-breaking (yet). Hence we
        added an additional boolean variable </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>f›</span></span></span><span> that indicates that
        the loop shall terminate. The </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>RETURN›</span></span></span><span>-statements used in our
        program are the return-operator of the monad, and must not be mixed up
        with the return-statement given in the original program, that is 
        modeled by breaking the loop. The if-statement after the loop takes
        care to return the right value;
      \item We added an else-branch to the if-statement that checks
        whether we reached the destination node;
      \item We added an assertion of the first part of the invariant to the
        program text, moreover, we annotated invariants at the loops.
        We also added an assertion </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>w∉N›</span></span></span><span> into the inner loop. This
        is merely an optimization, that will allow us to implement the
        insert operation more efficiently;
      \item Each conditional branch in the loop body ends with a 
        </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>RETURN›</span></span></span><span>-statement. This is required by the monadic style;
      \item Failure is modeled by an option-datatype. The result 
        </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>Some d›</span></span></span><span> means that the integer </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>d›</span></span></span><span> is returned,
        the result </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>None›</span></span></span><span> means that a failure is returned.
    \end{itemize}
›</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>text_raw</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹\clearpage›</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Breadth_First_Search.Graph.bfs_def|fact"><span class="entity_def" id="Breadth_First_Search.Graph.bfs_def|thm"><span class="entity_def" id="Breadth_First_Search.Graph.bfs_def_raw|axiom"><span class="entity_def" id="offset_9154..9164">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Breadth_First_Search.Graph.bfs.cong|fact"><span class="entity_def" id="Breadth_First_Search.Graph.bfs.cong|thm"><span class="entity_def" id="Breadth_First_Search.Graph.bfs|const"><span class="entity_def" id="offset_9165..9168">bfs</span></span></span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'vertex</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'vertex</span></span><span> </span><span class="main"><span>⇒</span></span><span> 
    </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option|type"><span>option</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres|type"><span>nres</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>bfs</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>src</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>dst</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
    </span><span class="main"><span>(</span></span><span class="bound"><span>f</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI|const"><span>WHILEI</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Breadth_First_Search.html#offset_6623..6632"><span>bfs_invar</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>src</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>dst</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>f</span></span><span class="main"><span>,</span></span><span class="bound"><span>V</span></span><span class="main"><span>,</span></span><span class="bound"><span>C</span></span><span class="main"><span>,</span></span><span class="bound"><span>N</span></span><span class="main"><span>,</span></span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>f</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>C</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>f</span></span><span class="main"><span>,</span></span><span class="bound"><span>V</span></span><span class="main"><span>,</span></span><span class="bound"><span>C</span></span><span class="main"><span>,</span></span><span class="bound"><span>N</span></span><span class="main"><span>,</span></span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
        </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>v</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>v</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="bound"><span>C</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>C</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="bound"><span>C</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><span>{</span></span><span class="bound"><span>v</span></span><span class="main"><span>}</span></span><span class="main"><span>;</span></span><span>
        </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="bound"><span>v</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span class="bound"><span class="entity"><span>dst</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span class="main"><span>,</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span class="main"><span>,</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span class="main"><span>,</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span class="main"><span>,</span></span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
          </span><span class="main"><span>(</span></span><span class="bound"><span>V</span></span><span class="main"><span>,</span></span><span class="bound"><span>N</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Refine_Foreach.html#Refine_Foreach.FOREACHi|const"><span>FOREACHi</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Breadth_First_Search.html#offset_6927..6935"><span>FE_invar</span></a><span> </span><span class="bound"><span>V</span></span><span> </span><span class="bound"><span>N</span></span><span> </span><span class="bound"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>succ</span></span><span> </span><span class="bound"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>w</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>V</span></span><span class="main"><span>,</span></span><span class="bound"><span>N</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> 
            </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>w</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.not_member|const"><span>∉</span></a></span><span class="bound"><span>V</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span> 
              </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>w</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.not_member|const"><span>∉</span></a></span><span class="bound"><span>N</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
              </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.insert|const"><span>insert</span></a><span> </span><span class="bound"><span>w</span></span><span> </span><span class="bound"><span>V</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.insert|const"><span>insert</span></a><span> </span><span class="bound"><span>w</span></span><span> </span><span class="bound"><span>N</span></span><span class="main"><span>)</span></span><span> 
            </span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>V</span></span><span class="main"><span>,</span></span><span class="bound"><span>N</span></span><span class="main"><span>)</span></span><span>
          </span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>V</span></span><span class="main"><span>,</span></span><span class="bound"><span>N</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
          </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Breadth_First_Search.html#offset_5858..5868"><span>bfs_invar'</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>src</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>dst</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>f</span></span><span class="main"><span>,</span></span><span class="bound"><span>V</span></span><span class="main"><span>,</span></span><span class="bound"><span>C</span></span><span class="main"><span>,</span></span><span class="bound"><span>N</span></span><span class="main"><span>,</span></span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
          </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>C</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
            </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>C</span></span><span class="main"><span>=</span></span><span class="bound"><span>N</span></span><span class="main"><span>;</span></span><span> 
            </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>N</span></span><span class="main"><span>=</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span class="main"><span>;</span></span><span> 
            </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>d</span></span><span class="main"><span>=</span></span><span class="bound"><span>d</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>;</span></span><span>
            </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>f</span></span><span class="main"><span>,</span></span><span class="bound"><span>V</span></span><span class="main"><span>,</span></span><span class="bound"><span>C</span></span><span class="main"><span>,</span></span><span class="bound"><span>N</span></span><span class="main"><span>,</span></span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span>
          </span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>f</span></span><span class="main"><span>,</span></span><span class="bound"><span>V</span></span><span class="main"><span>,</span></span><span class="bound"><span>C</span></span><span class="main"><span>,</span></span><span class="bound"><span>N</span></span><span class="main"><span>,</span></span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span>
        </span><span class="main"><span>}</span></span><span>
      </span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a><span class="main"><span>,</span></span><span class="main"><span>{</span></span><span class="free"><span class="bound"><span class="entity"><span>src</span></span></span></span><span class="main"><span>}</span></span><span class="main"><span>,</span></span><span class="main"><span>{</span></span><span class="free"><span class="bound"><span class="entity"><span>src</span></span></span></span><span class="main"><span>}</span></span><span class="main"><span>,</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span class="main"><span>,</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>::</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
    </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="bound"><span>f</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.Some|const"><span>Some</span></a><span> </span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.None|const"><span>None</span></a><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>"Verification Tasks"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
    In order to make the proof more readable, we have extracted the
    difficult verification conditions and proved them in separate lemmas.
    The other verification conditions are proved automatically by Isabelle/HOL
    during the proof of the main theorem.

    Due to the timing constraints of the competition, the verification 
    conditions are mostly proved in Isabelle's apply-style, that is faster
    to write for the experienced user, but harder to read by a human.

    Exemplarily, we formulated the last proof in the proof language 
    {\em Isar}, that allows one to write human-readable proofs and verify
    them with Isabelle/HOL.
›</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
    The first part of the invariant is preserved if we take a node from 
    </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>C›</span></span></span><span>, and add its successors that are not in </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>V›</span></span></span><span> to 
    </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>N›</span></span></span><span>.
    This is the verification condition for the assertion after the 
    foreach-loop.
›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_10943..10948">lemma</span></span></span><span> </span><span class="entity_def" id="Breadth_First_Search.Graph.invar_succ_step|fact"><span class="entity_def" id="Breadth_First_Search.Graph.invar_succ_step|thm"><span class="entity_def" id="offset_10949..10964">invar_succ_step</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Breadth_First_Search.html#offset_5858..5868"><span>bfs_invar'</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="free"><span>dst</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a><span class="main"><span>,</span></span><span> </span><span class="free"><span>V</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>C</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>N</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>v</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>C</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>v</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="free"><span>dst</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Breadth_First_Search.html#offset_5858..5868"><span>bfs_invar'</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="free"><span>dst</span></span><span> 
            </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a><span class="main"><span>,</span></span><span> </span><span class="free"><span>V</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="free"><span>succ</span></span><span> </span><span class="free"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>C</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><span>{</span></span><span class="free"><span>v</span></span><span class="main"><span>}</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>N</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>succ</span></span><span> </span><span class="free"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>V</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_10943..10948"><span>assms</span></a><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span class="quasi_keyword"><span>no_asm_use</span></span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_5846..5856"><span>bfs_invar'_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjI|fact"><span>conjI</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>goal_cases</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>6</span><span> </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Un_iff|fact"><span>Un_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Diff_iff|fact"><span>Diff_iff</span></a><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1744..1754"><span>connI_succ</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.le_SucE|fact"><span>le_SucE</span></a><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_3095..3108"><span>min_dist_succ</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>7</span><span> </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Un_iff|fact"><span>Un_iff</span></a><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1744..1754"><span>connI_succ</span></a><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_3095..3108"><span>min_dist_succ</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="main"><span class="keyword3"><span>+</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
    The first part of the invariant is preserved if the 
    </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>if C={}›</span></span></span><span>-statement is executed.
    This is the verification condition for the 
    loop-invariant. Note that preservation of the second part of the 
    invariant is proven easily inside the main proof.
›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_11709..11714">lemma</span></span></span><span> </span><span class="entity_def" id="Breadth_First_Search.Graph.invar_empty_step|fact"><span class="entity_def" id="Breadth_First_Search.Graph.invar_empty_step|thm"><span class="entity_def" id="offset_11715..11731">invar_empty_step</span></span></span><span class="main"><span>:</span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Breadth_First_Search.html#offset_5858..5868"><span>bfs_invar'</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="free"><span>dst</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a><span class="main"><span>,</span></span><span> </span><span class="free"><span>V</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>N</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Breadth_First_Search.html#offset_5858..5868"><span>bfs_invar'</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="free"><span>dst</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a><span class="main"><span>,</span></span><span> </span><span class="free"><span>V</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>N</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_11709..11714"><span>assms</span></a><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span class="quasi_keyword"><span>no_asm_use</span></span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_5846..5856"><span>bfs_invar'_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjI|fact"><span>conjI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.impI|fact"><span>impI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.allI|fact"><span>allI</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>goal_cases</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>3</span><span> </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.le_SucI|fact"><span>le_SucI</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>4</span><span> </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.le_SucE|fact"><span>le_SucE</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subsetD|fact"><span>subsetD</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>5</span><span> </span><span class="skolem"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_3295..3307"><span>min_dist_suc</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="free"><span>src</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>v</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="free"><span>d</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>6</span><span> </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc_n_not_le_n|fact"><span>Suc_n_not_le_n</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="main"><span class="keyword3"><span>+</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹The invariant holds initially.›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Breadth_First_Search.Graph.invar_init|fact"><span class="entity_def" id="Breadth_First_Search.Graph.invar_init|thm"><span class="entity_def" id="offset_12280..12290">invar_init</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Breadth_First_Search.html#offset_6623..6632"><span>bfs_invar</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="free"><span>dst</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a><span class="main"><span>,</span></span><span> </span><span class="main"><span>{</span></span><span class="free"><span>src</span></span><span class="main"><span>}</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>{</span></span><span class="free"><span>src</span></span><span class="main"><span>}</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span class="main"><span>,</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_6611..6621"><span>bfs_invar_def</span></a><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_5846..5856"><span>bfs_invar'_def</span></a><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_6424..6434"><span>empty_assm_def</span></a><span class="main"><span>)</span></span><span>
       </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_3295..3307"><span>min_dist_suc</span></a><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_2679..2693"><span>min_dist_z_iff</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹The invariant is preserved if we break the loop.›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_12509..12514">lemma</span></span></span><span> </span><span class="entity_def" id="Breadth_First_Search.Graph.invar_break|fact"><span class="entity_def" id="Breadth_First_Search.Graph.invar_break|thm"><span class="entity_def" id="offset_12515..12526">invar_break</span></span></span><span class="main"><span>:</span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Breadth_First_Search.html#offset_6623..6632"><span>bfs_invar</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="free"><span>dst</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a><span class="main"><span>,</span></span><span> </span><span class="free"><span>V</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>C</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>N</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>dst</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>C</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Breadth_First_Search.html#offset_6623..6632"><span>bfs_invar</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="free"><span>dst</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span class="main"><span>,</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span class="main"><span>,</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span class="main"><span>,</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_12509..12514"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_6611..6621"><span>bfs_invar_def</span></a><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_5846..5856"><span>bfs_invar'_def</span></a><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_6424..6434"><span>empty_assm_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹If we have {\em break}ed the loop, the invariant implies
    that we, indeed, returned the shortest path.›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_12853..12858">lemma</span></span></span><span> </span><span class="entity_def" id="Breadth_First_Search.Graph.invar_final_succeed|fact"><span class="entity_def" id="Breadth_First_Search.Graph.invar_final_succeed|thm"><span class="entity_def" id="offset_12859..12878">invar_final_succeed</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Breadth_First_Search.html#offset_5858..5868"><span>bfs_invar'</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="free"><span>dst</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span class="main"><span>,</span></span><span> </span><span class="free"><span>V</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>C</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>N</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Breadth_First_Search.html#offset_1452..1460"><span>min_dist</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="free"><span>dst</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>d</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_12853..12858"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_5846..5856"><span>bfs_invar'_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹If the loop terminated normally, there is no path between 
    </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>src›</span></span></span><span> and </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>dst›</span></span></span><span>. 

    The lemma is formulated as deriving a contradiction from the fact
    that there is a path and the loop terminated normally.

    Note the proof language {\em Isar} that was used here.
    It allows one to write human-readable proofs in a theorem prover.
›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Breadth_First_Search.Graph.invar_final_fail|fact"><span class="entity_def" id="Breadth_First_Search.Graph.invar_final_fail|thm"><span class="entity_def" id="offset_13380..13396">invar_final_fail</span></span></span><span class="main"><span>:</span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_13411..13412">C</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Breadth_First_Search.html#offset_1506..1510"><span>conn</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="free"><span>dst</span></span><span>"</span></span></span><span> </span><span class="comment1"><span>― ‹There is a path between 
      </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>text</span></span><span> </span><span class="raw_text"><span>"src"</span></span><span class="antiquote"><span>}</span></span></span><span> and </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>text</span></span><span> </span><span class="raw_text"><span>"dst"</span></span><span class="antiquote"><span>}</span></span></span><span>.›</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_13509..13512">INV</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Breadth_First_Search.html#offset_5858..5868"><span>bfs_invar'</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="free"><span>dst</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a><span class="main"><span>,</span></span><span> </span><span class="free"><span>V</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span class="main"><span>,</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>txt</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹We make a case-distinction whether </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>d'≤d›</span></span></span><span>:›</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Breadth_First_Search.html#offset_1452..1460"><span>min_dist</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="free"><span>dst</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1452..1460"><span>min_dist</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="free"><span>dst</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>{</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>txt</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Due to the invariant, any node with a path of 
        length at most </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>d›</span></span></span><span> is contained in </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>V›</span></span></span><span>
›</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_13509..13512"><span>INV</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>v</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1506..1510"><span>conn</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1452..1460"><span>min_dist</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="bound"><span>v</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>V</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_5846..5856"><span>bfs_invar'_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>txt</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹This applies in the first case, hence we obtain that 
        </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>dst∈V›</span></span></span><span>›</span></span></span><span>
      </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span>A</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Breadth_First_Search.html#offset_1452..1460"><span>min_dist</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="free"><span>dst</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>d</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_13411..13412"><span>C</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Breadth_First_Search.html#offset_1087..1091"><span>dist</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Breadth_First_Search.html#offset_1452..1460"><span>min_dist</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="free"><span>dst</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>dst</span></span><span>"</span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_2800..2816"><span>min_dist_is_dist</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>dst</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>V</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span>txt</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹However, as </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>C›</span></span></span><span> and </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>N›</span></span></span><span> are empty, the invariant
        also implies that </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>dst›</span></span></span><span> is not in </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>V›</span></span></span><span>:›</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_13509..13512"><span>INV</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>dst</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.not_member|const"><span>∉</span></a></span><span class="free"><span>V</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_5846..5856"><span>bfs_invar'_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span>txt</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹This yields a contradiction:›</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>}</span></span></span><span> </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>{</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>txt</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹In the case </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>d+1 ≤ d'›</span></span></span><span>, we also obtain a node
        that has a shortest path of length </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>d+1›</span></span></span><span>:›</span></span></span><span>
      </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>d</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1452..1460"><span>min_dist</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="free"><span>dst</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_4243..4254"><span>min_dist_le</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_13411..13412"><span>C</span></a><span class="main"><span>]</span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>v'</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> 
        </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Breadth_First_Search.html#offset_1506..1510"><span>conn</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="skolem"><span>v'</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Breadth_First_Search.html#offset_1452..1460"><span>min_dist</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="skolem"><span>v'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span>txt</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹However, the invariant states that such nodes are either in
        </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>N›</span></span></span><span> or are successors of </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>C›</span></span></span><span>. As </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>N›</span></span></span><span> 
        and </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>C›</span></span></span><span> are both empty, we again get a contradiction.›</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_13509..13512"><span>INV</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_5846..5856"><span>bfs_invar'_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>}</span></span></span><span> </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
    Finally, we prove our algorithm correct:
    The following theorem solves both verification tasks.

    Note that a proposition of the form </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>S ⊑ SPEC Φ›</span></span></span><span> states partial 
    correctness in our framework, i.e., </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>S›</span></span></span><span> refines the 
    specification </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>Φ›</span></span></span><span>.

    The actual specification that we prove here
    precisely reflects the two verification tasks: {\em If the algorithm fails,
    there is no path between </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>src›</span></span></span><span> and </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>dst›</span></span></span><span>, otherwise
    it returns the length of the shortest path.}

    The proof of this theorem first applies the verification condition 
    generator (</span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>apply (intro refine_vcg)›</span></span></span><span>), and then uses the
    lemmas proved beforehand to discharge the verification conditions.
    During the </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>auto›</span></span></span><span>-methods, some trivial verification conditions,
    e.g., those concerning the invariant of the inner loop, are discharged
    automatically.
    During the proof, we gradually unfold the definition of the loop
    invariant.
›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Breadth_First_Search.Graph.bfs_spec_def|fact"><span class="entity_def" id="Breadth_First_Search.Graph.bfs_spec_def|thm"><span class="entity_def" id="Breadth_First_Search.Graph.bfs_spec_def_raw|axiom"><span class="entity_def" id="offset_15977..15987">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Breadth_First_Search.Graph.bfs_spec.cong|fact"><span class="entity_def" id="Breadth_First_Search.Graph.bfs_spec.cong|thm"><span class="entity_def" id="Breadth_First_Search.Graph.bfs_spec|const"><span class="entity_def" id="offset_15989..15997">bfs_spec</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>src</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>dst</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span>
    </span><span class="main"><span>λ</span></span><span class="bound"><span>r</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>case</span></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="keyword1"><span>of</span></span><span> None </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1506..1510"><span>conn</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>src</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>dst</span></span></span></span><span>
              </span><span class="main"><span>|</span></span><span> Some </span><span class="bound"><span>d</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1506..1510"><span>conn</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>src</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>dst</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_1452..1460"><span>min_dist</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>src</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>dst</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>theorem</span></span></span><span> </span><span class="entity_def" id="Breadth_First_Search.Graph.bfs_correct|fact"><span class="entity_def" id="Breadth_First_Search.Graph.bfs_correct|thm"><span>bfs_correct</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Breadth_First_Search.html#offset_9165..9168"><span>bfs</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="free"><span>dst</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_15989..15997"><span>bfs_spec</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="free"><span>dst</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_9154..9164"><span>bfs_def</span></a><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_15977..15987"><span>bfs_spec_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_vcg|fact"><span class="dynamic"><span class="dynamic"><span>refine_vcg</span></span></span></a><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_6915..6925"><span>FE_invar_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> 
      </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_12280..12290"><span>invar_init</span></a><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_12515..12526"><span>invar_break</span></a><span> </span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_6611..6621"><span>bfs_invar_def</span></a><span> 
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> 
      </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_10949..10964"><span>invar_succ_step</span></a><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_11715..11731"><span>invar_empty_step</span></a><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_12859..12878"><span>invar_final_succeed</span></a><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_6424..6434"><span>empty_assm_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_13380..13396"><span>invar_final_fail</span></a><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Breadth_First_Search.html#offset_5846..5856"><span>bfs_invar'_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span></pre>
</body>

</html>