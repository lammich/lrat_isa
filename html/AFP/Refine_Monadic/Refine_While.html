<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Refine_While</title>
</head>


<body>
<div class="head">
<h1>Theory Refine_While</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹While-Loops›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><a href="Refine_While.html"><span>Refine_While</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> 
  </span><a href="Refine_Basic.html"><span>Refine_Basic</span></a><span> </span><a href="Refine_Leof.html"><span>Refine_Leof</span></a><span> </span><span class="quoted"><span>"</span><a href="RefineG_While.html"><span>Generic/RefineG_While</span></a><span>"</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Refine_While.WHILEIT_def|fact"><span class="entity_def" id="Refine_While.WHILEIT_def|thm"><span class="entity_def" id="Refine_While.WHILEIT_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Refine_While.WHILEIT|const"><span>WHILEIT</span></span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword1"><span>WHILE<span class="hidden">⇩</span><sub>T</sub>⇗</span></span><span>_</span><span class="keyword1"><span>⇖</span></span><span>"</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>WHILEIT</span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="RefineG_While.html#RefineG_While.iWHILEIT|const"><span>iWHILEIT</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.bind|const"><span>bind</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Refine_While.WHILEI_def|fact"><span class="entity_def" id="Refine_While.WHILEI_def|thm"><span class="entity_def" id="Refine_While.WHILEI_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Refine_While.WHILEI|const"><span>WHILEI</span></span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword1"><span>WHILE⇗</span></span><span>_</span><span class="keyword1"><span>⇖</span></span><span>"</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>WHILEI</span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="RefineG_While.html#RefineG_While.iWHILEI|const"><span>iWHILEI</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.bind|const"><span>bind</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Refine_While.WHILET_def|fact"><span class="entity_def" id="Refine_While.WHILET_def|thm"><span class="entity_def" id="Refine_While.WHILET_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Refine_While.WHILET|const"><span>WHILET</span></span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword1"><span>WHILE<span class="hidden">⇩</span><sub>T</sub></span></span><span>"</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>WHILET</span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="RefineG_While.html#RefineG_While.iWHILET|const"><span>iWHILET</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.bind|const"><span>bind</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Refine_While.WHILE_def|fact"><span class="entity_def" id="Refine_While.WHILE_def|thm"><span class="entity_def" id="Refine_While.WHILE_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Refine_While.WHILE|const"><span>WHILE</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>WHILE</span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="RefineG_While.html#RefineG_While.iWHILE|const"><span>iWHILE</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.bind|const"><span>bind</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Refine_While.while.WHILET_rule|fact"><span class="entity_def" id="Refine_While.while.WHILE_rule|fact"><span class="entity_def" id="Refine_While.while.WHILEIT_rule|fact"><span class="entity_def" id="Refine_While.while.WHILEI_rule|fact"><span class="entity_def" id="Refine_While.while.ireturn_rule|fact"><span class="entity_def" id="Refine_While.while.iSPEC_rule|fact"><span class="entity_def" id="Refine_While.while.ireturn_eq|fact"><span class="entity_def" id="Refine_While.while.ibind_rule|fact"><span class="entity_def" id="Refine_While.while.iSPEC_eq|fact"><span class="entity_def" id="Refine_While.while.generic_WHILE_rules_axioms|fact"><span class="entity_def" id="Refine_While.while.WHILE_mono_prover_rule|fact"><span class="entity_def" id="Refine_While.while.transfer_WHILET_esc|fact"><span class="entity_def" id="Refine_While.while.transfer_WHILEIT_esc|fact"><span class="entity_def" id="Refine_While.while.WHILET_unfold|fact"><span class="entity_def" id="Refine_While.while.WHILE_unfold|fact"><span class="entity_def" id="Refine_While.while.WHILEI_le_WHILEIT|fact"><span class="entity_def" id="Refine_While.while.WHILEIT_weaken|fact"><span class="entity_def" id="Refine_While.while.WHILEIT_unfold|fact"><span class="entity_def" id="Refine_While.while.WHILEI_weaken|fact"><span class="entity_def" id="Refine_While.while.RECT_mono_ref|fact"><span class="entity_def" id="Refine_While.while.REC_mono_ref|fact"><span class="entity_def" id="Refine_While.while.WHILEI_unfold|fact"><span class="entity_def" id="Refine_While.while.WHILEI_mono_ge|fact"><span class="entity_def" id="Refine_While.while.WHILEI_mono|fact"><span class="entity_def" id="Refine_While.while.WHILEI_body_trimono|fact"><span class="entity_def" id="Refine_While.while.imonad_laws|fact"><span class="entity_def" id="Refine_While.while.WHILE_def|fact"><span class="entity_def" id="Refine_While.while.WHILET_def|fact"><span class="entity_def" id="Refine_While.while.WHILEI_def|fact"><span class="entity_def" id="Refine_While.while.WHILEIT_def|fact"><span class="entity_def" id="Refine_While.while.WHILE_eq|fact"><span class="entity_def" id="Refine_While.while.WHILET_eq|fact"><span class="entity_def" id="Refine_While.while.WHILEI_eq|fact"><span class="entity_def" id="Refine_While.while.WHILEIT_eq|fact"><span class="entity_def" id="Refine_While.while.ibind_mono|fact"><span class="entity_def" id="Refine_While.while.ibind_mono_ge|fact"><span class="entity_def" id="Refine_While.while.imonad3|fact"><span class="entity_def" id="Refine_While.while.imonad2|fact"><span class="entity_def" id="Refine_While.while.imonad1|fact"><span class="entity_def" id="Refine_While.while.generic_WHILE_axioms|fact"><span class="entity_def" id="Refine_While.while.ireturn_rule|thm"><span class="entity_def" id="Refine_While.while.iSPEC_rule|thm"><span class="entity_def" id="Refine_While.while.ireturn_eq|thm"><span class="entity_def" id="Refine_While.while.ibind_rule|thm"><span class="entity_def" id="Refine_While.while.iSPEC_eq|thm"><span class="entity_def" id="Refine_While.while.WHILEI_mono_ge|thm"><span class="entity_def" id="Refine_While.while.WHILEI_mono|thm"><span class="entity_def" id="Refine_While.while.imonad_laws(3)|thm"><span class="entity_def" id="Refine_While.while.imonad_laws(2)|thm"><span class="entity_def" id="Refine_While.while.imonad_laws(1)|thm"><span class="entity_def" id="Refine_While.while.WHILE_eq|thm"><span class="entity_def" id="Refine_While.while.WHILET_eq|thm"><span class="entity_def" id="Refine_While.while.WHILEI_eq|thm"><span class="entity_def" id="Refine_While.while.WHILEIT_eq|thm"><span class="entity_def" id="Refine_While.while.ibind_mono|thm"><span class="entity_def" id="Refine_While.while.ibind_mono_ge|thm"><span class="entity_def" id="Refine_While.while.imonad3|thm"><span class="entity_def" id="Refine_While.while.imonad2|thm"><span class="entity_def" id="Refine_While.while.imonad1|thm"><span class="entity_def" id="Refine_While.while.WHILET_rule|thm"><span class="entity_def" id="Refine_While.while.WHILET_unfold|thm"><span class="entity_def" id="Refine_While.while.WHILEIT_weaken|thm"><span class="entity_def" id="Refine_While.while.WHILEI_le_WHILEIT|thm"><span class="entity_def" id="Refine_While.while.WHILEI_weaken|thm"><span class="entity_def" id="Refine_While.while.WHILE_unfold|thm"><span class="entity_def" id="Refine_While.while.WHILE_rule|thm"><span class="entity_def" id="Refine_While.while.WHILEI_body_trimono|thm"><span class="entity_def" id="Refine_While.while.WHILEIT_def|thm"><span class="entity_def" id="Refine_While.while.WHILET_def|thm"><span class="entity_def" id="Refine_While.while.WHILE_def|thm"><span class="entity_def" id="Refine_While.while.WHILEI_def|thm"><span class="entity_def" id="Refine_While.while.WHILEIT_unfold|thm"><span class="entity_def" id="Refine_While.while.WHILEI_unfold|thm"><span class="entity_def" id="Refine_While.while.WHILEIT_rule|thm"><span class="entity_def" id="Refine_While.while.WHILEI_rule|thm"><span class="entity_def" id="Refine_While.while.generic_WHILE_rules_axioms|thm"><span class="entity_def" id="Refine_While.while.WHILE_mono_prover_rule(6)|thm"><span class="entity_def" id="Refine_While.while.WHILE_mono_prover_rule(5)|thm"><span class="entity_def" id="Refine_While.while.WHILE_mono_prover_rule(4)|thm"><span class="entity_def" id="Refine_While.while.WHILE_mono_prover_rule(3)|thm"><span class="entity_def" id="Refine_While.while.WHILE_mono_prover_rule(2)|thm"><span class="entity_def" id="Refine_While.while.WHILE_mono_prover_rule(1)|thm"><span class="entity_def" id="Refine_While.while.transfer_WHILET_esc|thm"><span class="entity_def" id="Refine_While.while.transfer_WHILEIT_esc|thm"><span class="entity_def" id="Refine_While.while.RECT_mono_ref|thm"><span class="entity_def" id="Refine_While.while.REC_mono_ref|thm"><span class="entity_def" id="Refine_While.while.generic_WHILE_axioms|thm"><span>interpretation</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> while</span><span class="main"><span>?</span></span><span class="main"><span>:</span></span><span> </span><a class="entity_ref" href="RefineG_While.html#RefineG_While.generic_WHILE_rules|locale"><span>generic_WHILE_rules</span></a><span> </span><span class="quoted"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.bind|const"><span>bind</span></a></span><span> </span><span class="quoted"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a></span><span> </span><span class="quoted"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a></span><span>
  </span><span class="quoted"><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEIT|const"><span>WHILEIT</span></a></span><span> </span><span class="quoted"><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI|const"><span>WHILEI</span></a></span><span> </span><span class="quoted"><a class="entity_ref" href="Refine_While.html#Refine_While.WHILET|const"><span>WHILET</span></a></span><span> </span><span class="quoted"><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>unfold_locales</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEIT_def|fact"><span>WHILEIT_def</span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI_def|fact"><span>WHILEI_def</span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILET_def|fact"><span>WHILET_def</span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE_def|fact"><span>WHILE_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="Refine_Mono_Prover.html#Refine_Mono_Prover.refine_mono|method"><span class="operator"><span>refine_mono</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="Refine_Mono_Prover.html#Refine_Mono_Prover.refine_mono|method"><span class="operator"><span>refine_mono</span></span></a><span>

  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RES_Sup_RETURN|fact"><span>RES_Sup_RETURN</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span> 
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule_tac</span></span><span> f</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/Complete_Lattices.html#Complete_Lattices.Sup_class.Sup|const"><span>Sup</span></a></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>in</span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.arg_cong|fact"><span>arg_cong</span></a><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>erule</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.bind_rule|fact"><span>bind_rule</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_vcg|attribute"><span class="operator"><span>refine_vcg</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILEI_rule|fact"><span>WHILEI_rule</span></a><span>
</span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_vcg|attribute"><span class="operator"><span>refine_vcg</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILEIT_rule|fact"><span>WHILEIT_rule</span></a><span>

</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Data Refinement Rules›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_830..835">lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.ref_WHILEI_invarI|fact"><span class="entity_def" id="Refine_While.ref_WHILEI_invarI|thm"><span>ref_WHILEI_invarI</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>I</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI|const"><span>WHILEI</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI|const"><span>WHILEI</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILEI_unfold|fact"><span>WHILEI_unfold</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>I</span></span><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILEI_unfold|fact"><span>WHILEI_unfold</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>erule</span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_830..835"><span>assms</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_1067..1072">lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.ref_WHILEIT_invarI|fact"><span class="entity_def" id="Refine_While.ref_WHILEIT_invarI|thm"><span>ref_WHILEIT_invarI</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>I</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEIT|const"><span>WHILEIT</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEIT|const"><span>WHILEIT</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILEIT_unfold|fact"><span>WHILEIT_unfold</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>I</span></span><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILEIT_unfold|fact"><span>WHILEIT_unfold</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>erule</span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_1067..1072"><span>assms</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>


</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.WHILEI_le_rule|fact"><span class="entity_def" id="Refine_While.WHILEI_le_rule|thm"><span>WHILEI_le_rule</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_1342..1344">R0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>s</span></span><span class="main"><span>,</span></span><span class="free"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_1367..1369">RS</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>W</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>s</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>s</span></span><span class="main"><span>,</span></span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="bound"><span>W</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>M</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>s</span></span><span class="main"><span>,</span></span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> 
    </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.bind|const"><span>bind</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>W</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>s</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>M</span></span><span> </span><span class="bound"><span>s'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI|const"><span>WHILEI</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>M</span></span><span> </span><span class="free"><span>s'</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILEI_def|fact"><span>WHILEI_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.REC_le_rule|fact"><span>REC_le_rule</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> M</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="free"><span>M</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="RefineG_While.html#RefineG_While.WHILEI_body_def|fact"><span>WHILEI_body_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="Refine_Mono_Prover.html#Refine_Mono_Prover.refine_mono|method"><span class="operator"><span>refine_mono</span></span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_1342..1344"><span>R0</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>erule</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order_trans|fact"><span>order_trans</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>rotated</span></span><span class="main"><span class="main"><span>,</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_1367..1369"><span>RS</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="RefineG_While.html#RefineG_While.WHILEI_body_def|fact"><span>WHILEI_body_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>


</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹WHILE-refinement rule with invisible concrete steps.
  Intuitively, a concrete step may either refine an abstract step, or
  must not change the corresponding abstract state.›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.WHILEI_invisible_refine_genR|fact"><span class="entity_def" id="Refine_While.WHILEI_invisible_refine_genR|thm"><span>WHILEI_invisible_refine_genR</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_1980..1982">R0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>I'</span></span><span> </span><span class="free"><span>s'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>s</span></span><span class="main"><span>,</span></span><span class="free"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_2014..2016">RI</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>s</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>s</span></span><span class="main"><span>,</span></span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="bound"><span>s'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>s</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_2064..2066">RB</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>s</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>s</span></span><span class="main"><span>,</span></span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>s'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>s</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_2126..2128">RS</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>s</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>s</span></span><span class="main"><span>,</span></span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>⟧</span></span><span> 
    </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.sup_class.sup|const"><span>sup</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R'</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.ASSUME|const"><span>ASSUME</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>f'</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R'</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_2250..2255">R_REF</span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R'</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI|const"><span>WHILEI</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI|const"><span>WHILEI</span></a><span> </span><span class="free"><span>I'</span></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="free"><span>f'</span></span><span> </span><span class="free"><span>s'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.ref_WHILEI_invarI|fact"><span>ref_WHILEI_invarI</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI_le_rule|fact"><span>WHILEI_le_rule</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> R</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="free"><span>R'</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>erule</span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_1980..1982"><span>R0</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.ref_WHILEI_invarI|fact"><span>ref_WHILEI_invarI</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>frule</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_2014..2016"><span>RI</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct_tacs.ML.html#HOL.case_tac|method"><span class="operator"><span>case_tac</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span> </span><span class="improper"><span>s</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILEI_unfold|fact"><span>WHILEI_unfold</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_2064..2066"><span>RB</span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN_refine|fact"><span>RETURN_refine</span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_2250..2255"><span>R_REF</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order_trans|fact"><span>order_trans</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.order_class.monoD|fact"><span>monoD</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.bind_mono1|fact"><span>bind_mono1</span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_2126..2128"><span>RS</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>only</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.bind_distrib_sup1|fact"><span>bind_distrib_sup1</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.semilattice_sup_class.sup_least|fact"><span>sup_least</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILEI_unfold|fact"><span>WHILEI_unfold</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_2064..2066"><span>RB</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.impI|fact"><span>impI</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.bind_refine|fact"><span>bind_refine</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order_refl|fact"><span>order_refl</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>


</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.WHILEI_refine_genR|fact"><span class="entity_def" id="Refine_While.WHILEI_refine_genR|thm"><span>WHILEI_refine_genR</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_3026..3028">R0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>I'</span></span><span> </span><span class="free"><span>x'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span class="free"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_3060..3064">IREF</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_3112..3120">COND_REF</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_3181..3189">STEP_REF</span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R'</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_3273..3278">R_REF</span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R'</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI|const"><span>WHILEI</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI|const"><span>WHILEI</span></a><span> </span><span class="free"><span>I'</span></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="free"><span>f'</span></span><span> </span><span class="free"><span>x'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI_invisible_refine_genR|fact"><span>WHILEI_invisible_refine_genR</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_3026..3028"><span>R0</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>assumption</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>erule</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_3060..3064"><span>IREF</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_3112..3120"><span>COND_REF</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.semilattice_sup_class.le_supI1|fact"><span>le_supI1</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_3112..3120"><span>COND_REF</span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_3181..3189"><span>STEP_REF</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_3273..3278"><span>R_REF</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_3624..3629">lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.WHILE_invisible_refine_genR|fact"><span class="entity_def" id="Refine_While.WHILE_invisible_refine_genR|thm"><span>WHILE_invisible_refine_genR</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>R0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>s</span></span><span class="main"><span>,</span></span><span class="free"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>RB</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>s</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>s</span></span><span class="main"><span>,</span></span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>s'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>s</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>RS</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>s</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>s</span></span><span class="main"><span>,</span></span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>⟧</span></span><span> 
    </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.sup_class.sup|const"><span>sup</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R'</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.ASSUME|const"><span>ASSUME</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>f'</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R'</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>R_REF</span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R'</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>b'</span></span><span> </span><span class="free"><span>f'</span></span><span> </span><span class="free"><span>s'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILE_def|fact"><span>WHILE_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI_invisible_refine_genR|fact"><span>WHILEI_invisible_refine_genR</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_3624..3629"><span>assms</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_4073..4078">lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.WHILE_refine_genR|fact"><span class="entity_def" id="Refine_While.WHILE_refine_genR|thm"><span>WHILE_refine_genR</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>R0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span class="free"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>COND_REF</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>STEP_REF</span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R'</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>R_REF</span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R'</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>b'</span></span><span> </span><span class="free"><span>f'</span></span><span> </span><span class="free"><span>x'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILE_def|fact"><span>WHILE_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI_refine_genR|fact"><span>WHILEI_refine_genR</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_4073..4078"><span>assms</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_4476..4481">lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.WHILE_refine_genR&apos;|fact"><span class="entity_def" id="Refine_While.WHILE_refine_genR&apos;|thm"><span>WHILE_refine_genR'</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>R0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span class="free"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>COND_REF</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>STEP_REF</span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R'</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>R_REF</span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R'</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI|const"><span>WHILEI</span></a><span> </span><span class="free"><span>I'</span></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="free"><span>f'</span></span><span> </span><span class="free"><span>x'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILE_def|fact"><span>WHILE_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI_refine_genR|fact"><span>WHILEI_refine_genR</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_4476..4481"><span>assms</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.TrueI|fact"><span>TrueI</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹WHILE-refinement rule with invisible concrete steps.
  Intuitively, a concrete step may either refine an abstract step, or
  must not change the corresponding abstract state.›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_5086..5091">lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.WHILEI_invisible_refine|fact"><span class="entity_def" id="Refine_While.WHILEI_invisible_refine|thm"><span>WHILEI_invisible_refine</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>R0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>I'</span></span><span> </span><span class="free"><span>s'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>s</span></span><span class="main"><span>,</span></span><span class="free"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>RI</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>s</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>s</span></span><span class="main"><span>,</span></span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="bound"><span>s'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>s</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>RB</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>s</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>s</span></span><span class="main"><span>,</span></span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>s'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>s</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>RS</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>s</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>s</span></span><span class="main"><span>,</span></span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>⟧</span></span><span> 
    </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.sup_class.sup|const"><span>sup</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.ASSUME|const"><span>ASSUME</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>f'</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI|const"><span>WHILEI</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI|const"><span>WHILEI</span></a><span> </span><span class="free"><span>I'</span></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="free"><span>f'</span></span><span> </span><span class="free"><span>s'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI_invisible_refine_genR|fact"><span>WHILEI_invisible_refine_genR</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> R'</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="free"><span>R</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_5086..5091"><span>assms</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.WHILEI_refine|fact"><span class="entity_def" id="Refine_While.WHILEI_refine|thm"><span>WHILEI_refine</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine|attribute"><span class="operator"><span>refine</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_5573..5575">R0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>I'</span></span><span> </span><span class="free"><span>x'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span class="free"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_5606..5610">IREF</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_5657..5665">COND_REF</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_5725..5733">STEP_REF</span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI|const"><span>WHILEI</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI|const"><span>WHILEI</span></a><span> </span><span class="free"><span>I'</span></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="free"><span>f'</span></span><span> </span><span class="free"><span>x'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI_invisible_refine|fact"><span>WHILEI_invisible_refine</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_5573..5575"><span>R0</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>assumption</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>erule</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_5606..5610"><span>IREF</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_5657..5665"><span>COND_REF</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.semilattice_sup_class.le_supI1|fact"><span>le_supI1</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_5657..5665"><span>COND_REF</span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_5725..5733"><span>STEP_REF</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_6045..6050">lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.WHILE_invisible_refine|fact"><span class="entity_def" id="Refine_While.WHILE_invisible_refine|thm"><span>WHILE_invisible_refine</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>R0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>s</span></span><span class="main"><span>,</span></span><span class="free"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>RB</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>s</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>s</span></span><span class="main"><span>,</span></span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>s'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>s</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>RS</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>s</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>s</span></span><span class="main"><span>,</span></span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>⟧</span></span><span> 
    </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.sup_class.sup|const"><span>sup</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.ASSUME|const"><span>ASSUME</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>f'</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>b'</span></span><span> </span><span class="free"><span>f'</span></span><span> </span><span class="free"><span>s'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILE_def|fact"><span>WHILE_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI_invisible_refine|fact"><span>WHILEI_invisible_refine</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_6045..6050"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.WHILE_le_rule|fact"><span class="entity_def" id="Refine_While.WHILE_le_rule|thm"><span>WHILE_le_rule</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_6417..6419">R0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>s</span></span><span class="main"><span>,</span></span><span class="free"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_6442..6444">RS</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>W</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>s</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>s</span></span><span class="main"><span>,</span></span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="bound"><span>W</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>M</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>s</span></span><span class="main"><span>,</span></span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> 
    </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.bind|const"><span>bind</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>W</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>s</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>M</span></span><span> </span><span class="bound"><span>s'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>M</span></span><span> </span><span class="free"><span>s'</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILE_def|fact"><span>WHILE_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI_le_rule|fact"><span>WHILEI_le_rule</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_6417..6419"><span>R0</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_6442..6444"><span>RS</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_6675..6680">lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.WHILE_refine|fact"><span class="entity_def" id="Refine_While.WHILE_refine|thm"><span>WHILE_refine</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine|attribute"><span class="operator"><span>refine</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>R0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span class="free"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>COND_REF</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>STEP_REF</span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>b'</span></span><span> </span><span class="free"><span>f'</span></span><span> </span><span class="free"><span>x'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILE_def|fact"><span>WHILE_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI_refine|fact"><span>WHILEI_refine</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_6675..6680"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_6979..6984">lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.WHILE_refine&apos;|fact"><span class="entity_def" id="Refine_While.WHILE_refine&apos;|thm"><span>WHILE_refine'</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine|attribute"><span class="operator"><span>refine</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>R0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>I'</span></span><span> </span><span class="free"><span>x'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span class="free"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>COND_REF</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>STEP_REF</span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI|const"><span>WHILEI</span></a><span> </span><span class="free"><span>I'</span></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="free"><span>f'</span></span><span> </span><span class="free"><span>x'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILE_def|fact"><span>WHILE_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI_refine|fact"><span>WHILEI_refine</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_6979..6984"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.AIF_leI|fact"><span class="entity_def" id="Refine_While.AIF_leI|thm"><span>AIF_leI</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span class="free"><span>Φ</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>Φ</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span>S'</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>Φ</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="free"><span>S</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.FAIL|const"><span>FAIL</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>S'</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.ref_AIFI|fact"><span class="entity_def" id="Refine_While.ref_AIFI|thm"><span>ref_AIFI</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span class="free"><span>Φ</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="free"><span>S'</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>S</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>Φ</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="free"><span>S'</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.FAIL|const"><span>FAIL</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="free"><span>Φ</span></span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Refinement with generalized refinement relation. Required to exploit
  the fact that the condition does not hold at the end of the loop.›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.WHILEIT_refine_genR|fact"><span class="entity_def" id="Refine_While.WHILEIT_refine_genR|thm"><span>WHILEIT_refine_genR</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_7650..7652">R0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>I'</span></span><span> </span><span class="free"><span>x'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span class="free"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_7684..7688">IREF</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_7736..7744">COND_REF</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_7805..7813">STEP_REF</span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R'</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_7897..7902">R_REF</span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R'</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEIT|const"><span>WHILEIT</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEIT|const"><span>WHILEIT</span></a><span> </span><span class="free"><span>I'</span></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="free"><span>f'</span></span><span> </span><span class="free"><span>x'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.ref_WHILEIT_invarI|fact"><span>ref_WHILEIT_invarI</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILEIT_def|fact"><span>WHILEIT_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RECT_refine|fact"><span>RECT_refine</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILEI_body_trimono|fact"><span>WHILEI_body_trimono</span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_7650..7652"><span>R0</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>assumption</span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="RefineG_While.html#RefineG_While.WHILEI_body_def|fact"><span>WHILEI_body_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.ref_AIFI|fact"><span>ref_AIFI</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.AIF_leI|fact"><span>AIF_leI</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_7684..7688"><span>IREF</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.if_refine|fact"><span>if_refine</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_7736..7744"><span>COND_REF</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.bind_refine|fact"><span>bind_refine</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_7805..7813"><span>STEP_REF</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>assumption</span></span><span>

  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN_refine|fact"><span>RETURN_refine</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_7897..7902"><span>R_REF</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>


</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_8461..8466">lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.WHILET_refine_genR|fact"><span class="entity_def" id="Refine_While.WHILET_refine_genR|thm"><span>WHILET_refine_genR</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_8497..8499">R0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span class="free"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>COND_REF</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>STEP_REF</span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R'</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>R_REF</span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R'</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILET|const"><span>WHILET</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILET|const"><span>WHILET</span></a><span> </span><span class="free"><span>b'</span></span><span> </span><span class="free"><span>f'</span></span><span> </span><span class="free"><span>x'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILET_def|fact"><span>WHILET_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEIT_refine_genR|fact"><span>WHILEIT_refine_genR</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_8497..8499"><span>R0</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.TrueI|fact"><span>TrueI</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_8461..8466"><span>assms</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_8890..8895">lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.WHILET_refine_genR&apos;|fact"><span class="entity_def" id="Refine_While.WHILET_refine_genR&apos;|thm"><span>WHILET_refine_genR'</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_8927..8929">R0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>I'</span></span><span> </span><span class="free"><span>x'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span class="free"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>COND_REF</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>STEP_REF</span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R'</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>R_REF</span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R'</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILET|const"><span>WHILET</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEIT|const"><span>WHILEIT</span></a><span> </span><span class="free"><span>I'</span></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="free"><span>f'</span></span><span> </span><span class="free"><span>x'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILET_def|fact"><span>WHILET_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEIT_refine_genR|fact"><span>WHILEIT_refine_genR</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_8927..8929"><span>R0</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>assumption</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.TrueI|fact"><span>TrueI</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_8890..8895"><span>assms</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_9376..9381">lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.WHILEIT_refine|fact"><span class="entity_def" id="Refine_While.WHILEIT_refine|thm"><span>WHILEIT_refine</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine|attribute"><span class="operator"><span>refine</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>R0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>I'</span></span><span> </span><span class="free"><span>x'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span class="free"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>IREF</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>COND_REF</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>STEP_REF</span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEIT|const"><span>WHILEIT</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEIT|const"><span>WHILEIT</span></a><span> </span><span class="free"><span>I'</span></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="free"><span>f'</span></span><span> </span><span class="free"><span>x'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEIT_refine_genR|fact"><span>WHILEIT_refine_genR</span></a><span class="main"><span>[</span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> R</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="free"><span>R</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>and</span></span></span></span><span> R'</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="free"><span>R</span></span></span><span class="main"><span>,</span></span><span> </span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_9376..9381"><span>assms</span></a><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_9762..9767">lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.WHILET_refine|fact"><span class="entity_def" id="Refine_While.WHILET_refine|thm"><span>WHILET_refine</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine|attribute"><span class="operator"><span>refine</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>R0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span class="free"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>COND_REF</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>STEP_REF</span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILET|const"><span>WHILET</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILET|const"><span>WHILET</span></a><span> </span><span class="free"><span>b'</span></span><span> </span><span class="free"><span>f'</span></span><span> </span><span class="free"><span>x'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILET_def|fact"><span>WHILET_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEIT_refine|fact"><span>WHILEIT_refine</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_9762..9767"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_10071..10076">lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.WHILET_refine&apos;|fact"><span class="entity_def" id="Refine_While.WHILET_refine&apos;|thm"><span>WHILET_refine'</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine|attribute"><span class="operator"><span>refine</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>R0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>I'</span></span><span> </span><span class="free"><span>x'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span class="free"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>COND_REF</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>STEP_REF</span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILET|const"><span>WHILET</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEIT|const"><span>WHILEIT</span></a><span> </span><span class="free"><span>I'</span></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="free"><span>f'</span></span><span> </span><span class="free"><span>x'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILET_def|fact"><span>WHILET_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEIT_refine|fact"><span>WHILEIT_refine</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_10071..10076"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>


</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_10408..10413">lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.WHILEI_refine_new_invar|fact"><span class="entity_def" id="Refine_While.WHILEI_refine_new_invar|thm"><span>WHILEI_refine_new_invar</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>R0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>I'</span></span><span> </span><span class="free"><span>x'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span class="free"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>INV0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="free"><span>x'</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span class="free"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>COND_REF</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>STEP_REF</span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>STEP_INV</span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI|const"><span>WHILEI</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI|const"><span>WHILEI</span></a><span> </span><span class="free"><span>I'</span></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="free"><span>f'</span></span><span> </span><span class="free"><span>x'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI_refine_genR|fact"><span>WHILEI_refine_genR</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> 
    I</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="free"><span>I</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> I'</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="free"><span>I'</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> x'</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="free"><span>x'</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> x</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="free"><span>x</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> R</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="free"><span>R</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> b</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="free"><span>b</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> b'</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="free"><span>b'</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> f'</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="free"><span>f'</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="free"><span>f</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> R'</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>c</span></span><span class="main"><span>,</span></span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>c</span></span><span class="main"><span>,</span></span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>c</span></span><span> </span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_10408..10413"><span>assms</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.add_invar_refineI|fact"><span>add_invar_refineI</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_11041..11046">lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.WHILEIT_refine_new_invar|fact"><span class="entity_def" id="Refine_While.WHILEIT_refine_new_invar|thm"><span>WHILEIT_refine_new_invar</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>R0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>I'</span></span><span> </span><span class="free"><span>x'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span class="free"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>INV0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="free"><span>x'</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span class="free"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>COND_REF</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>STEP_REF</span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>STEP_INV</span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I'</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEIT|const"><span>WHILEIT</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEIT|const"><span>WHILEIT</span></a><span> </span><span class="free"><span>I'</span></span><span> </span><span class="free"><span>b'</span></span><span> </span><span class="free"><span>f'</span></span><span> </span><span class="free"><span>x'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEIT_refine_genR|fact"><span>WHILEIT_refine_genR</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> 
    I</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="free"><span>I</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> I'</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="free"><span>I'</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> x'</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="free"><span>x'</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> x</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="free"><span>x</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> R</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="free"><span>R</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> b</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="free"><span>b</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> b'</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="free"><span>b'</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> f'</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="free"><span>f'</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="free"><span>f</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> R'</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>c</span></span><span class="main"><span>,</span></span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>c</span></span><span class="main"><span>,</span></span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>c</span></span><span> </span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_11041..11046"><span>assms</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.add_invar_refineI|fact"><span>add_invar_refineI</span></a><span class="main"><span>)</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Autoref Setup›</span></span></span><span>

</span><span class="comment1"><span>(*lemma id_WHILE[autoref_id_self]: "ID_LIST 
  (l (WHILET,3) (WHILEIT I,3) (WHILE,3) (WHILEI I,3))"
  by simp_all*)</span></span><span>

</span><span class="keyword1"><span class="command"><span>context</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span> </span><span class="keyword1"><span class="command"><span>interpretation</span></span></span><span> </span><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tool.html#Autoref_Tool.autoref_syn|locale"><span>autoref_syn</span></a><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Automatic_Refinement/Autoref_Id_Ops.html#Autoref_Id_Ops.autoref_op_pat_def|attribute"><span class="operator"><span>autoref_op_pat_def</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEIT|const"><span>WHILEIT</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.OP|const"><span>OP</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEIT|const"><span>WHILEIT</span></a><span> </span><span class="free"><span>I</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI|const"><span>WHILEI</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.OP|const"><span>OP</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI|const"><span>WHILEI</span></a><span> </span><span class="free"><span>I</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_11967..11972">lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.autoref_WHILET|fact"><span class="entity_def" id="Refine_While.autoref_WHILET|thm"><span>autoref_WHILET</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../Automatic_Refinement/Autoref_Relator_Interface.html#Autoref_Relator_Interface.autoref_rules|attribute"><span class="operator"><span>autoref_rules</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="free"><span>c'</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><a class="entity_ref" href="../Automatic_Refinement/Autoref_Translate.html#Autoref_Translate.REMOVE_INTERNAL|const"><span>REMOVE_INTERNAL</span></a><span> </span><span class="free"><span>c'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>⟧</span></span><span> 
    </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="free"><span>f'</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><span class="main"><span>⟨</span></span><span class="free"><span>R</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>s</span></span><span class="main"><span>,</span></span><span class="free"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILET|const"><span>WHILET</span></a><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>,</span></span><span>
    </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.OP|const"><span>OP</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILET|const"><span>WHILET</span></a><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.rel_ANNOT|const"><span>:::</span></a></span><span class="main"><span>(</span></span><span class="free"><span>R</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span class="main"><span>(</span></span><span class="free"><span>R</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span class="main"><span>⟨</span></span><span class="free"><span>R</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span class="free"><span>R</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span class="main"><span>⟨</span></span><span class="free"><span>R</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="free"><span>c'</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="free"><span>f'</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="free"><span>s'</span></span><span class="main"><span>)</span></span><span>
   </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><span class="main"><span>⟨</span></span><span class="free"><span>R</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_11967..11972"><span>assms</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres_rel_def|fact"><span>nres_rel_def</span></a><span> </span><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_def|fact"><span>fun_rel_def</span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILET_refine|fact"><span>WHILET_refine</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_12353..12358">lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.autoref_WHILEIT|fact"><span class="entity_def" id="Refine_While.autoref_WHILEIT|thm"><span class="entity_def" id="offset_12359..12374">autoref_WHILEIT</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../Automatic_Refinement/Autoref_Relator_Interface.html#Autoref_Relator_Interface.autoref_rules|attribute"><span class="operator"><span>autoref_rules</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="free"><span>c'</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><a class="entity_ref" href="../Automatic_Refinement/Autoref_Translate.html#Autoref_Translate.REMOVE_INTERNAL|const"><span>REMOVE_INTERNAL</span></a><span> </span><span class="free"><span>c'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="free"><span>f'</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><span class="main"><span>⟨</span></span><span class="free"><span>R</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>I</span></span><span> </span><span class="free"><span>s'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>s</span></span><span class="main"><span>,</span></span><span class="free"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILET|const"><span>WHILET</span></a><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>,</span></span><span>
      </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.OP|const"><span>OP</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEIT|const"><span>WHILEIT</span></a><span> </span><span class="free"><span>I</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.rel_ANNOT|const"><span>:::</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>R</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>R</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span class="main"><span>⟨</span></span><span class="free"><span>R</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="main"><span>⟨</span></span><span class="free"><span>R</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="free"><span>c'</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="free"><span>f'</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="free"><span>s'</span></span><span>
    </span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="main"><span>⟨</span></span><span class="free"><span>R</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_12353..12358"><span>assms</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres_rel_def|fact"><span>nres_rel_def</span></a><span> </span><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_def|fact"><span>fun_rel_def</span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILET_refine&apos;|fact"><span>WHILET_refine'</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_12767..12772">lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.autoref_WHILEIT&apos;|fact"><span class="entity_def" id="Refine_While.autoref_WHILEIT&apos;|thm"><span>autoref_WHILEIT'</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../Automatic_Refinement/Autoref_Relator_Interface.html#Autoref_Relator_Interface.autoref_rules|attribute"><span class="operator"><span>autoref_rules</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="free"><span>c'</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><a class="entity_ref" href="../Automatic_Refinement/Autoref_Translate.html#Autoref_Translate.REMOVE_INTERNAL|const"><span>REMOVE_INTERNAL</span></a><span> </span><span class="free"><span>c'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>⟧</span></span><span> 
    </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="free"><span>f'</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><span class="main"><span>⟨</span></span><span class="free"><span>R</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILET|const"><span>WHILET</span></a><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>,</span></span><span>
      </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.OP|const"><span>OP</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEIT|const"><span>WHILEIT</span></a><span> </span><span class="free"><span>I</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.rel_ANNOT|const"><span>:::</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>R</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>R</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span class="main"><span>⟨</span></span><span class="free"><span>R</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="main"><span>⟨</span></span><span class="free"><span>R</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="free"><span>c'</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="free"><span>f'</span></span><span>
    </span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="main"><span>⟨</span></span><span class="free"><span>R</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.autoref_tag_defs|fact"><span class="dynamic"><span class="dynamic"><span>autoref_tag_defs</span></span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Automatic_Refinement/Param_Tool.html#Param_Tool.parametricity|method"><span class="operator"><span>parametricity</span></span></a><span> 
      </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_12359..12374"><span>autoref_WHILEIT</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>unfolded</span></span><span> </span><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.autoref_tag_defs|fact"><span class="dynamic"><span class="dynamic"><span>autoref_tag_defs</span></span></span></a><span class="main"><span class="main"><span>]</span></span></span><span>
      </span><a class="entity_ref" href="Refine_While.html#offset_12767..12772"><span>assms</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>unfolded</span></span><span> </span><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.autoref_tag_defs|fact"><span class="dynamic"><span class="dynamic"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.autoref_tag_defs|fact"><span class="dynamic"><span class="dynamic"><span>autoref_tag_defs</span></span></span></a></span></span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_13225..13230">lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.autoref_WHILE|fact"><span class="entity_def" id="Refine_While.autoref_WHILE|thm"><span>autoref_WHILE</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../Automatic_Refinement/Autoref_Relator_Interface.html#Autoref_Relator_Interface.autoref_rules|attribute"><span class="operator"><span>autoref_rules</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="comment1"><span>(** TODO: obsolete ? **)</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="free"><span>c'</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><a class="entity_ref" href="../Automatic_Refinement/Autoref_Translate.html#Autoref_Translate.REMOVE_INTERNAL|const"><span>REMOVE_INTERNAL</span></a><span> </span><span class="free"><span>c'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>⟧</span></span><span> 
    </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="free"><span>f'</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><span class="main"><span>⟨</span></span><span class="free"><span>R</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>s</span></span><span class="main"><span>,</span></span><span class="free"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>,</span></span><span>
      </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.OP|const"><span>OP</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.rel_ANNOT|const"><span>:::</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>R</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>R</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span class="main"><span>⟨</span></span><span class="free"><span>R</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="main"><span>⟨</span></span><span class="free"><span>R</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="free"><span>c'</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="free"><span>f'</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="free"><span>s'</span></span><span>
    </span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="main"><span>⟨</span></span><span class="free"><span>R</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_13225..13230"><span>assms</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres_rel_def|fact"><span>nres_rel_def</span></a><span> </span><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_def|fact"><span>fun_rel_def</span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE_refine|fact"><span>WHILE_refine</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_13642..13647">lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.autoref_WHILE&apos;|fact"><span class="entity_def" id="Refine_While.autoref_WHILE&apos;|thm"><span>autoref_WHILE'</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../Automatic_Refinement/Autoref_Relator_Interface.html#Autoref_Relator_Interface.autoref_rules|attribute"><span class="operator"><span>autoref_rules</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="free"><span>c'</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><a class="entity_ref" href="../Automatic_Refinement/Autoref_Translate.html#Autoref_Translate.REMOVE_INTERNAL|const"><span>REMOVE_INTERNAL</span></a><span> </span><span class="free"><span>c'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>⟧</span></span><span> 
    </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="free"><span>f'</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><span class="main"><span>⟨</span></span><span class="free"><span>R</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>,</span></span><span>
      </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.OP|const"><span>OP</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.rel_ANNOT|const"><span>:::</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>R</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>R</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span class="main"><span>⟨</span></span><span class="free"><span>R</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="main"><span>⟨</span></span><span class="free"><span>R</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="free"><span>c'</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="free"><span>f'</span></span><span>
    </span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="main"><span>⟨</span></span><span class="free"><span>R</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_13642..13647"><span>assms</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres_rel_def|fact"><span>nres_rel_def</span></a><span> </span><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_def|fact"><span>fun_rel_def</span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE_refine|fact"><span>WHILE_refine</span></a><span class="main"><span>)</span></span><span>


</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_14014..14019">lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.autoref_WHILEI|fact"><span class="entity_def" id="Refine_While.autoref_WHILEI|thm"><span class="entity_def" id="offset_14020..14034">autoref_WHILEI</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../Automatic_Refinement/Autoref_Relator_Interface.html#Autoref_Relator_Interface.autoref_rules|attribute"><span class="operator"><span>autoref_rules</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="free"><span>c'</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><a class="entity_ref" href="../Automatic_Refinement/Autoref_Translate.html#Autoref_Translate.REMOVE_INTERNAL|const"><span>REMOVE_INTERNAL</span></a><span> </span><span class="free"><span>c'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="free"><span>f'</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><span class="main"><span>⟨</span></span><span class="free"><span>R</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>I</span></span><span> </span><span class="free"><span>s'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>s</span></span><span class="main"><span>,</span></span><span class="free"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>,</span></span><span>
      </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.OP|const"><span>OP</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI|const"><span>WHILEI</span></a><span> </span><span class="free"><span>I</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.rel_ANNOT|const"><span>:::</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>R</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>R</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span class="main"><span>⟨</span></span><span class="free"><span>R</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="main"><span>⟨</span></span><span class="free"><span>R</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="free"><span>c'</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="free"><span>f'</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="free"><span>s'</span></span><span>
    </span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="main"><span>⟨</span></span><span class="free"><span>R</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_14014..14019"><span>assms</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres_rel_def|fact"><span>nres_rel_def</span></a><span> </span><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_def|fact"><span>fun_rel_def</span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE_refine&apos;|fact"><span>WHILE_refine'</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_14424..14429">lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.autoref_WHILEI&apos;|fact"><span class="entity_def" id="Refine_While.autoref_WHILEI&apos;|thm"><span>autoref_WHILEI'</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../Automatic_Refinement/Autoref_Relator_Interface.html#Autoref_Relator_Interface.autoref_rules|attribute"><span class="operator"><span>autoref_rules</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="free"><span>c'</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><a class="entity_ref" href="../Automatic_Refinement/Autoref_Translate.html#Autoref_Translate.REMOVE_INTERNAL|const"><span>REMOVE_INTERNAL</span></a><span> </span><span class="free"><span>c'</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>⟧</span></span><span> 
    </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="free"><span>f'</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><span class="main"><span>⟨</span></span><span class="free"><span>R</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>,</span></span><span>
      </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.OP|const"><span>OP</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI|const"><span>WHILEI</span></a><span> </span><span class="free"><span>I</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.rel_ANNOT|const"><span>:::</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>R</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>R</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span class="main"><span>⟨</span></span><span class="free"><span>R</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="main"><span>⟨</span></span><span class="free"><span>R</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="free"><span>c'</span></span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.APP|const"><span>$</span></a></span><span class="free"><span>f'</span></span><span>
    </span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="main"><span>⟨</span></span><span class="free"><span>R</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.autoref_tag_defs|fact"><span class="dynamic"><span class="dynamic"><span>autoref_tag_defs</span></span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Automatic_Refinement/Param_Tool.html#Param_Tool.parametricity|method"><span class="operator"><span>parametricity</span></span></a><span> 
      </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_14020..14034"><span>autoref_WHILEI</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>unfolded</span></span><span> </span><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.autoref_tag_defs|fact"><span class="dynamic"><span class="dynamic"><span>autoref_tag_defs</span></span></span></a><span class="main"><span class="main"><span>]</span></span></span><span>
      </span><a class="entity_ref" href="Refine_While.html#offset_14424..14429"><span>assms</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>unfolded</span></span><span> </span><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.autoref_tag_defs|fact"><span class="dynamic"><span class="dynamic"><a class="entity_ref" href="../Automatic_Refinement/Autoref_Tagging.html#Autoref_Tagging.autoref_tag_defs|fact"><span class="dynamic"><span class="dynamic"><span>autoref_tag_defs</span></span></span></a></span></span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>



</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Invariants›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Tail Recursion›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>context</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_14964..14969">lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.tailrec_transform_aux1|fact"><span class="entity_def" id="Refine_While.tailrec_transform_aux1|thm"><span class="entity_def" id="offset_14970..14992">tailrec_transform_aux1</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>m</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="RefineG_Recursion.html#RefineG_Recursion.REC|const"><span>REC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>D</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.sup_class.sup|const"><span>sup</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Inductive.html#Inductive.complete_lattice_class.lfp|const"><span>lfp</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.sup_class.sup|const"><span>sup</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span>
    </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="RefineG_Recursion.html#RefineG_Recursion.REC|const"><span>REC</span></a><span> </span><span class="var"><span>?F</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Inductive.html#Inductive.complete_lattice_class.lfp|const"><span>lfp</span></a><span> </span><span class="var"><span>?f</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="RefineG_Recursion.html#RefineG_Recursion.REC_rule|fact"><span>REC_rule</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> pre </span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>λ</span></span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Inductive.html#Inductive.complete_lattice_class.lfp|const"><span>lfp</span></a><span> </span><span class="var"><span>?f</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="Refine_Mono_Prover.html#Refine_Mono_Prover.refine_mono|method"><span class="operator"><span>refine_mono</span></span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Inductive.html#Inductive.complete_lattice_class.lfp|const"><span>lfp</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.sup_class.sup|const"><span>sup</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Inductive.html#Inductive.lfp_unfold|fact"><span>lfp_unfold</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="../Automatic_Refinement/Tagged_Solver.html#Tagged_Solver.tagged_solver|method"><span class="operator"><span>tagged_solver</span></span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_14964..14969"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.semilattice_sup_class.le_supI1|fact"><span>le_supI1</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>f</span></span><span> </span><span class="skolem"><span>x</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_15380..15382">IH</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Inductive.html#Inductive.complete_lattice_class.lfp|const"><span>lfp</span></a><span> </span><span class="var"><span>?f</span></span><span> </span><span class="main"><span>⟹</span></span><span>
                  </span><span class="skolem"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Inductive.html#Inductive.complete_lattice_class.lfp|const"><span>lfp</span></a><span> </span><span class="var"><span>?f</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_15453..15456">PRE</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Inductive.html#Inductive.complete_lattice_class.lfp|const"><span>lfp</span></a><span> </span><span class="var"><span>?f</span></span><span>"</span></span></span><span>
  
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>" </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.sup_class.sup|const"><span>sup</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><span class="skolem"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Inductive.html#Inductive.complete_lattice_class.lfp|const"><span>lfp</span></a><span> </span><span class="var"><span>?f</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.semilattice_sup_class.sup_least|fact"><span>sup_least</span></a><span class="main"><span>)</span></span><span>  
      </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Inductive.html#Inductive.complete_lattice_class.lfp|const"><span>lfp</span></a><span> </span><span class="var"><span>?f</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_15453..15456"><span>PRE</span></a><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_15453..15456"><span>PRE</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Inductive.html#Inductive.complete_lattice_class.lfp|const"><span>lfp</span></a><span> </span><span class="var"><span>?f</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><span class="free"><span>a</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>…</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Inductive.html#Inductive.complete_lattice_class.lfp|const"><span>lfp</span></a><span> </span><span class="var"><span>?f</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Inductive.html#Inductive.lfp_unfold|fact"><span>lfp_unfold</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="../Automatic_Refinement/Tagged_Solver.html#Tagged_Solver.tagged_solver|method"><span class="operator"><span>tagged_solver</span></span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.semilattice_sup_class.le_supI2|fact"><span>le_supI2</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><span class="skolem"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Inductive.html#Inductive.complete_lattice_class.lfp|const"><span>lfp</span></a><span> </span><span class="var"><span>?f</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_15380..15382"><span>IH</span></a><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>  
  
  </span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span>corollary</span></span></span><span> </span><span class="entity_def" id="Refine_While.tailrec_transform1|fact"><span class="entity_def" id="Refine_While.tailrec_transform1|thm"><span class="entity_def" id="offset_16041..16059">tailrec_transform1</span></span></span><span class="main"><span>:</span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres|type"><span>nres</span></a><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><a class="entity_ref" href="RefineG_Recursion.html#RefineG_Recursion.REC|const"><span>REC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>D</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.sup_class.sup|const"><span>sup</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Inductive.html#Inductive.complete_lattice_class.lfp|const"><span>lfp</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.sup_class.sup|const"><span>sup</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="free"><span>m</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>erule</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.bind_le_nofailI|fact"><span>bind_le_nofailI</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>erule</span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_14970..14992"><span>tailrec_transform_aux1</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.not_nofail_iff|fact"><span>not_nofail_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Inductive.html#Inductive.lfp_const|fact"><span>lfp_const</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
  
            
  </span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.tailrec_transform_aux2|fact"><span class="entity_def" id="Refine_While.tailrec_transform_aux2|thm"><span class="entity_def" id="offset_16353..16375">tailrec_transform_aux2</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres|type"><span>nres</span></a><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Inductive.html#Inductive.complete_lattice_class.lfp|const"><span>lfp</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.sup_class.sup|const"><span>sup</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> 
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="RefineG_Recursion.html#RefineG_Recursion.REC|const"><span>REC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>D</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.sup_class.sup|const"><span>sup</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Inductive.html#Inductive.complete_lattice_class.lfp|const"><span>lfp</span></a><span> </span><span class="var"><span>?f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="RefineG_Recursion.html#RefineG_Recursion.REC|const"><span>REC</span></a><span> </span><span class="var"><span>?F</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="Refine_Misc.html#Refine_Misc.gen_kleene_lfp|fact"><span>gen_kleene_lfp</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Misc.html#Refine_Misc.cont_def|fact"><span>cont_def</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_eq_iff|fact"><span>pw_eq_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Complete_Lattices.html#Complete_Lattices.complete_lattice_class.SUP_least|fact"><span>SUP_least</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>i</span></span><span>
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.compower|const"><span>^^</span></a></span><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="RefineG_Recursion.html#RefineG_Recursion.REC|const"><span>REC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>D</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.sup_class.sup|const"><span>sup</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induction.ML.html#HOL.induction|method"><span class="operator"><span>induction</span></span></a><span> </span><span class="quoted"><span class="skolem"><span>i</span></span></span><span> </span><span class="quasi_keyword"><span>arbitrary</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="free"><span>m</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="RefineG_Recursion.html#RefineG_Recursion.REC_unfold|fact"><span>REC_unfold</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="Refine_Mono_Prover.html#Refine_Mono_Prover.refine_mono|method"><span class="operator"><span>refine_mono</span></span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="main"><span>)</span></span><span>
      
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.funpow_Suc_right|fact"><span>funpow_Suc_right</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order_trans|fact"><span>order_trans</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../Automatic_Refinement/Refine_Util.html#Refine_Util.rprems|method"><span class="operator"><span>rprems</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="RefineG_Recursion.html#RefineG_Recursion.REC_unfold|fact"><span>REC_unfold</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="Refine_Mono_Prover.html#Refine_Mono_Prover.refine_mono|method"><span class="operator"><span>refine_mono</span></span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.bind_distrib_sup2|fact"><span>bind_distrib_sup2</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  
  
  </span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.tailrec_transform_aux3|fact"><span class="entity_def" id="Refine_While.tailrec_transform_aux3|thm"><span class="entity_def" id="offset_17159..17181">tailrec_transform_aux3</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="RefineG_Recursion.html#RefineG_Recursion.REC|const"><span>REC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>D</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.sup_class.sup|const"><span>sup</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><span class="free"><span>b</span></span><span> 
    </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="RefineG_Recursion.html#RefineG_Recursion.REC|const"><span>REC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>D</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.sup_class.sup|const"><span>sup</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.bind_le_shift|fact"><span>bind_le_shift</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="RefineG_Recursion.html#RefineG_Recursion.REC_rule|fact"><span>REC_rule</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="Refine_Mono_Prover.html#Refine_Mono_Prover.refine_mono|method"><span class="operator"><span>refine_mono</span></span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.TrueI|fact"><span>TrueI</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><span class="quasi_keyword"><span>asm</span></span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>4</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="RefineG_Recursion.html#RefineG_Recursion.REC_unfold|fact"><span>REC_unfold</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="Refine_Mono_Prover.html#Refine_Mono_Prover.refine_mono|method"><span class="operator"><span>refine_mono</span></span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order_trans|fact"><span>order_trans</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.bind_mono|fact"><span>bind_mono</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order_refl|fact"><span>order_refl</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../Automatic_Refinement/Refine_Util.html#Refine_Util.rprems|method"><span class="operator"><span>rprems</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>3</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="RefineG_Recursion.html#RefineG_Recursion.REC_unfold|fact"><span>REC_unfold</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="Refine_Mono_Prover.html#Refine_Mono_Prover.refine_mono|method"><span class="operator"><span>refine_mono</span></span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="main"><span>)</span></span><span>
  
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="RefineG_Recursion.html#RefineG_Recursion.REC_unfold|fact"><span>REC_unfold</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="Refine_Mono_Prover.html#Refine_Mono_Prover.refine_mono|method"><span class="operator"><span>refine_mono</span></span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
  
  </span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.tailrec_transform2|fact"><span class="entity_def" id="Refine_While.tailrec_transform2|thm"><span class="entity_def" id="offset_17700..17718">tailrec_transform2</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Inductive.html#Inductive.complete_lattice_class.lfp|const"><span>lfp</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.sup_class.sup|const"><span>sup</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.bind|const"><span>bind</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="RefineG_Recursion.html#RefineG_Recursion.REC|const"><span>REC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>D</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.sup_class.sup|const"><span>sup</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.bind_mono|fact"><span>bind_mono</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_16353..16375"><span>tailrec_transform_aux2</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order_refl|fact"><span>order_refl</span></a><span class="main"><span>]</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Inductive.html#Inductive.complete_lattice_class.lfp|const"><span>lfp</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.sup_class.sup|const"><span>sup</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.bind|const"><span>bind</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><span class="free"><span>b</span></span><span> 
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="RefineG_Recursion.html#RefineG_Recursion.REC|const"><span>REC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>D</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.sup_class.sup|const"><span>sup</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.bind_mono|fact"><span>bind_mono</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order_refl|fact"><span>order_refl</span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_17159..17181"><span>tailrec_transform_aux3</span></a><span class="main"><span>]</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>…</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="RefineG_Recursion.html#RefineG_Recursion.REC|const"><span>REC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>D</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.sup_class.sup|const"><span>sup</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>  
  
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Refine_While.tailrec_body_def|fact"><span class="entity_def" id="Refine_While.tailrec_body_def|thm"><span class="entity_def" id="Refine_While.tailrec_body_def_raw|axiom"><span class="entity_def" id="offset_18141..18151">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Refine_While.tailrec_body|const"><span>tailrec_body</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>a</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>b</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>D</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.sup_class.sup|const"><span>sup</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.bind|const"><span>bind</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>a</span></span></span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>b</span></span></span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  
  </span><span class="keyword1"><span class="command"><span>theorem</span></span></span><span> </span><span class="entity_def" id="Refine_While.tailrec_transform|fact"><span class="entity_def" id="Refine_While.tailrec_transform|thm"><span class="entity_def" id="offset_18219..18236">tailrec_transform</span></span></span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="RefineG_Recursion.html#RefineG_Recursion.REC|const"><span>REC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>D</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.sup_class.sup|const"><span>sup</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Inductive.html#Inductive.complete_lattice_class.lfp|const"><span>lfp</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.sup_class.sup|const"><span>sup</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.bind|const"><span>bind</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.antisym|fact"><span>antisym</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_16041..16059"><span>tailrec_transform1</span></a><span class="main"><span>)</span></span><span>  
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_17700..17718"><span>tailrec_transform2</span></a><span class="main"><span>)</span></span><span>  
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
  
  </span><span class="keyword1"><span class="command"><span>theorem</span></span></span><span> </span><span class="entity_def" id="Refine_While.tailrec_transform&apos;|fact"><span class="entity_def" id="Refine_While.tailrec_transform&apos;|thm"><span class="entity_def" id="offset_18437..18455">tailrec_transform'</span></span></span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="RefineG_Recursion.html#RefineG_Recursion.REC|const"><span>REC</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.tailrec_body|const"><span>tailrec_body</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Inductive.html#Inductive.complete_lattice_class.lfp|const"><span>lfp</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.sup_class.sup|const"><span>sup</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.bind|const"><span>bind</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_18141..18151"><span>tailrec_body_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_18219..18236"><span>tailrec_transform</span></a><span class="main"><span>)</span></span><span>
  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> 
    </span><a class="entity_ref" href="RefineG_Recursion.html#RefineG_Recursion.REC|const"><span>REC</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.tailrec_body|const"><span>tailrec_body</span></a><span> 
      </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.ASSUME|const"><span>ASSUME</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> 
      </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.ASSUME|const"><span>ASSUME</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>c</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>s</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILE_def|fact"><span>WHILE_def</span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILEI_def|fact"><span>WHILEI_def</span></a><span> </span><a class="entity_ref" href="RefineG_While.html#RefineG_While.WHILEI_body_def|fact"><span>WHILEI_body_def</span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_18141..18151"><span>tailrec_body_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Automatic_Refinement/Refine_Util.html#Refine_Util.fo_rule|method"><span class="operator"><span>fo_rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.fun_cong|fact"><span>fun_cong</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.arg_cong|fact"><span>arg_cong</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.ext|fact"><span>ext</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.WHILEI_tailrec_conv|fact"><span class="entity_def" id="Refine_While.WHILEI_tailrec_conv|thm"><span class="entity_def" id="offset_18879..18898">WHILEI_tailrec_conv</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI|const"><span>WHILEI</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> 
    </span><a class="entity_ref" href="RefineG_Recursion.html#RefineG_Recursion.REC|const"><span>REC</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.tailrec_body|const"><span>tailrec_body</span></a><span> 
      </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.ASSUME|const"><span>ASSUME</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> 
      </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.ASSUME|const"><span>ASSUME</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>c</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>s</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILEI_def|fact"><span>WHILEI_def</span></a><span> </span><a class="entity_ref" href="RefineG_While.html#RefineG_While.WHILEI_body_def|fact"><span>WHILEI_body_def</span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_18141..18151"><span>tailrec_body_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Automatic_Refinement/Refine_Util.html#Refine_Util.fo_rule|method"><span class="operator"><span>fo_rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.fun_cong|fact"><span>fun_cong</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.arg_cong|fact"><span>arg_cong</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.ext|fact"><span>ext</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.WHILEIT_tailrec_conv|fact"><span class="entity_def" id="Refine_While.WHILEIT_tailrec_conv|thm"><span>WHILEIT_tailrec_conv</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEIT|const"><span>WHILEIT</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> 
    </span><a class="entity_ref" href="RefineG_Recursion.html#RefineG_Recursion.RECT|const"><span>RECT</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.tailrec_body|const"><span>tailrec_body</span></a><span> 
      </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.ASSUME|const"><span>ASSUME</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> 
      </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.ASSUME|const"><span>ASSUME</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>c</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>s</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILEIT_def|fact"><span>WHILEIT_def</span></a><span> </span><a class="entity_ref" href="RefineG_While.html#RefineG_While.WHILEI_body_def|fact"><span>WHILEI_body_def</span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_18141..18151"><span>tailrec_body_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Automatic_Refinement/Refine_Util.html#Refine_Util.fo_rule|method"><span class="operator"><span>fo_rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.fun_cong|fact"><span>fun_cong</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.arg_cong|fact"><span>arg_cong</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.ext|fact"><span>ext</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
  
  
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Refine_While.WHILEI_lfp_body_def|fact"><span class="entity_def" id="Refine_While.WHILEI_lfp_body_def|thm"><span class="entity_def" id="Refine_While.WHILEI_lfp_body_def_raw|axiom"><span class="entity_def" id="offset_19526..19536">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Refine_While.WHILEI_lfp_body|const"><span>WHILEI_lfp_body</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>I</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>c</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> 
    </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.sup_class.sup|const"><span>sup</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
       </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>←</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span>
       </span><span class="main"><span class="bound"><span>_</span></span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>I</span></span></span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
       </span><span class="main"><span class="bound"><span>_</span></span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.ASSUME|const"><span>ASSUME</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>c</span></span></span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
       </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="bound"><span>s</span></span><span>
     </span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.WHILEI_lfp_conv|fact"><span class="entity_def" id="Refine_While.WHILEI_lfp_conv|thm"><span>WHILEI_lfp_conv</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI|const"><span>WHILEI</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> 
    </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span> 
      </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Inductive.html#Inductive.complete_lattice_class.lfp|const"><span>lfp</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI_lfp_body|const"><span>WHILEI_lfp_body</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> 
      </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> 
      </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.ASSUME|const"><span>ASSUME</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>c</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> 
      </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>s</span></span><span> 
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_19526..19536"><span>WHILEI_lfp_body_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_18879..18898"><span>WHILEI_tailrec_conv</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_18437..18455"><span>tailrec_transform'</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>..</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Most Specific Invariant›</span></span></span><span>
  
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Refine_While.msii_def|fact"><span class="entity_def" id="Refine_While.msii_def|thm"><span class="entity_def" id="Refine_While.msii_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Refine_While.msii|const"><span>msii</span></span></span><span> </span><span class="comment1"><span>― ‹Most specific invariant for WHILE-loop›</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>msii</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>I</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>c</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Inductive.html#Inductive.complete_lattice_class.lfp|const"><span>lfp</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI_lfp_body|const"><span>WHILEI_lfp_body</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>I</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>c</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.intro|attribute"><span class="operator"><span>intro</span></span></a><span class="main"><span class="main"><span class="main"><span class="main"><span>!</span></span></span></span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.order_class.mono|const"><span>mono</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI_lfp_body|const"><span>WHILEI_lfp_body</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI_lfp_body_def|fact"><span>WHILEI_lfp_body_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../Automatic_Refinement/Tagged_Solver.html#Tagged_Solver.tagged_solver|method"><span class="operator"><span>tagged_solver</span></span></a><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Refine_While.filter_ASSUME_def|fact"><span class="entity_def" id="Refine_While.filter_ASSUME_def|thm"><span class="entity_def" id="Refine_While.filter_ASSUME_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Refine_While.filter_ASSUME|const"><span>filter_ASSUME</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>c</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>x</span></span><span class="main"><span>←</span></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.ASSUME|const"><span>ASSUME</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>c</span></span></span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>x</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Refine_While.filter_ASSERT_def|fact"><span class="entity_def" id="Refine_While.filter_ASSERT_def|thm"><span class="entity_def" id="Refine_While.filter_ASSERT_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Refine_While.filter_ASSERT|const"><span>filter_ASSERT</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>c</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>x</span></span><span class="main"><span>←</span></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>c</span></span></span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>x</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|attribute"><span class="operator"><span>refine_pw_simps</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_ASSUME|const"><span>filter_ASSUME</span></a><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>m</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="free"><span>m</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_ASSUME_def|fact"><span>filter_ASSUME_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|attribute"><span class="operator"><span>refine_pw_simps</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.inres|const"><span>inres</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_ASSUME|const"><span>filter_ASSUME</span></a><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>m</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>x</span></span><span> 
  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.inres|const"><span>inres</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_ASSUME_def|fact"><span>filter_ASSUME_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.msii_is_invar|fact"><span class="entity_def" id="Refine_While.msii_is_invar(2)|thm"><span class="entity_def" id="Refine_While.msii_is_invar(1)|thm"><span>msii_is_invar</span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.msii|const"><span>msii</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.msii|const"><span>msii</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.bind|const"><span>bind</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_ASSUME|const"><span>filter_ASSUME</span></a><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_ASSERT|const"><span>filter_ASSERT</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>m</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.msii|const"><span>msii</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span>  </span><a class="entity_ref" href="Refine_While.html#Refine_While.msii_def|fact"><span>msii_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Inductive.html#Inductive.lfp_unfold|fact"><span>lfp_unfold</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI_lfp_body_def|fact"><span>WHILEI_lfp_body_def</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_ASSUME_def|fact"><span>filter_ASSUME_def</span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_ASSERT_def|fact"><span>filter_ASSERT_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Inductive.html#Inductive.lfp_unfold|fact"><span>lfp_unfold</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI_lfp_body_def|fact"><span>WHILEI_lfp_body_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>only</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.WHILE_msii_conv|fact"><span class="entity_def" id="Refine_While.WHILE_msii_conv|thm"><span>WHILE_msii_conv</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI|const"><span>WHILEI</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span> 
  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_ASSUME|const"><span>filter_ASSUME</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Not</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>o</span></a></span><span> </span><span class="free"><span>c</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_ASSERT|const"><span>filter_ASSERT</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.msii|const"><span>msii</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI_lfp_conv|fact"><span>WHILEI_lfp_conv</span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_ASSERT_def|fact"><span>filter_ASSERT_def</span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_ASSUME_def|fact"><span>filter_ASSUME_def</span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.msii_def|fact"><span>msii_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.msii_induct|fact"><span class="entity_def" id="Refine_While.msii_induct|thm"><span>msii_induct</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_21277..21279">I0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m0</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>P</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_21300..21302">IS</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>m</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span class="bound"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.msii|const"><span>msii</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>;</span></span><span> </span><span class="bound"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>P</span></span><span class="main"><span>;</span></span><span>
    </span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_ASSUME|const"><span>filter_ASSUME</span></a><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_ASSERT|const"><span>filter_ASSERT</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>m</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.msii|const"><span>msii</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span>
      </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_ASSUME|const"><span>filter_ASSUME</span></a><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_ASSERT|const"><span>filter_ASSERT</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>m</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>P</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.msii|const"><span>msii</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>P</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.msii_def|fact"><span>msii_def</span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI_lfp_body_def|fact"><span>WHILEI_lfp_body_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_Misc.html#Refine_Misc.lfp_gen_induct|fact"><span>lfp_gen_induct</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="../Automatic_Refinement/Tagged_Solver.html#Tagged_Solver.tagged_solver|method"><span class="operator"><span>tagged_solver</span></span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.msii_def|fact"><span>msii_def</span></a><span class="main"><span>[</span></span><span class="operator"><span>symmetric</span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI_lfp_body_def|fact"><span>WHILEI_lfp_body_def</span></a><span class="main"><span>[</span></span><span class="operator"><span>symmetric</span></span><span class="main"><span>]</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_21277..21279"><span>I0</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>drule</span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_21300..21302"><span>IS</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_ASSERT_def|fact"><span>filter_ASSERT_def</span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_ASSUME_def|fact"><span>filter_ASSUME_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Reachable without fail›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Reachable states in a while loop, ignoring failing states›</span></span></span><span>

  </span><span class="comment1"><span>(* (R)eachable states (w)ith(o)ut (f)ail. All non-fail states reachable
    in a while-loop. *)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Refine_While.rwof.inducts|fact"><span class="entity_def" id="Refine_While.rwof.simps|fact"><span class="entity_def" id="Refine_While.rwof.induct|fact"><span class="entity_def" id="Refine_While.rwof.cases|fact"><span class="entity_def" id="Refine_While.rwof.intros|fact"><span class="entity_def" id="Refine_While.rwof.inducts|thm"><span class="entity_def" id="Refine_While.rwof.simps|thm"><span class="entity_def" id="Refine_While.rwof.induct|thm"><span class="entity_def" id="Refine_While.rwof.cases|thm"><span class="entity_def" id="Refine_While.rwof.intros(2)|thm"><span class="entity_def" id="Refine_While.rwof.intros(1)|thm"><span class="entity_def" id="Refine_While.rwof_def|axiom"><span>inductive</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Refine_While.rwof|const"><span>rwof</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres|type"><span>nres</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres|type"><span>nres</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="entity"><span>m0</span></span><span> </span><span class="entity"><span>cond</span></span><span> </span><span class="entity"><span>step</span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
      </span><span class="entity_def" id="Refine_While.rwof.init|fact"><span class="entity_def" id="Refine_While.rwof.init|thm"><span>init</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><span class="free"><span>m0</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres.RES|const"><span>RES</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>X</span></span></span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span class="bound"><span class="entity"><span>X</span></span></span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>rwof</span></span><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span>"</span></span></span><span>
    </span><span class="main"><span>|</span></span><span> </span><span class="entity_def" id="Refine_While.rwof.step|fact"><span class="entity_def" id="Refine_While.rwof.step|thm"><span>step</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><span class="free"><span>rwof</span></span><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres.RES|const"><span>RES</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>Y</span></span></span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span class="bound"><span class="entity"><span>Y</span></span></span></span><span> </span><span class="main"><span>⟧</span></span><span> 
      </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>rwof</span></span><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span>"</span></span></span><span>

  </span><span class="comment1"><span>(* This lemma establishes consequences of rwof as invariants. *)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_22278..22283">lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.establish_rwof_invar|fact"><span class="entity_def" id="Refine_While.establish_rwof_invar|thm"><span>establish_rwof_invar</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_22318..22319">I</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m0</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Refine_Leof.html#Refine_Leof.le_or_fail|const"><span>≤<span class="hidden">⇩</span><sub>n</sub></span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_22349..22350">S</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>⟧</span></span><span> 
      </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Refine_Leof.html#Refine_Leof.le_or_fail|const"><span>≤<span class="hidden">⇩</span><sub>n</sub></span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>I</span></span><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_22278..22283"><span>assms</span></a><span class="main"><span>(</span></span><span>3</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.induct|method"><span class="operator"><span>induct</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_22318..22319"><span>I</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_22349..22350"><span>S</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

  </span><span class="comment1"><span>(* Predicate to express an rwof-invariant *)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Refine_While.is_rwof_invar_def|fact"><span class="entity_def" id="Refine_While.is_rwof_invar_def|thm"><span class="entity_def" id="Refine_While.is_rwof_invar_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Refine_While.is_rwof_invar|const"><span>is_rwof_invar</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m0</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>cond</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>step</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>I</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> 
      </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>m0</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Refine_Leof.html#Refine_Leof.le_or_fail|const"><span>≤<span class="hidden">⇩</span><sub>n</sub></span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>I</span></span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>s</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>m0</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>cond</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>step</span></span></span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>I</span></span></span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>cond</span></span></span></span><span> </span><span class="bound"><span>s</span></span><span> 
        </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>step</span></span></span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Refine_Leof.html#Refine_Leof.le_or_fail|const"><span>≤<span class="hidden">⇩</span><sub>n</sub></span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>I</span></span></span></span><span> </span><span class="main"><span>)</span></span><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_22771..22776">lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.is_rwof_invarI|fact"><span class="entity_def" id="Refine_While.is_rwof_invarI|thm"><span>is_rwof_invarI</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.intro|attribute"><span class="operator"><span>intro</span></span></a><span class="main"><span class="main"><span class="main"><span class="main"><span>?</span></span></span></span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>I</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m0</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Refine_Leof.html#Refine_Leof.le_or_fail|const"><span>≤<span class="hidden">⇩</span><sub>n</sub></span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>S</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>⟧</span></span><span> 
      </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Refine_Leof.html#Refine_Leof.le_or_fail|const"><span>≤<span class="hidden">⇩</span><sub>n</sub></span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.is_rwof_invar|const"><span>is_rwof_invar</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_22771..22776"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.is_rwof_invar_def|fact"><span>is_rwof_invar_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.rwof_cons|fact"><span class="entity_def" id="Refine_While.rwof_cons|thm"><span>rwof_cons</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.is_rwof_invar|const"><span>is_rwof_invar</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.is_rwof_invar_def|fact"><span>is_rwof_invar_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.establish_rwof_invar|fact"><span>establish_rwof_invar</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="free"><span>m0</span></span></span><span> </span><span class="quoted"><span class="free"><span>I</span></span></span><span> </span><span class="quoted"><span class="free"><span>cond</span></span></span><span> </span><span class="quoted"><span class="free"><span>step</span></span></span><span> </span><span class="quoted"><span class="free"><span>s</span></span></span><span class="main"><span>]</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    

  </span><span class="comment1"><span>(* This lemma proves a specification for the while loop, based on rwof
    and a nofail-proof. *)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.rwof_WHILE_rule|fact"><span class="entity_def" id="Refine_While.rwof_WHILE_rule|thm"><span>rwof_WHILE_rule</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_23331..23333">I0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m0</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_23361..23362">S</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m0</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>cond</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_23331..23333"><span>I0</span></a><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>M0</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m0</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres.RES|const"><span>RES</span></a><span> </span><span class="skolem"><span>M0</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>M0</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Collect|const"><span>Collect</span></a><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="free"><span>m0</span></span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILE_rule|fact"><span>WHILE_rule</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> I</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>λ</span></span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="bound"><span>s</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
      </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>s</span></span><span> </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>s</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="skolem"><span>M0</span></span><span>"</span></span></span><span> </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>I</span></span><span> </span><span class="skolem"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="skolem"><span>s</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_23331..23333"><span>I0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof.init|fact"><span>rwof.init</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>

    </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
      </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>s</span></span><span>
      </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_23896..23897">A</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>I</span></span><span> </span><span class="skolem"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="skolem"><span>s</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_23931..23932">C</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>cond</span></span><span> </span><span class="skolem"><span>s</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>step</span></span><span> </span><span class="skolem"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>-</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_23361..23362"><span>S</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span>then</span></span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>S'</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>step</span></span><span> </span><span class="skolem"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres.RES|const"><span>RES</span></a><span> </span><span class="skolem"><span>S'</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_24047..24049">by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>step</span></span><span> </span><span class="skolem"><span>s</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof.step|fact"><span>rwof.step</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjunct2|fact"><span>conjunct2</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_23896..23897"><span>A</span></a><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_23931..23932"><span>C</span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_24047..24049"><span>this</span></a><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_24047..24049"><span>this</span></a><span> 
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>step</span></span><span> </span><span class="skolem"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.SPEC_rule_conjI|fact"><span>SPEC_rule_conjI</span></a><span class="main"><span>)</span></span><span> 
      </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>step</span></span><span> </span><span class="skolem"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Filtering out states that satisfy the loop condition›</span></span></span><span>
  </span><span class="comment1"><span>(* A shortcut definition for filtering out all results that satisfy
    the loop condition. Intuitively, filtering out these results from the 
    best invariant gives the results of the while loop. *)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Refine_While.filter_nb_def|fact"><span class="entity_def" id="Refine_While.filter_nb_def|thm"><span class="entity_def" id="Refine_While.filter_nb_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Refine_While.filter_nb|const"><span>filter_nb</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres|type"><span>nres</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres|type"><span>nres</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>filter_nb</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>b</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>I</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>s</span></span><span class="main"><span>←</span></span><span class="free"><span class="bound"><span class="entity"><span>I</span></span></span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.ASSUME|const"><span>ASSUME</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span class="bound"><span class="entity"><span>b</span></span></span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>s</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.pw_filter_nb|fact"><span class="entity_def" id="Refine_While.pw_filter_nb(2)|thm"><span class="entity_def" id="Refine_While.pw_filter_nb(1)|thm"><span>pw_filter_nb</span></span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|attribute"><span class="operator"><span>refine_pw_simps</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_nb|const"><span>filter_nb</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.inres|const"><span>inres</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_nb|const"><span>filter_nb</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.inres|const"><span>inres</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>b</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_nb_def|fact"><span>filter_nb_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.filter_nb_mono|fact"><span class="entity_def" id="Refine_While.filter_nb_mono|thm"><span>filter_nb_mono</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span>m'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_nb|const"><span>filter_nb</span></a><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_nb|const"><span>filter_nb</span></a><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>m'</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_nb_def|fact"><span>filter_nb_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="Refine_Mono_Prover.html#Refine_Mono_Prover.refine_mono|method"><span class="operator"><span>refine_mono</span></span></a><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.filter_nb_cont|fact"><span class="entity_def" id="Refine_While.filter_nb_cont|thm"><span>filter_nb_cont</span></span></span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_nb|const"><span>filter_nb</span></a><span> </span><span class="free"><span>cond</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Complete_Lattices.html#Complete_Lattices.Sup_class.Sup|const"><span>Sup</span></a><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Complete_Lattices.html#Complete_Lattices.Sup_class.Sup|const"><span>Sup</span></a><span> </span><span class="main"><span>{</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_nb|const"><span>filter_nb</span></a><span> </span><span class="free"><span>cond</span></span><span> </span><span class="bound"><span>m</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="bound"><span>m</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.antisym|fact"><span>antisym</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.not_nofail_inres|fact"><span>not_nofail_inres</span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
    
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.not_nofail_inres|fact"><span>not_nofail_inres</span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.filter_nb_FAIL|fact"><span class="entity_def" id="Refine_While.filter_nb_FAIL|thm"><span>filter_nb_FAIL</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_nb|const"><span>filter_nb</span></a><span> </span><span class="free"><span>cond</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.FAIL|const"><span>FAIL</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.FAIL|const"><span>FAIL</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_nb_def|fact"><span>filter_nb_def</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.filter_nb_RES|fact"><span class="entity_def" id="Refine_While.filter_nb_RES|thm"><span>filter_nb_RES</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_nb|const"><span>filter_nb</span></a><span> </span><span class="free"><span>cond</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres.RES|const"><span>RES</span></a><span> </span><span class="free"><span>X</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres.RES|const"><span>RES</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>x</span></span></span><span class="main"><span>∈</span></span><span class="free"><span>X</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>cond</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_eq_iff|fact"><span>pw_eq_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Bounded while-loop›</span></span></span><span>

  </span><span class="comment1"><span>(* A while rule that establishes an inductive invariant,
    and then filters out the results satisfying the condition. *)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.WHILE_rule_gen_le|fact"><span class="entity_def" id="Refine_While.WHILE_rule_gen_le|thm"><span>WHILE_rule_gen_le</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_25793..25795">I0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m0</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_25818..25823">ISTEP</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m0</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_nb|const"><span>filter_nb</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>unfold</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILE_def|fact"><span>WHILE_def</span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILEI_def|fact"><span>WHILEI_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_rcg|method"><span class="operator"><span>refine_rcg</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order_trans|fact"><span>order_trans</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_25793..25795"><span>I0</span></a><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_vcg|fact"><span class="dynamic"><span class="dynamic"><span>refine_vcg</span></span></span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_bind_leI|fact"><span>pw_bind_leI</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_25793..25795"><span>I0</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>

      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="RefineG_Recursion.html#RefineG_Recursion.REC_rule|fact"><span>REC_rule</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILEI_body_trimono|fact"><span>WHILEI_body_trimono</span></a><span class="main"><span class="main"><span>,</span></span></span><span> </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> pre</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>λ</span></span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_25793..25795"><span>I0</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>
      
        </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="RefineG_While.html#RefineG_While.WHILEI_body_def|fact"><span>WHILEI_body_def</span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/splitter.ML.html#HOL.split|method"><span class="operator"><span>split</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.if_split|fact"><span>if_split</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.impI|fact"><span>impI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjI|fact"><span>conjI</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_25818..25823"><span>ISTEP</span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span class="quasi_keyword"><span>no_asm_use</span></span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span class="quasi_keyword"><span>only</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>only</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> 
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>


  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Refine_While.bounded_WHILE&apos;.simps|fact"><span class="entity_def" id="Refine_While.bounded_WHILE&apos;_def|fact"><span class="entity_def" id="Refine_While.bounded_WHILE&apos;.simps(2)|thm"><span class="entity_def" id="Refine_While.bounded_WHILE&apos;.simps(1)|thm"><span class="entity_def" id="Refine_While.bounded_WHILE&apos;_def|thm"><span class="entity_def" id="Refine_While.bounded_WHILE&apos;_def|axiom"><span>primrec</span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Refine_While.bounded_WHILE&apos;|const"><span>bounded_WHILE'</span></span></span><span> 
    </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres|type"><span>nres</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres|type"><span>nres</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres|type"><span>nres</span></a><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>bounded_WHILE'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>cond</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>step</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span>"</span></span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>bounded_WHILE'</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>cond</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>step</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>←</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><span>;</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>cond</span></span></span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="free"><span>bounded_WHILE'</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>cond</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>step</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>step</span></span></span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>x</span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Refine_While.bounded_WHILE.simps|fact"><span class="entity_def" id="Refine_While.bounded_WHILE_def|fact"><span class="entity_def" id="Refine_While.bounded_WHILE.simps(2)|thm"><span class="entity_def" id="Refine_While.bounded_WHILE.simps(1)|thm"><span class="entity_def" id="Refine_While.bounded_WHILE_def|thm"><span class="entity_def" id="Refine_While.bounded_WHILE_def|axiom"><span>primrec</span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Refine_While.bounded_WHILE|const"><span>bounded_WHILE</span></span></span><span>
    </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres|type"><span>nres</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres|type"><span>nres</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres|type"><span>nres</span></a><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>bounded_WHILE</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>cond</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>step</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span>"</span></span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>bounded_WHILE</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>cond</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>step</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>←</span></span><span> </span><span class="free"><span>bounded_WHILE</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>cond</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>step</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><span>;</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>cond</span></span></span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>step</span></span></span></span><span> </span><span class="bound"><span>x</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>x</span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.bounded_WHILE_shift|fact"><span class="entity_def" id="Refine_While.bounded_WHILE_shift|thm"><span>bounded_WHILE_shift</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
             </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>←</span></span><span> </span><span class="free"><span>m</span></span><span class="main"><span>;</span></span><span>
             </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE|const"><span>bounded_WHILE</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>step</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>x</span></span><span>
           </span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
             </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE|const"><span>bounded_WHILE</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>m</span></span><span class="main"><span>;</span></span><span>
             </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>x</span></span><span>
           </span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induction.ML.html#HOL.induction|method"><span class="operator"><span>induction</span></span></a><span> </span><span class="quoted"><span class="free"><span>n</span></span></span><span> </span><span class="quasi_keyword"><span>arbitrary</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="free"><span>m</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>0</span><span> </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>cong</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.if_cong|fact"><span>if_cong</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_27440..27443">Suc</span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span> 

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_27458..27462">aux1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>←</span></span><span> </span><span class="skolem"><span>m</span></span><span class="main"><span>;</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
                       </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE|const"><span>bounded_WHILE</span></a><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>step</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
                       </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>x</span></span><span>
                     </span><span class="main"><span>}</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>x</span></span><span>
    </span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>←</span></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
        </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>←</span></span><span> </span><span class="skolem"><span>m</span></span><span class="main"><span>;</span></span><span> 
        </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE|const"><span>bounded_WHILE</span></a><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>step</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>x</span></span><span>
      </span><span class="main"><span>}</span></span><span class="main"><span>;</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>x</span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_eq_iff|fact"><span>pw_eq_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>

    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>cong</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.if_cong|fact"><span>if_cong</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_27458..27462"><span>aux1</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_27440..27443"><span>Suc.IH</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_eq_iff|fact"><span>pw_eq_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>


  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.bounded_WHILE&apos;_eq|fact"><span class="entity_def" id="Refine_While.bounded_WHILE&apos;_eq|thm"><span>bounded_WHILE'_eq</span></span></span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE&apos;|const"><span>bounded_WHILE'</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE|const"><span>bounded_WHILE</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>m</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.induct|method"><span class="operator"><span>induct</span></span></a><span> </span><span class="quoted"><span class="free"><span>n</span></span></span><span> </span><span class="quasi_keyword"><span>arbitrary</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="free"><span>m</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>cong</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.if_cong|fact"><span>if_cong</span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE_shift|fact"><span>bounded_WHILE_shift</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.mWHILE_unfold|fact"><span class="entity_def" id="Refine_While.mWHILE_unfold|thm"><span>mWHILE_unfold</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>←</span></span><span> </span><span class="free"><span>m</span></span><span class="main"><span>;</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>x</span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILE_unfold|fact"><span>WHILE_unfold</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>abs_def</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.refl|fact"><span>refl</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.WHILE_bounded_aux1|fact"><span class="entity_def" id="Refine_While.WHILE_bounded_aux1|thm"><span>WHILE_bounded_aux1</span></span></span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_nb|const"><span>filter_nb</span></a><span> </span><span class="free"><span>cond</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE|const"><span>bounded_WHILE</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>m</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE&apos;_eq|fact"><span>bounded_WHILE'_eq</span></a><span class="main"><span>[</span></span><span class="operator"><span>symmetric</span></span><span class="main"><span>]</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.induct|method"><span class="operator"><span>induct</span></span></a><span> </span><span class="quoted"><span class="free"><span>n</span></span></span><span> </span><span class="quasi_keyword"><span>arbitrary</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="free"><span>m</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.mWHILE_unfold|fact"><span>mWHILE_unfold</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="main"><span>)</span></span><span>
    
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.mWHILE_unfold|fact"><span>mWHILE_unfold</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.WHILE_bounded_aux2|fact"><span class="entity_def" id="Refine_While.WHILE_bounded_aux2|thm"><span>WHILE_bounded_aux2</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> 
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_nb|const"><span>filter_nb</span></a><span> </span><span class="free"><span>cond</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Complete_Lattices.html#Complete_Lattices.Sup_class.Sup|const"><span>Sup</span></a><span> </span><span class="main"><span>{</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE|const"><span>bounded_WHILE</span></a><span> </span><span class="bound"><span>n</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE_rule_gen_le|fact"><span>WHILE_rule_gen_le</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>mono_tags</span><span class="main"><span class="main"><span>,</span></span></span><span> lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Complete_Lattices.html#Complete_Lattices.complete_lattice_class.Sup_upper|fact"><span>Sup_upper</span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE.simps|fact"><span>bounded_WHILE.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> 
      </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.mem_Collect_eq|fact"><span>mem_Collect_eq</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span> 
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>s</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="skolem"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Complete_Lattices.html#Complete_Lattices.Sup_class.Sup|const"><span>Sup</span></a><span> </span><span class="main"><span>{</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE|const"><span>bounded_WHILE</span></a><span> </span><span class="bound"><span>n</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>|</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>n</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="skolem"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE|const"><span>bounded_WHILE</span></a><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>m</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>fold</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.inres_def|fact"><span>inres_def</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>cond</span></span><span> </span><span class="skolem"><span>s</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>step</span></span><span> </span><span class="skolem"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE|const"><span>bounded_WHILE</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>m</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>step</span></span><span> </span><span class="skolem"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Complete_Lattices.html#Complete_Lattices.Sup_class.Sup|const"><span>Sup</span></a><span> </span><span class="main"><span>{</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE|const"><span>bounded_WHILE</span></a><span> </span><span class="bound"><span>n</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>|</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span class="main"><span>}</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>mono_tags</span><span class="main"><span class="main"><span>,</span></span></span><span> lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Complete_Lattices.html#Complete_Lattices.complete_lattice_class.Sup_upper2|fact"><span>Sup_upper2</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.mem_Collect_eq|fact"><span>mem_Collect_eq</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

   
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.WHILE_bounded|fact"><span class="entity_def" id="Refine_While.WHILE_bounded|thm"><span>WHILE_bounded</span></span></span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> 
    </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_nb|const"><span>filter_nb</span></a><span> </span><span class="free"><span>cond</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Complete_Lattices.html#Complete_Lattices.Sup_class.Sup|const"><span>Sup</span></a><span> </span><span class="main"><span>{</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE|const"><span>bounded_WHILE</span></a><span> </span><span class="bound"><span>n</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.antisym|fact"><span>antisym</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE_bounded_aux2|fact"><span>WHILE_bounded_aux2</span></a><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_nb_cont|fact"><span>filter_nb_cont</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Complete_Lattices.html#Complete_Lattices.complete_lattice_class.Sup_least|fact"><span>Sup_least</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE_bounded_aux1|fact"><span>WHILE_bounded_aux1</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Relation to rwof›</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_29921..29926">lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.rwof_in_bounded_WHILE|fact"><span class="entity_def" id="Refine_While.rwof_in_bounded_WHILE|thm"><span>rwof_in_bounded_WHILE</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE|const"><span>bounded_WHILE</span></a><span> </span><span class="bound"><span>n</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>m0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_29921..29926"><span>assms</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induction.ML.html#HOL.induction|method"><span class="operator"><span>induction</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule_tac</span></span><span> x</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>in</span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.exI|fact"><span>exI</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule_tac</span></span><span> x</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="improper"><span>n</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>in</span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.exI|fact"><span>exI</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_30252..30257">lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.bounded_WHILE_FAIL_rwof|fact"><span class="entity_def" id="Refine_While.bounded_WHILE_FAIL_rwof|thm"><span>bounded_WHILE_FAIL_rwof</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE|const"><span>bounded_WHILE</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>m0</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.FAIL|const"><span>FAIL</span></a><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_30345..30347">M0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m0</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.FAIL|const"><span>FAIL</span></a><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>∃</span></span><span class="bound"><span class="bound"><span>n'</span></span></span><span class="main"><span>&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>X</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> 
        </span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE|const"><span>bounded_WHILE</span></a><span> </span><span class="bound"><span>n'</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>m0</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres.RES|const"><span>RES</span></a><span> </span><span class="bound"><span>X</span></span><span> 
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="bound"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.FAIL|const"><span>FAIL</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_30252..30257"><span>assms</span></a><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induction.ML.html#HOL.induction|method"><span class="operator"><span>induction</span></span></a><span> </span><span class="quoted"><span class="free"><span>n</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>0</span><span> </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_30556..30559">Suc</span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE|const"><span>bounded_WHILE</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>m0</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.FAIL|const"><span>FAIL</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE|const"><span>bounded_WHILE</span></a><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>m0</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.FAIL|const"><span>FAIL</span></a><span> 
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>X</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE|const"><span>bounded_WHILE</span></a><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>m0</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres.RES|const"><span>RES</span></a><span> </span><span class="bound"><span>X</span></span><span> 
          </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="bound"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.FAIL|const"><span>FAIL</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?C1</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="var"><span>?C2</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE|const"><span>bounded_WHILE</span></a><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>m0</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_eq_iff|fact"><span>pw_eq_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span> </span><span class="quasi_keyword"><span>split</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.if_split_asm|fact"><span>if_split_asm</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.not_nofail_inres|fact"><span>not_nofail_inres</span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>{</span></span></span><span>
      </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_31020..31026">assume</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?C1</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_30556..30559"><span>Suc.IH</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_31020..31026"><span>this</span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_30345..30347"><span>M0</span></a><span class="main"><span>]</span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>n'</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>x</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>X</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>n'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>n</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>
        </span><span class="entity_def" id="offset_31102..31103">1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE|const"><span>bounded_WHILE</span></a><span> </span><span class="skolem"><span>n'</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>m0</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres.RES|const"><span>RES</span></a><span> </span><span class="skolem"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="skolem"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.FAIL|const"><span>FAIL</span></a><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_31205..31206">2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>n'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="skolem"><span>n</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_31102..31103"><span>1</span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_31205..31206"><span>2</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>}</span></span></span><span> </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>{</span></span></span><span>
      </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?C2</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>}</span></span></span><span> </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_31371..31376">lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.bounded_WHILE_RES_rwof|fact"><span class="entity_def" id="Refine_While.bounded_WHILE_RES_rwof|thm"><span>bounded_WHILE_RES_rwof</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE|const"><span>bounded_WHILE</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>m0</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres.RES|const"><span>RES</span></a><span> </span><span class="free"><span>X</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>X</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_31371..31376"><span>assms</span></a><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induction.ML.html#HOL.induction|method"><span class="operator"><span>induction</span></span></a><span> </span><span class="quoted"><span class="free"><span>n</span></span></span><span> </span><span class="quasi_keyword"><span>arbitrary</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="free"><span>x</span></span></span><span> </span><span class="quoted"><span class="free"><span>X</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>0</span><span> </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof.init|fact"><span>rwof.init</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_31619..31622">Suc</span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_31619..31622"><span>Suc.prems</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_31649..31655">obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>Xh</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
      </span><span class="entity_def" id="offset_31671..31674">BWN</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE|const"><span>bounded_WHILE</span></a><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>m0</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres.RES|const"><span>RES</span></a><span> </span><span class="skolem"><span>Xh</span></span><span>"</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>∀</span></span><span class="bound"><span>x</span></span><span class="main"><span>∈</span></span><span class="skolem"><span>Xh</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>step</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>∃</span></span><span class="bound"><span>x</span></span><span class="main"><span>∈</span></span><span class="skolem"><span>Xh</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.inres|const"><span>inres</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>step</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="skolem"><span>Xh</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>cond</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>}</span></span><span> "</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE|const"><span>bounded_WHILE</span></a><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>m0</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_31649..31655"><span>that</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.force|method"><span class="operator"><span>force</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_eq_iff|fact"><span>pw_eq_iff</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_eq_iff|fact"><span>pw_eq_iff</span></a><span> </span><span class="quasi_keyword"><span>split</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.if_split_asm|fact"><span>if_split_asm</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_31619..31622"><span>Suc.prems</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>xh</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>X'</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> 
        </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>xh</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="skolem"><span>Xh</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>
      </span><span class="entity_def" id="offset_32152..32153">C</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>cond</span></span><span> </span><span class="skolem"><span>xh</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="skolem"><span>xh</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nres.RES|const"><span>RES</span></a><span> </span><span class="skolem"><span>X'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="skolem"><span>X'</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_32195..32197">NC</span><span class="main"><span>:</span></span><span>  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>cond</span></span><span> </span><span class="skolem"><span>xh</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="skolem"><span>xh</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail_RES_conv|fact"><span>nofail_RES_conv</span></a><span class="main"><span>)</span></span><span>
    
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>cond</span></span><span> </span><span class="skolem"><span>xh</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof.step|fact"><span>rwof.step</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> Y</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="skolem"><span>X'</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_31619..31622"><span>Suc.IH</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_31671..31674"><span>BWN</span></a><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="skolem"><span>xh</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="skolem"><span>Xh</span></span><span>›</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>assumption</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_32152..32153"><span>C</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span>2</span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
        
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_31619..31622"><span>Suc.IH</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_31671..31674"><span>BWN</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_32195..32197"><span>NC</span></a><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="skolem"><span>xh</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="skolem"><span>Xh</span></span><span>›</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
      

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.rwof_FAIL_imp_WHILE_FAIL|fact"><span class="entity_def" id="Refine_While.rwof_FAIL_imp_WHILE_FAIL|thm"><span>rwof_FAIL_imp_WHILE_FAIL</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_32615..32617">RW</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_32650..32651">C</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_32671..32672">S</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>step</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.FAIL|const"><span>FAIL</span></a><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m0</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.FAIL|const"><span>FAIL</span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof_in_bounded_WHILE|fact"><span>rwof_in_bounded_WHILE</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_32615..32617"><span>RW</span></a><span class="main"><span>]</span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>n</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> 
      </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE|const"><span>bounded_WHILE</span></a><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>m0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>..</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_32650..32651"><span>C</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>step</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE|const"><span>bounded_WHILE</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>m0</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_32671..32672"><span>S</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE|const"><span>bounded_WHILE</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>m0</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.FAIL|const"><span>FAIL</span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE_bounded_aux1|fact"><span>WHILE_bounded_aux1</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="free"><span>cond</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="skolem"><span>n</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="free"><span>step</span></span></span><span> </span><span class="quoted"><span class="free"><span>m0</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>del</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE.simps|fact"><span>bounded_WHILE.simps</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.pw_bounded_WHILE_RES_rwof|fact"><span class="entity_def" id="Refine_While.pw_bounded_WHILE_RES_rwof|thm"><span>pw_bounded_WHILE_RES_rwof</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE|const"><span>bounded_WHILE</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>m0</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> 
    </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.inres|const"><span>inres</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE|const"><span>bounded_WHILE</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>m0</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE_RES_rwof|fact"><span>bounded_WHILE_RES_rwof</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="free"><span>n</span></span></span><span> </span><span class="quoted"><span class="free"><span>cond</span></span></span><span> </span><span class="quoted"><span class="free"><span>step</span></span></span><span> </span><span class="quoted"><span class="free"><span>m0</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="quoted"><span class="free"><span>x</span></span></span><span class="main"><span>]</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_eq_iff|fact"><span>pw_eq_iff</span></a><span class="main"><span>)</span></span><span>
    
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_33384..33393">corollary</span></span></span><span> </span><span class="entity_def" id="Refine_While.WHILE_nofail_imp_rwof_nofail|fact"><span class="entity_def" id="Refine_While.WHILE_nofail_imp_rwof_nofail|thm"><span>WHILE_nofail_imp_rwof_nofail</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>m0</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_33480..33482">RW</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_33519..33520">C</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>step</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.ccontr|fact"><span>ccontr</span></a><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail_def|fact"><span>nofail_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_33384..33393"><span>assms</span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof_FAIL_imp_WHILE_FAIL|fact"><span>rwof_FAIL_imp_WHILE_FAIL</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_33480..33482"><span>RW</span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_33519..33520"><span>C</span></a><span class="main"><span>]</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

  </span><span class="comment1"><span>(* TODO: Move *)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.WHILE_le_WHILEI|fact"><span class="entity_def" id="Refine_While.WHILE_le_WHILEI|thm"><span>WHILE_le_WHILEI</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI|const"><span>WHILEI</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILE_def|fact"><span>WHILE_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILEI_weaken|fact"><span>WHILEI_weaken</span></a><span class="main"><span>)</span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>corollary</span></span></span><span> </span><span class="entity_def" id="Refine_While.WHILEI_nofail_imp_rwof_nofail|fact"><span class="entity_def" id="Refine_While.WHILEI_nofail_imp_rwof_nofail|thm"><span>WHILEI_nofail_imp_rwof_nofail</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_33863..33865">NF</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>m0</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI|const"><span>WHILEI</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_33914..33916">RW</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_33953..33954">C</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>step</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_33863..33865"><span>NF</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>m0</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE_le_WHILEI|fact"><span>WHILE_le_WHILEI</span></a><span> 
      </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_34087..34089">by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE_nofail_imp_rwof_nofail|fact"><span>WHILE_nofail_imp_rwof_nofail</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_34087..34089"><span>this</span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_33914..33916"><span>RW</span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_33953..33954"><span>C</span></a><span class="main"><span>]</span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>corollary</span></span></span><span> </span><span class="entity_def" id="Refine_While.WHILET_nofail_imp_rwof_nofail|fact"><span class="entity_def" id="Refine_While.WHILET_nofail_imp_rwof_nofail|thm"><span>WHILET_nofail_imp_rwof_nofail</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_34263..34265">NF</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>m0</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILET|const"><span>WHILET</span></a><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_34312..34314">RW</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_34351..34352">C</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>step</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_34263..34265"><span>NF</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>m0</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILEI_le_WHILEIT|fact"><span>WHILEI_le_WHILEIT</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILE_def|fact"><span>WHILE_def</span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILET_def|fact"><span>WHILET_def</span></a><span> 
      </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_34518..34520">by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE_nofail_imp_rwof_nofail|fact"><span>WHILE_nofail_imp_rwof_nofail</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_34518..34520"><span>this</span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_34312..34314"><span>RW</span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_34351..34352"><span>C</span></a><span class="main"><span>]</span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>corollary</span></span></span><span> </span><span class="entity_def" id="Refine_While.WHILEIT_nofail_imp_rwof_nofail|fact"><span class="entity_def" id="Refine_While.WHILEIT_nofail_imp_rwof_nofail|thm"><span>WHILEIT_nofail_imp_rwof_nofail</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_34695..34697">NF</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>m0</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEIT|const"><span>WHILEIT</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_34747..34749">RW</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_34786..34787">C</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>step</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_34695..34697"><span>NF</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>m0</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE_le_WHILEI|fact"><span>WHILE_le_WHILEI</span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILEI_le_WHILEIT|fact"><span>WHILEI_le_WHILEIT</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILE_def|fact"><span>WHILE_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_34957..34959">by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE_nofail_imp_rwof_nofail|fact"><span>WHILE_nofail_imp_rwof_nofail</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_34957..34959"><span>this</span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_34747..34749"><span>RW</span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_34786..34787"><span>C</span></a><span class="main"><span>]</span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.pw_rwof_in_bounded_WHILE|fact"><span class="entity_def" id="Refine_While.pw_rwof_in_bounded_WHILE|thm"><span>pw_rwof_in_bounded_WHILE</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.inres|const"><span>inres</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE|const"><span>bounded_WHILE</span></a><span> </span><span class="bound"><span>n</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>m0</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof_in_bounded_WHILE|fact"><span>rwof_in_bounded_WHILE</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="free"><span>m0</span></span></span><span> </span><span class="quoted"><span class="free"><span>cond</span></span></span><span> </span><span class="quoted"><span class="free"><span>step</span></span></span><span> </span><span class="quoted"><span class="free"><span>x</span></span></span><span class="main"><span>]</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.not_nofail_inres|fact"><span>not_nofail_inres</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹WHILE-loops in the nofail-case›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.nofail_WHILE_eq_rwof|fact"><span class="entity_def" id="Refine_While.nofail_WHILE_eq_rwof|thm"><span>nofail_WHILE_eq_rwof</span></span></span><span class="main"><span>:</span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_35383..35385">NF</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>m0</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m0</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>cond</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_35383..35385"><span>NF</span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE_bounded|fact"><span>WHILE_bounded</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="free"><span>m0</span></span></span><span> </span><span class="quoted"><span class="free"><span>cond</span></span></span><span> </span><span class="quoted"><span class="free"><span>step</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_35553..35556">NF'</span><span class="main"><span>:</span></span><span> 
      </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Complete_Lattices.html#Complete_Lattices.Sup_class.Sup|const"><span>Sup</span></a><span> </span><span class="main"><span>{</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_nb|const"><span>filter_nb</span></a><span> </span><span class="free"><span>cond</span></span><span> </span><span class="bound"><span>m</span></span><span> </span><span class="main"><span>|</span></span><span class="bound"><span>m</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="bound"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE|const"><span>bounded_WHILE</span></a><span> </span><span class="bound"><span>n</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>m0</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_nb_cont|fact"><span>filter_nb_cont</span></a><span class="main"><span>)</span></span><span>

    </span><span class="comment1"><span>(*from NF WHILE_bounded[of m0 cond step] obtain X 
      where FR:
        "Sup {filter_nb cond m |m. ∃n. m = bounded_WHILE n cond step m0} = RES X"
      by (auto simp: nofail_RES_conv filter_nb_cont)*)</span></span><span>
    
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE_bounded|fact"><span>WHILE_bounded</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="free"><span>m0</span></span></span><span> </span><span class="quoted"><span class="free"><span>cond</span></span></span><span> </span><span class="quoted"><span class="free"><span>step</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_nb_cont|fact"><span>filter_nb_cont</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.antisym|fact"><span>antisym</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Complete_Lattices.html#Complete_Lattices.Sup_class.Sup|const"><span>Sup</span></a><span> </span><span class="main"><span>{</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_nb|const"><span>filter_nb</span></a><span> </span><span class="free"><span>cond</span></span><span> </span><span class="bound"><span>m</span></span><span> </span><span class="main"><span>|</span></span><span class="bound"><span>m</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="bound"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE|const"><span>bounded_WHILE</span></a><span> </span><span class="bound"><span>n</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>m0</span></span><span class="main"><span>}</span></span><span>
        </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_35553..35556"><span>NF'</span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.pw_bounded_WHILE_RES_rwof|fact"><span>pw_bounded_WHILE_RES_rwof</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="main"><span>_</span></span><span> </span><span class="quoted"><span class="free"><span>cond</span></span></span><span> </span><span class="quoted"><span class="free"><span>step</span></span></span><span> </span><span class="quoted"><span class="free"><span>m0</span></span></span><span class="main"><span>]</span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
      </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span>
        </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Complete_Lattices.html#Complete_Lattices.Sup_class.Sup|const"><span>Sup</span></a><span> </span><span class="main"><span>{</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.filter_nb|const"><span>filter_nb</span></a><span> </span><span class="free"><span>cond</span></span><span> </span><span class="bound"><span>m</span></span><span> </span><span class="main"><span>|</span></span><span class="bound"><span>m</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="bound"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.bounded_WHILE|const"><span>bounded_WHILE</span></a><span> </span><span class="bound"><span>n</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>m0</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>      
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_35553..35556"><span>NF'</span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.pw_rwof_in_bounded_WHILE|fact"><span>pw_rwof_in_bounded_WHILE</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="free"><span>m0</span></span></span><span> </span><span class="quoted"><span class="free"><span>cond</span></span></span><span> </span><span class="quoted"><span class="free"><span>step</span></span></span><span class="main"><span>]</span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.WHILE_refine_rwof|fact"><span class="entity_def" id="Refine_While.WHILE_refine_rwof|thm"><span>WHILE_refine_rwof</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>mi</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>c</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>mi</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.nofail_WHILE_eq_rwof|fact"><span>nofail_WHILE_eq_rwof</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>fact</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>


  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.pw_rwof_init|fact"><span class="entity_def" id="Refine_While.pw_rwof_init(2)|thm"><span class="entity_def" id="Refine_While.pw_rwof_init(1)|thm"><span>pw_rwof_init</span></span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_36837..36839">NF</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>m0</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.inres|const"><span>inres</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="free"><span>m0</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_36837..36839"><span>NF</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="free"><span>m0</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof.init|fact"><span>rwof.init</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
    
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_36837..36839"><span>NF</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.rwof_init|fact"><span class="entity_def" id="Refine_While.rwof_init|thm"><span>rwof_init</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_37132..37134">NF</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>m0</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m0</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.pw_rwof_init|fact"><span>pw_rwof_init</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_37132..37134"><a class="entity_ref" href="Refine_While.html#offset_37132..37134"><span>NF</span></a></a><span class="main"><span>]</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>
  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.pw_rwof_step&apos;|fact"><span class="entity_def" id="Refine_While.pw_rwof_step&apos;|thm"><span>pw_rwof_step'</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_37324..37326">NF</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>step</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_37358..37359">R</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_37395..37396">C</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.inres|const"><span>inres</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>step</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>s'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>s'</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_37324..37326"><span>NF</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail_RES_conv|fact"><span>nofail_RES_conv</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof.step|fact"><span>rwof.step</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_37358..37359"><span>R</span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_37395..37396"><span>C</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>assumption</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.rwof_step&apos;|fact"><span class="entity_def" id="Refine_While.rwof_step&apos;|thm"><span>rwof_step'</span></span></span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>step</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><span>⟧</span></span><span>
    </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.pw_rwof_step&apos;|fact"><span>pw_rwof_step'</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="free"><span>step</span></span></span><span> </span><span class="quoted"><span class="free"><span>s</span></span></span><span> </span><span class="quoted"><span class="free"><span>m0</span></span></span><span> </span><span class="quoted"><span class="free"><span>cond</span></span></span><span class="main"><span>]</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_37794..37799">lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.pw_rwof_step|fact"><span class="entity_def" id="Refine_While.pw_rwof_step(2)|thm"><span class="entity_def" id="Refine_While.pw_rwof_step(1)|thm"><span>pw_rwof_step</span></span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_37826..37828">NF</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>m0</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_37874..37875">R</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_37911..37912">C</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.inres|const"><span>inres</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>step</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>s'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>s'</span></span><span>"</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>step</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE_nofail_imp_rwof_nofail|fact"><span>WHILE_nofail_imp_rwof_nofail</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_37826..37828"><span>NF</span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_37874..37875"><span>R</span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_37911..37912"><span>C</span></a><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.pw_rwof_step&apos;|fact"><span>pw_rwof_step'</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> _ </span><a class="entity_ref" href="Refine_While.html#offset_37794..37799"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2-</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>]</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.rwof_step|fact"><span class="entity_def" id="Refine_While.rwof_step|thm"><span>rwof_step</span></span></span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>m0</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><span>⟧</span></span><span>
    </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.pw_rwof_step|fact"><span>pw_rwof_step</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="free"><span class="quoted"><span class="free"><span>m0</span></span></span></span></span><span> </span><span class="quoted"><span class="free"><span class="quoted"><span class="free"><span>cond</span></span></span></span></span><span> </span><span class="quoted"><span class="free"><span class="quoted"><span class="free"><span>step</span></span></span></span></span><span> </span><span class="quoted"><span class="free"><span class="quoted"><span class="free"><span>s</span></span></span></span></span><span class="main"><span>]</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> -</span><span class="main"><span>)</span></span><span> </span><span class="entity_def" id="Refine_While.rwof_leof_init|fact"><span class="entity_def" id="Refine_While.rwof_leof_init|thm"><span>rwof_leof_init</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Refine_Leof.html#Refine_Leof.le_or_fail|const"><span>≤<span class="hidden">⇩</span><sub>n</sub></span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof.init|fact"><span>rwof.init</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail_RES_conv|fact"><span>nofail_RES_conv</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> -</span><span class="main"><span>)</span></span><span> </span><span class="entity_def" id="Refine_While.rwof_leof_step|fact"><span class="entity_def" id="Refine_While.rwof_leof_step|thm"><span>rwof_leof_step</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Refine_Leof.html#Refine_Leof.le_or_fail|const"><span>≤<span class="hidden">⇩</span><sub>n</sub></span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof.step|fact"><span>rwof.step</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail_RES_conv|fact"><span>nofail_RES_conv</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>


  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> -</span><span class="main"><span>)</span></span><span> </span><span class="entity_def" id="Refine_While.rwof_step_refine|fact"><span class="entity_def" id="Refine_While.rwof_step_refine|thm"><span>rwof_step_refine</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_38680..38682">NF</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>m0</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_38730..38731">A</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step'</span></span><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_38768..38770">FR</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>step'</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Refine_Leof.html#Refine_Leof.le_or_fail|const"><span>≤<span class="hidden">⇩</span><sub>n</sub></span></a></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="bound"><span>s</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m0</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.establish_rwof_invar|fact"><span>establish_rwof_invar</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> _ _ </span><a class="entity_ref" href="Refine_While.html#offset_38730..38731"><span>A</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof_leof_init|fact"><span>rwof_leof_init</span></a><span class="main"><span>)</span></span><span>

      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_Leof.html#Refine_Leof.leof_trans_nofail|fact"><span>leof_trans_nofail</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_38768..38770"><span>FR</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE_nofail_imp_rwof_nofail|fact"><span>WHILE_nofail_imp_rwof_nofail</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_38680..38682"><span>NF</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span class="main"><span>)</span></span><span>

        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof_leof_step|fact"><span>rwof_leof_step</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Adding Invariants›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.WHILE_eq_I_rwof|fact"><span class="entity_def" id="Refine_While.WHILE_eq_I_rwof|thm"><span>WHILE_eq_I_rwof</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI|const"><span>WHILEI</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.antisym|fact"><span>antisym</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI|const"><span>WHILEI</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span>
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span>s</span></span><span class="main"><span>,</span></span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>}</span></span><span> 
        </span><span class="main"><span>(</span></span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILE_def|fact"><span>WHILE_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.bind_refine|fact"><span>bind_refine</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.intro_prgR|fact"><span>intro_prgR</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> R</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span>s</span></span><span class="main"><span>,</span></span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="free"><span>m</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof.init|fact"><span>rwof.init</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
    
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI_refine|fact"><span>WHILEI_refine</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.pw_rwof_step&apos;|fact"><span>pw_rwof_step'</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI|const"><span>WHILEI</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEI|const"><span>WHILEI</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILE_def|fact"><span>WHILE_def</span></a><span> 
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.bind_mono|fact"><span>bind_mono</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order_refl|fact"><span>order_refl</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILEI_weaken|fact"><span>WHILEI_weaken</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>..</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.WHILET_eq_I_rwof|fact"><span class="entity_def" id="Refine_While.WHILET_eq_I_rwof|thm"><span>WHILET_eq_I_rwof</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILET|const"><span>WHILET</span></a><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEIT|const"><span>WHILEIT</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.antisym|fact"><span>antisym</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEIT|const"><span>WHILEIT</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span>
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span>s</span></span><span class="main"><span>,</span></span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>}</span></span><span> 
        </span><span class="main"><span>(</span></span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILET|const"><span>WHILET</span></a><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILET_def|fact"><span>WHILET_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.bind_refine|fact"><span>bind_refine</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.intro_prgR|fact"><span>intro_prgR</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> R</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span>s</span></span><span class="main"><span>,</span></span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="free"><span>m</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof.init|fact"><span>rwof.init</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
    
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEIT_refine|fact"><span>WHILEIT_refine</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.pw_rwof_step&apos;|fact"><span>pw_rwof_step'</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEIT|const"><span>WHILEIT</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILET|const"><span>WHILET</span></a><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILET|const"><span>WHILET</span></a><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEIT|const"><span>WHILEIT</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILET_def|fact"><span>WHILET_def</span></a><span> 
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.bind_mono|fact"><span>bind_mono</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order_refl|fact"><span>order_refl</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILEIT_weaken|fact"><span>WHILEIT_weaken</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>..</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>


</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Refinement›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.rwof_refine|fact"><span class="entity_def" id="Refine_While.rwof_refine|thm"><span>rwof_refine</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_40911..40913">RW</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_40940..40942">NF</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>m'</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILE|const"><span>WHILE</span></a><span> </span><span class="free"><span>c'</span></span><span> </span><span class="free"><span>f'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_40982..40983">M</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Refine_Leof.html#Refine_Leof.le_or_fail|const"><span>≤<span class="hidden">⇩</span><sub>n</sub></span></a></span><span> </span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="free"><span>m'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_41009..41010">C</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>s</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span class="main"><span>(</span></span><span class="bound"><span>s</span></span><span class="main"><span>,</span></span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m'</span></span><span> </span><span class="free"><span>c'</span></span><span> </span><span class="free"><span>f'</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>c'</span></span><span> </span><span class="bound"><span>s'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_41088..41089">S</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>s</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span class="main"><span>(</span></span><span class="bound"><span>s</span></span><span class="main"><span>,</span></span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m'</span></span><span> </span><span class="free"><span>c'</span></span><span> </span><span class="free"><span>f'</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>c'</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Refine_Leof.html#Refine_Leof.le_or_fail|const"><span>≤<span class="hidden">⇩</span><sub>n</sub></span></a></span><span> </span><span class="main"><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f'</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>s'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>s</span></span><span class="main"><span>,</span></span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>m'</span></span><span> </span><span class="free"><span>c'</span></span><span> </span><span class="free"><span>f'</span></span><span> </span><span class="bound"><span>s'</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_40911..40913"><span>RW</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induction.ML.html#HOL.induction|method"><span class="operator"><span>induction</span></span></a><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.establish_rwof_invar|fact"><span>establish_rwof_invar</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>rotated</span></span><span> -1</span><span class="main"><span class="main"><span>,</span></span></span><span class="operator"><span>consumes</span></span><span> 1</span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_40982..40983"><span>M</span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof_init|fact"><span>rwof_init</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_40940..40942"><span>NF</span></a><span class="main"><span>]</span></span><span> 
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>only</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Leof.html#Refine_Leof.pw_leof_iff|fact"><span>pw_leof_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_41009..41010"><span>C</span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_41088..41089"><span>S</span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof_step|fact"><span>rwof_step</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_40940..40942"><span>NF</span></a><span class="main"><span>]</span></span><span> 
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>only</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Leof.html#Refine_Leof.pw_leof_iff|fact"><span>pw_leof_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Total Correct Loops›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹In this theory, we show that every non-failing total-correct 
  while loop gives rise to a compatible well-founded relation›</span></span></span><span>


</span><span class="keyword1"><span class="command"><span class="entity_def" id="Refine_While.rwof_rel_def|fact"><span class="entity_def" id="Refine_While.rwof_rel_def|thm"><span class="entity_def" id="Refine_While.rwof_rel_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Refine_While.rwof_rel|const"><span>rwof_rel</span></span></span><span> 
  </span><span class="comment1"><span>― ‹Transitions in a while-loop as relation›</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>rwof_rel</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>init</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>cond</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>step</span></span></span></span><span> 
    </span><span class="main"><span>≡</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span>s</span></span><span class="main"><span>,</span></span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>init</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>cond</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>step</span></span></span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>cond</span></span></span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.inres|const"><span>inres</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>step</span></span></span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.rwof_rel_spec|fact"><span class="entity_def" id="Refine_While.rwof_rel_spec|thm"><span>rwof_rel_spec</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>init</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>⟧</span></span><span> 
  </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Refine_Leof.html#Refine_Leof.le_or_fail|const"><span>≤<span class="hidden">⇩</span><sub>n</sub></span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>s'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>s</span></span><span class="main"><span>,</span></span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof_rel|const"><span>rwof_rel</span></a><span> </span><span class="free"><span>init</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof_rel_def|fact"><span>rwof_rel_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Leof.html#Refine_Leof.pw_leof_iff|fact"><span>pw_leof_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>  


</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_42033..42038">lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.rwof_reachable|fact"><span class="entity_def" id="Refine_While.rwof_reachable|thm"><span>rwof_reachable</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>init</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>s0</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.inres|const"><span>inres</span></a><span> </span><span class="free"><span>init</span></span><span> </span><span class="bound"><span>s0</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>s0</span></span><span class="main"><span>,</span></span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof_rel|const"><span>rwof_rel</span></a><span> </span><span class="free"><span>init</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Transitive_Closure.html#Transitive_Closure.rtrancl|const"><span><span class="hidden">⇧</span><sup>*</sup></span></a></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_42033..42038"><span>assms</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induction.ML.html#HOL.induction|method"><span class="operator"><span>induction</span></span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof_rel_def|fact"><span>rwof_rel_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof.intros|fact"><span>rwof.intros</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.exI|fact"><span>exI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjI|fact"><span>conjI</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Transitive_Closure.html#Transitive_Closure.rtrancl.rtrancl_into_rtrancl|fact"><span>rtrancl_into_rtrancl</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof.intros|fact"><span>rwof.intros</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
  
</span><span class="keyword1"><span class="command"><span>theorem</span></span></span><span> </span><span class="entity_def" id="Refine_While.nofail_WHILEIT_wf_rel|fact"><span class="entity_def" id="Refine_While.nofail_WHILEIT_wf_rel|thm"><span>nofail_WHILEIT_wf_rel</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_42443..42445">NF</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.nofail|const"><span>nofail</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>init</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEIT|const"><span>WHILEIT</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Wellfounded.html#Wellfounded.wf|const"><span>wf</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof_rel|const"><span>rwof_rel</span></a><span> </span><span class="free"><span>init</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.converse|const"><span>¯</span></a></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.ccontr|fact"><span>ccontr</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><a class="entity_ref" href="../../HOL/HOL/Wellfounded.html#Wellfounded.wf|const"><span>wf</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof_rel|const"><span>rwof_rel</span></a><span> </span><span class="free"><span>init</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.converse|const"><span>¯</span></a></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>f</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_42613..42615">IP</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>f</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof_rel|const"><span>rwof_rel</span></a><span> </span><span class="free"><span>init</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Hilbert_Choice.html#Hilbert_Choice.wf_iff_no_infinite_down_chain|fact"><span>wf_iff_no_infinite_down_chain</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof|const"><span>rwof</span></a><span> </span><span class="free"><span>init</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof_rel_def|fact"><span>rwof_rel_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>s0</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>sn</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>s0</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>sn</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof_rel|const"><span>rwof_rel</span></a><span> </span><span class="free"><span>init</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Transitive_Closure.html#Transitive_Closure.rtrancl|const"><span><span class="hidden">⇧</span><sup>*</sup></span></a></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.inres|const"><span>inres</span></a><span> </span><span class="free"><span>init</span></span><span> </span><span class="skolem"><span>s0</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>sn</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof_reachable|fact"><span>rwof_reachable</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>f</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_42934..42935">P</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>f</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof_rel|const"><span>rwof_rel</span></a><span> </span><span class="free"><span>init</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_42991..42992">I</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.inres|const"><span>inres</span></a><span> </span><span class="free"><span>init</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_42613..42615"><span>IP</span></a><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.induct|method"><span class="operator"><span>induct</span></span></a><span> </span><span class="quasi_keyword"><span>arbitrary</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>f</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_43064..43068">step</span><span> </span><span class="skolem"><span>sk</span></span><span> </span><span class="skolem"><span>sn</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>let</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?f</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat.case_nat|const"><span>case_nat</span></a><span> </span><span class="skolem"><span>sk</span></span><span> </span><span class="skolem"><span>f</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>sk</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="var"><span>?f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="var"><span>?f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span> </span><span class="var"><span>?f</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof_rel|const"><span>rwof_rel</span></a><span> </span><span class="free"><span>init</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_43064..43068"><span>step</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>split</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat.splits|fact"><span>nat.splits</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_43064..43068"><span>step</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

  </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_42934..42935"><span>P</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof_rel_def|fact"><span>rwof_rel_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

  </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_42934..42935"><span>P</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_43364..43367">SIR</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.inres|const"><span>inres</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>step</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>f</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.rwof_rel_def|fact"><span>rwof_rel_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_43444..43450">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>F</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>F</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="RefineG_While.html#RefineG_While.WHILEI_body|const"><span>WHILEI_body</span></a><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>(⤜)</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>{</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_43518..43519">M</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="RefineG_Recursion.html#RefineG_Recursion.trimono|const"><span>trimono</span></a><span> </span><span class="skolem"><span>F</span></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_43537..43543">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>f'</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>f'</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.range|const"><span>range</span></a><span> </span><span class="skolem"><span>f</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.FAIL|const"><span>FAIL</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Inductive.html#Inductive.complete_lattice_class.gfp|const"><span>gfp</span></a><span> </span><span class="skolem"><span>F</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>f'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="skolem"><span>F</span></span><span> </span><span class="skolem"><span>f'</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_43537..43543"><span>f'_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.le_funI|fact"><span>le_funI</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct_tacs.ML.html#HOL.case_tac|method"><span class="operator"><span>case_tac</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="improper"><span>x</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.range|const"><span>range</span></a><span> </span><span class="skolem"><span>f</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>defer</span></span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Inductive.html#Inductive.gfp_unfold|fact"><span>gfp_unfold</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_43518..43519"><span>M</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="RefineG_Recursion.html#RefineG_Recursion.trimono_def|fact"><span>trimono_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>unfold</span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_43444..43450"><span>F_def</span></a><span> </span><a class="entity_ref" href="RefineG_While.html#RefineG_While.WHILEI_body_def|fact"><span>WHILEI_body_def</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>      

      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>unfold</span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_43444..43450"><span>F_def</span></a><span> </span><a class="entity_ref" href="RefineG_While.html#RefineG_While.WHILEI_body_def|fact"><span>WHILEI_body_def</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.not_nofail_iff|fact"><span>not_nofail_iff</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_43364..43367"><span>SIR</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>      
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span class="entity_def" id="offset_44082..44086">done</span></span></span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Inductive.html#Inductive.complete_lattice_class.gfp_upperbound|fact"><span>gfp_upperbound</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="skolem"><span>f'</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>F</span></span></span><span class="main"><span>,</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_44082..44086"><span>this</span></a><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>f'</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Inductive.html#Inductive.complete_lattice_class.gfp|const"><span>gfp</span></a><span> </span><span class="skolem"><span>F</span></span><span> </span><span class="bound"><span>x</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_44162..44164">by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.le_funD|fact"><span>le_funD</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_44162..44164"><span>this</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Inductive.html#Inductive.complete_lattice_class.gfp|const"><span>gfp</span></a><span> </span><span class="skolem"><span>F</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.FAIL|const"><span>FAIL</span></a><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_43537..43543"><span>f'_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_44276..44277">}</span></span></span><span> </span><span class="keyword1"><span class="command"><span>note</span></span></span><span> </span><span class="entity_def" id="offset_44283..44286">aux</span><span class="main"><span>=</span></span><a class="entity_ref" href="Refine_While.html#offset_44276..44277"><span>this</span></a><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.FAIL|const"><span>FAIL</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILEIT|const"><span>WHILEIT</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>cond</span></span><span> </span><span class="free"><span>step</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILET_def|fact"><span>WHILET_def</span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILEIT_def|fact"><span>WHILEIT_def</span></a><span> </span><a class="entity_ref" href="RefineG_Recursion.html#RefineG_Recursion.RECT_def|fact"><span>RECT_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="RefineG_Domain.html#RefineG_Domain.gfp_eq_flatf_gfp|fact"><span>gfp_eq_flatf_gfp</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="RefineG_Recursion.html#RefineG_Recursion.trimono_def|fact"><span>trimono_def</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span>2</span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>unfold</span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_43444..43450"><span>F_def</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_44283..44286"><span>aux</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_42443..42445"><span>NF</span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_42991..42992"><span>I</span></a><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>


</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Convenience›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Iterate over range of list›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Refine_While.range_set_WHILE|fact"><span class="entity_def" id="Refine_While.range_set_WHILE|thm"><span>range_set_WHILE</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_44706..44709">CEQ</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>u</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_44743..44745">F0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>F</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span> </span><span class="free"><span>s0</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>s0</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_44772..44774">Fs</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>s</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>X</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="bound"><span>i</span></span><span class="main"><span>;</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>u</span></span><span class="main"><span>⟧</span></span><span> 
    </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>F</span></span><span> </span><span class="bound"><span>X</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>i'</span></span><span class="main"><span>,</span></span><span class="bound"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>r</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span>F</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.insert|const"><span>insert</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>list</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>X</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Refine_While.html#Refine_While.WHILET|const"><span>WHILET</span></a><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>l</span></span><span class="main"><span>,</span></span><span class="free"><span>s0</span></span><span class="main"><span>)</span></span><span> 
    </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="bound"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span>F</span></span><span> </span><span class="main"><span>{</span></span><span class="free"><span>list</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="bound"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>u</span></span><span class="main"><span>}</span></span><span> </span><span class="free"><span>s0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="main"><span>(</span></span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>u</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILET_unfold|fact"><span>WHILET_unfold</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_44743..44745"><span>F0</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_44706..44709"><span>CEQ</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.subst|fact"><span>subst</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Automatic_Refinement/Refine_Util.html#Refine_Util.fo_rule|method"><span class="operator"><span>fo_rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.cong|fact"><span>cong</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.refl|fact"><span>refl</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#Refine_While.while.WHILET_rule|fact"><span>WHILET_rule</span></a><span class="main"><span class="main"><span>[</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> R </span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Wellfounded.html#Wellfounded.measure|const"><span>measure</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>u</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> I </span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="bound"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span>u</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>F</span></span><span> </span><span class="main"><span>{</span></span><span class="free"><span>list</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="bound"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>i</span></span><span class="main"><span>}</span></span><span> </span><span class="free"><span>s0</span></span><span>"</span></span></span><span>
    </span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span>

  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="Refine_While.html#offset_44743..44745"><span>F0</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Automatic_Refinement/Refine_Util.html#Refine_Util.fo_rule|method"><span class="operator"><span>fo_rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.cong|fact"><span>cong</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.refl|fact"><span>refl</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_44706..44709"><span>CEQ</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order_trans|fact"><span>order_trans</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_44772..44774"><span>Fs</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
    </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.fun_cong|fact"><span>fun_cong</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.arg_cong|fact"><span>arg_cong</span></a><span class="main"><span class="main"><span class="main"><span>[</span></span></span></span><a class="entity_ref" href="../Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="main"><span class="main"><span class="main"><span>_</span></span></span></span><span> </span><span class="main"><span class="main"><span class="main"><span>_</span></span></span></span><span> </span><span class="quoted"><span class="free"><span>F</span></span></span><span class="main"><span class="main"><span class="main"><span>]</span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span>
    </span><span class="quasi_keyword"><span>elim</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.less_SucE|fact"><span>less_SucE</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Refine_While.html#offset_44706..44709"><span>CEQ</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>


</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span></pre>
</body>

</html>