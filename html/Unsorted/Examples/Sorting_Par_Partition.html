<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Sorting_Par_Partition</title>
</head>


<body>
<div class="head">
<h1>Theory Sorting_Par_Partition</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><a href="Sorting_Par_Partition.html"><span>Sorting_Par_Partition</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> </span><a href="Sorting_Setup.html"><span>Sorting_Setup</span></a><span> </span><a href="Sorting_Guarded_Partition.html"><span>Sorting_Guarded_Partition</span></a><span> </span><a href="IICF_DS_Interval_List.html"><span>IICF_DS_Interval_List</span></a><span> </span><a href="IICF_Shared_Lists.html"><span>IICF_Shared_Lists</span></a><span> </span><a href="IICF_DS_Array_Idxs.html"><span>IICF_DS_Array_Idxs</span></a><span> </span><a href="Sorting_Sample_Partition.html"><span>Sorting_Sample_Partition</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="comment1"><span>(* TODO: Move near set_drop_conv *)</span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.set_take_conv_nth|fact"><span class="entity_def" id="Sorting_Par_Partition.set_take_conv_nth|thm"><span>set_take_conv_nth</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list.set|const"><span>set</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.take|const"><span>take</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span class="main"><span>|</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> 0 3 </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.in_set_conv_nth|fact"><span>in_set_conv_nth</span></a><span class="main"><span>)</span></span><span> 

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.set_drop_conv_nth|fact"><span class="entity_def" id="Sorting_Par_Partition.set_drop_conv_nth|thm"><span>set_drop_conv_nth</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list.set|const"><span>set</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.drop|const"><span>drop</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span class="main"><span>|</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>≥</span></a></span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.set_drop_conv|fact"><span>set_drop_conv</span></a><span class="main"><span>)</span></span><span>
      
</span><span class="comment1"><span>(* TODO: Move *)</span></span><span>  
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.slice_eq_mset_whole_iff|fact"><span class="entity_def" id="Sorting_Par_Partition.slice_eq_mset_whole_iff(2)|thm"><span class="entity_def" id="Sorting_Par_Partition.slice_eq_mset_whole_iff(1)|thm"><span>slice_eq_mset_whole_iff</span></span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset|const"><span>slice_eq_mset</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>  
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset|const"><span>slice_eq_mset</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs'</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>  
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_def|fact"><span>slice_eq_mset_def</span></a><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice_def|fact"><span>Misc.slice_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.dual_order.refl|fact"><span>dual_order.refl</span></a><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset_eq_length|fact"><span>mset_eq_length</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.take_all_iff|fact"><span>take_all_iff</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.dual_order.refl|fact"><span>dual_order.refl</span></a><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset_eq_length|fact"><span>mset_eq_length</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.take_all_iff|fact"><span>take_all_iff</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>


</span><span class="comment1"><span>(* TODO: Move *)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.nat_div_round_up_def|fact"><span class="entity_def" id="Sorting_Par_Partition.nat_div_round_up_def|thm"><span class="entity_def" id="Sorting_Par_Partition.nat_div_round_up_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_Par_Partition.nat_div_round_up|const"><span>nat_div_round_up</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres|type"><span>nres</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>nat_div_round_up</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>q</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
  </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>q</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
  </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.divide_class.divide|const"><span>div</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>q</span></span></span></span><span class="main"><span>;</span></span><span>
  </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>q</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> 
    </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>r</span></span><span> 
  </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
    </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>r</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
    </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>r</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>}</span></span><span>
</span><span class="main"><span>}</span></span><span>"</span></span></span><span>  

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.nat_div_round_up_correct|fact"><span class="entity_def" id="Sorting_Par_Partition.nat_div_round_up_correct|thm"><span>nat_div_round_up_correct</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|attribute"><span class="operator"><span>refine_vcg</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>q</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.nat_div_round_up|const"><span>nat_div_round_up</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>q</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span>  </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>r</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="free"><span>q</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="free"><span>q</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.nat_div_round_up_def|fact"><span>nat_div_round_up_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.algebra_simps|fact"><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Rings.html#Euclidean_Rings.modulo_nat_def|fact"><span>modulo_nat_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.ordered_ab_semigroup_monoid_add_imp_le_class.less_add_same_cancel1|fact"><span>less_add_same_cancel1</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.linorder_class.nle_le|fact"><span>nle_le</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Rings.html#Euclidean_Rings.times_div_less_eq_dividend|fact"><span>times_div_less_eq_dividend</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Rings.html#Euclidean_Rings.div_le_dividend|fact"><span>div_le_dividend</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.gr0_implies_Suc|fact"><span>gr0_implies_Suc</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.linorder_class.leI|fact"><span>leI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.le_antisym|fact"><span>le_antisym</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.less_Suc_eq_le|fact"><span>less_Suc_eq_le</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.times_nat.mult_Suc|fact"><span>mult_Suc</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.not_add_less1|fact"><span>not_add_less1</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Rings.html#Euclidean_Rings.dividend_less_times_div|fact"><span>dividend_less_times_div</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.less_imp_le_nat|fact"><span>less_imp_le_nat</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Presburger.html#Presburger.presburger|method"><span class="operator"><span>presburger</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
  

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.nat_div_round_up.mcomb|fact"><span class="entity_def" id="Sorting_Par_Partition.nat_div_round_up.arity|fact"><span class="entity_def" id="Sorting_Par_Partition.nat_div_round_up.itype|fact"><span class="entity_def" id="Sorting_Par_Partition.nat_div_round_up.mcomb|thm"><span class="entity_def" id="Sorting_Par_Partition.nat_div_round_up.arity|thm"><span class="entity_def" id="Sorting_Par_Partition.nat_div_round_up.itype|thm"><span>sepref_register</span></span></span></span></span></span></span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.nat_div_round_up|const"><span>nat_div_round_up</span></a></span><span>

</span><span class="keyword1"><span class="command"><span>sepref_def</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_Par_Partition.nat_div_round_up_impl|const"><span>nat_div_round_up_impl</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.uncurry|const"><span>uncurry</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.nat_div_round_up|const"><span>nat_div_round_up</span></a><span>"</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.snat_assn&apos;|const"><span>snat_assn'</span></a><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_More_Word_Lemmas.html#LLVM_More_Word_Lemmas.len2|class"><span>len2</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.snat_assn&apos;|const"><span>snat_assn'</span></a><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefttnd|const"><span>→<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.snat_assn&apos;|const"><span>snat_assn'</span></a><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.nat_div_round_up_def|fact"><span>nat_div_round_up_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.annot_snat_const|method"><span class="operator"><span>annot_snat_const</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.nat_div_round_up_impl.refine|fact"><span class="entity_def" id="Sorting_Par_Partition.nat_div_round_up_impl_def|fact"><span class="entity_def" id="Sorting_Par_Partition.nat_div_round_up_impl.refine_raw|fact"><span class="entity_def" id="Sorting_Par_Partition.nat_div_round_up_impl.refine|thm"><span class="entity_def" id="Sorting_Par_Partition.nat_div_round_up_impl_def|thm"><span class="entity_def" id="Sorting_Par_Partition.nat_div_round_up_impl.refine_raw|thm"><span class="entity_def" id="Sorting_Par_Partition.nat_div_round_up_impl_def_raw|axiom"><span>by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref|method"><span class="operator"><span>sepref</span></span></a><span>



</span><span class="comment1"><span>(* TODO: Move *)</span></span><span>

</span><span class="comment1"><span>(* Copy-nth implementation for woarray_slice_assn *)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.array_cp_nth_def|fact"><span class="entity_def" id="Sorting_Par_Partition.array_cp_nth_def|thm"><span class="entity_def" id="Sorting_Par_Partition.array_cp_nth_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Codegen_Preproc.html#LLVM_Codegen_Preproc.llvm_inline|attribute"><span class="operator"><span>llvm_inline</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Par_Partition.array_cp_nth|const"><span>array_cp_nth</span></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>cp</span></span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="tfree"><span>'a</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow.html#LLVM_Shallow.llvm_rep|class"><span>llvm_rep</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Simple_Memory.html#Simple_Memory.llM|type"><span>llM</span></a><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doM</span></span><span> </span><span class="main"><span>{</span></span><span>
  </span><span class="bound"><span>r</span></span><span class="main"><span>←</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_DS_Array.html#LLVM_DS_Array.array_nth|const"><span>array_nth</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span class="main"><span>;</span></span><span>
  </span><span class="bound"><span>r</span></span><span class="main"><span>←</span></span><span class="free"><span class="bound"><span class="entity"><span>cp</span></span></span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><span>;</span></span><span>
  </span><a class="entity_ref" href="../Isabelle_LLVM/MMonad.html#MMonad.Mreturn|const"><span>Mreturn</span></a><span> </span><span class="bound"><span>r</span></span><span>
</span><span class="main"><span>}</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.sao_assn_cp_rl|fact"><span class="entity_def" id="Sorting_Par_Partition.sao_assn_cp_rl|thm"><span>sao_assn_cp_rl</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Basic_VCG.html#Basic_VCG.vcg_rules|attribute"><span class="operator"><span>vcg_rules</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="tfree"><span>'a</span></span><span class="main"><span>,</span></span><span class="tfree"><span>'c</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow.html#LLVM_Shallow.llvm_rep|class"><span>llvm_rep</span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow_RS.html#LLVM_Shallow_RS.dr_assn|type"><span>dr_assn</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>cp</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>copy_elem_rl</span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Basic_VCG.html#Basic_VCG.vcg_rules|attribute"><span class="operator"><span>vcg_rules</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>c</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow_RS.html#LLVM_Shallow_RS.llvm_htriple|const"><span>llvm_htriple</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow_RS.html#LLVM_Shallow_RS.dr_assn_prefix|const"><span>↿</span></a></span><span class="free"><span>A</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>c</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>cp</span></span><span> </span><span class="bound"><span>c</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>r</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow_RS.html#LLVM_Shallow_RS.dr_assn_prefix|const"><span>↿</span></a></span><span class="free"><span>A</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>c</span></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Separation_Algebra.Separation_Algebra.html#Separation_Algebra.sep_algebra_class.sep_conj|const"><span>**</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow_RS.html#LLVM_Shallow_RS.dr_assn_prefix|const"><span>↿</span></a></span><span class="free"><span>A</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow_RS.html#LLVM_Shallow_RS.llvm_htriple|const"><span>llvm_htriple</span></a><span> 
    </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow_RS.html#LLVM_Shallow_RS.dr_assn_prefix|const"><span>↿</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Proto_EOArray.html#Proto_EOArray.sao_assn|const"><span>sao_assn</span></a><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Separation_Algebra.Separation_Algebra.html#Separation_Algebra.sep_algebra_class.sep_conj|const"><span>∧*</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow_RS.html#LLVM_Shallow_RS.dr_assn_prefix|const"><span>↿</span></a></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_DS_Arith.html#LLVM_DS_Arith.snat.assn|const"><span>snat.assn</span></a><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>ii</span></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Separation_Algebra.Separation_Algebra.html#Separation_Algebra.sep_algebra_class.sep_conj|const"><span>∧*</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Frame_Infer.html#Frame_Infer.pred_lift_AUTO_DEFER|const"><span>↑<span class="hidden">⇩</span><sub>d</sub></span></a></span><span class="main"><span>(</span></span><span class="free"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.None|const"><span>None</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> 
    </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.array_cp_nth|const"><span>array_cp_nth</span></a><span> </span><span class="free"><span>cp</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>ii</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>ri</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow_RS.html#LLVM_Shallow_RS.dr_assn_prefix|const"><span>↿</span></a></span><span class="free"><span>A</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.the|const"><span>the</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>ri</span></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Separation_Algebra.Separation_Algebra.html#Separation_Algebra.sep_algebra_class.sep_conj|const"><span>∧*</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow_RS.html#LLVM_Shallow_RS.dr_assn_prefix|const"><span>↿</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Proto_EOArray.html#Proto_EOArray.sao_assn|const"><span>sao_assn</span></a><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Proto_EOArray.html#Proto_EOArray.sao_assn_def|fact"><span>sao_assn_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.array_cp_nth_def|fact"><span>array_cp_nth_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>supply</span></span></span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Proto_EOArray.html#Proto_EOArray.lo_extract_elem|fact"><span>lo_extract_elem</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Basic_VCG.html#Basic_VCG.vcg|method"><span class="operator"><span>vcg</span></span></a><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.mop_list_cp_get.fref&apos;|fact"><span class="entity_def" id="Sorting_Par_Partition.mop_list_cp_get.fref|fact"><span class="entity_def" id="Sorting_Par_Partition.op_list_cp_get.fref&apos;|fact"><span class="entity_def" id="Sorting_Par_Partition.pre_list_cp_get.param|fact"><span class="entity_def" id="Sorting_Par_Partition.op_list_cp_get.fref|fact"><span class="entity_def" id="Sorting_Par_Partition.mop_list_cp_get.vcg|fact"><span class="entity_def" id="Sorting_Par_Partition.mop_list_cp_get.mcomb|fact"><span class="entity_def" id="Sorting_Par_Partition.mop_list_cp_get.arity|fact"><span class="entity_def" id="Sorting_Par_Partition.mop_list_cp_get.itype|fact"><span class="entity_def" id="Sorting_Par_Partition.mop_list_cp_get_def|fact"><span class="entity_def" id="Sorting_Par_Partition.pre_list_cp_get_def|fact"><span class="entity_def" id="Sorting_Par_Partition.op_list_cp_get.itype|fact"><span class="entity_def" id="Sorting_Par_Partition.op_list_cp_get_def|fact"><span class="entity_def" id="Sorting_Par_Partition.mop_list_cp_get.fref&apos;|thm"><span class="entity_def" id="Sorting_Par_Partition.mop_list_cp_get.fref|thm"><span class="entity_def" id="Sorting_Par_Partition.op_list_cp_get.fref&apos;|thm"><span class="entity_def" id="Sorting_Par_Partition.pre_list_cp_get.param|thm"><span class="entity_def" id="Sorting_Par_Partition.op_list_cp_get.fref|thm"><span class="entity_def" id="Sorting_Par_Partition.mop_list_cp_get.vcg(2)|thm"><span class="entity_def" id="Sorting_Par_Partition.mop_list_cp_get.vcg(1)|thm"><span class="entity_def" id="Sorting_Par_Partition.mop_list_cp_get.mcomb|thm"><span class="entity_def" id="Sorting_Par_Partition.mop_list_cp_get.arity|thm"><span class="entity_def" id="Sorting_Par_Partition.mop_list_cp_get.itype|thm"><span class="entity_def" id="Sorting_Par_Partition.mop_list_cp_get_def|thm"><span class="entity_def" id="Sorting_Par_Partition.pre_list_cp_get_def|thm"><span class="entity_def" id="Sorting_Par_Partition.op_list_cp_get.itype|thm"><span class="entity_def" id="Sorting_Par_Partition.op_list_cp_get_def|thm"><span class="entity_def" id="Sorting_Par_Partition.mop_list_cp_get_def|axiom"><span class="entity_def" id="Sorting_Par_Partition.pre_list_cp_get_def|axiom"><span class="entity_def" id="Sorting_Par_Partition.op_list_cp_get_def|axiom"><span>sepref_decl_op</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.mop_list_cp_get_alt|fact"><span class="entity_def" id="Sorting_Par_Partition.mop_list_cp_get_alt|thm"><span class="entity_def" id="Sorting_Par_Partition.mop_list_cp_get|const"><span class="entity_def" id="Sorting_Par_Partition.pre_list_cp_get|const"><span class="entity_def" id="Sorting_Par_Partition.op_list_cp_get|const"><span>list_cp_get</span></span></span></span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>nth</span></a></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.frefnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>l</span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="bound"><span>l</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.frefnd|const"><span>]<span class="hidden">⇩</span><sub>f</sub></span></a></span><span> </span><span class="main"><span>⟨</span></span><span class="free"><span>A</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.list_rel|const"><span>list_rel</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.prod_rel_syn|const"><span>×<span class="hidden">⇩</span><sub>r</sub></span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.nat_rel|const"><span>nat_rel</span></a><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.frefnd|const"><span>→</span></a></span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
  
</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_2542..2547">lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.woarray_slice_cp_nth_hnr|fact"><span class="entity_def" id="Sorting_Par_Partition.woarray_slice_cp_nth_hnr|thm"><span>woarray_slice_cp_nth_hnr</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.GEN_ALGO|const"><span>GEN_ALGO</span></a><span> </span><span class="free"><span>cp</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.is_copy|const"><span>is_copy</span></a><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.uncurry|const"><span>uncurry</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.array_cp_nth|const"><span>array_cp_nth</span></a><span> </span><span class="free"><span>cp</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.uncurry|const"><span>uncurry</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.mop_list_cp_get|const"><span>mop_list_cp_get</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Proto_IICF_EOArray.html#Proto_IICF_EOArray.woarray_slice_assn|const"><span>woarray_slice_assn</span></a><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.snat_assn|const"><span>snat_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefttnd|const"><span>→<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>

  </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_2542..2547"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>copy_elem_rl</span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Basic_VCG.html#Basic_VCG.vcg_rules|attribute"><span class="operator"><span>vcg_rules</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>c</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow_RS.html#LLVM_Shallow_RS.llvm_htriple|const"><span>llvm_htriple</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>A</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>c</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>cp</span></span><span> </span><span class="bound"><span>c</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>r</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>c</span></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Separation_Algebra.Separation_Algebra.html#Separation_Algebra.sep_algebra_class.sep_conj|const"><span>**</span></a></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.GEN_ALGO_def|fact"><span>GEN_ALGO_def</span></a><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.is_copy_def|fact"><span>is_copy_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>drule</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefD|fact"><span>hfrefD</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>drule</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.hn_refineD|fact"><span>hn_refineD</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>erule</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Simple_Memory_RS.html#LLVM_Simple_Memory_RS.htriple_ent_post|fact"><span>htriple_ent_post</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>rotated</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sep_Algebra_Add.html#Sep_Algebra_Add.sep_algebra_simps|fact"><span class="dynamic"><span class="dynamic"><span>sep_algebra_simps</span></span></span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
  

  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref_to_hoare|method"><span class="operator"><span>sepref_to_hoare</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Proto_IICF_EOArray.html#Proto_IICF_EOArray.woarray_slice_assn_def|fact"><span>woarray_slice_assn_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Proto_IICF_EOArray.html#Proto_IICF_EOArray.eoarray_slice_assn_def|fact"><span>eoarray_slice_assn_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hr_comp_def|fact"><span>hr_comp_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.in_snat_rel_conv_assn|fact"><span>in_snat_rel_conv_assn</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>supply</span></span></span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.dest|attribute"><span class="operator"><span>dest</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.list_rel_imp_same_length|fact"><span>list_rel_imp_same_length</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Proto_IICF_EOArray.html#Proto_IICF_EOArray.some_list_rel_conv|fact"><span>some_list_rel_conv</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Basic_VCG.html#Basic_VCG.vcg|method"><span class="operator"><span>vcg</span></span></a><span>
    
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>  

</span><span class="keyword1"><span class="command"><span>context</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>notes</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.fcomp_norm_simps|attribute"><span class="operator"><span>fcomp_norm_simps</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.list_rel_id_simp|fact"><span>list_rel_id_simp</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>sepref_decl_impl</span></span></span><span> </span><span class="main"><span>(</span></span><span>ismop</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.woarray_slice_cp_nth_hnr|fact"><span>woarray_slice_cp_nth_hnr</span></a><span> </span><span class="keyword2"><span class="keyword"><span>uses</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.mop_list_cp_get.fref|fact"><span>mop_list_cp_get.fref</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Abstract Algorithm›</span></span></span><span>

  

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_3497..3504">context</span></span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.weak_ordering|locale"><span>weak_ordering</span></a><span> </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>  

  </span><span class="comment1"><span>(* Partitioning the whole list *)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>abbreviation</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.gpartition_all_spec|const"><span class="entity_def" id="offset_3581..3600">gpartition_all_spec</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs'</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span>gpartition_spec</span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs'</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.gpartition_all_spec_alt1|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.gpartition_all_spec_alt1|thm"><span class="entity_def" id="offset_3665..3689">gpartition_all_spec_alt1</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_3581..3600"><span>gpartition_all_spec</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> 
      </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span>xs</span></span><span> 
    </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span>
    </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span class="bound"><span>i</span></span></span><span class="main"><span>&lt;</span></span><span class="free"><span>m</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>xs'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span>  
    </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>xs'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span><span class="hidden">❙</span><b>≥</b></span></span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span>
  "</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_3497..3504"><span>gpartition_spec_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.slice_eq_mset_whole_iff|fact"><span>slice_eq_mset_whole_iff</span></a><span class="main"><span>)</span></span><span>
  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.gpartition_all_spec_alt2|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.gpartition_all_spec_alt2|thm"><span>gpartition_all_spec_alt2</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_3581..3600"><span>gpartition_all_spec</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span>
    </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span>xs</span></span><span> 
  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span>
  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>x</span></span><span class="main"><span>∈</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list.set|const"><span>set</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.take|const"><span>take</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs'</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>x</span></span><span class="main"><span>∈</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list.set|const"><span>set</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.drop|const"><span>drop</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs'</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>p</span></span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>
  "</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_3665..3689"><span>gpartition_all_spec_alt1</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.set_take_conv_nth|fact"><span>set_take_conv_nth</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.set_drop_conv_nth|fact"><span>set_drop_conv_nth</span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset_eq_length|fact"><span>mset_eq_length</span></a><span class="main"><span>)</span></span><span>  
    
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.gpartition_spec_permute|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.gpartition_spec_permute|thm"><span class="entity_def" id="offset_4235..4258">gpartition_spec_permute</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_3581..3600"><span>gpartition_all_spec</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_3581..3600"><span>gpartition_all_spec</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="free"><span>m</span></span><span>"</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_3665..3689"><span>gpartition_all_spec_alt1</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset_eq_length|fact"><span>mset_eq_length</span></a><span class="main"><span>)</span></span><span>
    
    
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Step 1: Partition the Array›</span></span></span><span>

</span><span class="comment1"><span>(*
  Step 1: partition the array, and keep track of the set of small/big indices
    in practice, the array will be partitioned into multiple slices, and the sets will be intervals
*)</span></span><span>

</span><span class="comment1"><span>(* An array together with sets of small/big elements *)</span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.is_ppart.axioms|fact"><span class="entity_def" id="Sorting_Par_Partition.is_ppart.intro|fact"><span class="entity_def" id="Sorting_Par_Partition.is_ppart_def|fact"><span class="entity_def" id="Sorting_Par_Partition.is_ppart_axioms.intro|fact"><span class="entity_def" id="Sorting_Par_Partition.is_ppart_axioms_def|fact"><span class="entity_def" id="Sorting_Par_Partition.is_ppart.axioms(2)|thm"><span class="entity_def" id="Sorting_Par_Partition.is_ppart.axioms(1)|thm"><span class="entity_def" id="Sorting_Par_Partition.is_ppart.intro|thm"><span class="entity_def" id="Sorting_Par_Partition.is_ppart_def|thm"><span class="entity_def" id="Sorting_Par_Partition.is_ppart_axioms.intro|thm"><span class="entity_def" id="Sorting_Par_Partition.is_ppart_axioms_def|thm"><span class="entity_def" id="Sorting_Par_Partition.is_ppart_def|axiom"><span class="entity_def" id="Sorting_Par_Partition.is_ppart_axioms_def|axiom"><span>locale</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.is_ppart|locale"><span class="entity_def" id="Sorting_Par_Partition.is_ppart|const"><span class="entity_def" id="Sorting_Par_Partition.is_ppart_axioms|const"><span>is_ppart</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.weak_ordering|locale"><span>weak_ordering</span></a><span> </span><span class="main"><span>+</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>ss</span></span><span> </span><span class="free"><span>bs</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.is_ppart.complete|fact"><span class="entity_def" id="Sorting_Par_Partition.is_ppart.complete|thm"><span class="entity_def" id="offset_4788..4796">complete</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>ss</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="free"><span>bs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.is_ppart.disjoint|fact"><span class="entity_def" id="Sorting_Par_Partition.is_ppart.disjoint|thm"><span class="entity_def" id="offset_4836..4844">disjoint</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>ss</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>∩</span></a></span><span> </span><span class="free"><span>bs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.is_ppart.ss_in_P1|fact"><span class="entity_def" id="Sorting_Par_Partition.is_ppart.ss_in_P1|thm"><span class="entity_def" id="offset_4871..4879">ss_in_P1</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>ss</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>i</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span>p</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.is_ppart.bs_in_P2|fact"><span class="entity_def" id="Sorting_Par_Partition.is_ppart.bs_in_P2|thm"><span class="entity_def" id="offset_4910..4918">bs_in_P2</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>bs</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>i</span></span><span>"</span></span></span><span>
  


</span><span class="keyword1"><span class="command"><span>context</span></span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.weak_ordering|locale"><span>weak_ordering</span></a><span> </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>
  
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_spec_def|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_spec_def|thm"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_spec_def_raw|axiom"><span class="entity_def" id="offset_4977..4987">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_spec.cong|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_spec.cong|thm"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_spec|const"><span class="entity_def" id="offset_4989..4999">ppart_spec</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs'</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>ss</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>bs</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs'</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.is_ppart|const"><span>is_ppart</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>≤</b>)</span></span></span><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs'</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>ss</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>bs</span></span></span></span><span>"</span></span></span><span>  
    
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_SPEC_def|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_SPEC_def|thm"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_SPEC_def_raw|axiom"><span class="entity_def" id="offset_5079..5089">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_SPEC.cong|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_SPEC.cong|thm"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_SPEC|const"><span class="entity_def" id="offset_5091..5101">ppart_SPEC</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>xs'</span></span><span class="main"><span>,</span></span><span class="bound"><span>ss</span></span><span class="main"><span>,</span></span><span class="bound"><span>bs</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_4989..4999"><span>ppart_spec</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="bound"><span>xs'</span></span><span> </span><span class="bound"><span>ss</span></span><span> </span><span class="bound"><span>bs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  
  </span><span class="comment1"><span>(* For paper *)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_5091..5101"><span>ppart_SPEC</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>xs'</span></span><span class="main"><span>,</span></span><span class="bound"><span>ss</span></span><span class="main"><span>,</span></span><span class="bound"><span>bs</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> 
    </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="bound"><span>xs'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span>xs</span></span><span>
  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>ss</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="bound"><span>bs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="bound"><span>xs'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>ss</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>∩</span></a></span><span> </span><span class="bound"><span>bs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>
  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="bound"><span>ss</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>xs'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="bound"><span>bs</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="bound"><span>xs'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_5079..5089"><span>ppart_SPEC_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_4977..4987"><span>ppart_spec_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.is_ppart_def|fact"><span>is_ppart_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.is_ppart_axioms_def|fact"><span>is_ppart_axioms_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>weak_ordering_axioms</span><span class="main"><span>)</span></span><span>
    
  
  
  
  </span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Step 2: compute mid-index, filter misplaced indexes›</span></span></span><span>

  </span><span class="comment1"><span>(*
    Step 2: compute position of bound (first position of big element)
  *)</span></span><span>  
  
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_mpos_def|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_mpos_def|thm"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_mpos_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_mpos|const"><span>ppart_mpos</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>ppart_mpos</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>ss</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>ss</span></span></span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_filter_def|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_filter_def|thm"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_filter_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_filter|const"><span>ppart_filter</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod|type"><span>×</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>ppart_filter</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>ss</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>bs</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>i</span></span></span><span class="main"><span>∈</span></span><span class="free"><span class="bound"><span class="entity"><span>ss</span></span></span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="bound"><span>i</span></span><span class="main"><span>}</span></span><span class="main"><span>,</span></span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>i</span></span></span><span class="main"><span>∈</span></span><span class="free"><span class="bound"><span class="entity"><span>bs</span></span></span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>  
  
</span><span class="comment1"><span>(*
  Number of misplaced elements small and big elements is the same.
  Lemma is generalized for sets of indexes, no matter how they are formed.
*)</span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.intro|fact"><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements_def|fact"><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.intro|thm"><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements_def|thm"><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements_def|axiom"><span>locale</span></span></span></span></span></span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements|locale"><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements|const"><span>misplaced_elements</span></span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>ss</span></span><span> </span><span class="free"><span>bs</span></span><span> </span><span class="free"><span>n</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.SSU|fact"><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.SSU(2)|thm"><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.SSU(1)|thm"><span class="entity_def" id="offset_6092..6095">SSU</span></span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>ss</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="free"><span>bs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>ss</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>∩</span></a></span><span> </span><span class="free"><span>bs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.m_def|fact"><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.m_def|thm"><span class="entity_def" id="offset_6173..6178">m_def</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>ss</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.ss\&lt;^sub&gt;1_def|fact"><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.ss\&lt;^sub&gt;1_def|thm"><span class="entity_def" id="offset_6204..6212">ss<span class="hidden">⇩</span><sub>1</sub>_def</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>i</span></span></span><span class="main"><span>∈</span></span><span class="free"><span>ss</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>m</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.ss\&lt;^sub&gt;2_def|fact"><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.ss\&lt;^sub&gt;2_def|thm"><span class="entity_def" id="offset_6245..6253">ss<span class="hidden">⇩</span><sub>2</sub>_def</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>i</span></span></span><span class="main"><span>∈</span></span><span class="free"><span>ss</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="bound"><span>i</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.bs\&lt;^sub&gt;1_def|fact"><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.bs\&lt;^sub&gt;1_def|thm"><span class="entity_def" id="offset_6286..6294">bs<span class="hidden">⇩</span><sub>1</sub>_def</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>i</span></span></span><span class="main"><span>∈</span></span><span class="free"><span>bs</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="bound"><span>i</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.bs\&lt;^sub&gt;2_def|fact"><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.bs\&lt;^sub&gt;2_def|thm"><span class="entity_def" id="offset_6327..6335">bs<span class="hidden">⇩</span><sub>2</sub>_def</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>i</span></span></span><span class="main"><span>∈</span></span><span class="free"><span>bs</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>m</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.finiteIs1|fact"><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.finiteIs1(2)|thm"><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.finiteIs1(1)|thm"><span>finiteIs1</span></span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.intro|attribute"><span class="operator"><span>intro</span></span></a><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span>!</span></span></span></span></span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="free"><span>ss</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="free"><span>bs</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6092..6095"><span>SSU</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite_Un|fact"><span>finite_Un</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.finite_atLeastLessThan|fact"><span>finite_atLeastLessThan</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>
    
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.finiteIs2|fact"><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.finiteIs2(4)|thm"><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.finiteIs2(3)|thm"><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.finiteIs2(2)|thm"><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.finiteIs2(1)|thm"><span>finiteIs2</span></span></span></span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.intro|attribute"><span class="operator"><span>intro</span></span></a><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span>!</span></span></span></span></span></span></span></span></span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6204..6212"><span>ss<span class="hidden">⇩</span><sub>1</sub>_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6245..6253"><span>ss<span class="hidden">⇩</span><sub>2</sub>_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6286..6294"><span>bs<span class="hidden">⇩</span><sub>1</sub>_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6327..6335"><span>bs<span class="hidden">⇩</span><sub>2</sub>_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.m_le_n|fact"><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.m_le_n|thm"><span class="entity_def" id="offset_6654..6660">m_le_n</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span>n</span></span><span>"</span></span></span><span> 
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span> 
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>ss</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>bs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>n</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6092..6095"><span>SSU</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_Un_Int|fact"><span>card_Un_Int</span></a><span class="main"><span>)</span></span><span>
      
    </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span>n</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6173..6178"><span>m_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> 
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>              

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.ss_split|fact"><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.ss_split|thm"><span class="entity_def" id="offset_6838..6846">ss_split</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>ss</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.ss_dj|fact"><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.ss_dj|thm"><span class="entity_def" id="offset_6875..6880">ss_dj</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>∩</span></a></span><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6204..6212"><span>ss<span class="hidden">⇩</span><sub>1</sub>_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6245..6253"><span>ss<span class="hidden">⇩</span><sub>2</sub>_def</span></a><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
    
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.bs_split|fact"><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.bs_split|thm"><span class="entity_def" id="offset_6959..6967">bs_split</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>bs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.bs_dj|fact"><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.bs_dj|thm"><span class="entity_def" id="offset_6996..7001">bs_dj</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>∩</span></a></span><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6286..6294"><span>bs<span class="hidden">⇩</span><sub>1</sub>_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6327..6335"><span>bs<span class="hidden">⇩</span><sub>2</sub>_def</span></a><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.low_range_split|fact"><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.low_range_split|thm"><span class="entity_def" id="offset_7076..7091">low_range_split</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.low_range_dj|fact"><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.low_range_dj|thm"><span class="entity_def" id="offset_7125..7137">low_range_dj</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>∩</span></a></span><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6204..6212"><span>ss<span class="hidden">⇩</span><sub>1</sub>_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6327..6335"><span>bs<span class="hidden">⇩</span><sub>2</sub>_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6092..6095"><span>SSU</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6654..6660"><span>m_le_n</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
    
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.high_range_split|fact"><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.high_range_split|thm"><span class="entity_def" id="offset_7233..7249">high_range_split</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.high_range_dj|fact"><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.high_range_dj|thm"><span class="entity_def" id="offset_7283..7296">high_range_dj</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>∩</span></a></span><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6286..6294"><span>bs<span class="hidden">⇩</span><sub>1</sub>_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6245..6253"><span>ss<span class="hidden">⇩</span><sub>2</sub>_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6092..6095"><span>SSU</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
    
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.same_djs|fact"><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.same_djs(2)|thm"><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.same_djs(1)|thm"><span class="entity_def" id="offset_7385..7393">same_djs</span></span></span></span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>∩</span></a></span><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span>  
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>∩</span></a></span><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6286..6294"><span>bs<span class="hidden">⇩</span><sub>1</sub>_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6327..6335"><span>bs<span class="hidden">⇩</span><sub>2</sub>_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6204..6212"><span>ss<span class="hidden">⇩</span><sub>1</sub>_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6245..6253"><span>ss<span class="hidden">⇩</span><sub>2</sub>_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
    
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.in_range|fact"><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.in_range(4)|thm"><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.in_range(3)|thm"><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.in_range(2)|thm"><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.in_range(1)|thm"><span class="entity_def" id="offset_7521..7529">in_range</span></span></span></span></span></span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span>"</span></span></span><span>          
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span>"</span></span></span><span>          
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span>"</span></span></span><span>          
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6092..6095"><span>SSU</span></a><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6286..6294"><span>bs<span class="hidden">⇩</span><sub>1</sub>_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6327..6335"><span>bs<span class="hidden">⇩</span><sub>2</sub>_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6204..6212"><span>ss<span class="hidden">⇩</span><sub>1</sub>_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6245..6253"><span>ss<span class="hidden">⇩</span><sub>2</sub>_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
    
    
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.misplaced_same_card|fact"><span class="entity_def" id="Sorting_Par_Partition.misplaced_elements.misplaced_same_card|thm"><span class="entity_def" id="offset_7740..7759">misplaced_same_card</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6838..6846"><span>ss_split</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6875..6880"><span>ss_dj</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>m</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_Un_disjoint|fact"><span>card_Un_disjoint</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6173..6178"><span>m_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_7076..7091"><span>low_range_split</span></a><span class="main"><span>[</span></span><span class="operator"><span>symmetric</span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_7125..7137"><span>low_range_dj</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>…</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span>"</span></span></span><span>   
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_Un_disjoint|fact"><span>card_Un_disjoint</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>  
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>  
  
  
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.ppar_step2.axioms|fact"><span class="entity_def" id="Sorting_Par_Partition.ppar_step2.intro|fact"><span class="entity_def" id="Sorting_Par_Partition.ppar_step2_def|fact"><span class="entity_def" id="Sorting_Par_Partition.ppar_step2.axioms|thm"><span class="entity_def" id="Sorting_Par_Partition.ppar_step2.intro|thm"><span class="entity_def" id="Sorting_Par_Partition.ppar_step2_def|thm"><span class="entity_def" id="Sorting_Par_Partition.ppar_step2_def|axiom"><span class="entity_def" id="offset_8136..8142">locale</span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.ppar_step2|locale"><span class="entity_def" id="Sorting_Par_Partition.ppar_step2|const"><span>ppar_step2</span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.is_ppart|locale"><span>is_ppart</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>  
  </span><span class="keyword1"><span class="command"><span>abbreviation</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Par_Partition.ppar_step2.m|const"><span class="entity_def" id="offset_8189..8190">m</span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.weak_ordering.ppart_mpos|const"><span>ppart_mpos</span></a><span> </span><span class="free"><span>ss</span></span><span>"</span></span></span><span>
  
  
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.ppar_step2.ss\&lt;^sub&gt;1_def|fact"><span class="entity_def" id="Sorting_Par_Partition.ppar_step2.ss\&lt;^sub&gt;1_def|thm"><span class="entity_def" id="Sorting_Par_Partition.ppar_step2.ss\&lt;^sub&gt;1_def_raw|axiom"><span class="entity_def" id="offset_8216..8226">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Par_Partition.ppar_step2.ss\&lt;^sub&gt;1.cong|fact"><span class="entity_def" id="Sorting_Par_Partition.ppar_step2.ss\&lt;^sub&gt;1.cong|thm"><span class="entity_def" id="Sorting_Par_Partition.ppar_step2.ss\&lt;^sub&gt;1|const"><span class="entity_def" id="offset_8228..8232">ss<span class="hidden">⇩</span><sub>1</sub></span></span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>i</span></span></span><span class="main"><span>∈</span></span><span class="free"><span>ss</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8189..8190"><span>m</span></a><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.ppar_step2.ss\&lt;^sub&gt;2_def|fact"><span class="entity_def" id="Sorting_Par_Partition.ppar_step2.ss\&lt;^sub&gt;2_def|thm"><span class="entity_def" id="Sorting_Par_Partition.ppar_step2.ss\&lt;^sub&gt;2_def_raw|axiom"><span class="entity_def" id="offset_8250..8260">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Par_Partition.ppar_step2.ss\&lt;^sub&gt;2.cong|fact"><span class="entity_def" id="Sorting_Par_Partition.ppar_step2.ss\&lt;^sub&gt;2.cong|thm"><span class="entity_def" id="Sorting_Par_Partition.ppar_step2.ss\&lt;^sub&gt;2|const"><span class="entity_def" id="offset_8262..8266">ss<span class="hidden">⇩</span><sub>2</sub></span></span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.weak_ordering.ppart_filter|const"><span>ppart_filter</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8189..8190"><span>m</span></a><span> </span><span class="free"><span>ss</span></span><span> </span><span class="free"><span>bs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.ppar_step2.bs\&lt;^sub&gt;1_def|fact"><span class="entity_def" id="Sorting_Par_Partition.ppar_step2.bs\&lt;^sub&gt;1_def|thm"><span class="entity_def" id="Sorting_Par_Partition.ppar_step2.bs\&lt;^sub&gt;1_def_raw|axiom"><span class="entity_def" id="offset_8302..8312">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Par_Partition.ppar_step2.bs\&lt;^sub&gt;1.cong|fact"><span class="entity_def" id="Sorting_Par_Partition.ppar_step2.bs\&lt;^sub&gt;1.cong|thm"><span class="entity_def" id="Sorting_Par_Partition.ppar_step2.bs\&lt;^sub&gt;1|const"><span class="entity_def" id="offset_8314..8318">bs<span class="hidden">⇩</span><sub>1</sub></span></span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>i</span></span></span><span class="main"><span>∈</span></span><span class="free"><span>bs</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8189..8190"><span>m</span></a><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="bound"><span>i</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.ppar_step2.bs\&lt;^sub&gt;2_def|fact"><span class="entity_def" id="Sorting_Par_Partition.ppar_step2.bs\&lt;^sub&gt;2_def|thm"><span class="entity_def" id="Sorting_Par_Partition.ppar_step2.bs\&lt;^sub&gt;2_def_raw|axiom"><span class="entity_def" id="offset_8336..8346">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Par_Partition.ppar_step2.bs\&lt;^sub&gt;2.cong|fact"><span class="entity_def" id="Sorting_Par_Partition.ppar_step2.bs\&lt;^sub&gt;2.cong|thm"><span class="entity_def" id="Sorting_Par_Partition.ppar_step2.bs\&lt;^sub&gt;2|const"><span class="entity_def" id="offset_8348..8352">bs<span class="hidden">⇩</span><sub>2</sub></span></span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.snd|const"><span>snd</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.weak_ordering.ppart_filter|const"><span>ppart_filter</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8189..8190"><span>m</span></a><span> </span><span class="free"><span>ss</span></span><span> </span><span class="free"><span>bs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>


  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_8387..8396">sublocale</span></span></span><span> misplaced</span><span class="main"><span>:</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.misplaced_elements|locale"><span>misplaced_elements</span></a><span> </span><span class="quoted"><span class="free"><span>ss</span></span></span><span> </span><span class="quoted"><span class="free"><span>bs</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8189..8190"><span>m</span></a></span><span> </span><span class="quoted"><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8228..8232"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></a></span><span> </span><span class="quoted"><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8262..8266"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></a></span><span> </span><span class="quoted"><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8314..8318"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></a></span><span> </span><span class="quoted"><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8348..8352"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></a></span><span> 
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>unfold_locales</span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8136..8142"><span>ppart_mpos_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8136..8142"><span>ppart_filter_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8216..8226"><span>ss<span class="hidden">⇩</span><sub>1</sub>_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8250..8260"><span>ss<span class="hidden">⇩</span><sub>2</sub>_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8302..8312"><span>bs<span class="hidden">⇩</span><sub>1</sub>_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8336..8346"><span>bs<span class="hidden">⇩</span><sub>2</sub>_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_4788..4796"><span>complete</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_4836..4844"><span>disjoint</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

  </span><span class="comment1"><span>(*
    Same number of misplaced small and big indexes
  *)</span></span><span>  
  </span><span class="keyword1"><span class="command"><span>thm</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8387..8396"><span>misplaced.misplaced_same_card</span></a><span>
  
  </span><span class="comment1"><span>(*
    All other indexes are well-placed
  *)</span></span><span>  
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_8770..8775">lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.ppar_step2.low_nbs2_well_placed|fact"><span class="entity_def" id="Sorting_Par_Partition.ppar_step2.low_nbs2_well_placed|thm"><span>low_nbs2_well_placed</span></span></span><span class="main"><span>:</span></span><span> </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8189..8190"><span>m</span></a><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.not_member|const"><span>∉</span></a></span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8348..8352"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>i</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span>p</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8770..8775"><span>assms</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8387..8396"><span>misplaced.low_range_split</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8228..8232"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8387..8396"><span>misplaced.ss_split</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>ss</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_4871..4879"><span>ss_in_P1</span></a><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>  
    
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_9019..9024">lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.ppar_step2.high_nss2_well_placed|fact"><span class="entity_def" id="Sorting_Par_Partition.ppar_step2.high_nss2_well_placed|thm"><span>high_nss2_well_placed</span></span></span><span class="main"><span>:</span></span><span> </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8189..8190"><span>m</span></a><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span>i</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.not_member|const"><span>∉</span></a></span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8262..8266"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>p</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>i</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_9019..9024"><span>assms</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8387..8396"><span>misplaced.high_range_split</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8314..8318"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8387..8396"><span>misplaced.bs_split</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>bs</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_4910..4918"><span>bs_in_P2</span></a><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>  

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>  
  
</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Step 3: compute swaps›</span></span></span><span>
  
  
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.swap_spec_pre.intro|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_spec_pre_def|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_spec_pre.intro|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_spec_pre_def|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_spec_pre_def|axiom"><span>locale</span></span></span></span></span></span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_spec_pre|locale"><span class="entity_def" id="Sorting_Par_Partition.swap_spec_pre|const"><span>swap_spec_pre</span></span></span><span> </span><span class="main"><span>=</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>src</span></span><span> </span><span class="free"><span>dst</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list|type"><span>list</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_spec_pre.src_dst_dj|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_spec_pre.src_dst_dj|thm"><span class="entity_def" id="offset_9411..9421">src_dst_dj</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>src</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>∩</span></a></span><span> </span><span class="free"><span>dst</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_spec_pre.src_ss|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_spec_pre.src_ss|thm"><span class="entity_def" id="offset_9451..9457">src_ss</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>src</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_spec_pre.dst_ss|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_spec_pre.dst_ss|thm"><span class="entity_def" id="offset_9493..9499">dst_ss</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>dst</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_spec_pre.card_eq|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_spec_pre.card_eq|thm"><span class="entity_def" id="offset_9535..9542">card_eq</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>dst</span></span><span>"</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_spec_pre.finite_src|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_spec_pre.finite_src|thm"><span>finite_src</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>,</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.intro|attribute"><span class="operator"><span>intro</span></span></a><span class="main"><span class="main"><span class="main"><span>!</span></span></span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="free"><span>src</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_9451..9457"><span>src_ss</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite_subset|fact"><span>finite_subset</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_spec_pre.finite_dst|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_spec_pre.finite_dst|thm"><span>finite_dst</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>,</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.intro|attribute"><span class="operator"><span>intro</span></span></a><span class="main"><span class="main"><span class="main"><span>!</span></span></span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="free"><span>dst</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_9493..9499"><span>dst_ss</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite_subset|fact"><span>finite_subset</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>  

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.swap_spec.axioms|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_spec.intro|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_spec_def|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_spec_axioms.intro|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_spec_axioms_def|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_spec.axioms(2)|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_spec.axioms(1)|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_spec.intro|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_spec_def|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_spec_axioms.intro|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_spec_axioms_def|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_spec_def|axiom"><span class="entity_def" id="Sorting_Par_Partition.swap_spec_axioms_def|axiom"><span>locale</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_spec|locale"><span class="entity_def" id="Sorting_Par_Partition.swap_spec|const"><span class="entity_def" id="Sorting_Par_Partition.swap_spec_axioms|const"><span>swap_spec</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_spec_pre|locale"><span>swap_spec_pre</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list|type"><span>list</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_spec.elems_outside|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_spec.elems_outside|thm"><span class="entity_def" id="offset_9829..9842">elems_outside</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.not_member|const"><span>∉</span></a></span><span class="free"><span>src</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="free"><span>dst</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>xs'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>i</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_spec.elems_src|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_spec.elems_src|thm"><span class="entity_def" id="offset_9895..9904">elems_src</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>src</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>∃</span></span><span class="bound"><span>j</span></span><span class="main"><span>∈</span></span><span class="free"><span>dst</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>xs'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>j</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_spec.elems_dst|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_spec.elems_dst|thm"><span class="entity_def" id="offset_9945..9954">elems_dst</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>dst</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>∃</span></span><span class="bound"><span>j</span></span><span class="main"><span>∈</span></span><span class="free"><span>src</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>xs'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>j</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_spec.permut|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_spec.permut|thm"><span class="entity_def" id="offset_9995..10001">permut</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_spec.length_xs&apos;_eq|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_spec.length_xs&apos;_eq|thm"><span>length_xs'_eq</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset_eq_length|fact"><span>mset_eq_length</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_9995..10001"><span>permut</span></a><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>  
  
</span><span class="comment1"><span>(* For presentation in paper *)</span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_spec_pre|const"><span>swap_spec_pre</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="free"><span>dst</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> 
  </span><span class="free"><span>src</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>∩</span></a></span><span> </span><span class="free"><span>dst</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>src</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="free"><span>dst</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>dst</span></span><span>
  "</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_spec_pre_def|fact"><span>swap_spec_pre_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_spec|const"><span>swap_spec</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="free"><span>dst</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> 
    </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_spec_pre|const"><span>swap_spec_pre</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="free"><span>dst</span></span><span> </span><span class="free"><span>xs</span></span><span>
  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.not_member|const"><span>∉</span></a></span><span class="free"><span>src</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="free"><span>dst</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="free"><span>xs'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="free"><span>src</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>∃</span></span><span class="bound"><span>j</span></span><span class="main"><span>∈</span></span><span class="free"><span>dst</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>xs'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>j</span></span><span class="main"><span>∈</span></span><span class="free"><span>dst</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>∃</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="free"><span>src</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>xs'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span>
  "</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_spec_def|fact"><span>swap_spec_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_spec_axioms_def|fact"><span>swap_spec_axioms_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>




</span><span class="keyword1"><span class="command"><span>context</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_spec_pre|locale"><span>swap_spec_pre</span></a><span> </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_spec_pre.swap_spec_refl|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_spec_pre.swap_spec_refl|thm"><span>swap_spec_refl</span></span></span><span class="main"><span>:</span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>src</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_spec|const"><span>swap_spec</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="free"><span>dst</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>unfold_locales</span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_9535..9542"><span>card_eq</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>


</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.swap_SPEC_def|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_SPEC_def|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_SPEC_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Par_Partition.swap_SPEC|const"><span>swap_SPEC</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>ss</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>bs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_spec_pre|const"><span>swap_spec_pre</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>ss</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>bs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_spec|const"><span>swap_spec</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>ss</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>bs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>}</span></span><span>"</span></span></span><span>


</span><span class="comment1"><span>(* Sanity check lemma *)</span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_10893..10898">lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_spec_exists|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_spec_exists|thm"><span>swap_spec_exists</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_spec_pre|const"><span>swap_spec_pre</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="free"><span>dst</span></span><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>xs'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_spec|const"><span>swap_spec</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="free"><span>dst</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="bound"><span>xs'</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_10893..10898"><span>assms</span></a><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induction.ML.html#HOL.induction|method"><span class="operator"><span>induction</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>src</span></span><span>"</span></span></span><span> </span><span class="quasi_keyword"><span>arbitrary</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="free"><span>src</span></span></span><span> </span><span class="quoted"><span class="free"><span>dst</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_11064..11065">0</span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>interpret</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_spec_pre|locale"><span>swap_spec_pre</span></a><span> </span><span class="quoted"><span class="skolem"><span>src</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>dst</span></span></span><span> </span><span class="quoted"><span class="free"><span>xs</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_11108..11110">by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  
  </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_11064..11065"><span>0</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_11108..11110"><span>card_eq</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>src</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>dst</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
  
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.exI|fact"><span>exI</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> x</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="free"><span>xs</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>unfold_locales</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
  
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_11278..11281">Suc</span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>interpret</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_spec_pre|locale"><span>swap_spec_pre</span></a><span> </span><span class="quoted"><span class="skolem"><span>src</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>dst</span></span></span><span> </span><span class="quoted"><span class="free"><span>xs</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_11327..11329">by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>src</span></span><span>›</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>symmetric</span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_11327..11329"><span>card_eq</span></a><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>i</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>j</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>src'</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>dst'</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> 
    </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>src</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.insert|const"><span>insert</span></a><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="skolem"><span>src'</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>dst</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.insert|const"><span>insert</span></a><span> </span><span class="skolem"><span>j</span></span><span> </span><span class="skolem"><span>dst'</span></span><span>"</span></span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_11470..11472">NI</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.not_member|const"><span>∉</span></a></span><span class="skolem"><span>src'</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.not_member|const"><span>∉</span></a></span><span class="skolem"><span>dst'</span></span><span>"</span></span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_11501..11505">CARD</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>src'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>n</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>dst'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>n</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_Suc_eq_finite|fact"><span>card_Suc_eq_finite</span></a><span class="main"><span>)</span></span><span>
    
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_11327..11329"><span>src_ss</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_11327..11329"><span>dst_ss</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
    
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_spec_pre|const"><span>swap_spec_pre</span></a><span> </span><span class="skolem"><span>src'</span></span><span> </span><span class="skolem"><span>dst'</span></span><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>unfold_locales</span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_11327..11329"><span>src_dst_dj</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_11327..11329"><span>src_ss</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_11327..11329"><span>dst_ss</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_11327..11329"><span>card_eq</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_11501..11505"><span>CARD</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_11278..11281"><span>Suc.hyps</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="skolem"><span>src'</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>dst'</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>xs'</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_spec|const"><span>swap_spec</span></a><span> </span><span class="skolem"><span>src'</span></span><span> </span><span class="skolem"><span>dst'</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="skolem"><span>xs'</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_11501..11505"><span>CARD</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>interpret</span></span></span><span> IH</span><span class="main"><span>:</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_spec|locale"><span>swap_spec</span></a><span> </span><span class="quoted"><span class="skolem"><span>src'</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>dst'</span></span></span><span> </span><span class="quoted"><span class="free"><span>xs</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>xs'</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_11932..11933">.</span></span></span><span>
    
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_spec|const"><span>swap_spec</span></a><span> </span><span class="skolem"><span>src</span></span><span> </span><span class="skolem"><span>dst</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap|const"><span>swap</span></a><span> </span><span class="skolem"><span>xs'</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="skolem"><span>j</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>unfold_locales</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> k </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_11932..11933"><span>IH.elems_outside</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> k
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>k</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="skolem"><span>i</span></span><span>"</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_11932..11933"><span>IH.elems_outside</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_11932..11933"><span>IH.elems_src</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_11470..11472"><span>NI</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="skolem"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_11932..11933"><span>IH.elems_src</span></a><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="skolem"><span>dst</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.insert|const"><span>insert</span></a><span> </span><span class="skolem"><span>j</span></span><span> </span><span class="skolem"><span>dst'</span></span><span>›</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="skolem"><span>src</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.insert|const"><span>insert</span></a><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="skolem"><span>src'</span></span><span>›</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.disjoint_iff|fact"><span>disjoint_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.insertCI|fact"><span>insertCI</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_11327..11329"><span>src_dst_dj</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.swap_indep|fact"><span>swap_indep</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> k
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>k</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="skolem"><span>j</span></span><span>"</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_11932..11933"><span>IH.elems_dst</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_11932..11933"><span>IH.elems_outside</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_11470..11472"><span>NI</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="skolem"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_11932..11933"><span>IH.elems_dst</span></a><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="skolem"><span>dst</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.insert|const"><span>insert</span></a><span> </span><span class="skolem"><span>j</span></span><span> </span><span class="skolem"><span>dst'</span></span><span>›</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="skolem"><span>src</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.insert|const"><span>insert</span></a><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="skolem"><span>src'</span></span><span>›</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.disjoint_iff|fact"><span>disjoint_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.insertCI|fact"><span>insertCI</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_11327..11329"><span>src_dst_dj</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.swap_indep|fact"><span>swap_indep</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_11932..11933"><span>IH.permut</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>  
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>..</span></span></span><span>    
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>      
  
  
</span><span class="keyword1"><span class="command"><span>context</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.ppar_step2|locale"><span>ppar_step2</span></a><span> </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>    
  </span><span class="comment1"><span>(*
    ss<span class="hidden">⇩</span><sub>2</sub> and bs<span class="hidden">⇩</span><sub>2</sub> satisfy precondition for swapping
  *)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.ppar_step2.swap_spec_pre|fact"><span class="entity_def" id="Sorting_Par_Partition.ppar_step2.swap_spec_pre|thm"><span>swap_spec_pre</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_spec_pre|const"><span>swap_spec_pre</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8262..8266"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8348..8352"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>unfold_locales</span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_7385..7393"><span>misplaced.same_djs</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_7521..7529"><span>misplaced.in_range</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_7740..7759"><span>misplaced.misplaced_same_card</span></a><span class="main"><span>)</span></span><span>
    
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>    
  
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.ppar_step3.axioms|fact"><span class="entity_def" id="Sorting_Par_Partition.ppar_step3.intro|fact"><span class="entity_def" id="Sorting_Par_Partition.ppar_step3_def|fact"><span class="entity_def" id="Sorting_Par_Partition.ppar_step3.axioms(2)|thm"><span class="entity_def" id="Sorting_Par_Partition.ppar_step3.axioms(1)|thm"><span class="entity_def" id="Sorting_Par_Partition.ppar_step3.intro|thm"><span class="entity_def" id="Sorting_Par_Partition.ppar_step3_def|thm"><span class="entity_def" id="Sorting_Par_Partition.ppar_step3_def|axiom"><span>locale</span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.ppar_step3|locale"><span class="entity_def" id="Sorting_Par_Partition.ppar_step3|const"><span>ppar_step3</span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.ppar_step2|locale"><span>ppar_step2</span></a><span> </span><span class="main"><span>+</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_spec|locale"><span>swap_spec</span></a><span> </span><span class="quoted"><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8262..8266"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></a></span><span> </span><span class="quoted"><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8348..8352"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></a></span><span> </span><span class="quoted"><span class="free"><span>xs</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>  

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_9995..10001"><span>permut</span></a><span class="main"><span>)</span></span><span>

  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.ppar_step3.elems_ss1|fact"><span class="entity_def" id="Sorting_Par_Partition.ppar_step3.elems_ss1|thm"><span class="entity_def" id="offset_13123..13132">elems_ss1</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8228..8232"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></a><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>xs'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>i</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_9829..9842"><span>elems_outside</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="free"><span>i</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_7521..7529"><span>misplaced.in_range</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_7125..7137"><span>misplaced.low_range_dj</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6875..6880"><span>misplaced.ss_dj</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.ppar_step3.elems_bs1|fact"><span class="entity_def" id="Sorting_Par_Partition.ppar_step3.elems_bs1|thm"><span class="entity_def" id="offset_13272..13281">elems_bs1</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8314..8318"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></a><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>xs'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>i</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_9829..9842"><span>elems_outside</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="free"><span>i</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_7521..7529"><span>misplaced.in_range</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_7283..7296"><span>misplaced.high_range_dj</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6996..7001"><span>misplaced.bs_dj</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span>
        
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_13424..13429">lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.ppar_step3.partitioned1|fact"><span class="entity_def" id="Sorting_Par_Partition.ppar_step3.partitioned1|thm"><span class="entity_def" id="offset_13430..13442">partitioned1</span></span></span><span class="main"><span>:</span></span><span> </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8189..8190"><span>m</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>xs'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>i</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span>p</span></span><span>"</span></span></span><span> 
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8228..8232"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8348..8352"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></a><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_13424..13429"><span>assms</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_7076..7091"><span>misplaced.low_range_split</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_13123..13132"><span>elems_ss1</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6838..6846"><span>misplaced.ss_split</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_4871..4879"><span>ss_in_P1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.UnCI|fact"><span>UnCI</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_9945..9954"><span>elems_dst</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6838..6846"><span>misplaced.ss_split</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_4871..4879"><span>ss_in_P1</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>  
      
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_13823..13828">lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.ppar_step3.partitioned2|fact"><span class="entity_def" id="Sorting_Par_Partition.ppar_step3.partitioned2|thm"><span class="entity_def" id="offset_13829..13841">partitioned2</span></span></span><span class="main"><span>:</span></span><span> </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8189..8190"><span>m</span></a><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span>i</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>p</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span>xs'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>i</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8262..8266"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8314..8318"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></a><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_13823..13828"><span>assms</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_7233..7249"><span>misplaced.high_range_split</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_4910..4918"><span>bs_in_P2</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.dual_order.refl|fact"><span>dual_order.refl</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_9895..9904"><span>elems_src</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.in_mono|fact"><span>in_mono</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.semilattice_sup_class.le_sup_iff|fact"><span>le_sup_iff</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6959..6967"><span>misplaced.bs_split</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_13272..13281"><span>elems_bs1</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6959..6967"><span>misplaced.bs_split</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_4910..4918"><span>bs_in_P2</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
    

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.ppar_step3.is_valid_partition|fact"><span class="entity_def" id="Sorting_Par_Partition.ppar_step3.is_valid_partition|thm"><span>is_valid_partition</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_3581..3600"><span>gpartition_all_spec</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>xs'</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_8189..8190"><span>m</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_3665..3689"><span>gpartition_all_spec_alt1</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_9995..10001"><span>permut</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_6654..6660"><span>misplaced.m_le_n</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_13430..13442"><span>partitioned1</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_13829..13841"><span>partitioned2</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>


  


</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹The Algorithm›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_14470..14477">context</span></span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.weak_ordering|locale"><span>weak_ordering</span></a><span> </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart1_def|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart1_def|thm"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart1_def_raw|axiom"><span class="entity_def" id="offset_14500..14510">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart1.cong|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart1.cong|thm"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart1|const"><span class="entity_def" id="offset_14512..14518">ppart1</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
    </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>ss</span></span><span class="main"><span>,</span></span><span class="bound"><span>bs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_5091..5101"><span>ppart_SPEC</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>;</span></span><span>
    </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>m</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.weak_ordering.ppart_mpos|const"><span>ppart_mpos</span></a><span> </span><span class="bound"><span>ss</span></span><span class="main"><span>;</span></span><span>

    </span><span class="keyword1"><span>let</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.weak_ordering.ppart_filter|const"><span>ppart_filter</span></a><span> </span><span class="bound"><span>m</span></span><span> </span><span class="bound"><span>ss</span></span><span> </span><span class="bound"><span>bs</span></span><span class="main"><span>;</span></span><span>
    
    </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_SPEC|const"><span>swap_SPEC</span></a><span> </span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>;</span></span><span>
  
    </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>m</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>}</span></span><span>"</span></span></span><span>

  </span><span class="comment1"><span>(* For presentation in paper *)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_14512..14518"><span>ppart1</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
    </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>ss</span></span><span class="main"><span>,</span></span><span class="bound"><span>bs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_5091..5101"><span>ppart_SPEC</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>;</span></span><span>
    </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>m</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="bound"><span>ss</span></span><span class="main"><span>;</span></span><span>
    </span><span class="keyword1"><span>let</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>ss</span></span><span class="main"><span>,</span></span><span class="bound"><span>bs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>i</span></span></span><span class="main"><span>∈</span></span><span class="bound"><span>ss</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="bound"><span>i</span></span><span class="main"><span>}</span></span><span class="main"><span>,</span></span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>i</span></span></span><span class="main"><span>∈</span></span><span class="bound"><span>bs</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>m</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
    </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_SPEC|const"><span>swap_SPEC</span></a><span> </span><span class="bound"><span>ss</span></span><span> </span><span class="bound"><span>bs</span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>;</span></span><span>
    </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>m</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_14500..14510"><span>ppart1_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_14470..14477"><span>ppart_mpos_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_14470..14477"><span>ppart_filter_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  
  
  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart1_valid_partitition|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart1_valid_partitition|thm"><span class="entity_def" id="offset_15031..15055">ppart1_valid_partitition</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_14512..14518"><span>ppart1</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>m</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs'</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_3581..3600"><span>gpartition_all_spec</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="bound"><span>xs'</span></span><span> </span><span class="bound"><span>m</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_14500..14510"><span>ppart1_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_14470..14477"><span>ppart_spec_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_SPEC_def|fact"><span>swap_SPEC_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_14470..14477"><span>ppart_SPEC_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="skolem"><span>ss</span></span><span> </span><span class="skolem"><span>bs</span></span><span> </span><span class="skolem"><span>ss<span class="hidden">⇩</span><sub>2</sub>X</span></span><span> </span><span class="skolem"><span>bs<span class="hidden">⇩</span><sub>2</sub>X</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> 
      </span><span class="entity_def" id="offset_15309..15315">pp_flt</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.weak_ordering.ppart_filter|const"><span>ppart_filter</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.weak_ordering.ppart_mpos|const"><span>ppart_mpos</span></a><span> </span><span class="skolem"><span>ss</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>ss</span></span><span> </span><span class="skolem"><span>bs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>ss<span class="hidden">⇩</span><sub>2</sub>X</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>bs<span class="hidden">⇩</span><sub>2</sub>X</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>
      </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="skolem"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>
      </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.is_ppart|const"><span>is_ppart</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>≤</b>)</span></span></span><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="skolem"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="skolem"><span>ss</span></span><span> </span><span class="skolem"><span>bs</span></span><span>"</span></span></span><span>
  
      
    </span><span class="keyword1"><span class="command"><span>interpret</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.is_ppart|locale"><span>is_ppart</span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>≤</b>)</span></span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="free"><span>p</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span></span><span> </span><span class="quoted"><span class="skolem"><span>ss</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>bs</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fact</span></span><span>  
    </span><span class="keyword1"><span class="command"><span>interpret</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.ppar_step2|locale"><span>ppar_step2</span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>≤</b>)</span></span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="free"><span>p</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span></span><span> </span><span class="quoted"><span class="skolem"><span>ss</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>bs</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_15577..15579">by</span></span></span><span> </span><span class="operator"><span>unfold_locales</span></span><span>
    
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>ss<span class="hidden">⇩</span><sub>2</sub>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_15577..15579"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></a><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>bs<span class="hidden">⇩</span><sub>2</sub>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_15577..15579"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_15577..15579"><span>ss<span class="hidden">⇩</span><sub>2</sub>_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_15577..15579"><span>bs<span class="hidden">⇩</span><sub>2</sub>_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_15309..15315"><span>pp_flt</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_spec_pre|const"><span>swap_spec_pre</span></a><span> </span><span class="skolem"><span>ss<span class="hidden">⇩</span><sub>2</sub>X</span></span><span> </span><span class="skolem"><span>bs<span class="hidden">⇩</span><sub>2</sub>X</span></span><span> </span><span class="skolem"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_15577..15579"><span>swap_spec_pre</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> 
      
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>xs'</span></span><span>  
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_15806..15811">sspec</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_spec|const"><span>swap_spec</span></a><span> </span><span class="skolem"><span>ss<span class="hidden">⇩</span><sub>2</sub>X</span></span><span> </span><span class="skolem"><span>bs<span class="hidden">⇩</span><sub>2</sub>X</span></span><span> </span><span class="skolem"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="skolem"><span>xs'</span></span><span>"</span></span></span><span>
  
          
    </span><span class="keyword1"><span class="command"><span>interpret</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_spec|locale"><span>swap_spec</span></a><span> </span><span class="quoted"><a class="entity_ref" href="Sorting_Par_Partition.html#offset_15577..15579"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></a></span><span> </span><span class="quoted"><a class="entity_ref" href="Sorting_Par_Partition.html#offset_15577..15579"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></a></span><span> </span><span class="quoted"><span class="skolem"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span></span><span> </span><span class="quoted"><span class="skolem"><span>xs'</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_15806..15811"><span>sspec</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      
    </span><span class="keyword1"><span class="command"><span>interpret</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.ppar_step3|locale"><span>ppar_step3</span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>≤</b>)</span></span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="free"><span>p</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span></span><span> </span><span class="quoted"><span class="skolem"><span>ss</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>bs</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>xs'</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_15999..16001">by</span></span></span><span> </span><span class="operator"><span>unfold_locales</span></span><span> 
      
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_3581..3600"><span>gpartition_all_spec</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="skolem"><span>xs'</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_15577..15579"><span>m</span></a><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="skolem"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span>xs</span></span><span>›</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_15999..16001"><span>is_valid_partition</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_4235..4258"><span>gpartition_spec_permute</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>    
  
  </span><span class="comment1"><span>(* For presentation in paper *)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_14512..14518"><span>ppart1</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>m</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>xs'</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> 
      </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="bound"><span>xs'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span> 
    </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span class="bound"><span>i</span></span></span><span class="main"><span>&lt;</span></span><span class="bound"><span>m</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>xs'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="bound"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="bound"><span>xs'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_15031..15055"><span>ppart1_valid_partitition</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.refl|fact"><span>refl</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="free"><span>p</span></span></span><span> </span><span class="quoted"><span class="free"><span>xs</span></span></span><span class="main"><span>]</span></span><span> 
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_3665..3689"><span>gpartition_all_spec_alt1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    
  
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
  
</span><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Refinement to Parallel Partitioning›</span></span></span><span>  

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_16528..16535">context</span></span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.weak_ordering|locale"><span>weak_ordering</span></a><span> </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>
  
  </span><span class="comment1"><span>(*
    Parallel partitioning with interval, abstract level
  *)</span></span><span>
  
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_16630..16635">lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_spec_merge|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_spec_merge|thm"><span class="entity_def" id="offset_16636..16652">ppart_spec_merge</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_4989..4999"><span>ppart_spec</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub>'</span></span><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_4989..4999"><span>ppart_spec</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>2</sub>'</span></span><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>defines</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>ss<span class="hidden">⇩</span><sub>2</sub>'</span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>(+)</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span class="free"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>defines</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>bs<span class="hidden">⇩</span><sub>2</sub>'</span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>(+)</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span class="free"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_4989..4999"><span>ppart_spec</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span class="free"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub>'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span class="free"><span>xs<span class="hidden">⇩</span><sub>2</sub>'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>2</sub>'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>2</sub>'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_16630..16635"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>,</span></span><span>2</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_16528..16535"><span>ppart_spec_def</span></a><span> 
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub>'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>2</sub>'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub>'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>2</sub>'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset_eq_length|fact"><span>mset_eq_length</span></a><span class="main"><span>)</span></span><span>
  
  
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.is_ppart|const"><span>is_ppart</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>≤</b>)</span></span></span><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub>'</span></span><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.is_ppart|const"><span>is_ppart</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>≤</b>)</span></span></span><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>2</sub>'</span></span><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span>"</span></span></span><span>

    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>interpret</span></span></span><span> p1</span><span class="main"><span>:</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.is_ppart|locale"><span>is_ppart</span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>≤</b>)</span></span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="free"><span>p</span></span></span><span> </span><span class="quoted"><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub>'</span></span></span><span> </span><span class="quoted"><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span></span><span> </span><span class="quoted"><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span></span><span> </span><span class="main"><span>+</span></span><span> p2</span><span class="main"><span>:</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.is_ppart|locale"><span>is_ppart</span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>≤</b>)</span></span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="free"><span>p</span></span></span><span> </span><span class="quoted"><span class="free"><span>xs<span class="hidden">⇩</span><sub>2</sub>'</span></span></span><span> </span><span class="quoted"><span class="free"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span></span><span> </span><span class="quoted"><span class="free"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_17368..17369">.</span></span></span><span>
    
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_17368..17369"><span>p2.complete</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_17401..17408">sb<span class="hidden">⇩</span><sub>2</sub>_Un</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>ss<span class="hidden">⇩</span><sub>2</sub>'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>2</sub>'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub>'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub>'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span class="free"><span>xs<span class="hidden">⇩</span><sub>2</sub>'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_16630..16635"><span>ss<span class="hidden">⇩</span><sub>2</sub>'_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_16630..16635"><span>bs<span class="hidden">⇩</span><sub>2</sub>'_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>flip</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image_Un|fact"><span>image_Un</span></a><span class="main"><span>)</span></span><span>
      
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_17368..17369"><span>p2.disjoint</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_17573..17580">sb<span class="hidden">⇩</span><sub>2</sub>_dj</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>ss<span class="hidden">⇩</span><sub>2</sub>'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>∩</span></a></span><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>2</sub>'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_16630..16635"><span>ss<span class="hidden">⇩</span><sub>2</sub>'_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_16630..16635"><span>bs<span class="hidden">⇩</span><sub>2</sub>'_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_17669..17675">sb'_dj</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>∩</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>ss<span class="hidden">⇩</span><sub>2</sub>'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span class="free"><span>bs<span class="hidden">⇩</span><sub>2</sub>'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_17368..17369"><span>p1.complete</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_16630..16635"><span>ss<span class="hidden">⇩</span><sub>2</sub>'_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_16630..16635"><span>bs<span class="hidden">⇩</span><sub>2</sub>'_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      
    
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_17368..17369"><span>p1.complete</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_17838..17851">ss<span class="hidden">⇩</span><sub>1</sub>_in_range</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> 
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_17368..17369"><span>p1.complete</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_17917..17930">bs<span class="hidden">⇩</span><sub>1</sub>_in_range</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> 

    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_17401..17408"><span>sb<span class="hidden">⇩</span><sub>2</sub>_Un</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_17993..18007">ss<span class="hidden">⇩</span><sub>2</sub>'_in_range</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>ss<span class="hidden">⇩</span><sub>2</sub>'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="bound"><span>i</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> 
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_17401..17408"><span>sb<span class="hidden">⇩</span><sub>2</sub>_Un</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_18070..18084">bs<span class="hidden">⇩</span><sub>2</sub>'_in_range</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>bs<span class="hidden">⇩</span><sub>2</sub>'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="bound"><span>i</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> 
    
          
    
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.is_ppart|const"><span>is_ppart</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>≤</b>)</span></span></span><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub>'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>2</sub>'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>2</sub>'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>2</sub>'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>unfold_locales</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.trans|fact"><span>HOL.trans</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> s</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span class="main"><span>(</span></span><span class="free"><span>ss<span class="hidden">⇩</span><sub>2</sub>'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>2</sub>'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_17401..17408"><span>sb<span class="hidden">⇩</span><sub>2</sub>_Un</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_17368..17369"><span>p1.complete</span></a><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_17368..17369"><span>p1.disjoint</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_17368..17369"><span>p2.disjoint</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_17573..17580"><span>sb<span class="hidden">⇩</span><sub>2</sub>_dj</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_17669..17675"><span>sb'_dj</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>     
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> i
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth_append|fact"><span>nth_append</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_17368..17369"><span>p1.ss_in_P1</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_17838..17851"><span>ss<span class="hidden">⇩</span><sub>1</sub>_in_range</span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_17993..18007"><span>ss<span class="hidden">⇩</span><sub>2</sub>'_in_range</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_16630..16635"><span>ss<span class="hidden">⇩</span><sub>2</sub>'_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_17368..17369"><span>p2.ss_in_P1</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> i
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth_append|fact"><span>nth_append</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_17368..17369"><span>p1.bs_in_P2</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_17917..17930"><span>bs<span class="hidden">⇩</span><sub>1</sub>_in_range</span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_18070..18084"><span>bs<span class="hidden">⇩</span><sub>2</sub>'_in_range</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_16630..16635"><span>bs<span class="hidden">⇩</span><sub>2</sub>'_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_17368..17369"><span>p2.bs_in_P2</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>    
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>      
        
  
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.gpartition_slices_def|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.gpartition_slices_def|thm"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.gpartition_slices_def_raw|axiom"><span class="entity_def" id="offset_18865..18875">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.gpartition_slices.cong|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.gpartition_slices.cong|thm"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.gpartition_slices|const"><span class="entity_def" id="offset_18877..18894">gpartition_slices</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>len</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/RefineG_Recursion.html#RefineG_Recursion.RECT|const"><span>RECT</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>gpartition_slices</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>len</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
    </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
    </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>len</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
    </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>len</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>ss</span></span><span class="main"><span>,</span></span><span class="bound"><span>bs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_5091..5101"><span>ppart_SPEC</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="bound"><span>len</span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>;</span></span><span>
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>ss</span></span><span class="main"><span>,</span></span><span class="bound"><span>bs</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>si</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="bound"><span>len</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span class="main"><span>;</span></span><span>
      </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="main"><span>(</span></span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/IICF_Array.html#IICF_Array.WITH_SPLIT|const"><span>WITH_SPLIT</span></a><span> </span><span class="bound"><span>si</span></span><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
        </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>ivs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="main"><span>(</span></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>ivs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Parallel.html#Sepref_Parallel.nres_par|const"><span>nres_par</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>gpartition_slices</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_5091..5101"><span>ppart_SPEC</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>si</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>;</span></span><span>
        </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="bound"><span>ivs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>ivs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span class="main"><span>(</span></span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.iv_incr_elems_abs_bound|const"><span>iv_incr_elems_abs_bound</span></a><span> </span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="bound"><span>si</span></span><span> </span><span class="bound"><span>len</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      </span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>←</span></span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.mop_set_incr_elems|const"><span>mop_set_incr_elems</span></a><span> </span><span class="bound"><span>si</span></span><span> </span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>;</span></span><span>
      
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span class="main"><span>(</span></span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.iv_incr_elems_abs_bound|const"><span>iv_incr_elems_abs_bound</span></a><span> </span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="bound"><span>si</span></span><span> </span><span class="bound"><span>len</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      </span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>←</span></span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.mop_set_incr_elems|const"><span>mop_set_incr_elems</span></a><span> </span><span class="bound"><span>si</span></span><span> </span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>;</span></span><span>
      
      </span><span class="bound"><span>ss</span></span><span class="main"><span>←</span></span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.mop_set_union_disj|const"><span>mop_set_union_disj</span></a><span> </span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>;</span></span><span>
      </span><span class="bound"><span>bs</span></span><span class="main"><span>←</span></span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.mop_set_union_disj|const"><span>mop_set_union_disj</span></a><span> </span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>;</span></span><span>
      
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>ss</span></span><span class="main"><span>,</span></span><span class="bound"><span>bs</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>}</span></span><span>
  </span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>len</span></span></span></span><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_spec_imp_len_eq|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_spec_imp_len_eq|thm"><span class="entity_def" id="offset_19696..19717">ppart_spec_imp_len_eq</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_4989..4999"><span>ppart_spec</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="free"><span>ss</span></span><span> </span><span class="free"><span>bs</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_16528..16535"><span>ppart_spec_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset_eq_length|fact"><span>mset_eq_length</span></a><span class="main"><span>)</span></span><span>
  
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_19841..19846">lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_spec_len_bound|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_spec_len_bound(2)|thm"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_spec_len_bound(1)|thm"><span class="entity_def" id="offset_19847..19867">ppart_spec_len_bound</span></span></span></span><span class="main"><span>:</span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_4989..4999"><span>ppart_spec</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="free"><span>ss</span></span><span> </span><span class="free"><span>bs</span></span><span>"</span></span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>ss</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>bs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span>"</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_19841..19846"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_16528..16535"><span>ppart_spec_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.is_ppart_def|fact"><span>is_ppart_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.is_ppart_axioms_def|fact"><span>is_ppart_axioms_def</span></a><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset_eq_length|fact"><span>mset_eq_length</span></a><span class="main"><span>)</span></span><span>
    
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_20083..20088">lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_spec_lb_imp_disj|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_spec_lb_imp_disj(2)|thm"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_spec_lb_imp_disj(1)|thm"><span class="entity_def" id="offset_20089..20111">ppart_spec_lb_imp_disj</span></span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_4989..4999"><span>ppart_spec</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="free"><span>ss</span></span><span> </span><span class="free"><span>bs</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>ss</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>∩</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>(+)</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span class="free"><span>ss'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>bs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>∩</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>(+)</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span class="free"><span>bs'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_19847..19867"><span>ppart_spec_len_bound</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_20083..20088"><a class="entity_ref" href="Sorting_Par_Partition.html#offset_20083..20088"><span>assms</span></a></a><span class="main"><span>]</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
    
  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.gpartition_slices_refine_aux|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.gpartition_slices_refine_aux|thm"><span class="entity_def" id="offset_20294..20322">gpartition_slices_refine_aux</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>d</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_18877..18894"><span>gpartition_slices</span></a><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>len</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_5091..5101"><span>ppart_SPEC</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>len</span></span><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_18865..18875"><span>gpartition_slices_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_16528..16535"><span>ppart_SPEC_def</span></a><span>
    
    </span><span class="keyword1"><span class="command"><span>thm</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/RefineG_Recursion.html#RefineG_Recursion.RECT_rule|fact"><span>RECT_rule</span></a><span>
    
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span>
    
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/RefineG_Recursion.html#RefineG_Recursion.RECT_rule|fact"><span>RECT_rule</span></a><span class="main"><span class="main"><span>[</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> 
            V</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Wellfounded.html#Wellfounded.measure|const"><span>measure</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
        </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> pre</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>len</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>len</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="bound"><span>xs</span></span><span>"</span></span></span><span> 
        </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> M</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>d</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>Refine_Basic.SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>xs'</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>ss</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>bs</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_4989..4999"><span>ppart_spec</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>xs'</span></span><span> </span><span class="bound"><span>ss</span></span><span> </span><span class="bound"><span>bs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span class="main"><span>,</span></span></span><span> 
      </span><span class="operator"><span>THEN</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order_trans|fact"><span>order_trans</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Eisbach.Eisbach.html#Eisbach.all|method"><span class="operator"><span>all</span></span></a><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="operator"><span>thin_tac</span></span><span> </span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../AFP/Refine_Monadic/RefineG_Recursion.html#RefineG_Recursion.RECT|const"><a class="entity_ref" href="../../AFP/Refine_Monadic/RefineG_Recursion.html#RefineG_Recursion.RECT|const"><a class="entity_ref" href="../../AFP/Refine_Monadic/RefineG_Recursion.html#RefineG_Recursion.RECT|const"><a class="entity_ref" href="../../AFP/Refine_Monadic/RefineG_Recursion.html#RefineG_Recursion.RECT|const"><a class="entity_ref" href="../../AFP/Refine_Monadic/RefineG_Recursion.html#RefineG_Recursion.RECT|const"><a class="entity_ref" href="../../AFP/Refine_Monadic/RefineG_Recursion.html#RefineG_Recursion.RECT|const"><a class="entity_ref" href="../../AFP/Refine_Monadic/RefineG_Recursion.html#RefineG_Recursion.RECT|const"><span>RECT</span></a></a></a></a></a></a></a><span> </span><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span>_</span></span></span></span></span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span></a></span></a></span></a></span></a></span></a></span></a></span><span> </span><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span>_</span></span></span></span></span></span></span></span><span>"</span></span></span></span></span></span></span></span></span><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span>›</span></span><span class="main"><span>)</span></span><span>
    
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>  
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>  
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>  
    
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>drule</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.sym|fact"><span>sym</span></a><span class="main"><span class="main"><span>[</span></span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="main"><span>_</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>_</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><span>_</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span> </span><span class="comment1"><span>(* Turn around problematic premise for simplifier *)</span></span><span>
    
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order_trans|fact"><span>order_trans</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.rprems|method"><span class="operator"><span>rprems</span></span></a><span> 
    
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.force|method"><span class="operator"><span>force</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
    
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_19696..19717"><span>ppart_spec_imp_len_eq</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_19696..19717"><span>ppart_spec_imp_len_eq</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_19696..19717"><span>ppart_spec_imp_len_eq</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.iv_incr_elems_abs_bound_card_boundI|fact"><span>iv_incr_elems_abs_bound_card_boundI</span></a><span class="main"><span>)</span></span><span> 
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>erule</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_19847..19867"><span>ppart_spec_len_bound</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.iv_incr_elems_abs_bound_card_boundI|fact"><span>iv_incr_elems_abs_bound_card_boundI</span></a><span class="main"><span>)</span></span><span> 
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>erule</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_19847..19867"><span>ppart_spec_len_bound</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_20089..20111"><span>ppart_spec_lb_imp_disj</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_20089..20111"><span>ppart_spec_lb_imp_disj</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_16636..16652"><span>ppart_spec_merge</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>    
    
    
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.gpartition_slices_refine|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.gpartition_slices_refine|thm"><span class="entity_def" id="offset_21759..21783">gpartition_slices_refine</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><span>,</span></span><span class="free"><span>xs'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="main"><span>⟨</span></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.list_rel|const"><span>list_rel</span></a><span class="main"><span>;</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_18877..18894"><span>gpartition_slices</span></a><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_5091..5101"><span>ppart_SPEC</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="free"><span>xs'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_20294..20322"><span>gpartition_slices_refine_aux</span></a><span class="main"><span>)</span></span><span>
  
    
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
    

</span><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Refinement to Parallel Swap›</span></span></span><span>

    
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre.intro|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_def|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre.intro|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_def|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_def|axiom"><span>locale</span></span></span></span></span></span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre|locale"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre|const"><span>swap_opt_spec_pre</span></span></span><span> </span><span class="main"><span>=</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>src</span></span><span> </span><span class="free"><span>dst</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option|type"><span>option</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list|type"><span>list</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre.src_dst_dj|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre.src_dst_dj|thm"><span class="entity_def" id="offset_22078..22088">src_dst_dj</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>src</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>∩</span></a></span><span> </span><span class="free"><span>dst</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre.src_ss|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre.src_ss|thm"><span class="entity_def" id="offset_22118..22124">src_ss</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>src</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_indexes&apos;|const"><span>sl_indexes'</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre.dst_ss|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre.dst_ss|thm"><span class="entity_def" id="offset_22159..22165">dst_ss</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>dst</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_indexes&apos;|const"><span>sl_indexes'</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre.card_eq|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre.card_eq|thm"><span class="entity_def" id="offset_22200..22207">card_eq</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>dst</span></span><span>"</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>  

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre.finite_src|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre.finite_src|thm"><span class="entity_def" id="offset_22248..22258">finite_src</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>,</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.intro|attribute"><span class="operator"><span>intro</span></span></a><span class="main"><span class="main"><span class="main"><span>!</span></span></span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="free"><span>src</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite_subset|fact"><span>finite_subset</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_22118..22124"><span>src_ss</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre.finite_dst|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre.finite_dst|thm"><span class="entity_def" id="offset_22340..22350">finite_dst</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>,</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.intro|attribute"><span class="operator"><span>intro</span></span></a><span class="main"><span class="main"><span class="main"><span>!</span></span></span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="free"><span>dst</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite_subset|fact"><span>finite_subset</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_22159..22165"><span>dst_ss</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre.idxs_in_bounds|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre.idxs_in_bounds|thm"><span class="entity_def" id="offset_22433..22447">idxs_in_bounds</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>src</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span class="free"><span>dst</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_indexes&apos;|const"><span>sl_indexes'</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_22118..22124"><span>src_ss</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_22159..22165"><span>dst_ss</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
  
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec.axioms|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec.intro|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_def|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_axioms.intro|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_axioms_def|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec.axioms(2)|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec.axioms(1)|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec.intro|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_def|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_axioms.intro|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_axioms_def|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_def|axiom"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_axioms_def|axiom"><span>locale</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec|locale"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec|const"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_axioms|const"><span>swap_opt_spec</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec_pre|locale"><span>swap_opt_spec_pre</span></a><span> </span><span class="main"><span>+</span></span><span>  
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>xs'</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec.struct_eq|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec.struct_eq|thm"><span>struct_eq</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_struct|const"><span>sl_struct</span></a><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_struct|const"><span>sl_struct</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec.elems_outside|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec.elems_outside|thm"><span class="entity_def" id="offset_22637..22650">elems_outside</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.not_member|const"><span>∉</span></a></span><span class="free"><span>src</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="free"><span>dst</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_indexes&apos;|const"><span>sl_indexes'</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_get|const"><span>sl_get</span></a><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_get|const"><span>sl_get</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>i</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec.elems_src|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec.elems_src|thm"><span class="entity_def" id="offset_22722..22731">elems_src</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>src</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>∃</span></span><span class="bound"><span>j</span></span><span class="main"><span>∈</span></span><span class="free"><span>dst</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_get|const"><span>sl_get</span></a><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_get|const"><span>sl_get</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="bound"><span>j</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec.elems_dst|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec.elems_dst|thm"><span class="entity_def" id="offset_22788..22797">elems_dst</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>dst</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>∃</span></span><span class="bound"><span>j</span></span><span class="main"><span>∈</span></span><span class="free"><span>src</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_get|const"><span>sl_get</span></a><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_get|const"><span>sl_get</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="bound"><span>j</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec.permut|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec.permut|thm"><span class="entity_def" id="offset_22854..22860">permut</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec.length_eq|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec.length_eq|thm"><span>length_eq</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset_eq_length|fact"><span>mset_eq_length</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_22854..22860"><span>permut</span></a><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>




</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>  
  
  

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.axioms|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.intro|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split_def|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split_axioms.intro|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split_axioms_def|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.axioms(2)|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.axioms(1)|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.intro|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split_def|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split_axioms.intro|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split_axioms_def|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split_def|axiom"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split_axioms_def|axiom"><span>locale</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split|locale"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split|const"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split_axioms|const"><span>swap_opt_spec_pre_split</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec_pre|locale"><span>swap_opt_spec_pre</span></a><span> </span><span class="quoted"><span class="free"><span>ss</span></span></span><span> </span><span class="quoted"><span class="free"><span>bs</span></span></span><span> </span><span class="quoted"><span class="free"><span>xs</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="free"><span>ss</span></span><span> </span><span class="free"><span>bs</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>+</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.split_complete|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.split_complete(2)|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.split_complete(1)|thm"><span class="entity_def" id="offset_23105..23119">split_complete</span></span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>ss</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>bs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.split_dj|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.split_dj(2)|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.split_dj(1)|thm"><span class="entity_def" id="offset_23169..23177">split_dj</span></span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>∩</span></a></span><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>∩</span></a></span><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.split_card_eq1|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.split_card_eq1|thm"><span class="entity_def" id="offset_23227..23241">split_card_eq1</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.ss\&lt;^sub&gt;1_ne|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.ss\&lt;^sub&gt;1_ne|thm"><span class="entity_def" id="offset_23277..23284">ss<span class="hidden">⇩</span><sub>1</sub>_ne</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.finites|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.finites(4)|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.finites(3)|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.finites(2)|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.finites(1)|thm"><span>finites</span></span></span></span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>,</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.intro|attribute"><span class="operator"><span>intro</span></span></a><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span>!</span></span></span></span></span></span></span></span></span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span>"</span></span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span>"</span></span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span>"</span></span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_22248..22258"><span>finite_src</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_22340..22350"><span>finite_dst</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_23105..23119"><span>split_complete</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.card_ss_eq|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.card_ss_eq|thm"><span class="entity_def" id="offset_23483..23493">card_ss_eq</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>ss</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_23105..23119"><span>split_complete</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_23169..23177"><span>split_dj</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_Un_disjoint|fact"><span>card_Un_disjoint</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.card_bs_eq|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.card_bs_eq|thm"><span class="entity_def" id="offset_23600..23610">card_bs_eq</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>bs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_23105..23119"><span>split_complete</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_23169..23177"><span>split_dj</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_Un_disjoint|fact"><span>card_Un_disjoint</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.split_card_eq2|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.split_card_eq2|thm"><span class="entity_def" id="offset_23718..23732">split_card_eq2</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_23600..23610"><span>card_bs_eq</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_23483..23493"><span>card_ss_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.diff_add_inverse|fact"><span>diff_add_inverse</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_22200..22207"><span>card_eq</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_23227..23241"><span>split_card_eq1</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.split_card_eq|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.split_card_eq(2)|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.split_card_eq(1)|thm"><span class="entity_def" id="offset_23845..23858">split_card_eq</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_23227..23241"><span>split_card_eq1</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_23718..23732"><span>split_card_eq2</span></a><span>
  
  
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_23899..23908">sublocale</span></span></span><span> p1</span><span class="main"><span>:</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec_pre|locale"><span>swap_opt_spec_pre</span></a><span> </span><span class="quoted"><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span></span><span> </span><span class="quoted"><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_split|const"><span>sl_split</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>unfold_locales</span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_23169..23177"><span>split_dj</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_22078..22088"><span>src_dst_dj</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_22433..22447"><span>idxs_in_bounds</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_23845..23858"><span>split_card_eq</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_23105..23119"><span>split_complete</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_23105..23119"><span>split_complete</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_indexes_split|fact"><span>sl_indexes_split</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_23105..23119"><span>split_complete</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_indexes_split|fact"><span>sl_indexes_split</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_23105..23119"><span>split_complete</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_24271..24280">sublocale</span></span></span><span> p2</span><span class="main"><span>:</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec_pre|locale"><span>swap_opt_spec_pre</span></a><span> </span><span class="quoted"><span class="free"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span></span><span> </span><span class="quoted"><span class="free"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_split|const"><span>sl_split</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.uminus_class.uminus|const"><span>-</span></a></span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>unfold_locales</span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_23169..23177"><span>split_dj</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_22078..22088"><span>src_dst_dj</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_22433..22447"><span>idxs_in_bounds</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_23845..23858"><span>split_card_eq</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_23105..23119"><span>split_complete</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_23105..23119"><span>split_complete</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_indexes_split|fact"><span>sl_indexes_split</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_23105..23119"><span>split_complete</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_indexes_split|fact"><span>sl_indexes_split</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_23105..23119"><span>split_complete</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
  
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_24646..24651">lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.extreme|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.extreme(3)|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.extreme(2)|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.extreme(1)|thm"><span>extreme</span></span></span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span>  
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span>ss</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span>bs</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_24646..24651"><span>assms</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_23105..23119"><span>split_complete</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_23169..23177"><span>split_dj</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_23845..23858"><span>split_card_eq</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
    
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.idxs1_in_bounds|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.idxs1_in_bounds|thm"><span>idxs1_in_bounds</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_indexes&apos;|const"><span>sl_indexes'</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_22159..22165"><span>dst_ss</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_23105..23119"><span>split_complete</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_23105..23119"><span>split_complete</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_22118..22124"><span>src_ss</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.decreasing|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.decreasing|thm"><span>decreasing</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>ss</span></span><span>"</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_23483..23493"><span>card_ss_eq</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_23277..23284"><span>ss<span class="hidden">⇩</span><sub>1</sub>_ne</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span>
    
    
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.join|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_split.join|thm"><span>join</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec|const"><span>swap_opt_spec</span></a><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_split|const"><span>sl_split</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub>'</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec|const"><span>swap_opt_spec</span></a><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_split|const"><span>sl_split</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.uminus_class.uminus|const"><span>-</span></a></span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>2</sub>'</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec|const"><span>swap_opt_spec</span></a><span> </span><span class="free"><span>ss</span></span><span> </span><span class="free"><span>bs</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_join|const"><span>sl_join</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub>'</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>2</sub>'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>interpret</span></span></span><span> p1</span><span class="main"><span>:</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec|locale"><span>swap_opt_spec</span></a><span> </span><span class="quoted"><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span></span><span> </span><span class="quoted"><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_split|const"><span>sl_split</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub>'</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_25318..25320">by</span></span></span><span> </span><span class="operator"><span>fact</span></span><span>
    </span><span class="keyword1"><span class="command"><span>interpret</span></span></span><span> p2</span><span class="main"><span>:</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec|locale"><span>swap_opt_spec</span></a><span> </span><span class="quoted"><span class="free"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span></span><span> </span><span class="quoted"><span class="free"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_split|const"><span>sl_split</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.uminus_class.uminus|const"><span>-</span></a></span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="free"><span>xs<span class="hidden">⇩</span><sub>2</sub>'</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_25403..25405">by</span></span></span><span> </span><span class="operator"><span>fact</span></span><span>
  
    
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_25428..25434">COMPAT</span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_compat|const"><span>sl_compat</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_struct_split|const"><span>sl_struct_split</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_struct|const"><span>sl_struct</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_struct_split|const"><span>sl_struct_split</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.uminus_class.uminus|const"><span>-</span></a></span><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_struct|const"><span>sl_struct</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_compat_splitI|fact"><span>sl_compat_splitI</span></a><span class="main"><span>)</span></span><span>
    
      
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_join|const"><span>sl_join</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_split|const"><span>sl_split</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_split|const"><span>sl_split</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.uminus_class.uminus|const"><span>-</span></a></span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_join_split_eq|fact"><span>sl_join_split_eq</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="free"><span>xs</span></span></span><span class="main"><span>]</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>…</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_split|const"><span>sl_split</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_split|const"><span>sl_split</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.uminus_class.uminus|const"><span>-</span></a></span><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.replicate_mset|const"><span>replicate_mset</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.None|const"><span>None</span></a><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.mset_join_idxs_eq|fact"><span>mset_join_idxs_eq</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_25937..25949">mset_xs_conv</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_split|const"><span>sl_split</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_split|const"><span>sl_split</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.uminus_class.uminus|const"><span>-</span></a></span><span> </span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.replicate_mset|const"><span>replicate_mset</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.None|const"><span>None</span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
      
      
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>unfold_locales</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_struct_join_split|fact"><span>sl_struct_join_split</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span class="free"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span>"</span></span></span><span class="main"><span>]</span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_get_join|fact"><span>sl_get_join</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_indexes_lengthD|fact"><span>sl_indexes_lengthD</span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_23105..23119"><span>split_complete</span></a><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_indexes_split|fact"><span>sl_indexes_split</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_25403..25405"><span>p2.elems_outside</span></a><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_get_split|fact"><span>sl_get_split</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> i
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_23105..23119"><span>split_complete</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.safe|method"><span class="operator"><span>safe</span></span></a><span class="main"><span>)</span></span><span>  
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Un_iff|fact"><span>Un_iff</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_25428..25434"><span>COMPAT</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_25318..25320"><span>p1.elems_src</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_23899..23908"><span>p1.src_ss</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_25318..25320"><span>p1.struct_eq</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_25403..25405"><span>p2.struct_eq</span></a><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_get_join1|fact"><span>sl_get_join1</span></a><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_get_split|fact"><span>sl_get_split</span></a><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_struct_split|fact"><span>sl_struct_split</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_iff|fact"><span>subset_iff</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> 
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>frule</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_25403..25405"><span>p2.elems_src</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_25428..25434"><span>COMPAT</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.IntD1|fact"><span>IntD1</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.UnI2|fact"><span>UnI2</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_25318..25320"><span>p1.struct_eq</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_24271..24280"><span>p2.dst_ss</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_24271..24280"><span>p2.src_ss</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_25403..25405"><span>p2.struct_eq</span></a><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_get_join2|fact"><span>sl_get_join2</span></a><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_get_split|fact"><span>sl_get_split</span></a><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_indexes_split|fact"><span>sl_indexes_split</span></a><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_struct_split|fact"><span>sl_struct_split</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subsetD|fact"><span>subsetD</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_23105..23119"><span>split_complete</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.safe|method"><span class="operator"><span>safe</span></span></a><span class="main"><span>)</span></span><span>  
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_25428..25434"><span>COMPAT</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.in_mono|fact"><span>in_mono</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_23899..23908"><span>p1.dst_ss</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_25318..25320"><span>p1.elems_dst</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_25318..25320"><span>p1.struct_eq</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_25403..25405"><span>p2.struct_eq</span></a><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_get_join1|fact"><span>sl_get_join1</span></a><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_get_split|fact"><span>sl_get_split</span></a><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_struct_split|fact"><span>sl_struct_split</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.semilattice_sup_class.sup_ge1|fact"><span>sup_ge1</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> 
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>frule</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_25403..25405"><span>p2.elems_dst</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_25428..25434"><span>COMPAT</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.IntD1|fact"><span>IntD1</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Un_Int_eq|fact"><span>Un_Int_eq</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.in_mono|fact"><span>in_mono</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_25318..25320"><span>p1.struct_eq</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_24271..24280"><span>p2.dst_ss</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_24271..24280"><span>p2.src_ss</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_25403..25405"><span>p2.struct_eq</span></a><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_get_join2|fact"><span>sl_get_join2</span></a><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_get_split|fact"><span>sl_get_split</span></a><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_indexes_split|fact"><span>sl_indexes_split</span></a><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_struct_split|fact"><span>sl_struct_split</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.mset_join_idxs_eq|fact"><span>mset_join_idxs_eq</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_25937..25949"><span>mset_xs_conv</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_25318..25320"><span>p1.permut</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_25403..25405"><span>p2.permut</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>  
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>        

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
  

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_SPEC_def|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_SPEC_def|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_SPEC_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_SPEC|const"><span>swap_opt_SPEC</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>ss</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>bs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec_pre|const"><span>swap_opt_spec_pre</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>ss</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>bs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec|const"><span>swap_opt_spec</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>ss</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>bs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.split_sets_eq_SPEC_def|fact"><span class="entity_def" id="Sorting_Par_Partition.split_sets_eq_SPEC_def|thm"><span class="entity_def" id="Sorting_Par_Partition.split_sets_eq_SPEC_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Par_Partition.split_sets_eq_SPEC|const"><span>split_sets_eq_SPEC</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>ss</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>bs</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
  </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>ss</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>bs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>ss</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>bs</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
  </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="main"><span>(</span></span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> 
    </span><span class="free"><span class="bound"><span class="entity"><span>ss</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>bs</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span>
  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>∩</span></a></span><span> </span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>∩</span></a></span><span> </span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>
  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>
  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span>
  </span><span class="main"><span>)</span></span><span>
</span><span class="main"><span>}</span></span><span>"</span></span></span><span>


</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec_pre|locale"><span>swap_opt_spec_pre</span></a><span class="main"><span>)</span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre.split_sets_eq_SPEC_swap_rl|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre.split_sets_eq_SPEC_swap_rl|thm"><span>split_sets_eq_SPEC_swap_rl</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>src</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.split_sets_eq_SPEC|const"><span>split_sets_eq_SPEC</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="free"><span>dst</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="main"><span>(</span></span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec_pre_split|const"><span>swap_opt_spec_pre_split</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="free"><span>dst</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.split_sets_eq_SPEC_def|fact"><span>split_sets_eq_SPEC_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_22200..22207"><span>card_eq</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.force|method"><span class="operator"><span>force</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>unfold_locales</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>


</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.par_swap_aux_def|fact"><span class="entity_def" id="Sorting_Par_Partition.par_swap_aux_def|thm"><span class="entity_def" id="Sorting_Par_Partition.par_swap_aux_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Par_Partition.par_swap_aux|const"><span>par_swap_aux</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>ss</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>bs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/RefineG_Recursion.html#RefineG_Recursion.RECT|const"><span>RECT</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>par_swap</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>ss</span></span><span class="main"><span>,</span></span><span class="bound"><span>bs</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
  </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec_pre|const"><span>swap_opt_spec_pre</span></a><span> </span><span class="bound"><span>ss</span></span><span> </span><span class="bound"><span>bs</span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
    
  </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="main"><span>(</span></span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.split_sets_eq_SPEC|const"><span>split_sets_eq_SPEC</span></a><span> </span><span class="bound"><span>ss</span></span><span> </span><span class="bound"><span>bs</span></span><span class="main"><span>;</span></span><span>
  
  </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
    </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="bound"><span>ss</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="bound"><span>bs</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
    </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_SPEC|const"><span>swap_opt_SPEC</span></a><span> </span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>xs</span></span><span>
  </span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
    </span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.WITH_IDXS|const"><span>WITH_IDXS</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><span class="main"><span>(</span></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Parallel.html#Sepref_Parallel.nres_par|const"><span>nres_par</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_SPEC|const"><span>swap_opt_SPEC</span></a><span> </span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>par_swap</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Unity|const"><span>()</span></a></span><span class="main"><span>,</span></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
    </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>xs</span></span><span>
  </span><span class="main"><span>}</span></span><span>
</span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>ss</span></span></span></span><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>bs</span></span></span></span><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  



</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.par_swap_aux_correct|fact"><span class="entity_def" id="Sorting_Par_Partition.par_swap_aux_correct|thm"><span>par_swap_aux_correct</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>ss</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.par_swap_aux|const"><span>par_swap_aux</span></a><span> </span><span class="free"><span>ss</span></span><span> </span><span class="free"><span>bs</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_SPEC|const"><span>swap_opt_SPEC</span></a><span> </span><span class="free"><span>ss</span></span><span> </span><span class="free"><span>bs</span></span><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.par_swap_aux_def|fact"><span>par_swap_aux_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_SPEC_def|fact"><span>swap_opt_SPEC_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>supply</span></span></span></span></span><span> </span><span class="entity_def" id="offset_28834..28835">R</span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/RefineG_Recursion.html#RefineG_Recursion.RECT_rule|fact"><span>RECT_rule</span></a><span class="main"><span>[</span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> V</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Wellfounded.html#Wellfounded.measure|const"><span>measure</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>o</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>and</span></span></span></span><span> pre</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>ss</span></span><span class="main"><span>,</span></span><span class="bound"><span>bs</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>ss</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec_pre|const"><span>swap_opt_spec_pre</span></a><span> </span><span class="bound"><span>ss</span></span><span> </span><span class="bound"><span>bs</span></span><span> </span><span class="bound"><span>xs</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_28834..28835"><span>R</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> M</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>ss</span></span><span class="main"><span>,</span></span><span class="bound"><span>bs</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec|const"><span>swap_opt_spec</span></a><span> </span><span class="bound"><span>ss</span></span><span> </span><span class="bound"><span>bs</span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span class="main"><span>,</span></span></span><span> </span><span class="operator"><span>THEN</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order_trans|fact"><span>order_trans</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Eisbach.Eisbach.html#Eisbach.all|method"><span class="operator"><span>all</span></span></a><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="operator"><span>thin_tac</span></span><span> </span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../AFP/Refine_Monadic/RefineG_Recursion.html#RefineG_Recursion.RECT|const"><a class="entity_ref" href="../../AFP/Refine_Monadic/RefineG_Recursion.html#RefineG_Recursion.RECT|const"><a class="entity_ref" href="../../AFP/Refine_Monadic/RefineG_Recursion.html#RefineG_Recursion.RECT|const"><a class="entity_ref" href="../../AFP/Refine_Monadic/RefineG_Recursion.html#RefineG_Recursion.RECT|const"><a class="entity_ref" href="../../AFP/Refine_Monadic/RefineG_Recursion.html#RefineG_Recursion.RECT|const"><a class="entity_ref" href="../../AFP/Refine_Monadic/RefineG_Recursion.html#RefineG_Recursion.RECT|const"><span>RECT</span></a></a></a></a></a></a><span> </span><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span>_</span></span></span></span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span></a></span></a></span></a></span></a></span></a></span><span> </span><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span>_</span></span></span></span></span></span></span><span>"</span></span></span></span></span></span></span></span><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span>›</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> par_swap ss bs xs </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>goal_cases</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>1</span><span>
    
    </span><span class="keyword1"><span class="command"><span>note</span></span></span><span> </span><span class="entity_def" id="offset_29261..29263">IH</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>⟦</span></span><span class="main"><span>_</span></span><span class="main"><span>;</span></span><span class="main"><span>_</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="skolem"><span>par_swap</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span>  </span><span class="main"><span>_</span></span><span>›</span></span></span><span>
    
    </span><span class="keyword1"><span class="command"><span>note</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="skolem"><span>ss</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>›</span></span></span><span>
    
    </span><span class="keyword1"><span class="command"><span>note</span></span></span><span> </span><span>SOS_PRE</span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec_pre|const"><span>swap_opt_spec_pre</span></a><span> </span><span class="skolem"><span>ss</span></span><span> </span><span class="skolem"><span>bs</span></span><span> </span><span class="skolem"><span>xs</span></span><span>›</span></span></span><span>
    
    </span><span class="keyword1"><span class="command"><span>interpret</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec_pre|locale"><span>swap_opt_spec_pre</span></a><span> </span><span class="quoted"><span class="skolem"><span>ss</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>bs</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>xs</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_29428..29430">by</span></span></span><span> </span><span class="operator"><span>fact</span></span><span>
    
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_29428..29430"><span>split_sets_eq_SPEC_swap_rl</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>THEN</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order_trans|fact"><span>order_trans</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|fact"><span class="dynamic"><span class="dynamic"><span>refine_vcg</span></span></span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> ss<span class="hidden">⇩</span><sub>1</sub> ss<span class="hidden">⇩</span><sub>2</sub> bs<span class="hidden">⇩</span><sub>1</sub> bs<span class="hidden">⇩</span><sub>2</sub> </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>goal_cases</span></span><span>
        </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>1</span><span>
        </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>interpret</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec_pre_split|locale"><span>swap_opt_spec_pre_split</span></a><span> </span><span class="quoted"><span class="skolem"><span>ss</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>bs</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>xs</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span></span><span> </span><span class="quoted"><span class="skolem"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span></span><span> </span><span class="quoted"><span class="skolem"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span></span><span> </span><span class="quoted"><span class="skolem"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_29735..29736">.</span></span></span><span>
        
        </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_29735..29736"><span>extreme</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_29735..29736"><span>extreme</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_29735..29736"><span>extreme</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_29735..29736"><span>extreme</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_29735..29736"><span>extreme</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_29735..29736"><span>idxs1_in_bounds</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_29735..29736"><span>p1.swap_opt_spec_pre_axioms</span></a><span>
            </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span> 
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span>  
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> xs<span class="hidden">⇩</span><sub>1</sub>'
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_29261..29263"><span>IH</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>THEN</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order_trans|fact"><span>order_trans</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
              </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_29735..29736"><span>p2.swap_opt_spec_pre_axioms</span></a><span>
              </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span> 
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_29735..29736"><span>decreasing</span></a><span class="main"><span>)</span></span><span>
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span>
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> xs<span class="hidden">⇩</span><sub>2</sub>' </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>goal_cases</span></span><span>
              </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_30464..30465">1</span><span>
              </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>interpret</span></span></span><span> 
                p1</span><span class="main"><span>:</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec|locale"><span>swap_opt_spec</span></a><span> </span><span class="quoted"><span class="skolem"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span></span><span> </span><span class="quoted"><span class="skolem"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_split|const"><span>sl_split</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="skolem"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>xs</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>xs<span class="hidden">⇩</span><sub>1</sub>'</span></span></span><span> </span><span class="main"><span>+</span></span><span>
                p2</span><span class="main"><span>:</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec|locale"><span>swap_opt_spec</span></a><span> </span><span class="quoted"><span class="skolem"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span></span><span> </span><span class="quoted"><span class="skolem"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_split|const"><span>sl_split</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.uminus_class.uminus|const"><span>-</span></a></span><span> </span><span class="skolem"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="skolem"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>xs</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>xs<span class="hidden">⇩</span><sub>2</sub>'</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span>
              </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_30464..30465"><span>1</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_29735..29736"><span>join</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec|const"><span>swap_opt_spec</span></a><span> </span><span class="skolem"><span>ss</span></span><span> </span><span class="skolem"><span>bs</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_join|const"><span>sl_join</span></a><span> </span><span class="skolem"><span>xs<span class="hidden">⇩</span><sub>1</sub>'</span></span><span> </span><span class="skolem"><span>xs<span class="hidden">⇩</span><sub>2</sub>'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
              </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
                </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
            </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>  
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>  
            

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.par_swap_def|fact"><span class="entity_def" id="Sorting_Par_Partition.par_swap_def|thm"><span class="entity_def" id="Sorting_Par_Partition.par_swap_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Par_Partition.par_swap|const"><span>par_swap</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>ss</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>bs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
  </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>ss</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span>
  </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
    </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.mop_sl_of_list|const"><span>mop_sl_of_list</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>;</span></span><span>
    </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.par_swap_aux|const"><span>par_swap_aux</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>ss</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>bs</span></span></span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>;</span></span><span>
    </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.mop_list_of_sl|const"><span>mop_list_of_sl</span></a><span> </span><span class="bound"><span>xs</span></span><span>
  </span><span class="main"><span>}</span></span><span>
</span><span class="main"><span>}</span></span><span>"</span></span></span><span>



</span><span class="keyword1"><span class="command"><span>context</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_spec_pre|locale"><span>swap_spec_pre</span></a><span> </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_spec_pre.to_opt|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_spec_pre.to_opt|thm"><span>to_opt</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec_pre|const"><span>swap_opt_spec_pre</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="free"><span>dst</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_of_list|const"><span>sl_of_list</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>unfold_locales</span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_9411..9421"><span>src_dst_dj</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_9451..9457"><span>src_ss</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_9493..9499"><span>dst_ss</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_9535..9542"><span>card_eq</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
  


</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>



</span><span class="keyword1"><span class="command"><span>context</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec|locale"><span>swap_opt_spec</span></a><span> </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec.to_plain_complete|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec.to_plain_complete|thm"><span>to_plain_complete</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_of_list|const"><span>sl_of_list</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_complete|const"><span>sl_complete</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_struct|const"><span>sl_struct</span></a><span> </span><span class="free"><span>xs'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>


  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec.to_plain|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec.to_plain|thm"><span>to_plain</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_of_list|const"><span>sl_of_list</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_spec|const"><span>swap_spec</span></a><span> </span><span class="free"><span>src</span></span><span> </span><span class="free"><span>dst</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.list_of_sl|const"><span>list_of_sl</span></a><span> </span><span class="free"><span>xs'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>unfold_locales</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_22078..22088"><span>src_dst_dj</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_22118..22124"><span>src_ss</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_22159..22165"><span>dst_ss</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_22200..22207"><span>card_eq</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> i </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_22637..22650"><span>elems_outside</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="skolem"><span>i</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> i </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_22722..22731"><span>elems_src</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="skolem"><span>i</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> i </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_22788..22797"><span>elems_dst</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="skolem"><span>i</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_22854..22860"><span>permut</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.mset_of_list_permut|fact"><span>mset_of_list_permut</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
  
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.par_swap_refine_aux|fact"><span class="entity_def" id="Sorting_Par_Partition.par_swap_refine_aux|thm"><span>par_swap_refine_aux</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.par_swap|const"><span>par_swap</span></a><span> </span><span class="free"><span>ss</span></span><span> </span><span class="free"><span>bs</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_SPEC|const"><span>swap_SPEC</span></a><span> </span><span class="free"><span>ss</span></span><span> </span><span class="free"><span>bs</span></span><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.par_swap_def|fact"><span>par_swap_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_SPEC_def|fact"><span>swap_SPEC_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_spec_pre.swap_spec_refl|fact"><span>swap_spec_pre.swap_spec_refl</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order_trans|fact"><span>order_trans</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.par_swap_aux_correct|fact"><span>par_swap_aux_correct</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_SPEC_def|fact"><span>swap_opt_SPEC_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_spec_pre.to_opt|fact"><span>swap_spec_pre.to_opt</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec.to_plain_complete|fact"><span>swap_opt_spec.to_plain_complete</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec.to_plain|fact"><span>swap_opt_spec.to_plain</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.par_swap_refine|fact"><span class="entity_def" id="Sorting_Par_Partition.par_swap_refine|thm"><span>par_swap_refine</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span class="main"><span>(</span></span><span class="free"><span>ss</span></span><span class="main"><span>,</span></span><span class="free"><span>ss'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="main"><span>⟨</span></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.set_rel|const"><span>set_rel</span></a><span class="main"><span>;</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>bs</span></span><span class="main"><span>,</span></span><span class="free"><span>bs'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="main"><span>⟨</span></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.set_rel|const"><span>set_rel</span></a><span class="main"><span>;</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><span>,</span></span><span class="free"><span>xs'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="main"><span>⟨</span></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.list_rel|const"><span>list_rel</span></a><span class="main"><span>⟧</span></span><span> 
  </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.par_swap|const"><span>par_swap</span></a><span> </span><span class="free"><span>ss</span></span><span> </span><span class="free"><span>bs</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="main"><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="main"><span>(</span></span><span class="main"><span>⟨</span></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.list_rel|const"><span>list_rel</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_SPEC|const"><span>swap_SPEC</span></a><span> </span><span class="free"><span>ss'</span></span><span> </span><span class="free"><span>bs'</span></span><span> </span><span class="free"><span>xs'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.par_swap_refine_aux|fact"><span>par_swap_refine_aux</span></a><span class="main"><span>)</span></span><span>
  

  
  
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.swap_o_intv_aux_def|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_o_intv_aux_def|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_o_intv_aux_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Par_Partition.swap_o_intv_aux|const"><span>swap_o_intv_aux</span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>l<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>h<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>l<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>h<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
  </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>l<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="bound"><span>h<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>l<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="bound"><span>h<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>h<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="bound"><span>l<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="bound"><span>h<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="bound"><span>l<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
  </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>←</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_While.html#Refine_While.WHILEIT|const"><span>WHILEIT</span></a><span> 
    </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastAtMost|const"><span>{</span></a></span><span class="bound"><span>l<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastAtMost|const"><span>..</span></a></span><span class="bound"><span>h<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastAtMost|const"><span>}</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastAtMost|const"><span>{</span></a></span><span class="bound"><span>l<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastAtMost|const"><span>..</span></a></span><span class="bound"><span>h<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastAtMost|const"><span>}</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="bound"><span>l<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="bound"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="bound"><span>l<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec|const"><span>swap_opt_spec</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="bound"><span>l<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="bound"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="bound"><span>l<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="bound"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span> </span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>h<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> 
    </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span class="main"><span>(</span></span><span class="bound"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>h<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>h<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      </span><span class="bound"><span>xs</span></span><span class="main"><span>←</span></span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.mop_slist_swap|const"><span>mop_slist_swap</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>;</span></span><span>
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>,</span></span><span class="bound"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>l<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>l<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
  </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>xs</span></span><span>
</span><span class="main"><span>}</span></span><span>"</span></span></span><span>  

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_empty|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_empty|thm"><span>swap_opt_spec_empty</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec|const"><span>swap_opt_spec</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>unfold_locales</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

  
  
</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_33132..33137">lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_o_intv_aux_correct|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_o_intv_aux_correct|thm"><span>swap_o_intv_aux_correct</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>l<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span>h<span class="hidden">⇩</span><sub>1</sub></span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>l<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span>h<span class="hidden">⇩</span><sub>2</sub></span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_o_intv_aux|const"><span>swap_o_intv_aux</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>l<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="free"><span>h<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>l<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>,</span></span><span class="free"><span>h<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span>  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_SPEC|const"><span>swap_opt_SPEC</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>l<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>h<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>l<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>h<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_SPEC_def|fact"><span>swap_opt_SPEC_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>  
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec_pre|const"><span>swap_opt_spec_pre</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>l<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>h<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>l<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>h<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>interpret</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec_pre|locale"><span>swap_opt_spec_pre</span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>l<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>h<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>l<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>h<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span>"</span></span></span><span> </span><span class="quoted"><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_33476..33477">.</span></span></span><span>
  
  </span><span class="keyword1"><span class="command"><span>{</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="skolem"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="skolem"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_33515..33517">B1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>l<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="skolem"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>h<span class="hidden">⇩</span><sub>1</sub></span></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_33554..33556">B2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>l<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="skolem"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>h<span class="hidden">⇩</span><sub>2</sub></span></span><span>"</span></span></span><span> 
    
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec|const"><span>swap_opt_spec</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>l<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="skolem"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>l<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="skolem"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="skolem"><span>xs</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>interpret</span></span></span><span> this</span><span class="main"><span>:</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec|locale"><span>swap_opt_spec</span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>l<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="skolem"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>l<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="skolem"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span>"</span></span></span><span> </span><span class="quoted"><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span></span><span> </span><span class="quoted"><span class="skolem"><span>xs</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_33722..33723">.</span></span></span><span>
    
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_indexes&apos;|const"><span>sl_indexes'</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_indexes&apos;|const"><span>sl_indexes'</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33515..33517"><span>B1</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33554..33556"><span>B2</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33476..33477"><span>src_ss</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33476..33477"><span>dst_ss</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
    
    
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec|const"><span>swap_opt_spec</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>l<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="skolem"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>l<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="skolem"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap|const"><span>swap</span></a><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="skolem"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="skolem"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>unfold_locales</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33515..33517"><span>B1</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33554..33556"><span>B2</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33476..33477"><span>src_dst_dj</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33515..33517"><span>B1</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33554..33556"><span>B2</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33476..33477"><span>src_ss</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33515..33517"><span>B1</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33554..33556"><span>B2</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33476..33477"><span>dst_ss</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33515..33517"><span>B1</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33554..33556"><span>B2</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33722..33723"><span>this.card_eq</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc_diff_le|fact"><span>Suc_diff_le</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.card_atLeastLessThan|fact"><span>card_atLeastLessThan</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33515..33517"><span>B1</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33554..33556"><span>B2</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33476..33477"><span>src_ss</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33476..33477"><span>dst_ss</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33515..33517"><span>B1</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33554..33556"><span>B2</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33722..33723"><span>this.elems_outside</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_get_swap_other|fact"><span>sl_get_swap_other</span></a><span class="main"><span>)</span></span><span> 
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> j
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subgoal_tac</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="skolem"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="skolem"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_indexes&apos;|const"><span>sl_indexes'</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="skolem"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33722..33723"><span>this.elems_src</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="skolem"><span>j</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_get_swap_iff|fact"><span>sl_get_swap_iff</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33515..33517"><span>B1</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33554..33556"><span>B2</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33476..33477"><span>src_dst_dj</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33722..33723"><span>this.elems_outside</span></a><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_get_swap_iff|fact"><span>sl_get_swap_iff</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33515..33517"><span>B1</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33554..33556"><span>B2</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33476..33477"><span>src_dst_dj</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33476..33477"><span>src_ss</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>  
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> j
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subgoal_tac</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="skolem"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="skolem"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_indexes&apos;|const"><span>sl_indexes'</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="skolem"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33722..33723"><span>this.elems_dst</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="skolem"><span>j</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_get_swap_iff|fact"><span>sl_get_swap_iff</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33515..33517"><span>B1</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33554..33556"><span>B2</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33476..33477"><span>src_dst_dj</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33722..33723"><span>this.elems_outside</span></a><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_get_swap_iff|fact"><span>sl_get_swap_iff</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33515..33517"><span>B1</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33554..33556"><span>B2</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33476..33477"><span>src_dst_dj</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33476..33477"><span>dst_ss</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>  
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="skolem"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_indexes&apos;|const"><span>sl_indexes'</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span>›</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="skolem"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_indexes&apos;|const"><span>sl_indexes'</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span>›</span></span></span><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_indexes_lengthD|fact"><span>sl_indexes_lengthD</span></a><span> </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_struct_length|fact"><span>sl_struct_length</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap_multiset|fact"><span>swap_multiset</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33722..33723"><span>this.length_eq</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33722..33723"><span>this.permut</span></a><span class="main"><span>)</span></span><span>  
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_35139..35140">}</span></span></span><span> </span><span class="keyword1"><span class="command"><span>note</span></span></span><span> </span><span class="entity_def" id="offset_35146..35149">aux</span><span class="main"><span>=</span></span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_35139..35140"><span>this</span></a><span>
  
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_o_intv_aux|const"><span>swap_o_intv_aux</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>l<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>h<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>l<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>h<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec|const"><span>swap_opt_spec</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>l<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>h<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>l<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>h<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_o_intv_aux_def|fact"><span>swap_o_intv_aux_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_While.html#Refine_While.while.WHILEIT_rule|fact"><span>WHILEIT_rule</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> R</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Wellfounded.html#Wellfounded.measure|const"><span>measure</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>h<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33132..33137"><span>assms</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec.struct_eq|fact"><span>swap_opt_spec.struct_eq</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_35146..35149"><span>aux</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33476..33477"><span>card_eq</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33476..33477"><span>src_ss</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33476..33477"><span>dst_ss</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc_diff_le|fact"><span>Suc_diff_le</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Presburger.html#Presburger.presburger|method"><span class="operator"><span>presburger</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.diff_less_mono2|fact"><span>diff_less_mono2</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.lessI|fact"><span>lessI</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Presburger.html#Presburger.presburger|method"><span class="operator"><span>presburger</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> xs i2 </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_33132..33137"><span>assms</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.eq_diff_iff|fact"><span>eq_diff_iff</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
    
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="comment1"><span>(* Transform this to intervals *)</span></span><span>

</span><span class="comment1"><span>(* As we, technically, allow intervals to be empty here, we guard against empty intervals. *)</span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.swap_o_intv_def|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_o_intv_def|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_o_intv_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Par_Partition.swap_o_intv|const"><span>swap_o_intv</span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>l<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>h<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>l<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>h<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>.</span></span><span> 
  </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="bound"><span>l<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="bound"><span>h<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>l<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="bound"><span>h<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_o_intv_aux|const"><span>swap_o_intv_aux</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>l<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>h<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>l<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>h<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>xs</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_empty1_conv|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_empty1_conv|thm"><span>swap_opt_spec_pre_empty1_conv</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec_pre|const"><span>swap_opt_spec_pre</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span> </span><span class="free"><span>bs</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="free"><span>bs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span>  
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec_pre_def|fact"><span>swap_opt_spec_pre_def</span></a><span> 
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite_subset|fact"><span>finite_subset</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> _ </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_indexes_finite|fact"><span>sl_indexes_finite</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_empty2_conv|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_opt_spec_pre_empty2_conv|thm"><span>swap_opt_spec_pre_empty2_conv</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec_pre|const"><span>swap_opt_spec_pre</span></a><span> </span><span class="free"><span>ss</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="free"><span>ss</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span>  
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec_pre_def|fact"><span>swap_opt_spec_pre_def</span></a><span> 
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite_subset|fact"><span>finite_subset</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> _ </span><a class="entity_ref" href="IICF_Shared_Lists.html#IICF_Shared_Lists.sl_indexes_finite|fact"><span>sl_indexes_finite</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  
  
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_o_intv_correct|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_o_intv_correct|thm"><span>swap_o_intv_correct</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_o_intv|const"><span>swap_o_intv</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>l<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="free"><span>h<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>l<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>,</span></span><span class="free"><span>h<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span>  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_SPEC|const"><span>swap_opt_SPEC</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>l<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>h<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>l<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>h<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_o_intv_def|fact"><span>swap_o_intv_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>l<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>h<span class="hidden">⇩</span><sub>1</sub></span></span><span>"</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>l<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>h<span class="hidden">⇩</span><sub>2</sub></span></span><span>"</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_o_intv_aux_correct|fact"><span>swap_o_intv_aux_correct</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_SPEC_def|fact"><span>swap_opt_SPEC_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Eisbach.Eisbach.html#Eisbach.all|method"><span class="operator"><span>all</span></span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec_pre_empty1_conv|fact"><span>swap_opt_spec_pre_empty1_conv</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_spec_pre_empty2_conv|fact"><span>swap_opt_spec_pre_empty2_conv</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
  
  
  
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_o_intv_refine|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_o_intv_refine|thm"><span>swap_o_intv_refine</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_o_intv|const"><span>swap_o_intv</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_opt_SPEC|const"><span>swap_opt_SPEC</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.iv_rel|const"><span>iv_rel</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.iv_rel|const"><span>iv_rel</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="main"><span>⟨</span></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.iv_rel_def|fact"><span>iv_rel_def</span></a><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.in_br_conv|fact"><span>in_br_conv</span></a><span> </span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.iv_\&lt;alpha&gt;_def|fact"><span>iv_α_def</span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_relI|fact"><span>nres_relI</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_o_intv_correct|fact"><span>swap_o_intv_correct</span></a><span class="main"><span>)</span></span><span>
  
</span><span class="keyword1"><span class="command"><span>context</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>notes</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.fcomp_norm_simps|attribute"><span class="operator"><span>fcomp_norm_simps</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.iv_assn_def|fact"><span>iv_assn_def</span></a><span class="main"><span>[</span></span><span class="operator"><span>symmetric</span></span><span class="main"><span>]</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>  
  
  </span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span>abbreviation</span></span></span><span> </span><span class="main"><span>(</span></span><span>input</span><span class="main"><span>)</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Par_Partition.ivA|const"><span>ivA</span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.iv_assn_raw|const"><span>iv_assn_raw</span></a><span> </span><span class="main"><span>::</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_t|type"><span>size_t</span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/HOL-Library.Word.html#Word.word|type"><span>word</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod|type"><span>×</span></a></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>_</span></span><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>sepref_definition</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_Par_Partition.swap_o_intv_impl|const"><span>swap_o_intv_impl</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Codegen_Preproc.html#LLVM_Codegen_Preproc.llvm_code|attribute"><span class="operator"><span>llvm_code</span></span></a><span class="main"><span>]</span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry2|const"><span>uncurry2</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_o_intv|const"><span>swap_o_intv</span></a><span>"</span></span></span><span> 
    </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.ivA|const"><span>ivA</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.ivA|const"><span>ivA</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="IICF_DS_Array_Idxs.html#IICF_DS_Array_Idxs.oarray_idxs_assn|const"><span>oarray_idxs_assn</span></a><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfdrop|const"><span><span class="hidden">⇧</span><sup>d</sup></span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="IICF_DS_Array_Idxs.html#IICF_DS_Array_Idxs.oarray_idxs_assn|const"><span>oarray_idxs_assn</span></a><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="bound"><span>xsi</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>ri</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>ri</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="bound"><span>xsi</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_o_intv_def|fact"><span>swap_o_intv_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_o_intv_aux_def|fact"><span>swap_o_intv_aux_def</span></a><span> </span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.iv_assn_raw_def|fact"><span>iv_assn_raw_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.annot_snat_const|method"><span class="operator"><span>annot_snat_const</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_t|type"><span>size_t</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.swap_o_intv_impl.refine|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_o_intv_impl_def|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_o_intv_impl.refine_raw|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_o_intv_impl.refine|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_o_intv_impl_def|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_o_intv_impl.refine_raw|thm"><span class="entity_def" id="Sorting_Par_Partition.swap_o_intv_impl_def_raw|axiom"><span class="entity_def" id="offset_37394..37396">by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref|method"><span class="operator"><span>sepref</span></span></a><span>
  
  </span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.swap_o_intv_oidxs_hnr|fact"><span class="entity_def" id="Sorting_Par_Partition.swap_o_intv_oidxs_hnr|thm"><span>swap_o_intv_oidxs_hnr</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.sepref_fr_rules|attribute"><span class="operator"><span>sepref_fr_rules</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_37394..37396"><span>swap_o_intv_impl.refine</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.FCOMP|attribute"><span class="operator"><span>FCOMP</span></span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_o_intv_refine|fact"><span>swap_o_intv_refine</span></a><span class="main"><span>]</span></span><span>  
  
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>  
  
    
</span><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Wrap-Up: Parallel Algorithm on Abstract Level›</span></span></span><span>
  
</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_37585..37592">context</span></span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.weak_ordering|locale"><span>weak_ordering</span></a><span> </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart2_def|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart2_def|thm"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart2_def_raw|axiom"><span class="entity_def" id="offset_37614..37624">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart2.cong|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart2.cong|thm"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart2|const"><span class="entity_def" id="offset_37626..37632">ppart2</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
  </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>ss</span></span><span class="main"><span>,</span></span><span class="bound"><span>bs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_18877..18894"><span>gpartition_slices</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>;</span></span><span>
  </span><span class="bound"><span>m</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.mop_set_card|const"><span>mop_set_card</span></a><span> </span><span class="bound"><span>ss</span></span><span class="main"><span>;</span></span><span>

  </span><span class="keyword1"><span>let</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.weak_ordering.ppart_filter|const"><span>ppart_filter</span></a><span> </span><span class="bound"><span>m</span></span><span> </span><span class="bound"><span>ss</span></span><span> </span><span class="bound"><span>bs</span></span><span class="main"><span>;</span></span><span>
  
  </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.par_swap|const"><span>par_swap</span></a><span> </span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>;</span></span><span>

  </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>m</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span>
</span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart2_refine|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart2_refine|thm"><span class="entity_def" id="offset_37821..37834">ppart2_refine</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>d</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><span>,</span></span><span class="free"><span>xs'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="main"><span>⟨</span></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.list_rel|const"><span>list_rel</span></a><span class="main"><span>;</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_37626..37632"><span>ppart2</span></a><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_14512..14518"><span>ppart1</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="free"><span>xs'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_37614..37624"><span>ppart2_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_37585..37592"><span>ppart1_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_37585..37592"><span>ppart_mpos_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_rcg|method"><span class="operator"><span>refine_rcg</span></span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_21759..21783"><span>gpartition_slices_refine</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.par_swap_refine|fact"><span>par_swap_refine</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

  
</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_38049..38054">lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart2_refine_p_all_spec|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart2_refine_p_all_spec|thm"><span class="entity_def" id="offset_38055..38079">ppart2_refine_p_all_spec</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>d</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>  
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_37626..37632"><span>ppart2</span></a><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>m</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs'</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_3581..3600"><span>gpartition_all_spec</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="bound"><span>xs'</span></span><span> </span><span class="bound"><span>m</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>  
  </span><span class="keyword1"><span class="command"><span>note</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_37821..37834"><span>ppart2_refine</span></a><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>note</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_15031..15055"><span>ppart1_valid_partitition</span></a><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_38049..38054"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_partition_pivot_par_def|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_partition_pivot_par_def|thm"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_partition_pivot_par_def_raw|axiom"><span class="entity_def" id="offset_38307..38317">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_partition_pivot_par.cong|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_partition_pivot_par.cong|thm"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_partition_pivot_par|const"><span class="entity_def" id="offset_38319..38344">ppart_partition_pivot_par</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
  </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="numeral"><span>4</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
  
  </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><span>move_pivot_to_first_sample</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span class="main"><span>;</span></span><span>

  </span><span class="bound"><span>p</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.mop_list_cp_get|const"><span>mop_list_cp_get</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>;</span></span><span>
    
  </span><span class="main"><span>(</span></span><span class="bound"><span>m</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/IICF_Array.html#IICF_Array.WITH_SPLIT|const"><span>WITH_SPLIT</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
    </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
    </span><span class="main"><span>(</span></span><span class="bound"><span>m</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_37626..37632"><span>ppart2</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span> </span><span class="bound"><span>p</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>;</span></span><span>
    </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>m</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
  
  </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
  
  </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>m'</span></span><span class="main"><span>=</span></span><span class="bound"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>;</span></span><span>
  
  </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="bound"><span>m'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
    </span><span class="bound"><span>xs</span></span><span class="main"><span>←</span></span><a class="entity_ref" href="../Isabelle_LLVM/IICF_List.html#IICF_List.mop_list_swap|const"><span>mop_list_swap</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="bound"><span>m</span></span><span class="main"><span>;</span></span><span>
    </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>m</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>m'</span></span><span class="main"><span>)</span></span><span>
</span><span class="main"><span>}</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.move_pivot_to_first_sample_weak_correct|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.move_pivot_to_first_sample_weak_correct|thm"><span class="entity_def" id="offset_38753..38792">move_pivot_to_first_sample_weak_correct</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span class="free"><span>n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>≥</span></a></span><span> </span><span class="numeral"><span>4</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span>move_pivot_to_first_sample</span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>xs'</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="bound"><span>xs'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>


</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.mset_eq_sum_mset_lengthD|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.mset_eq_sum_mset_lengthD|thm"><span class="entity_def" id="offset_38931..38955">mset_eq_sum_mset_lengthD</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.size_mset|fact"><span>size_mset</span></a><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.size_union|fact"><span>size_union</span></a><span class="main"><span>)</span></span><span>


</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_39065..39070">lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.slice_LT_by_nthI|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.slice_LT_by_nthI|thm"><span class="entity_def" id="offset_39071..39087">slice_LT_by_nthI</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span>m</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span>h</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span class="free"><span>p</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>p</span></span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Partially_Sorted.html#Sorting_Partially_Sorted.slice_LT|const"><span>slice_LT</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>≤</b>)</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>Misc.slice</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>Misc.slice</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_39065..39070"><span>assms</span></a><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Partially_Sorted.html#Sorting_Partially_Sorted.slice_LT_def|fact"><span>slice_LT_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Ball_def|fact"><span>Ball_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.in_set_conv_nth|fact"><span>in_set_conv_nth</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.force|method"><span class="operator"><span>force</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice_nth|fact"><span>slice_nth</span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>trans</span><span class="main"><span class="main"><span>[</span></span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="main"><span class="main"><span>_</span></span></span><span> </span><span class="quoted"><span class="free"><span>p</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span> 
  
  
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_partition_pivot_par_refines_part3|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_partition_pivot_par_refines_part3|thm"><span class="entity_def" id="offset_39372..39411">ppart_partition_pivot_par_refines_part3</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>d</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_38319..38344"><span>ppart_partition_pivot_par</span></a><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span>partition3_spec</span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="free"><span>n</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_37585..37592"><span>partition3_spec_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_38307..38317"><span>ppart_partition_pivot_par_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_38055..38079"><span>ppart2_refine_p_all_spec</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_38753..38792"><span>move_pivot_to_first_sample_weak_correct</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.sym|fact"><span>sym</span></a><span class="main"><span class="main"><span>[</span></span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>_</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><span>_</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="main"><span>_</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_37585..37592"><span>gpartition_spec_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.slice_eq_mset_whole_iff|fact"><span>slice_eq_mset_whole_iff</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset_eq_length|fact"><span>mset_eq_length</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_38931..38955"><span>mset_eq_sum_mset_lengthD</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset_eq_length|fact"><span>mset_eq_length</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_38931..38955"><span>mset_eq_sum_mset_lengthD</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset_eq_length|fact"><span>mset_eq_length</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_38931..38955"><span>mset_eq_sum_mset_lengthD</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset_eq_length|fact"><span>mset_eq_length</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_38931..38955"><span>mset_eq_sum_mset_lengthD</span></a><span class="main"><span>)</span></span><span>
  
  </span><span class="comment1"><span>(* Swapping: multiset equal *)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap_multiset|fact"><span>swap_multiset</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset_eq_length|fact"><span>mset_eq_length</span></a><span class="main"><span>)</span></span><span>
    
  </span><span class="comment1"><span>(* Swapping: partitioning *)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> xs<span class="hidden">⇩</span><sub>1</sub> xs<span class="hidden">⇩</span><sub>2</sub> xs<span class="hidden">⇩</span><sub>2</sub>' m
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_39071..39087"><span>slice_LT_by_nthI</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> p</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>drule</span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset_eq_length|fact"><span>mset_eq_length</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>drule</span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset_eq_length|fact"><span>mset_eq_length</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length_Suc_conv|fact"><span>length_Suc_conv</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap_nth|fact"><span>swap_nth</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>drule</span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset_eq_length|fact"><span>mset_eq_length</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length_Suc_conv|fact"><span>length_Suc_conv</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap_nth|fact"><span>swap_nth</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
    
  </span><span class="comment1"><span>(* Shifting: partitioning *)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> xs<span class="hidden">⇩</span><sub>2</sub> m xs<span class="hidden">⇩</span><sub>2</sub>' xs<span class="hidden">⇩</span><sub>1</sub>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_39071..39087"><span>slice_LT_by_nthI</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> p</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>drule</span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset_eq_length|fact"><span>mset_eq_length</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_38931..38955"><span>mset_eq_sum_mset_lengthD</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>drule</span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset_eq_length|fact"><span>mset_eq_length</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_38931..38955"><span>mset_eq_sum_mset_lengthD</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length_Suc_conv|fact"><span>length_Suc_conv</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth_Cons&apos;|fact"><span>nth_Cons'</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>drule</span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset_eq_length|fact"><span>mset_eq_length</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_38931..38955"><span>mset_eq_sum_mset_lengthD</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.force|method"><span class="operator"><span>force</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length_Suc_conv|fact"><span>length_Suc_conv</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth_Cons&apos;|fact"><span>nth_Cons'</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>    
  
  
  



  
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.align_chunk_size_def|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.align_chunk_size_def|thm"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.align_chunk_size_def_raw|axiom"><span class="entity_def" id="offset_40943..40953">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.align_chunk_size|const"><span>align_chunk_size</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres|type"><span>nres</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>align_chunk_size</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
  </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
  </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span>
  </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
    </span><span class="bound"><span>p</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.nat_div_round_up|const"><span>nat_div_round_up</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span class="main"><span>;</span></span><span>
    </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.nat_div_round_up|const"><span>nat_div_round_up</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="bound"><span>p</span></span><span>
  </span><span class="main"><span>}</span></span><span>
</span><span class="main"><span>}</span></span><span>"</span></span></span><span>  

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.align_chunk_size_correct|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.align_chunk_size_correct|thm"><span class="entity_def" id="offset_41162..41186">align_chunk_size_correct</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|attribute"><span class="operator"><span>refine_vcg</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>d</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.weak_ordering.align_chunk_size|const"><span>align_chunk_size</span></a><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>r</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_40943..40953"><span>align_chunk_size_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.ccontr|fact"><span>ccontr</span></a><span class="main"><span class="main"><span>[</span></span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="main"><span>_</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>

  
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_partition_pivot_def|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_partition_pivot_def|thm"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_partition_pivot_def_raw|axiom"><span class="entity_def" id="offset_41338..41348">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_partition_pivot.cong|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_partition_pivot.cong|thm"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_partition_pivot|const"><span class="entity_def" id="offset_41350..41371">ppart_partition_pivot</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> 
  </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span>partition_pivot_sample</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span>
  </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
    </span><span class="bound"><span>d</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.weak_ordering.align_chunk_size|const"><span>align_chunk_size</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span class="main"><span>;</span></span><span>
    </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_38319..38344"><span>ppart_partition_pivot_par</span></a><span> </span><span class="bound"><span>d</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span>
  </span><span class="main"><span>}</span></span><span>"</span></span></span><span>  
  
  
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_partition_pivot_refines_part3|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_partition_pivot_refines_part3|thm"><span>ppart_partition_pivot_refines_part3</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>d</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_41350..41371"><span>ppart_partition_pivot</span></a><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span>partition3_spec</span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="free"><span>n</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_41338..41348"><span>ppart_partition_pivot_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/splitter.ML.html#HOL.split|method"><span class="operator"><span>split</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.if_split|fact"><span>if_split</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjI|fact"><span>conjI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.impI|fact"><span>impI</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>partition_pivot_sample_correct</span><span class="main"><span>[</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="free"><span>xs</span></span></span><span> </span><span class="quoted"><span class="free"><span>xs</span></span></span><span> </span><span class="quoted"><span class="free"><span>n</span></span></span><span> </span><span class="quoted"><span class="free"><span>n</span></span></span><span class="main"><span>]</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.specify_left|fact"><span>specify_left</span></a><span class="main"><span>)</span></span><span>  
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_41162..41186"><span>align_chunk_size_correct</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_39372..39411"><span>ppart_partition_pivot_par_refines_part3</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>    
  
    
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>  

  



</span><span class="comment1"><span>(* Taking the smallest of two intervals, chopping the other *)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.split_sets_eq1_def|fact"><span class="entity_def" id="Sorting_Par_Partition.split_sets_eq1_def|thm"><span class="entity_def" id="Sorting_Par_Partition.split_sets_eq1_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Par_Partition.split_sets_eq1|const"><span>split_sets_eq1</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s<span class="hidden">⇩</span><sub>1</sub></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s<span class="hidden">⇩</span><sub>2</sub></span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>

  </span><span class="main"><span>(</span></span><span class="bound"><span>c<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.mop_set_rm_subset|const"><span>mop_set_rm_subset</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>s<span class="hidden">⇩</span><sub>1</sub></span></span></span></span><span class="main"><span>;</span></span><span>
  </span><span class="main"><span>(</span></span><span class="bound"><span>c<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.mop_set_rm_subset|const"><span>mop_set_rm_subset</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>s<span class="hidden">⇩</span><sub>2</sub></span></span></span></span><span class="main"><span>;</span></span><span>
    
  </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>card<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.op_set_card|const"><span>op_set_card</span></a><span> </span><span class="bound"><span>c<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>;</span></span><span>
  </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>card<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.op_set_card|const"><span>op_set_card</span></a><span> </span><span class="bound"><span>c<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>;</span></span><span>

  </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>mc</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.min|const"><span>min</span></a><span> </span><span class="bound"><span>card<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>card<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>;</span></span><span>
  
  </span><span class="main"><span>(</span></span><span class="bound"><span>c<span class="hidden">⇩</span><sub>1</sub><span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>c<span class="hidden">⇩</span><sub>1</sub><span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.mop_set_split_card|const"><span>mop_set_split_card</span></a><span> </span><span class="bound"><span>mc</span></span><span> </span><span class="bound"><span>c<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>;</span></span><span>
  </span><span class="main"><span>(</span></span><span class="bound"><span>c<span class="hidden">⇩</span><sub>2</sub><span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>c<span class="hidden">⇩</span><sub>2</sub><span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.mop_set_split_card|const"><span>mop_set_split_card</span></a><span> </span><span class="bound"><span>mc</span></span><span> </span><span class="bound"><span>c<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>;</span></span><span>
  
  </span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.mop_set_union_disj|const"><span>mop_set_union_disj</span></a><span> </span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>c<span class="hidden">⇩</span><sub>1</sub><span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>;</span></span><span>
  </span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.mop_set_union_disj|const"><span>mop_set_union_disj</span></a><span> </span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="bound"><span>c<span class="hidden">⇩</span><sub>2</sub><span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>;</span></span><span>

  </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="bound"><span>c<span class="hidden">⇩</span><sub>1</sub><span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="main"><span>(</span></span><span class="bound"><span>c<span class="hidden">⇩</span><sub>2</sub><span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
</span><span class="main"><span>}</span></span><span>"</span></span></span><span>



</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.ivls_split_refine|fact"><span class="entity_def" id="Sorting_Par_Partition.ivls_split_refine|thm"><span>ivls_split_refine</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.split_sets_eq1|const"><span>split_sets_eq1</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.split_sets_eq_SPEC|const"><span>split_sets_eq_SPEC</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="main"><span>⟨</span></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.split_sets_eq1_def|fact"><span>split_sets_eq1_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.split_sets_eq_SPEC_def|fact"><span>split_sets_eq_SPEC_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC_refine|fact"><span>SPEC_refine</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjI|fact"><span>conjI</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Int_Un_distrib|fact"><span>Int_Un_distrib</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.semilattice_inf_class.inf_commute|fact"><span>inf_commute</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_gt_0_iff|fact"><span>card_gt_0_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.linorder_class.min_less_iff_conj|fact"><span>min_less_iff_conj</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.bounded_semilattice_sup_bot_class.sup_bot_left|fact"><span>sup_bot_left</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

</span><span class="keyword1"><span class="command"><span>abbreviation</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Par_Partition.iv_assn_sz|const"><span>iv_assn_sz</span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.iv_assn&apos;|const"><span>iv_assn'</span></a><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_t|type"><span>size_t</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>  
</span><span class="keyword1"><span class="command"><span>abbreviation</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Par_Partition.iv_lb_assn_sz|const"><span>iv_lb_assn_sz</span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.iv_lb_assn&apos;|const"><span>iv_lb_assn'</span></a><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_t|type"><span>size_t</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>  
</span><span class="keyword1"><span class="command"><span>abbreviation</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Par_Partition.ivl_assn_sz|const"><span>ivl_assn_sz</span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.ivl_assn&apos;|const"><span>ivl_assn'</span></a><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_t|type"><span>size_t</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>  
  

</span><span class="keyword1"><span class="command"><span>sepref_definition</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_Par_Partition.split_sets_eq_impl|const"><span>split_sets_eq_impl</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Codegen_Preproc.html#LLVM_Codegen_Preproc.llvm_inline|attribute"><span class="operator"><span>llvm_inline</span></span></a><span class="main"><span>]</span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.uncurry|const"><span>uncurry</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.split_sets_eq1|const"><span>split_sets_eq1</span></a><span>"</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.ivl_assn_sz|const"><span>ivl_assn_sz</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfdrop|const"><span><span class="hidden">⇧</span><sup>d</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.ivl_assn_sz|const"><span>ivl_assn_sz</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfdrop|const"><span><span class="hidden">⇧</span><sup>d</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefttnd|const"><span>→<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.iv_assn_sz|const"><span>iv_assn_sz</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.prod_assn|const"><span>×<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.ivl_assn_sz|const"><span>ivl_assn_sz</span></a><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.prod_assn|const"><span>×<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.iv_assn_sz|const"><span>iv_assn_sz</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.prod_assn|const"><span>×<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.ivl_assn_sz|const"><span>ivl_assn_sz</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.split_sets_eq1_def|fact"><span>split_sets_eq1_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.min_def|fact"><span>min_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.split_sets_eq_impl.refine|fact"><span class="entity_def" id="Sorting_Par_Partition.split_sets_eq_impl_def|fact"><span class="entity_def" id="Sorting_Par_Partition.split_sets_eq_impl.refine_raw|fact"><span class="entity_def" id="Sorting_Par_Partition.split_sets_eq_impl.refine|thm"><span class="entity_def" id="Sorting_Par_Partition.split_sets_eq_impl_def|thm"><span class="entity_def" id="Sorting_Par_Partition.split_sets_eq_impl.refine_raw|thm"><span class="entity_def" id="Sorting_Par_Partition.split_sets_eq_impl_def_raw|axiom"><span>by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref|method"><span class="operator"><span>sepref</span></span></a><span>
  
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.split_sets_eq_SPEC.mcomb|fact"><span class="entity_def" id="Sorting_Par_Partition.split_sets_eq_SPEC.arity|fact"><span class="entity_def" id="Sorting_Par_Partition.split_sets_eq_SPEC.itype|fact"><span class="entity_def" id="Sorting_Par_Partition.split_sets_eq_SPEC.mcomb|thm"><span class="entity_def" id="Sorting_Par_Partition.split_sets_eq_SPEC.arity|thm"><span class="entity_def" id="Sorting_Par_Partition.split_sets_eq_SPEC.itype|thm"><span>sepref_register</span></span></span></span></span></span></span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.split_sets_eq_SPEC|const"><span>split_sets_eq_SPEC</span></a></span><span>
</span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.split_sets_eq_impl_spec_refine|fact"><span class="entity_def" id="Sorting_Par_Partition.split_sets_eq_impl_spec_refine|thm"><span>split_sets_eq_impl_spec_refine</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.sepref_fr_rules|attribute"><span class="operator"><span>sepref_fr_rules</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.split_sets_eq_impl.refine|fact"><span>split_sets_eq_impl.refine</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.FCOMP|attribute"><span class="operator"><span>FCOMP</span></span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.ivls_split_refine|fact"><span>ivls_split_refine</span></a><span class="main"><span>]</span></span><span>


  
</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_43484..43491">context</span></span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.weak_ordering|locale"><span>weak_ordering</span></a><span> </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>term</span></span></span><span> </span><span class="quoted"><span class="free"><span>partition_spec</span></span></span><span> 
  </span><span class="keyword1"><span class="command"><span>term</span></span></span><span> </span><span class="quoted"><span class="free"><span>partition_SPEC</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_seq1_def|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_seq1_def|thm"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_seq1_def_raw|axiom"><span class="entity_def" id="offset_43560..43570">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_seq1.cong|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_seq1.cong|thm"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_seq1|const"><span class="entity_def" id="offset_43572..43582">ppart_seq1</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
    </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
    </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>m</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><span>gpartition_SPEC</span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>;</span></span><span>
    </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="bound"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span class="main"><span>,</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="bound"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  
  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.gpartition_all_imp_ppart_spec|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.gpartition_all_imp_ppart_spec|thm"><span class="entity_def" id="offset_43715..43744">gpartition_all_imp_ppart_spec</span></span></span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_3581..3600"><span>gpartition_all_spec</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_4989..4999"><span>ppart_spec</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_3665..3689"><span>gpartition_all_spec_alt1</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_43484..43491"><span>ppart_spec_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span class="main"><span>)</span></span><span> 
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>frule</span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset_eq_length|fact"><span>mset_eq_length</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>unfold_locales</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_SPEC.mcomb|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_SPEC.arity|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_SPEC.itype|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_SPEC.pat|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_SPEC.mcomb|thm"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_SPEC.arity|thm"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_SPEC.itype|thm"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_SPEC.pat|thm"><span>sepref_register</span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="Sorting_Par_Partition.html#offset_5091..5101"><span>ppart_SPEC</span></a></span><span>   
       
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_seq1_refine|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.ppart_seq1_refine|thm"><span class="entity_def" id="offset_44037..44054">ppart_seq1_refine</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_43572..43582"><span>ppart_seq1</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_5091..5101"><span>ppart_SPEC</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="main"><span>⟨</span></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_43560..43570"><span>ppart_seq1_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_43484..43491"><span>gpartition_SPEC_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_43484..43491"><span>ppart_SPEC_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_43715..43744"><span>gpartition_all_imp_ppart_spec</span></a><span class="main"><span>)</span></span><span>

  </span><span class="comment1"><span>(*
    Refinement to match technical requirements of Sepref:
    
    Recursion must not rely on frame (all used parameters must be arguments to recursive function)
    Pivot element must be explicitly copied
    
    If doing sequential partitioning, the result must be converted from iv to ivl. 
    We currently do that by op_set_union_disj _ {}, and a custom_fold to include the length parameter.
    TODO: a iv_to_ivl conversion operator would not need the custom fold, 
    and save the (trivial) disjoint side-condition that, nevertheless, has to be solved by sepref
  *)</span></span><span>  
    
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.gpartition_slices2_def|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.gpartition_slices2_def|thm"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.gpartition_slices2_def_raw|axiom"><span class="entity_def" id="offset_44869..44879">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.gpartition_slices2.cong|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.gpartition_slices2.cong|thm"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.gpartition_slices2|const"><span class="entity_def" id="offset_44881..44899">gpartition_slices2</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>len</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/RefineG_Recursion.html#RefineG_Recursion.RECT|const"><span>RECT</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>gpartition_slices</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>d</span></span><span class="main"><span>,</span></span><span class="bound"><span>p</span></span><span class="main"><span>,</span></span><span class="bound"><span>len</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
    </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>d</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
    </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>len</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
    </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>len</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>ss</span></span><span class="main"><span>,</span></span><span class="bound"><span>bs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_5091..5101"><span>ppart_SPEC</span></a><span> </span><span class="bound"><span>p</span></span><span> </span><span class="bound"><span>len</span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>;</span></span><span>
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.op_set_union_disj|const"><span>op_set_union_disj</span></a><span> </span><span class="bound"><span>ss</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span class="main"><span>,</span></span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.op_set_union_disj|const"><span>op_set_union_disj</span></a><span> </span><span class="bound"><span>bs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>si</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="bound"><span>len</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="bound"><span>d</span></span><span class="main"><span>;</span></span><span>
      </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="main"><span>(</span></span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/IICF_Array.html#IICF_Array.WITH_SPLIT|const"><span>WITH_SPLIT</span></a><span> </span><span class="bound"><span>si</span></span><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
        </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>p_copy</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Monadify.html#Sepref_Monadify.COPY|const"><span>COPY</span></a><span> </span><span class="bound"><span>p</span></span><span class="main"><span>;</span></span><span>
        </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>ivs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="main"><span>(</span></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>ivs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Parallel.html#Sepref_Parallel.nres_par|const"><span>nres_par</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>gpartition_slices</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>p</span></span><span class="main"><span>,</span></span><span class="bound"><span>d</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_5091..5101"><span>ppart_SPEC</span></a><span> </span><span class="bound"><span>p</span></span><span> </span><span class="bound"><span>d</span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>d</span></span><span class="main"><span>,</span></span><span class="bound"><span>p</span></span><span class="main"><span>,</span></span><span class="bound"><span>si</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>p_copy</span></span><span class="main"><span>,</span></span><span class="bound"><span>d</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
        </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="bound"><span>ivs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>ivs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span class="main"><span>(</span></span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.iv_incr_elems_abs_bound|const"><span>iv_incr_elems_abs_bound</span></a><span> </span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="bound"><span>si</span></span><span> </span><span class="bound"><span>len</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      </span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>←</span></span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.mop_set_incr_elems|const"><span>mop_set_incr_elems</span></a><span> </span><span class="bound"><span>si</span></span><span> </span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>;</span></span><span>
      
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span class="main"><span>(</span></span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.iv_incr_elems_abs_bound|const"><span>iv_incr_elems_abs_bound</span></a><span> </span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="bound"><span>si</span></span><span> </span><span class="bound"><span>len</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      </span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>←</span></span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.mop_set_incr_elems|const"><span>mop_set_incr_elems</span></a><span> </span><span class="bound"><span>si</span></span><span> </span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>;</span></span><span>
      
      </span><span class="bound"><span>ss</span></span><span class="main"><span>←</span></span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.mop_set_union_disj|const"><span>mop_set_union_disj</span></a><span> </span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>ss<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>;</span></span><span>
      </span><span class="bound"><span>bs</span></span><span class="main"><span>←</span></span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.mop_set_union_disj|const"><span>mop_set_union_disj</span></a><span> </span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>bs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>;</span></span><span>
      
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>ss</span></span><span class="main"><span>,</span></span><span class="bound"><span>bs</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>}</span></span><span>
  </span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span class="main"><span>,</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Monadify.html#Sepref_Monadify.COPY|const"><span>COPY</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>len</span></span></span></span><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.gpartition_slices2_refine|fact"><span class="entity_def" id="Sorting_Par_Partition.weak_ordering.gpartition_slices2_refine|thm"><span class="entity_def" id="offset_45816..45841">gpartition_slices2_refine</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_44881..44899"><span>gpartition_slices2</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_18877..18894"><span>gpartition_slices</span></a><span class="main"><span>)</span></span><span> 
    </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.nat_rel|const"><span>nat_rel</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.nat_rel|const"><span>nat_rel</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="main"><span>⟨</span></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.list_rel|const"><span>list_rel</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="main"><span>⟨</span></span><span class="main"><span>⟨</span></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.list_rel|const"><span>list_rel</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.prod_rel_syn|const"><span>×<span class="hidden">⇩</span><sub>r</sub></span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.prod_rel_syn|const"><span>×<span class="hidden">⇩</span><sub>r</sub></span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_relI|fact"><span>fun_relI</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>goal_cases</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>1</span><span> </span><span class="skolem"><span>d<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="skolem"><span>p<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="skolem"><span>len<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="skolem"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span class="main"><span>)</span></span><span>
    
    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_46066..46072">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>R1</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>R1</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="skolem"><span>d<span class="hidden">⇩</span><sub>0</sub></span></span><span class="main"><span>,</span></span><span class="skolem"><span>p<span class="hidden">⇩</span><sub>0</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>len</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="main"><span>(</span></span><span class="bound"><span>len</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>len</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>::</span></span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list|type"><span>list</span></a><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span> </span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>note</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Heuristics.html#Refine_Heuristics.refine_dref_RELATES|attribute"><span class="operator"><span>refine_dref_RELATES</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Heuristics.html#Refine_Heuristics.RELATESI|fact"><span>RELATESI</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="skolem"><span>R1</span></span></span><span class="main"><span>]</span></span><span>
    
    
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_44869..44879"><span>gpartition_slices2_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_43484..43491"><span>gpartition_slices_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/ISABELLE_HOME/src/HOL/Library/rewrite.ML.html#Rewrite.rewrite|method"><span class="operator"><span>rewrite</span></span></a><span> </span><span class="quasi_keyword"><span>at</span></span><span> </span><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span class="keyword1"><span>let</span></span></span><span> </span><span class="main"><span class="bound"><span class="main"><span class="bound"><span>_</span></span></span></span></span><span> </span><span class="main"><span class="main"><span>=</span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Monadify.html#Sepref_Monadify.COPY|const"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Monadify.html#Sepref_Monadify.COPY|const"><span>COPY</span></a></a><span> </span><span class="main"><span class="main"><span>_</span></span></span><span> </span><span class="keyword1"><span class="keyword1"><span>in</span></span></span><span>  </span><span class="main"><span class="main"><span>_</span></span></span><span>"</span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Let_def|fact"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Let_def|fact"><span>Let_def</span></a></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_rcg|method"><span class="operator"><span>refine_rcg</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Heuristics.html#Refine_Heuristics.refine_dref_type|method"><span class="operator"><span>refine_dref_type</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_46066..46072"><span>R1_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span>
    
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
    
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>






   
</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_46465..46472">context</span></span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.sort_impl_copy_context|locale"><span>sort_impl_copy_context</span></a><span> </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>




  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.swap_o_intv_impl_uncurried_def|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.swap_o_intv_impl_uncurried_def|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.swap_o_intv_impl_uncurried_def_raw|axiom"><span class="entity_def" id="offset_46508..46518">definition</span></span></span></span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Codegen_Preproc.html#LLVM_Codegen_Preproc.llvm_code|attribute"><span class="operator"><span>llvm_code</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.swap_o_intv_impl_uncurried|const"><span>swap_o_intv_impl_uncurried</span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.swap_o_intv_impl|const"><span>swap_o_intv_impl</span></a><span> </span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>


  </span><span class="keyword1"><span class="command"><span>sepref_def</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.par_swap_aux_impl|const"><span>par_swap_aux_impl</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry2|const"><span>uncurry2</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.par_swap_aux|const"><span>par_swap_aux</span></a><span>"</span></span></span><span> 
    </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.ivl_assn_sz|const"><span>ivl_assn_sz</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfdrop|const"><span><span class="hidden">⇧</span><sup>d</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.ivl_assn_sz|const"><span>ivl_assn_sz</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfdrop|const"><span><span class="hidden">⇧</span><sup>d</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="IICF_DS_Array_Idxs.html#IICF_DS_Array_Idxs.oarray_idxs_assn|const"><span>oarray_idxs_assn</span></a><span> </span><span class="free"><span>elem_assn</span></span><span class="main"><span>)</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfdrop|const"><span><span class="hidden">⇧</span><sup>d</sup></span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="IICF_DS_Array_Idxs.html#IICF_DS_Array_Idxs.oarray_idxs_assn|const"><span>oarray_idxs_assn</span></a><span> </span><span class="free"><span>elem_assn</span></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="bound"><span>xsi</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>xsi'</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>xsi'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="bound"><span>xsi</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.par_swap_aux_def|fact"><span>par_swap_aux_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>supply</span></span></span></span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>[</span></span><span class="operator"><span>goals_limit</span></span><span> </span><span class="main"><span class="main"><span>=</span></span></span><span> 1</span><span class="main"><span>]</span></span><span class="main"><span>]</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/ISABELLE_HOME/src/HOL/Library/rewrite.ML.html#Rewrite.rewrite|method"><span class="operator"><span>rewrite</span></span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.RECT_cp_annot|fact"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.RECT_cp_annot|fact"><span>RECT_cp_annot</span></a></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> CP</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="bound"><span>xsi</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>xsi'</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>xsi'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="bound"><span>xsi</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>supply</span></span></span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.sepref_comb_rules|attribute"><span class="operator"><span>sepref_comb_rules</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.hn_RECT_cp_annot_noframe|fact"><span>hn_RECT_cp_annot_noframe</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>supply</span></span></span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref_opt_simps|attribute"><span class="operator"><span>sepref_opt_simps</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_46508..46518"><span>swap_o_intv_impl_uncurried_def</span></a><span class="main"><span>[</span></span><span class="operator"><span>symmetric</span></span><span class="main"><span>]</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.par_swap_aux_impl.refine|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.par_swap_aux_impl_def|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.par_swap_aux_impl.refine_raw|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.par_swap_aux_impl.refine|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.par_swap_aux_impl_def|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.par_swap_aux_impl.refine_raw|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.par_swap_aux_impl_def_raw|axiom"><span>by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref|method"><span class="operator"><span>sepref</span></span></a><span>    
    
  </span><span class="keyword1"><span class="command"><span>sepref_def</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.par_swap_impl|const"><span>par_swap_impl</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry2|const"><span>uncurry2</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.par_swap|const"><span>par_swap</span></a><span>"</span></span></span><span> 
    </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.ivl_assn_sz|const"><span>ivl_assn_sz</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfdrop|const"><span><span class="hidden">⇧</span><sup>d</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.ivl_assn_sz|const"><span>ivl_assn_sz</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfdrop|const"><span><span class="hidden">⇧</span><sup>d</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span class="main"><span>(</span></span><span>arr_assn</span><span class="main"><span>)</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfdrop|const"><span><span class="hidden">⇧</span><sup>d</sup></span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>→</span></a></span><span> </span><span>arr_assn</span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="bound"><span>xsi</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>xsi'</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>xsi'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="bound"><span>xsi</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.par_swap_def|fact"><span>par_swap_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.par_swap_impl.refine|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.par_swap_impl_def|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.par_swap_impl.refine_raw|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.par_swap_impl.refine|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.par_swap_impl_def|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.par_swap_impl.refine_raw|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.par_swap_impl_def_raw|axiom"><span>by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref|method"><span class="operator"><span>sepref</span></span></a><span>
    
    
  </span><span class="keyword1"><span class="command"><span>sepref_definition</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_seq_impl.cong|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_seq_impl.cong|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_seq_impl|const"><span class="entity_def" id="offset_47336..47350">ppart_seq_impl</span></span></span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Codegen_Preproc.html#LLVM_Codegen_Preproc.llvm_inline|attribute"><span class="operator"><span>llvm_inline</span></span></a><span class="main"><span>]</span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry2|const"><span>uncurry2</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_43572..43582"><span>ppart_seq1</span></a><span>"</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span> </span><span class="free"><span>elem_assn</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span>arr_assn</span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfdrop|const"><span><span class="hidden">⇧</span><sup>d</sup></span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>→</span></a></span><span> </span><span>arr_assn</span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.prod_assn|const"><span>×<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.iv_assn_sz|const"><span>iv_assn_sz</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.prod_assn|const"><span>×<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.iv_assn_sz|const"><span>iv_assn_sz</span></a><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="bound"><span>xsi</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xsi'</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>xsi'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="bound"><span>xsi</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_46465..46472"><span>ppart_seq1_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.annot_snat_const|method"><span class="operator"><span>annot_snat_const</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_t|type"><span>size_t</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_seq_impl.refine|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_seq_impl_def|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_seq_impl.refine_raw|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_seq_impl.refine|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_seq_impl_def|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_seq_impl.refine_raw|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_seq_impl_def_raw|axiom"><span class="entity_def" id="offset_47604..47606">by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref|method"><span class="operator"><span>sepref</span></span></a><span>
  
  </span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_seq_impl_hnr|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_seq_impl_hnr|thm"><span>ppart_seq_impl_hnr</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.sepref_fr_rules|attribute"><span class="operator"><span>sepref_fr_rules</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_47604..47606"><span>ppart_seq_impl.refine</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.FCOMP|attribute"><span class="operator"><span>FCOMP</span></span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_44037..44054"><span>ppart_seq1_refine</span></a><span class="main"><span>]</span></span><span>
    

  </span><span class="comment1"><span>(* We fold that, because the parallel operator works only with functions wight now.
    TODO: use automatic extraction (like for REC) to extract functions from parallel operator upon code generation!
  *)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_seq1_impl_uncurried_def|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_seq1_impl_uncurried_def|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_seq1_impl_uncurried_def_raw|axiom"><span class="entity_def" id="offset_47926..47936">definition</span></span></span></span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Codegen_Preproc.html#LLVM_Codegen_Preproc.llvm_code|attribute"><span class="operator"><span>llvm_code</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_seq1_impl_uncurried.cong|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_seq1_impl_uncurried.cong|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_seq1_impl_uncurried|const"><span>ppart_seq1_impl_uncurried</span></span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>p</span></span><span class="main"><span>,</span></span><span class="bound"><span>d</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_47336..47350"><span>ppart_seq_impl</span></a><span> </span><span class="bound"><span>p</span></span><span> </span><span class="bound"><span>d</span></span><span> </span><span class="bound"><span>xs</span></span><span>"</span></span></span><span>
    
  
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.gpartition_slices.mcomb|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.gpartition_slices.arity|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.gpartition_slices.itype|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.gpartition_slices.pat|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.gpartition_slices.mcomb|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.gpartition_slices.arity|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.gpartition_slices.itype|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.gpartition_slices.pat|thm"><span>sepref_register</span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="Sorting_Par_Partition.html#offset_18877..18894"><span>gpartition_slices</span></a></span><span>
  
  </span><span class="keyword1"><span class="command"><span>sepref_definition</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.gpartition_slices_impl.cong|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.gpartition_slices_impl.cong|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.gpartition_slices_impl|const"><span>gpartition_slices_impl</span></span></span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Codegen_Preproc.html#LLVM_Codegen_Preproc.llvm_code|attribute"><span class="operator"><span>llvm_code</span></span></a><span class="main"><span>]</span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry3|const"><span>uncurry3</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_44881..44899"><span>gpartition_slices2</span></a><span>"</span></span></span><span> </span><span class="main"><span>::</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span class="free"><span>elem_assn</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span>arr_assn</span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfdrop|const"><span><span class="hidden">⇧</span><sup>d</sup></span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>→</span></a></span><span> </span><span>arr_assn</span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.prod_assn|const"><span>×<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.ivl_assn_sz|const"><span>ivl_assn_sz</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.prod_assn|const"><span>×<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.ivl_assn_sz|const"><span>ivl_assn_sz</span></a><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="bound"><span>xsi</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xsi'</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>xsi'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="bound"><span>xsi</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_46465..46472"><span>gpartition_slices2_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>supply</span></span></span></span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>[</span></span><span class="operator"><span>goals_limit</span></span><span> </span><span class="main"><span class="main"><span>=</span></span></span><span> 1</span><span class="main"><span>]</span></span><span class="main"><span>]</span></span><span>
    
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/ISABELLE_HOME/src/HOL/Library/rewrite.ML.html#Rewrite.rewrite|method"><span class="operator"><span>rewrite</span></span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.RECT_cp_annot|fact"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.RECT_cp_annot|fact"><span>RECT_cp_annot</span></a></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> CP</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="bound"><span>xsi</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xsi'</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>xsi'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="bound"><span>xsi</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/ISABELLE_HOME/src/HOL/Library/rewrite.ML.html#Rewrite.rewrite|method"><span class="operator"><span>rewrite</span></span></a><span> </span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.ivl_fold_custom_empty|fact"><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.ivl_fold_custom_empty|fact"><span>ivl_fold_custom_empty</span></a></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> </span><span class="tfree"><span>'l</span></span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_t|type"><span class="quoted"><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_t|type"><span class="quoted"><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_t|type"><span>size_t</span></a></span></a></span></a></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/ISABELLE_HOME/src/HOL/Library/rewrite.ML.html#Rewrite.rewrite|method"><span class="operator"><span>rewrite</span></span></a><span> </span><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.ivl_fold_custom_empty|fact"><a class="entity_ref" href="IICF_DS_Interval_List.html#IICF_DS_Interval_List.ivl_fold_custom_empty|fact"><span>ivl_fold_custom_empty</span></a></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> </span><span class="tfree"><span>'l</span></span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_t|type"><span class="quoted"><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_t|type"><span class="quoted"><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_t|type"><span>size_t</span></a></span></a></span></a></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>supply</span></span></span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.sepref_comb_rules|attribute"><span class="operator"><span>sepref_comb_rules</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.hn_RECT_cp_annot_noframe|fact"><span>hn_RECT_cp_annot_noframe</span></a><span>
    
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>supply</span></span></span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref_opt_simps|attribute"><span class="operator"><span>sepref_opt_simps</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_47926..47936"><span>ppart_seq1_impl_uncurried_def</span></a><span class="main"><span>[</span></span><span class="operator"><span>symmetric</span></span><span class="main"><span>]</span></span><span>
    
    
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.gpartition_slices_impl.refine|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.gpartition_slices_impl_def|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.gpartition_slices_impl.refine_raw|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.gpartition_slices_impl.refine|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.gpartition_slices_impl_def|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.gpartition_slices_impl.refine_raw|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.gpartition_slices_impl_def_raw|axiom"><span class="entity_def" id="offset_48731..48733">by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref|method"><span class="operator"><span>sepref</span></span></a><span> </span><span class="comment1"><span>(* Takes looooong ~30 sec *)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>context</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>notes</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.fcomp_norm_simps|attribute"><span class="operator"><span>fcomp_norm_simps</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.list_rel_id_simp|fact"><span>list_rel_id_simp</span></a><span>
  </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>    

    </span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.gpartition_slices_hnr|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.gpartition_slices_hnr|thm"><span>gpartition_slices_hnr</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.sepref_fr_rules|attribute"><span class="operator"><span>sepref_fr_rules</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_48731..48733"><span>gpartition_slices_impl.refine</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.FCOMP|attribute"><span class="operator"><span>FCOMP</span></span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_45816..45841"><span>gpartition_slices2_refine</span></a><span class="main"><span>]</span></span><span>

  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>  
    

  </span><span class="keyword1"><span class="command"><span>thm</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_46465..46472"><span>ppart_filter_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_filter_alt|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_filter_alt|thm"><span class="entity_def" id="offset_49003..49019">ppart_filter_alt</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.weak_ordering.ppart_filter|const"><span>ppart_filter</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>ss</span></span><span> </span><span class="free"><span>bs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span> </span><span class="free"><span>ss</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>∩</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeast|const"><span>{</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeast|const"><span>..}</span></a></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>bs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>∩</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span> </span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_46465..46472"><span>ppart_filter_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
  
  </span><span class="keyword1"><span class="command"><span>sepref_def</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_filter_impl|const"><span>ppart_filter_impl</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry2|const"><span>uncurry2</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp3|const"><span>ooo</span></a></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.weak_ordering.ppart_filter|const"><span>ppart_filter</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.ivl_assn_sz|const"><span>ivl_assn_sz</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfdrop|const"><span><span class="hidden">⇧</span><sup>d</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.ivl_assn_sz|const"><span>ivl_assn_sz</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfdrop|const"><span><span class="hidden">⇧</span><sup>d</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefttnd|const"><span>→<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.ivl_assn_sz|const"><span>ivl_assn_sz</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.prod_assn|const"><span>×<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#Sorting_Par_Partition.ivl_assn_sz|const"><span>ivl_assn_sz</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_49003..49019"><span>ppart_filter_alt</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.annot_snat_const|method"><span class="operator"><span>annot_snat_const</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_t|type"><span>size_t</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_filter_impl.refine|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_filter_impl_def|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_filter_impl.refine_raw|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_filter_impl.refine|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_filter_impl_def|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_filter_impl.refine_raw|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_filter_impl_def_raw|axiom"><span>by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref|method"><span class="operator"><span>sepref</span></span></a><span>
    
        
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart2.mcomb|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart2.arity|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart2.itype|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart2.pat|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart2.mcomb|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart2.arity|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart2.itype|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart2.pat|thm"><span>sepref_register</span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="Sorting_Par_Partition.html#offset_37626..37632"><span>ppart2</span></a></span><span>  
  </span><span class="keyword1"><span class="command"><span>sepref_def</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_impl.cong|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_impl.cong|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_impl|const"><span>ppart_impl</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry3|const"><span>uncurry3</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_37626..37632"><span>ppart2</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span class="free"><span>elem_assn</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span>arr_assn</span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfdrop|const"><span><span class="hidden">⇧</span><sup>d</sup></span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.prod_assn|const"><span>×<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span>arr_assn</span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="bound"><span>xsi</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="bound"><span>ri</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>ri</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="bound"><span>xsi</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_46465..46472"><span>ppart2_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_impl.refine|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_impl_def|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_impl.refine_raw|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_impl.refine|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_impl_def|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_impl.refine_raw|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_impl_def_raw|axiom"><span class="entity_def" id="offset_49642..49644">by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref|method"><span class="operator"><span>sepref</span></span></a><span>

  </span><span class="keyword1"><span class="command"><span>find_theorems</span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="Sorting_Par_Partition.html#offset_14512..14518"><span>ppart1</span></a></span><span>
    
  </span><span class="keyword1"><span class="command"><span>thm</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_49642..49644"><span>ppart_impl.refine</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_37821..37834"><span>ppart2_refine</span></a><span>  
  </span><span class="comment1"><span>(* TODO: Find out what is needed for sorting, and assemble! *)</span></span><span>      
  
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_partition_pivot_par.mcomb|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_partition_pivot_par.arity|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_partition_pivot_par.itype|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_partition_pivot_par.pat|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_partition_pivot_par.mcomb|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_partition_pivot_par.arity|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_partition_pivot_par.itype|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_partition_pivot_par.pat|thm"><span>sepref_register</span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="Sorting_Par_Partition.html#offset_38319..38344"><span>ppart_partition_pivot_par</span></a></span><span>
  </span><span class="keyword1"><span class="command"><span>sepref_def</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_partition_pivot_par_impl.cong|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_partition_pivot_par_impl.cong|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_partition_pivot_par_impl|const"><span>ppart_partition_pivot_par_impl</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry2|const"><span>uncurry2</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_38319..38344"><span>ppart_partition_pivot_par</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span>arr_assn</span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfdrop|const"><span><span class="hidden">⇧</span><sup>d</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>→</span></a></span><span> </span><span>arr_assn</span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.prod_assn|const"><span>×<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="bound"><span>xsi</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xsi'</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>xsi'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="bound"><span>xsi</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_46465..46472"><span>ppart_partition_pivot_par_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_46465..46472"><span>move_pivot_to_first_sample_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.annot_snat_const|method"><span class="operator"><span>annot_snat_const</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_t|type"><span>size_t</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_partition_pivot_par_impl.refine|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_partition_pivot_par_impl_def|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_partition_pivot_par_impl.refine_raw|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_partition_pivot_par_impl.refine|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_partition_pivot_par_impl_def|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_partition_pivot_par_impl.refine_raw|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_partition_pivot_par_impl_def_raw|axiom"><span>by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref|method"><span class="operator"><span>sepref</span></span></a><span>


  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_partition_pivot.mcomb|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_partition_pivot.arity|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_partition_pivot.itype|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_partition_pivot.pat|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_partition_pivot.mcomb|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_partition_pivot.arity|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_partition_pivot.itype|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_partition_pivot.pat|thm"><span>sepref_register</span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="Sorting_Par_Partition.html#offset_41350..41371"><span>ppart_partition_pivot</span></a></span><span>
  </span><span class="keyword1"><span class="command"><span>sepref_def</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_partition_pivot_impl.cong|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_partition_pivot_impl.cong|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_partition_pivot_impl|const"><span>ppart_partition_pivot_impl</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry2|const"><span>uncurry2</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_41350..41371"><span>ppart_partition_pivot</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span>arr_assn</span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfdrop|const"><span><span class="hidden">⇧</span><sup>d</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>→</span></a></span><span> </span><span>arr_assn</span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.prod_assn|const"><span>×<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="bound"><span>xsi</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xsi'</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>xsi'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="bound"><span>xsi</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_46465..46472"><span>ppart_partition_pivot_def</span></a><span> </span><a class="entity_ref" href="Sorting_Par_Partition.html#offset_46465..46472"><span>align_chunk_size_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.annot_snat_const|method"><span class="operator"><span>annot_snat_const</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_t|type"><span>size_t</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_partition_pivot_impl.refine|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_partition_pivot_impl_def|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_partition_pivot_impl.refine_raw|fact"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_partition_pivot_impl.refine|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_partition_pivot_impl_def|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_partition_pivot_impl.refine_raw|thm"><span class="entity_def" id="Sorting_Par_Partition.sort_impl_copy_context.ppart_partition_pivot_impl_def_raw|axiom"><span>by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref|method"><span class="operator"><span>sepref</span></span></a><span>
    
    
  
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>      
    

</span><span class="comment1"><span>(*
global_interpretation test: sort_impl_copy_context "(≤)" "(&lt;)" ll_icmp_ult "unat_assn' TYPE(size_t)" Mreturn free_pure
  defines test_ppart_impl = test.ppart_impl
      and test_ppart_partition_pivot_par_impl = test.ppart_partition_pivot_par_impl
      and test_par_swap_impl = test.par_swap_impl
      and test_gpartition_slices_impl = test.gpartition_slices_impl
      and test_ppart_seq1_impl_uncurried = test.ppart_seq1_impl_uncurried (* TODO: Workaround, as templating seems to choke on llc_par! *)
  apply unfold_locales
  apply (auto simp: mk_free_pure free_pure_def[abs_def])
  apply rule apply sepref
  apply (rule is_copy_pure_gen_algo) apply solve_constraint
  done
  
declare [[llc_compile_par_call=true]]
export_llvm (timing) test_ppart_partition_pivot_par_impl
*)</span></span><span>


</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span></pre>
</body>

</html>