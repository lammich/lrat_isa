<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Sorting_Guarded_Partition</title>
</head>


<body>
<div class="head">
<h1>Theory Sorting_Guarded_Partition</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><a href="Sorting_Guarded_Partition.html"><span>Sorting_Guarded_Partition</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> </span><a href="Sorting_Quicksort_Scheme.html"><span>Sorting_Quicksort_Scheme</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="comment1"><span>(* TODO: Move *)</span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Guarded_Partition.slice_update_outside|fact"><span class="entity_def" id="Sorting_Guarded_Partition.slice_update_outside|thm"><span>slice_update_outside</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.not_member|const"><span>∉</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><span>[</span></span><span class="free"><span>i</span></span><span class="main"><span>:=</span></span><span class="free"><span>x</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice_def|fact"><span>Misc.slice_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.drop_take|fact"><span>drop_take</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.linorder_class.leI|fact"><span>leI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.take_update_cancel|fact"><span>take_update_cancel</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Guarded_Partition.slice_eq_mset_upd_outside|fact"><span class="entity_def" id="Sorting_Guarded_Partition.slice_eq_mset_upd_outside|thm"><span>slice_eq_mset_upd_outside</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset|const"><span>slice_eq_mset</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.not_member|const"><span>∉</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset|const"><span>slice_eq_mset</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><span>[</span></span><span class="free"><span>i</span></span><span class="main"><span>:=</span></span><span class="free"><span>x</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs'</span></span><span class="main"><span>[</span></span><span class="free"><span>i</span></span><span class="main"><span>:=</span></span><span class="free"><span>x</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_def|fact"><span>slice_eq_mset_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.drop_update_swap|fact"><span>drop_update_swap</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.linorder_class.not_le|fact"><span>not_le</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.drop_update_cancel|fact"><span>drop_update_cancel</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.drop_update_swap|fact"><span>drop_update_swap</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.linorder_class.leI|fact"><span>leI</span></a><span class="main"><span>)</span></span><span>



  
</span><span class="keyword1"><span class="command"><span>hide_const</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>open</span></span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Transcendental.html#Transcendental.pi|const"><span>Transcendental.pi</span></a><span> </span><span class="comment1"><span>― ‹</span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>pi›</span></span></span><span> is the implementation of </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>p›</span></span></span><span>, not some constant related to a circle ;)›</span></span><span>

</span><span class="comment1"><span>(* TODO: Move. Found useful for ATPs *)</span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Guarded_Partition.strict_itrans|fact"><span class="entity_def" id="Sorting_Guarded_Partition.strict_itrans|thm"><span>strict_itrans</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>c</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>_</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.linorder|class"><span>linorder</span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

</span><span class="comment1"><span>(* Guarded partitioning scheme, using sentinels. *)</span></span><span>  
  
  

</span><span class="keyword1"><span class="command"><span>context</span></span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.weak_ordering|locale"><span>weak_ordering</span></a><span> </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>  
  
</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Hoare Partitioning Scheme›</span></span></span><span>  


</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.ungrd_qsg_next_l_spec_def|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.ungrd_qsg_next_l_spec_def|thm"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.ungrd_qsg_next_l_spec_def_raw|axiom"><span class="entity_def" id="offset_903..913">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.ungrd_qsg_next_l_spec.cong|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.ungrd_qsg_next_l_spec.cong|thm"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.ungrd_qsg_next_l_spec|const"><span class="entity_def" id="offset_915..936">ungrd_qsg_next_l_spec</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>si</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> 
  </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
    </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>si</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>si</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>si</span></span></span></span><span> </span><span class="main"><span><span class="hidden">❙</span><b>≥</b></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
    </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>li'</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="bound"><span>li'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>li'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>si</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="bound"><span>li'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>&lt;</b></span></span></span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>li'</span></span><span class="main"><span><span class="hidden">❙</span><b>≥</b></span></span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>}</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.ungrd_qsg_next_h_spec_def|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.ungrd_qsg_next_h_spec_def|thm"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.ungrd_qsg_next_h_spec_def_raw|axiom"><span class="entity_def" id="offset_1089..1099">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.ungrd_qsg_next_h_spec.cong|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.ungrd_qsg_next_h_spec.cong|thm"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.ungrd_qsg_next_h_spec|const"><span class="entity_def" id="offset_1101..1122">ungrd_qsg_next_h_spec</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>si</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> 
  </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
    </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>si</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>si</span></span></span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
    </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>hi'</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>si</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="bound"><span>hi'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>hi'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>hi</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>{</span></a></span><span class="bound"><span>hi'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>&lt;..&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>hi</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span class="main"><span><span class="hidden">❙</span><b>&gt;</b></span></span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>hi'</span></span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  
  
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_next_l_def|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_next_l_def|thm"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_next_l_def_raw|axiom"><span class="entity_def" id="offset_1279..1289">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_next_l.cong|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_next_l.cong|thm"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_next_l|const"><span class="entity_def" id="offset_1290..1300">qsg_next_l</span></span></span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list|type"><span>list</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres|type"><span>nres</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>            
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>qsg_next_l</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>si</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
    </span><a class="entity_ref" href="../Isabelle_LLVM/Refine_Monadic_Add.html#Refine_Monadic_Add.monadic_WHILEIT|const"><span>monadic_WHILEIT</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>li'</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="bound"><span>li'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="bound"><span>li'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>&lt;</b></span></span></span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>li'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>si</span></span></span></span><span class="main"><span>)</span></span><span> 
      </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>li</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span> </span><span>mop_cmp_idx_v</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="bound"><span>li</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>li</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>li</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>si</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>li</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span>
  </span><span class="main"><span>}</span></span><span>"</span></span></span><span>  

  
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_next_l_refine|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_next_l_refine|thm"><span class="entity_def" id="offset_1576..1593">qsg_next_l_refine</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_1290..1300"><span>qsg_next_l</span></a><span class="main"><span>,</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_915..936"><span>ungrd_qsg_next_l_spec</span></a><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span class="main"><span>⟨</span></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_1279..1289"><span>qsg_next_l_def</span></a><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_903..913"><span>ungrd_qsg_next_l_spec_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_relI|fact"><span>fun_relI</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> si xs p li
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.monadic_WHILEIT_rule|fact"><span>monadic_WHILEIT_rule</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> R</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Wellfounded.html#Wellfounded.measure|const"><span>measure</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>li</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>si</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="bound"><span>li</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.split_ifI|fact"><span>split_ifI</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.le_eq_less_or_eq|fact"><span>le_eq_less_or_eq</span></a><span> </span><span>wo_leD</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan_iff|fact"><span>atLeastLessThan_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.less_Suc_eq|fact"><span>less_Suc_eq</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.diff_less_mono2|fact"><span>diff_less_mono2</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.lessI|fact"><span>lessI</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>wo_not_le_imp_less</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>


</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_next_h_def|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_next_h_def|thm"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_next_h_def_raw|axiom"><span class="entity_def" id="offset_2114..2124">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_next_h.cong|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_next_h.cong|thm"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_next_h|const"><span class="entity_def" id="offset_2125..2135">qsg_next_h</span></span></span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list|type"><span>list</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres|type"><span>nres</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>qsg_next_h</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>si</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
    </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>hi</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
    </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>hi</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>;</span></span><span>
    </span><a class="entity_ref" href="../Isabelle_LLVM/Refine_Monadic_Add.html#Refine_Monadic_Add.monadic_WHILEIT|const"><span>monadic_WHILEIT</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>hi'</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>si</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="bound"><span>hi'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>hi'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="bound"><span>hi</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanAtMost|const"><span>{</span></a></span><span class="bound"><span>hi'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanAtMost|const"><span>&lt;..</span></a></span><span class="bound"><span>hi</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanAtMost|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span class="main"><span><span class="hidden">❙</span><b>&gt;</b></span></span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>hi</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span> </span><span>mop_cmp_v_idx</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="bound"><span>hi</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>hi</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span class="main"><span>(</span></span><span class="bound"><span>hi</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>hi</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>hi</span></span><span>
  </span><span class="main"><span>}</span></span><span>"</span></span></span><span>  

  
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_next_h_refine|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_next_h_refine|thm"><span class="entity_def" id="offset_2433..2450">qsg_next_h_refine</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_2125..2135"><span>qsg_next_h</span></a><span class="main"><span>,</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_1101..1122"><span>ungrd_qsg_next_h_spec</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="main"><span>⟨</span></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_2114..2124"><span>qsg_next_h_def</span></a><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_1089..1099"><span>ungrd_qsg_next_h_spec_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.monadic_WHILEIT_rule|fact"><span>monadic_WHILEIT_rule</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> R</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Wellfounded.html#Wellfounded.measure|const"><span>measure</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.id|const"><span>id</span></a><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.split_ifI|fact"><span>split_ifI</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Eisbach.Eisbach.html#Eisbach.all|method"><span class="operator"><span>all</span></span></a><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Eisbach.Eisbach.html#Eisbach.determ|method"><span class="operator"><span>determ</span></span></a><span> </span><span class="quoted"><span>‹</span><span class="operator"><span>elim</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjE|fact"><span>conjE</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.exE|fact"><span>exE</span></a><span>›</span></span><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span>›</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.bot_nat_0.extremum_uniqueI|fact"><span>bot_nat_0.extremum_uniqueI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.gr0I|fact"><span>gr0I</span></a><span> </span><span>wo_leD</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.One_nat_def|fact"><span>One_nat_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Word_Lib.Many_More.html#Many_More.le_step_down_nat|fact"><span>le_step_down_nat</span></a><span> </span><span>wo_leD</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc_le_eq|fact"><span>Suc_le_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc_pred|fact"><span>Suc_pred</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanAtMost_iff|fact"><span>greaterThanAtMost_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.less_Suc_eq|fact"><span>less_Suc_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.less_Suc_eq_le|fact"><span>less_Suc_eq_le</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.greaterThanAtMost_upt|fact"><span>greaterThanAtMost_upt</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>unfold_le_to_lt</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Presburger.html#Presburger.presburger|method"><span class="operator"><span>presburger</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
  

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.ungrd_qsg_next_lh_spec_def|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.ungrd_qsg_next_lh_spec_def|thm"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.ungrd_qsg_next_lh_spec_def_raw|axiom"><span class="entity_def" id="offset_3045..3055">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.ungrd_qsg_next_lh_spec.cong|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.ungrd_qsg_next_lh_spec.cong|thm"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.ungrd_qsg_next_lh_spec|const"><span class="entity_def" id="offset_3057..3079">ungrd_qsg_next_lh_spec</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>si0</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>siN</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
  </span><span class="bound"><span>li</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_915..936"><span>ungrd_qsg_next_l_spec</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>siN</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span class="main"><span>;</span></span><span>
  </span><span class="bound"><span>hi</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_1101..1122"><span>ungrd_qsg_next_h_spec</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>si0</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi</span></span></span></span><span class="main"><span>;</span></span><span>
  </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>li</span></span><span class="main"><span>,</span></span><span class="bound"><span>hi</span></span><span class="main"><span>)</span></span><span>
</span><span class="main"><span>}</span></span><span>"</span></span></span><span>  

</span><span class="comment1"><span>(* Situation at start, and after swaps *)</span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_part_assn1_def|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_part_assn1_def|thm"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_part_assn1_def_raw|axiom"><span class="entity_def" id="offset_3256..3266">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_part_assn1.cong|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_part_assn1.cong|thm"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_part_assn1|const"><span class="entity_def" id="offset_3268..3282">qsg_part_assn1</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span>
    </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span class="bound"><span class="entity"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span>
  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset|const"><span>slice_eq_mset</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span>
  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span class="bound"><span class="entity"><span>hi</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span class="bound"><span class="entity"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span>
  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span class="bound"><span class="entity"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span class="main"><span>)</span></span><span> 
  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span class="bound"><span class="entity"><span>hi</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> 
"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_part_assn2_def|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_part_assn2_def|thm"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_part_assn2_def_raw|axiom"><span class="entity_def" id="offset_3528..3538">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_part_assn2.cong|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_part_assn2.cong|thm"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_part_assn2|const"><span class="entity_def" id="offset_3540..3554">qsg_part_assn2</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span>
    </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span class="bound"><span class="entity"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span>
  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset|const"><span>slice_eq_mset</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span>
  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span class="bound"><span class="entity"><span>hi</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span class="bound"><span class="entity"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span>
  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span class="bound"><span class="entity"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span class="main"><span>)</span></span><span> 
  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>{</span></a></span><span class="free"><span class="bound"><span class="entity"><span>hi</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>&lt;..&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> 
  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span> </span><span class="main"><span><span class="hidden">❙</span><b>≥</b></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span>
  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>hi</span></span></span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span>  
"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_part_12_aux|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_part_12_aux(3)|thm"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_part_12_aux(2)|thm"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_part_12_aux(1)|thm"><span class="entity_def" id="offset_3851..3866">qsg_part_12_aux</span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>SENTINELS</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span>p</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>p</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span> </span><span class="free"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>LI_LE_HI</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>li</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>hi</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>LI'_BOUND</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>li</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>li'</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>li'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>HI'_BOUND</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>hi'</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>hi'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>hi</span></span><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> 
  </span><span class="entity_def" id="offset_4075..4082">UPTO_LI</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>li</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span>p</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>
  </span><span class="entity_def" id="offset_4120..4129">LI_TO_LI'</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>li</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>li'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>&lt;</b></span></span></span><span> </span><span class="free"><span>p</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>
  </span><span class="entity_def" id="offset_4166..4175">DOWNTO_HI</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>hi</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span> </span><span class="bound"><span>i</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>
  </span><span class="entity_def" id="offset_4213..4222">HI'_TO_HI</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>{</span></a></span><span class="free"><span>hi'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>&lt;..&lt;</span></a></span><span class="free"><span>hi</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>&lt;</b></span></span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span> </span><span class="bound"><span>i</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>li'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="free"><span>hi'</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>li'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>{</span></a></span><span class="free"><span>hi'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>&lt;..&lt;</span></a></span><span class="free"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>

  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="entity_def" id="offset_4361..4363">G1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>li'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_4075..4082"><span>UPTO_LI</span></a><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_4120..4129"><span>LI_TO_LI'</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>unfold_lt_to_le</span><span class="main"><span>)</span></span><span>
  
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="entity_def" id="offset_4464..4466">G2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>{</span></a></span><span class="free"><span>hi'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>&lt;..&lt;</span></a></span><span class="free"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_4213..4222"><span>HI'_TO_HI</span></a><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_4166..4175"><span>DOWNTO_HI</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>unfold_lt_to_le</span><span class="main"><span>)</span></span><span>
  
  </span><span class="keyword1"><span class="command"><span>consider</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>li</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>li'</span></span><span>"</span></span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>hi'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>hi</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span>"</span></span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>li'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span>li</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>hi'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span>hi</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>hi'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>hi</span></span><span>›</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>li</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>li'</span></span><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/lin_arith.ML.html#Fields.linarith|method"><span class="operator"><span>linarith</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>li'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="free"><span>hi'</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>1</span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="main"><span>(</span></span><span class="free"><span>li'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>&lt;</b></span></span></span><span> </span><span class="free"><span>p</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_4120..4129"><span>LI_TO_LI'</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanAtMost|const"><span>{</span></a></span><span class="free"><span>hi'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanAtMost|const"><span>&lt;..</span></a></span><span class="free"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanAtMost|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>p</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span> </span><span class="free"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span><span>›</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_4464..4466"><span>G2</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanAtMost_iff|fact"><span>greaterThanAtMost_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan_iff|fact"><span>greaterThanLessThan_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.le_eq_less_or_eq|fact"><span>le_eq_less_or_eq</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>li'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span><span>›</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc_leD|fact"><span>Suc_leD</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc_lessE|fact"><span>Suc_lessE</span></a><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>li'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>&lt;</b></span></span></span><span> </span><span class="free"><span>p</span></span><span>›</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.diff_Suc_1|fact"><span>diff_Suc_1</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanAtMost_iff|fact"><span>greaterThanAtMost_iff</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Word_Lib.Legacy_Aliases.html#Legacy_Aliases.le_def|fact"><span>le_def</span></a><span> </span><span>unfold_lt_to_le</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>2</span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>p</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>&lt;</b></span></span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="main"><span>(</span></span><span class="free"><span>hi'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_4213..4222"><span>HI'_TO_HI</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span>li'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_4361..4363"><span>G1</span></a><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span>p</span></span><span>›</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan_iff|fact"><span>atLeastLessThan_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.le_antisym|fact"><span>le_antisym</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.le_refl|fact"><span>le_refl</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Word_Lib.Many_More.html#Many_More.nat_le_Suc_less_imp|fact"><span>nat_le_Suc_less_imp</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat_less_le|fact"><span>nat_less_le</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat_neq_iff|fact"><span>nat_neq_iff</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>hi'</span></span><span>›</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Meson/meson_tactic.ML.html#Meson.meson|method"><span class="operator"><span>meson</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan_iff|fact"><span>atLeastLessThan_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.le_SucI|fact"><span>le_SucI</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Word_Lib.Legacy_Aliases.html#Legacy_Aliases.le_def|fact"><span>le_def</span></a><span> </span><span>unfold_lt_to_le</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>3</span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>li</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span>hi</span></span><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/lin_arith.ML.html#Fields.linarith|method"><span class="operator"><span>linarith</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>  

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_part_12|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_part_12|thm"><span class="entity_def" id="offset_5623..5634">qsg_part_12</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_3268..3282"><span>qsg_part_assn1</span></a><span> </span><span class="free"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="free"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="free"><span>li</span></span><span> </span><span class="free"><span>hi</span></span><span> </span><span class="free"><span>xs</span></span><span> 
  </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_3057..3079"><span>ungrd_qsg_next_lh_spec</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>li</span></span><span> </span><span class="free"><span>hi</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>li'</span></span><span class="main"><span>,</span></span><span class="bound"><span>hi'</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span>
    </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_3540..3554"><span>qsg_part_assn2</span></a><span> </span><span class="free"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="free"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="bound"><span>li'</span></span><span> </span><span class="bound"><span>hi'</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>hi'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>hi</span></span><span>
     </span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_3045..3055"><span>ungrd_qsg_next_lh_spec_def</span></a><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_903..913"><span>ungrd_qsg_next_l_spec_def</span></a><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_1089..1099"><span>ungrd_qsg_next_h_spec_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_3256..3266"><span>qsg_part_assn1_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_eq_length|fact"><span>slice_eq_mset_eq_length</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.hd_drop_conv_nth|fact"><span>hd_drop_conv_nth</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_def|fact"><span>slice_eq_mset_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/lin_arith.ML.html#Fields.linarith|method"><span class="operator"><span>linarith</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> i
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_nth_outside|fact"><span>slice_eq_mset_nth_outside</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.diff_diff_cancel|fact"><span>diff_diff_cancel</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.less_imp_diff_less|fact"><span>less_imp_diff_less</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_eq_length|fact"><span>slice_eq_mset_eq_length</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> hi' li'  
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_3528..3538"><span>qsg_part_assn2_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_3851..3866"><span>qsg_part_12_aux</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_3851..3866"><span>qsg_part_12_aux</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>  

  
  
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_partition_aux_def|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_partition_aux_def|thm"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_partition_aux_def_raw|axiom"><span class="entity_def" id="offset_6416..6426">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_partition_aux.cong|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_partition_aux.cong|thm"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_partition_aux|const"><span class="entity_def" id="offset_6428..6445">qsg_partition_aux</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
  </span><span class="comment1"><span>― ‹Initialize›</span></span><span>
  </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
  </span><span class="main"><span>(</span></span><span class="bound"><span>li</span></span><span class="main"><span>,</span></span><span class="bound"><span>hi</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_3057..3079"><span>ungrd_qsg_next_lh_spec</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><span>;</span></span><span>
  
  </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>li</span></span><span class="main"><span>,</span></span><span class="bound"><span>hi</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_While.html#Refine_While.WHILEIT|const"><span>WHILEIT</span></a><span> 
    </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>li</span></span><span class="main"><span>,</span></span><span class="bound"><span>hi</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_3540..3554"><span>qsg_part_assn2</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="bound"><span>li</span></span><span> </span><span class="bound"><span>hi</span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>li</span></span><span class="main"><span>,</span></span><span class="bound"><span>hi</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>li</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>hi</span></span><span class="main"><span>)</span></span><span> 
    </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>li</span></span><span class="main"><span>,</span></span><span class="bound"><span>hi</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span class="main"><span>(</span></span><span class="bound"><span>li</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>hi</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>li</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>hi</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>li</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="bound"><span>hi</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/IICF_List.html#IICF_List.mop_list_swap|const"><span>mop_list_swap</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>li</span></span><span> </span><span class="bound"><span>hi</span></span><span class="main"><span>;</span></span><span>
      </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>li</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="bound"><span>li</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>;</span></span><span>
      
      </span><span class="main"><span>(</span></span><span class="bound"><span>li</span></span><span class="main"><span>,</span></span><span class="bound"><span>hi</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_3057..3079"><span>ungrd_qsg_next_lh_spec</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="bound"><span>li</span></span><span> </span><span class="bound"><span>hi</span></span><span class="main"><span>;</span></span><span>
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>li</span></span><span class="main"><span>,</span></span><span class="bound"><span>hi</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> 
    </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><span>,</span></span><span class="bound"><span>li</span></span><span class="main"><span>,</span></span><span class="bound"><span>hi</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
  
  </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>li</span></span><span class="main"><span>)</span></span><span>
</span><span class="main"><span>}</span></span><span>"</span></span></span><span>  


</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.gpartition_spec_def|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.gpartition_spec_def|thm"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.gpartition_spec_def_raw|axiom"><span class="entity_def" id="offset_6977..6987">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.gpartition_spec.cong|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.gpartition_spec.cong|thm"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.gpartition_spec|const"><span class="entity_def" id="offset_6989..7004">gpartition_spec</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs'</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> 
    </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset|const"><span>slice_eq_mset</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs'</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> 
  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastAtMost|const"><span>{</span></a></span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastAtMost|const"><span>..</span></a></span><span class="free"><span class="bound"><span class="entity"><span>hi</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastAtMost|const"><span>}</span></a></span><span>
  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs'</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>hi</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs'</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>


</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.gpartition_SPEC_def|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.gpartition_SPEC_def|thm"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.gpartition_SPEC_def_raw|axiom"><span class="entity_def" id="offset_7135..7145">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.gpartition_SPEC.cong|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.gpartition_SPEC.cong|thm"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.gpartition_SPEC|const"><span class="entity_def" id="offset_7147..7162">gpartition_SPEC</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
  </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span class="bound"><span class="entity"><span>hi</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
  </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>xs'</span></span><span class="main"><span>,</span></span><span class="bound"><span>m</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_6989..7004"><span>gpartition_spec</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="bound"><span>xs'</span></span><span> </span><span class="bound"><span>m</span></span><span class="main"><span>)</span></span><span>
</span><span class="main"><span>}</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_part1_init|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_part1_init|thm"><span class="entity_def" id="offset_7276..7290">qsg_part1_init</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>li</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>hi</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>li</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span>p</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span> </span><span class="free"><span>hi</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>li</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>hi</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_3268..3282"><span>qsg_part_assn1</span></a><span> </span><span class="free"><span>li</span></span><span> </span><span class="free"><span>hi</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>li</span></span><span> </span><span class="free"><span>hi</span></span><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_3256..3266"><span>qsg_part_assn1_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_7445..7450">lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_part2_in_bounds|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_part2_in_bounds(2)|thm"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_part2_in_bounds(1)|thm"><span class="entity_def" id="offset_7451..7470">qsg_part2_in_bounds</span></span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_3540..3554"><span>qsg_part_assn2</span></a><span> </span><span class="free"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="free"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="free"><span>li</span></span><span> </span><span class="free"><span>hi</span></span><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>li</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>hi</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_7445..7450"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_3528..3538"><span>qsg_part_assn2_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_eq_length|fact"><span>slice_eq_mset_eq_length</span></a><span class="main"><span>)</span></span><span>
  
  
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_part_21|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_part_21|thm"><span class="entity_def" id="offset_7662..7673">qsg_part_21</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_3540..3554"><span>qsg_part_assn2</span></a><span> </span><span class="free"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="free"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="free"><span>li</span></span><span> </span><span class="free"><span>hi</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>li</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>hi</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_3268..3282"><span>qsg_part_assn1</span></a><span> </span><span class="free"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="free"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="free"><span>li</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>hi</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap|const"><span>swap</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>li</span></span><span> </span><span class="free"><span>hi</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_3528..3538"><span>qsg_part_assn2_def</span></a><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_3256..3266"><span>qsg_part_assn1_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjI|fact"><span>conjI</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan_iff|fact"><span>atLeastLessThan_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.diff_diff_cancel|fact"><span>diff_diff_cancel</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.less_Suc_eq_le|fact"><span>less_Suc_eq_le</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.less_imp_diff_less|fact"><span>less_imp_diff_less</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat_less_le|fact"><span>nat_less_le</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_eq_length|fact"><span>slice_eq_mset_eq_length</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.swap_indep|fact"><span>swap_indep</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.swap_nth1|fact"><span>swap_nth1</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc_diff_Suc|fact"><span>Suc_diff_Suc</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.diff_is_0_eq|fact"><span>diff_is_0_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.greaterThanLessThan_iff|fact"><span>greaterThanLessThan_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat.simps|fact"><span>nat.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>3</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.linorder_class.not_less_iff_gr_or_eq|fact"><span>not_less_iff_gr_or_eq</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_eq_length|fact"><span>slice_eq_mset_eq_length</span></a><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#Sorting_Guarded_Partition.strict_itrans|fact"><span>strict_itrans</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.swap_indep|fact"><span>swap_indep</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.swap_nth2|fact"><span>swap_nth2</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
  
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_part_2fin|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_part_2fin|thm"><span class="entity_def" id="offset_8214..8227">qsg_part_2fin</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_3540..3554"><span>qsg_part_assn2</span></a><span> </span><span class="free"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="free"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="free"><span>li</span></span><span> </span><span class="free"><span>hi</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span> </span><span class="free"><span>li</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>hi</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_6989..7004"><span>gpartition_spec</span></a><span> </span><span class="free"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="free"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>li</span></span><span>"</span></span></span><span>  
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_3528..3538"><span>qsg_part_assn2_def</span></a><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_6977..6987"><span>gpartition_spec_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan_iff|fact"><span>atLeastLessThan_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.atLeastSucLessThan_greaterThanLessThan|fact"><span>atLeastSucLessThan_greaterThanLessThan</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.le_antisym|fact"><span>le_antisym</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.linorder_le_less_linear|fact"><span>linorder_le_less_linear</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Word_Lib.Many_More.html#Many_More.nat_Suc_less_le_imp|fact"><span>nat_Suc_less_le_imp</span></a><span class="main"><span>)</span></span><span>
  
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_partition_aux_correct|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_partition_aux_correct|thm"><span class="entity_def" id="offset_8532..8557">qsg_partition_aux_correct</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>li</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>hi</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="main"><span>(</span></span><span class="free"><span>li</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span>p</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span>hi</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_6428..6445"><span>qsg_partition_aux</span></a><span> </span><span class="free"><span>li</span></span><span> </span><span class="free"><span>hi</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_7147..7162"><span>gpartition_SPEC</span></a><span> </span><span class="free"><span>li</span></span><span> </span><span class="free"><span>hi</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>  
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_6416..6426"><span>qsg_partition_aux_def</span></a><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_7135..7145"><span>gpartition_SPEC_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_While.html#Refine_While.while.WHILEIT_rule|fact"><span>WHILEIT_rule</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> R</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Wellfounded.html#Wellfounded.measure|const"><span>measure</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="bound"><span>hi</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>hi</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_5623..5634"><span>qsg_part_12</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> xs<span class="hidden">⇩</span><sub>0</sub></span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="free"><span>xs</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>  
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_7276..7290"><span>qsg_part1_init</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_7451..7470"><span>qsg_part2_in_bounds</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_7451..7470"><span>qsg_part2_in_bounds</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_7662..7673"><span>qsg_part_21</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_8214..8227"><span>qsg_part_2fin</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>    

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_partition_def|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_partition_def|thm"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_partition_def_raw|axiom"><span class="entity_def" id="offset_9065..9075">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_partition.cong|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_partition.cong|thm"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_partition|const"><span class="entity_def" id="offset_9077..9090">qsg_partition</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
  </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

  </span><span class="main"><span>(</span></span><span class="bound"><span>e0</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.mop_idx_v_swap|const"><span>mop_idx_v_swap</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Monadify.html#Sepref_Monadify.COPY|const"><span>COPY</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
  </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>li</span></span><span class="main"><span>=</span></span><span class="free"><span class="bound"><span class="entity"><span>li<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>;</span></span><span>
  
  </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>hi</span></span><span class="main"><span>=</span></span><span class="free"><span class="bound"><span class="entity"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>;</span></span><span>
  </span><span class="main"><span>(</span></span><span class="bound"><span>eN</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.mop_idx_v_swap|const"><span>mop_idx_v_swap</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>hi</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Monadify.html#Sepref_Monadify.COPY|const"><span>COPY</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

  </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>m</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_6428..6445"><span>qsg_partition_aux</span></a><span> </span><span class="bound"><span>li</span></span><span> </span><span class="bound"><span>hi</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>;</span></span><span>
  
  </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>li</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="bound"><span>li</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>;</span></span><span>

  </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>e0ok</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="bound"><span>e0</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span class="main"><span>;</span></span><span>
  </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>eNok</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="bound"><span>eN</span></span><span class="main"><span>;</span></span><span>
  </span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.mop_idx_v_swap|const"><span>mop_idx_v_swap</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>li</span></span><span> </span><span class="bound"><span>e0</span></span><span class="main"><span>;</span></span><span>
  </span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.mop_idx_v_swap|const"><span>mop_idx_v_swap</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>hi</span></span><span> </span><span class="bound"><span>eN</span></span><span class="main"><span>;</span></span><span>
  
  </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset|const"><span>slice_eq_mset</span></a><span> </span><span class="bound"><span>li</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>hi</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
  
  </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="bound"><span>e0ok</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>eNok</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span>
    </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>m</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="bound"><span>e0ok</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="bound"><span>eNok</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
    </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/IICF_List.html#IICF_List.mop_list_swap|const"><span>mop_list_swap</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>m</span></span><span> </span><span class="bound"><span>hi</span></span><span class="main"><span>;</span></span><span>
    </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
    </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>m</span></span><span class="main"><span>=</span></span><span class="bound"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>;</span></span><span>
    </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>m</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="bound"><span>eNok</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
    </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="bound"><span>m</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
    </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>m</span></span><span class="main"><span>=</span></span><span class="bound"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>;</span></span><span>
    </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/IICF_List.html#IICF_List.mop_list_swap|const"><span>mop_list_swap</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>li</span></span><span> </span><span class="bound"><span>m</span></span><span class="main"><span>;</span></span><span>
    </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>m</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
    </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/IICF_List.html#IICF_List.mop_list_swap|const"><span>mop_list_swap</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>li</span></span><span> </span><span class="bound"><span>hi</span></span><span class="main"><span>;</span></span><span>
    </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>m</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>}</span></span><span>
  
</span><span class="main"><span>}</span></span><span>"</span></span></span><span>


</span><span class="keyword1"><span class="command"><span>term</span></span></span><span> </span><span class="quoted"><span>mop_cmp_idx_v</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_partition_wrapper_def|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_partition_wrapper_def|thm"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_partition_wrapper_def_raw|axiom"><span class="entity_def" id="offset_9881..9891">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_partition_wrapper.cong|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_partition_wrapper.cong|thm"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_partition_wrapper|const"><span class="entity_def" id="offset_9893..9914">qsg_partition_wrapper</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
  </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>hi</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="main"><span>(</span></span><span>
    </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>hi</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_9077..9090"><span>qsg_partition</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span>
    </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.monadic_If|const"><span>if<span class="hidden">⇩</span><sub>N</sub></span></a></span><span> </span><span>mop_cmp_idx_v</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.monadic_If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>hi</span></span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.monadic_If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>}</span></span><span>
  </span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span class="main"><span>)</span></span><span>
</span><span class="main"><span>}</span></span><span>"</span></span></span><span>


</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_partition_correct|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_partition_correct|thm"><span class="entity_def" id="offset_10131..10152">qsg_partition_correct</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>li</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>hi</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_9077..9090"><span>qsg_partition</span></a><span> </span><span class="free"><span>li</span></span><span> </span><span class="free"><span>hi</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_7147..7162"><span>gpartition_SPEC</span></a><span> </span><span class="free"><span>li</span></span><span> </span><span class="free"><span>hi</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_9065..9075"><span>qsg_partition_def</span></a><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_7135..7145"><span>gpartition_SPEC_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_8532..8557"><span>qsg_partition_aux_correct</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>THEN</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order_trans|fact"><span>order_trans</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_7135..7145"><span>gpartition_SPEC_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_6977..6987"><span>gpartition_spec_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_eq_length|fact"><span>slice_eq_mset_eq_length</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> xs' m
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>drule</span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#Sorting_Guarded_Partition.slice_eq_mset_upd_outside|fact"><span>slice_eq_mset_upd_outside</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> i</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>li</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> x</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span> </span><span class="free"><span>li</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>drule</span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#Sorting_Guarded_Partition.slice_eq_mset_upd_outside|fact"><span>slice_eq_mset_upd_outside</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> i</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>hi</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> x</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>hi</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list_update_swap|fact"><span>list_update_swap</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>erule</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_subslice|fact"><span>slice_eq_mset_subslice</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> xs' m
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjI|fact"><span>conjI</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.nth_list_update&apos;|fact"><span>nth_list_update'</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_eq_length|fact"><span>slice_eq_mset_eq_length</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.nth_list_update&apos;|fact"><span>nth_list_update'</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_eq_length|fact"><span>slice_eq_mset_eq_length</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> xs' m
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjI|fact"><span>conjI</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span class="quasi_keyword"><span>no_asm_simp</span></span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_eq_length|fact"><span>slice_eq_mset_eq_length</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap_nth|fact"><span>swap_nth</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth_list_update|fact"><span>nth_list_update</span></a><span class="main"><span>)</span></span><span> 
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>connex</span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_eq_length|fact"><span>slice_eq_mset_eq_length</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap_nth|fact"><span>swap_nth</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth_list_update|fact"><span>nth_list_update</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> xs' m
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjI|fact"><span>conjI</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc_le_D|fact"><span>Suc_le_D</span></a><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.Suc_to_right|fact"><span>Suc_to_right</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan_iff|fact"><span>atLeastLessThan_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.le_Suc_eq|fact"><span>le_Suc_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.le_eq_less_or_eq|fact"><span>le_eq_less_or_eq</span></a><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.nz_le_conv_less|fact"><span>nz_le_conv_less</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_swap|fact"><span>slice_eq_mset_swap</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.zero_less_Suc|fact"><span>zero_less_Suc</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> 
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> 
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_eq_length|fact"><span>slice_eq_mset_eq_length</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap_nth|fact"><span>swap_nth</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth_list_update|fact"><span>nth_list_update</span></a><span class="main"><span>)</span></span><span> 
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span class="quasi_keyword"><span>no_asm_simp</span></span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_eq_length|fact"><span>slice_eq_mset_eq_length</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap_nth|fact"><span>swap_nth</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth_list_update|fact"><span>nth_list_update</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.safe|method"><span class="operator"><span>safe</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>connex</span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan_iff|fact"><span>atLeastLessThan_iff</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Word_Lib.Legacy_Aliases.html#Legacy_Aliases.le_def|fact"><span>le_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.le_eq_less_or_eq|fact"><span>le_eq_less_or_eq</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Word_Lib.Many_More.html#Many_More.nat_le_Suc_less_imp|fact"><span>nat_le_Suc_less_imp</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>connex</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>connex</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc_le_D|fact"><span>Suc_le_D</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc_le_lessD|fact"><span>Suc_le_lessD</span></a><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.Suc_to_right|fact"><span>Suc_to_right</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan_iff|fact"><span>atLeastLessThan_iff</span></a><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.nat_in_between_eq|fact"><span>nat_in_between_eq</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Meson/meson_tactic.ML.html#Meson.meson|method"><span class="operator"><span>meson</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan_iff|fact"><span>atLeastLessThan_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.le_antisym|fact"><span>le_antisym</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.linorder_not_le|fact"><span>linorder_not_le</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Word_Lib.Many_More.html#Many_More.nat_le_Suc_less_imp|fact"><span>nat_le_Suc_less_imp</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>  
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> xs' m
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjI|fact"><span>conjI</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> 
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span class="quasi_keyword"><span>no_asm_simp</span></span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_eq_length|fact"><span>slice_eq_mset_eq_length</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap_nth|fact"><span>swap_nth</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth_list_update|fact"><span>nth_list_update</span></a><span class="main"><span>)</span></span><span> 
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>connex</span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span class="quasi_keyword"><span>no_asm_simp</span></span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_eq_length|fact"><span>slice_eq_mset_eq_length</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/More_List.html#More_List.swap_nth|fact"><span>swap_nth</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth_list_update|fact"><span>nth_list_update</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Meson/meson_tactic.ML.html#Meson.meson|method"><span class="operator"><span>meson</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan_iff|fact"><span>atLeastLessThan_iff</span></a><span> </span><span>connex</span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.diff_is_0_eq&apos;|fact"><span>diff_is_0_eq'</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.diffs0_imp_equal|fact"><span>diffs0_imp_equal</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Word_Lib.Legacy_Aliases.html#Legacy_Aliases.le_def|fact"><span>le_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Word_Lib.Many_More.html#Many_More.nat_le_Suc_less_imp|fact"><span>nat_le_Suc_less_imp</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

  
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.gpartition_SPEC.mcomb|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.gpartition_SPEC.arity|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.gpartition_SPEC.itype|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.gpartition_SPEC.pat|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.gpartition_SPEC.mcomb|thm"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.gpartition_SPEC.arity|thm"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.gpartition_SPEC.itype|thm"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.gpartition_SPEC.pat|thm"><span>sepref_register</span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_7147..7162"><span>gpartition_SPEC</span></a></span><span>
  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_partition_wrapper_refine|fact"><span class="entity_def" id="Sorting_Guarded_Partition.weak_ordering.qsg_partition_wrapper_refine|thm"><span class="entity_def" id="offset_12667..12695">qsg_partition_wrapper_refine</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_9893..9914"><span>qsg_partition_wrapper</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_7147..7162"><span>gpartition_SPEC</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="main"><span>⟨</span></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_9881..9891"><span>qsg_partition_wrapper_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span> </span><span class="quasi_keyword"><span>split</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.if_split|fact"><span>if_split</span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_relI|fact"><span>nres_relI</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_10131..10152"><span>qsg_partition_correct</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_7135..7145"><span>gpartition_SPEC_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Eisbach.Eisbach.html#Eisbach.all|method"><span class="operator"><span>all</span></span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_6977..6987"><span>gpartition_spec_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><span>connex</span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.le_less_Suc_eq|fact"><span>le_less_Suc_eq</span></a><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#Sorting_Guarded_Partition.strict_itrans|fact"><span>strict_itrans</span></a><span> </span><span>wo_leD</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.le_less_Suc_eq|fact"><span>le_less_Suc_eq</span></a><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#Sorting_Guarded_Partition.strict_itrans|fact"><span>strict_itrans</span></a><span> </span><span>wo_leI</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
  
  
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>  
  

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_13208..13215">context</span></span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.sort_impl_context|locale"><span>sort_impl_context</span></a><span> </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

  
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.ungrd_qsg_next_h_spec.mcomb|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.ungrd_qsg_next_h_spec.arity|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.ungrd_qsg_next_h_spec.itype|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.ungrd_qsg_next_h_spec.pat|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.ungrd_qsg_next_l_spec.mcomb|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.ungrd_qsg_next_l_spec.arity|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.ungrd_qsg_next_l_spec.itype|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.ungrd_qsg_next_l_spec.pat|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.ungrd_qsg_next_h_spec.mcomb|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.ungrd_qsg_next_h_spec.arity|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.ungrd_qsg_next_h_spec.itype|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.ungrd_qsg_next_h_spec.pat|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.ungrd_qsg_next_l_spec.mcomb|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.ungrd_qsg_next_l_spec.arity|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.ungrd_qsg_next_l_spec.itype|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.ungrd_qsg_next_l_spec.pat|thm"><span>sepref_register</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_915..936"><span>ungrd_qsg_next_l_spec</span></a></span><span> </span><span class="quoted"><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_1101..1122"><span>ungrd_qsg_next_h_spec</span></a></span><span> 

</span><span class="comment1"><span>(* TODO: We can get rid of the length xs restriction: the stopper element will always lie within &lt;h, which is size_t representable! *)</span></span><span>
</span><span class="keyword1"><span class="command"><span>sepref_definition</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_next_l_impl.cong|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_next_l_impl.cong|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_next_l_impl|const"><span>qsg_next_l_impl</span></span></span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Codegen_Preproc.html#LLVM_Codegen_Preproc.llvm_inline|attribute"><span class="operator"><span>llvm_inline</span></span></a><span class="main"><span>]</span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry3|const"><span>uncurry3</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_1290..1300"><span>qsg_next_l</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span class="main"><span>(</span></span><span>arr_assn</span><span class="main"><span>)</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span class="free"><span>elem_assn</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefttnd|const"><span>→<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_13208..13215"><span>qsg_next_l_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.annot_snat_const|method"><span class="operator"><span>annot_snat_const</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_t|type"><span>size_t</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_next_l_impl.refine|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_next_l_impl_def|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_next_l_impl.refine_raw|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_next_l_impl.refine|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_next_l_impl_def|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_next_l_impl.refine_raw|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_next_l_impl_def_raw|axiom"><span class="entity_def" id="offset_13680..13682">by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref|method"><span class="operator"><span>sepref</span></span></a><span>

</span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.sepref_fr_rules|attribute"><span class="operator"><span>sepref_fr_rules</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_13680..13682"><span>qsg_next_l_impl.refine</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.FCOMP|attribute"><span class="operator"><span>FCOMP</span></span></a><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_1576..1593"><span>qsg_next_l_refine</span></a><span class="main"><span>]</span></span><span>  
  
</span><span class="keyword1"><span class="command"><span>term</span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_2125..2135"><span>qsg_next_h</span></a></span><span>

</span><span class="keyword1"><span class="command"><span>sepref_definition</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_next_h_impl.cong|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_next_h_impl.cong|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_next_h_impl|const"><span>qsg_next_h_impl</span></span></span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Codegen_Preproc.html#LLVM_Codegen_Preproc.llvm_inline|attribute"><span class="operator"><span>llvm_inline</span></span></a><span class="main"><span>]</span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry3|const"><span>uncurry3</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_2125..2135"><span>qsg_next_h</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span class="main"><span>(</span></span><span>arr_assn</span><span class="main"><span>)</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span class="free"><span>elem_assn</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefttnd|const"><span>→<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_13208..13215"><span>qsg_next_h_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.annot_snat_const|method"><span class="operator"><span>annot_snat_const</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_t|type"><span>size_t</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_next_h_impl.refine|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_next_h_impl_def|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_next_h_impl.refine_raw|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_next_h_impl.refine|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_next_h_impl_def|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_next_h_impl.refine_raw|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_next_h_impl_def_raw|axiom"><span class="entity_def" id="offset_14027..14029">by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref|method"><span class="operator"><span>sepref</span></span></a><span>
  
</span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.sepref_fr_rules|attribute"><span class="operator"><span>sepref_fr_rules</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_14027..14029"><span>qsg_next_h_impl.refine</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.FCOMP|attribute"><span class="operator"><span>FCOMP</span></span></a><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_2433..2450"><span>qsg_next_h_refine</span></a><span class="main"><span>]</span></span><span>  
  

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_partition_aux.mcomb|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_partition_aux.arity|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_partition_aux.itype|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_partition_aux.pat|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_partition_aux.mcomb|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_partition_aux.arity|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_partition_aux.itype|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_partition_aux.pat|thm"><span>sepref_register</span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_6428..6445"><span>qsg_partition_aux</span></a></span><span>  
</span><span class="keyword1"><span class="command"><span>sepref_def</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_partition_aux_impl.cong|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_partition_aux_impl.cong|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_partition_aux_impl|const"><span>qsg_partition_aux_impl</span></span></span></span></span><span> </span><span class="comment1"><span>(*[llvm_inline]*)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry3|const"><span>uncurry3</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_6428..6445"><span>qsg_partition_aux</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span> 
  </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span class="free"><span>elem_assn</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span class="main"><span>(</span></span><span>arr_assn</span><span class="main"><span>)</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfdrop|const"><span><span class="hidden">⇧</span><sup>d</sup></span></a></span><span> 
    </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>→</span></a></span><span> </span><span>arr_assn</span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.prod_assn|const"><span>×<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="bound"><span>ai</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>r</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="bound"><span>ai</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_13208..13215"><span>qsg_partition_aux_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_13208..13215"><span>ungrd_qsg_next_lh_spec_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>only</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_monad_laws|fact"><span>nres_monad_laws</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.split|fact"><span>split</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.annot_snat_const|method"><span class="operator"><span>annot_snat_const</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_t|type"><span>size_t</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_partition_aux_impl.refine|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_partition_aux_impl_def|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_partition_aux_impl.refine_raw|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_partition_aux_impl.refine|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_partition_aux_impl_def|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_partition_aux_impl.refine_raw|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.qsg_partition_aux_impl_def_raw|axiom"><span>by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref|method"><span class="operator"><span>sepref</span></span></a><span>

</span><span class="comment1"><span>(* TODO: Move *)</span></span><span>                  
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.unfold_let_le|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.unfold_let_le|thm"><span class="entity_def" id="offset_14609..14622">unfold_let_le</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>a</span></span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span> </span><span class="free"><span>b</span></span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>&lt;</b></span></span></span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>unfold_le_to_lt</span><span class="main"><span>)</span></span><span>
        
</span><span class="comment1"><span>(* TODO: Move *)</span></span><span>                  
  
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.list_guarded_swap_def|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.list_guarded_swap_def|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.list_guarded_swap_def_raw|axiom"><span class="entity_def" id="offset_14756..14766">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.list_guarded_swap|const"><span>list_guarded_swap</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>j</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="free"><span class="bound"><span class="entity"><span>j</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/IICF_List.html#IICF_List.mop_list_swap|const"><span>mop_list_swap</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>j</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> "</span></span></span><span>  
  
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.list_guarded_swap_refine|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.list_guarded_swap_refine|thm"><span>list_guarded_swap_refine</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine|attribute"><span class="operator"><span>refine</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><span>,</span></span><span class="free"><span>xs'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="main"><span>⟨</span></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.list_rel|const"><span>list_rel</span></a><span class="main"><span>;</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>i</span></span><span class="main"><span>,</span></span><span class="free"><span>i'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><span>;</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>j</span></span><span class="main"><span>,</span></span><span class="free"><span>j'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#Sorting_Guarded_Partition.sort_impl_context.list_guarded_swap|const"><span>list_guarded_swap</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="main"><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/IICF_List.html#IICF_List.mop_list_swap|const"><span>mop_list_swap</span></a><span> </span><span class="free"><span>xs'</span></span><span> </span><span class="free"><span>i'</span></span><span> </span><span class="free"><span>j'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_14756..14766"><span>list_guarded_swap_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.list_guarded_swap.mcomb|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.list_guarded_swap.arity|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.list_guarded_swap.itype|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.list_guarded_swap.mcomb|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.list_guarded_swap.arity|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.list_guarded_swap.itype|thm"><span>sepref_register</span></span></span></span></span></span></span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="Sorting_Guarded_Partition.html#Sorting_Guarded_Partition.sort_impl_context.list_guarded_swap|const"><span>list_guarded_swap</span></a></span><span>  
  
</span><span class="keyword1"><span class="command"><span>sepref_def</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.list_guarded_swap_impl|const"><span>list_guarded_swap_impl</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Codegen_Preproc.html#LLVM_Codegen_Preproc.llvm_inline|attribute"><span class="operator"><span>llvm_inline</span></span></a><span class="main"><span>]</span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry2|const"><span>uncurry2</span></a><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#Sorting_Guarded_Partition.sort_impl_context.list_guarded_swap|const"><span>list_guarded_swap</span></a><span>"</span></span></span><span> 
  </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span> </span><span>arr_assn</span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfdrop|const"><span><span class="hidden">⇧</span><sup>d</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>→</span></a></span><span> </span><span>arr_assn</span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="bound"><span>p</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="bound"><span>p</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_14756..14766"><span>list_guarded_swap_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.list_guarded_swap_impl.refine|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.list_guarded_swap_impl_def|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.list_guarded_swap_impl.refine_raw|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.list_guarded_swap_impl.refine|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.list_guarded_swap_impl_def|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.list_guarded_swap_impl.refine_raw|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_context.list_guarded_swap_impl_def_raw|axiom"><span>by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref|method"><span class="operator"><span>sepref</span></span></a><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_15346..15353">context</span></span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.sort_impl_copy_context|locale"><span>sort_impl_copy_context</span></a><span> </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>
  
</span><span class="comment1"><span>(* Some refinement to tame exploding sepref *)</span></span><span>  
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_swap_back_def|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_swap_back_def|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_swap_back_def_raw|axiom"><span class="entity_def" id="offset_15435..15445">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_swap_back|const"><span>qsg_partition_swap_back</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>e0ok</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>eNok</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
  </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>e0ok</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>eNok</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span>
    </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>e0ok</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span class="bound"><span class="entity"><span>eNok</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
    </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#Sorting_Guarded_Partition.sort_impl_context.list_guarded_swap|const"><span>list_guarded_swap</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi</span></span></span></span><span class="main"><span>;</span></span><span>
    </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
    </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>m</span></span><span class="main"><span>=</span></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>;</span></span><span>
    </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>m</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>eNok</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
    </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
    </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>m</span></span><span class="main"><span>=</span></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>;</span></span><span>
    </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#Sorting_Guarded_Partition.sort_impl_context.list_guarded_swap|const"><span>list_guarded_swap</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span> </span><span class="bound"><span>m</span></span><span class="main"><span>;</span></span><span>
    </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>m</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
    </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#Sorting_Guarded_Partition.sort_impl_context.list_guarded_swap|const"><span>list_guarded_swap</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi</span></span></span></span><span class="main"><span>;</span></span><span>
    </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>}</span></span><span>

</span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition2_def|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition2_def|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition2_def_raw|axiom"><span class="entity_def" id="offset_15861..15871">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition2.cong|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition2.cong|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition2|const"><span class="entity_def" id="offset_15873..15887">qsg_partition2</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
  </span><span class="main"><span>(</span></span><span class="bound"><span>e0</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.mop_idx_v_swap|const"><span>mop_idx_v_swap</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Monadify.html#Sepref_Monadify.COPY|const"><span>COPY</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
  </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
  </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>li</span></span><span class="main"><span>=</span></span><span class="free"><span class="bound"><span class="entity"><span>li</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>;</span></span><span>
  
  </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
  </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>hi</span></span><span class="main"><span>=</span></span><span class="free"><span class="bound"><span class="entity"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>;</span></span><span>
  </span><span class="main"><span>(</span></span><span class="bound"><span>eN</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.mop_idx_v_swap|const"><span>mop_idx_v_swap</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>hi</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Monadify.html#Sepref_Monadify.COPY|const"><span>COPY</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

  </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>m</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_6428..6445"><span>qsg_partition_aux</span></a><span> </span><span class="bound"><span>li</span></span><span> </span><span class="bound"><span>hi</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>;</span></span><span>
  
  </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>li</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
  </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>li</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="bound"><span>li</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>;</span></span><span>

  </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>e0ok</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="bound"><span>e0</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span class="main"><span>;</span></span><span>
  </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>eNok</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="bound"><span>eN</span></span><span class="main"><span>;</span></span><span>
  </span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.mop_idx_v_swap|const"><span>mop_idx_v_swap</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>li</span></span><span> </span><span class="bound"><span>e0</span></span><span class="main"><span>;</span></span><span>
  </span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.mop_idx_v_swap|const"><span>mop_idx_v_swap</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>hi</span></span><span> </span><span class="bound"><span>eN</span></span><span class="main"><span>;</span></span><span>

  </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_swap_back|const"><span>qsg_partition_swap_back</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>hi<span class="hidden">⇩</span><sub>0</sub></span></span></span></span><span> </span><span class="bound"><span>li</span></span><span> </span><span class="bound"><span>hi</span></span><span> </span><span class="bound"><span>m</span></span><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>e0ok</span></span><span> </span><span class="bound"><span>eNok</span></span><span>
</span><span class="main"><span>}</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition2_refine|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition2_refine|thm"><span class="entity_def" id="offset_16331..16352">qsg_partition2_refine</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span>  </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_15873..15887"><span>qsg_partition2</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_9077..9090"><span>qsg_partition</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="main"><span>⟨</span></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_15861..15871"><span>qsg_partition2_def</span></a><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_15346..15353"><span>qsg_partition_def</span></a><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_15435..15445"><span>qsg_partition_swap_back_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_rcg|method"><span class="operator"><span>refine_rcg</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Heuristics.html#Refine_Heuristics.refine_dref_type|method"><span class="operator"><span>refine_dref_type</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_swap_back.mcomb|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_swap_back.arity|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_swap_back.itype|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_swap_back.mcomb|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_swap_back.arity|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_swap_back.itype|thm"><span>sepref_register</span></span></span></span></span></span></span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="Sorting_Guarded_Partition.html#Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_swap_back|const"><span>qsg_partition_swap_back</span></a></span><span>

</span><span class="keyword1"><span class="command"><span>sepref_def</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_swap_back_impl|const"><span>qsg_partition_swap_back_impl</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry6|const"><span>uncurry6</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Guarded_Partition.html#Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_swap_back|const"><span>qsg_partition_swap_back</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span> 
  </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span class="main"><span>(</span></span><span>arr_assn</span><span class="main"><span>)</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfdrop|const"><span><span class="hidden">⇧</span><sup>d</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.bool1_assn|const"><span>bool1_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.bool1_assn|const"><span>bool1_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span>
    </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>→</span></a></span><span> </span><span>arr_assn</span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.prod_assn|const"><span>×<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="bound"><span>ai</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>r</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="bound"><span>ai</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_15435..15445"><span>qsg_partition_swap_back_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.annot_snat_const|method"><span class="operator"><span>annot_snat_const</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_t|type"><span>size_t</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_swap_back_impl.refine|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_swap_back_impl_def|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_swap_back_impl.refine_raw|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_swap_back_impl.refine|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_swap_back_impl_def|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_swap_back_impl.refine_raw|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_swap_back_impl_def_raw|axiom"><span>by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref_dbg_keep|method"><span class="operator"><span>sepref_dbg_keep</span></span></a><span>
  
  

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition.mcomb|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition.arity|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition.itype|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition.pat|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition.mcomb|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition.arity|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition.itype|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition.pat|thm"><span>sepref_register</span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_9077..9090"><span>qsg_partition</span></a></span><span>

</span><span class="keyword1"><span class="command"><span>sepref_definition</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_impl.cong|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_impl.cong|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_impl|const"><span>qsg_partition_impl</span></span></span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Codegen_Preproc.html#LLVM_Codegen_Preproc.llvm_code|attribute"><span class="operator"><span>llvm_code</span></span></a><span class="main"><span>]</span></span><span> </span><span class="comment1"><span>(*[llvm_inline]*)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry3|const"><span>uncurry3</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_15873..15887"><span>qsg_partition2</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span> 
  </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span class="free"><span>elem_assn</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span class="main"><span>(</span></span><span>arr_assn</span><span class="main"><span>)</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfdrop|const"><span><span class="hidden">⇧</span><sup>d</sup></span></a></span><span> 
    </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>→</span></a></span><span> </span><span>arr_assn</span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.prod_assn|const"><span>×<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="bound"><span>ai</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>r</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="bound"><span>ai</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_15861..15871"><span>qsg_partition2_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_14609..14622"><span>unfold_let_le</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>supply</span></span></span></span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>[</span></span><span class="operator"><span>goals_limit</span></span><span> </span><span class="main"><span class="main"><span>=</span></span></span><span> 1</span><span class="main"><span>]</span></span><span class="main"><span>]</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.annot_snat_const|method"><span class="operator"><span>annot_snat_const</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_t|type"><span>size_t</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref_dbg_keep|method"><span class="operator"><span>sepref_dbg_keep</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_impl.refine|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_impl_def|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_impl.refine_raw|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_impl.refine|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_impl_def|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_impl.refine_raw|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_impl_def_raw|axiom"><span class="entity_def" id="offset_17487..17491">done</span></span></span></span></span></span></span></span></span></span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_impl&apos;_hnr|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_impl&apos;_hnr|thm"><span>qsg_partition_impl'_hnr</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.sepref_fr_rules|attribute"><span class="operator"><span>sepref_fr_rules</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_17487..17491"><span>qsg_partition_impl.refine</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.FCOMP|attribute"><span class="operator"><span>FCOMP</span></span></a><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_16331..16352"><span>qsg_partition2_refine</span></a><span class="main"><span>]</span></span><span>


</span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_wrapper.mcomb|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_wrapper.arity|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_wrapper.itype|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_wrapper.pat|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_wrapper.mcomb|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_wrapper.arity|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_wrapper.itype|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_wrapper.pat|thm"><span>sepref_register</span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_9893..9914"><span>qsg_partition_wrapper</span></a></span><span>
</span><span class="keyword1"><span class="command"><span>sepref_definition</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_wrapper_impl.cong|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_wrapper_impl.cong|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_wrapper_impl|const"><span>qsg_partition_wrapper_impl</span></span></span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Codegen_Preproc.html#LLVM_Codegen_Preproc.llvm_code|attribute"><span class="operator"><span>llvm_code</span></span></a><span class="main"><span>]</span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry3|const"><span>uncurry3</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_9893..9914"><span>qsg_partition_wrapper</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span class="free"><span>elem_assn</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span class="main"><span>(</span></span><span>arr_assn</span><span class="main"><span>)</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfdrop|const"><span><span class="hidden">⇧</span><sup>d</sup></span></a></span><span> 
    </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>→</span></a></span><span> </span><span>arr_assn</span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.prod_assn|const"><span>×<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_assn|const"><span>size_assn</span></a><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="bound"><span>ai</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>r</span></span><span class="main"><span>,</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="bound"><span>ai</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefptnd|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_15346..15353"><span>qsg_partition_wrapper_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.annot_snat_const|method"><span class="operator"><span>annot_snat_const</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.size_t|type"><span>size_t</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_wrapper_impl.refine|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_wrapper_impl_def|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_wrapper_impl.refine_raw|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_wrapper_impl.refine|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_wrapper_impl_def|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_wrapper_impl.refine_raw|thm"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_wrapper_impl_def_raw|axiom"><span class="entity_def" id="offset_17971..17973">by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref|method"><span class="operator"><span>sepref</span></span></a><span>


</span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_wrapper_impl&apos;_hnr|fact"><span class="entity_def" id="Sorting_Guarded_Partition.sort_impl_copy_context.qsg_partition_wrapper_impl&apos;_hnr|thm"><span>qsg_partition_wrapper_impl'_hnr</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.sepref_fr_rules|attribute"><span class="operator"><span>sepref_fr_rules</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_17971..17973"><span>qsg_partition_wrapper_impl.refine</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.FCOMP|attribute"><span class="operator"><span>FCOMP</span></span></a><span> </span><a class="entity_ref" href="Sorting_Guarded_Partition.html#offset_12667..12695"><span>qsg_partition_wrapper_refine</span></a><span class="main"><span>]</span></span><span>  
  

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>                           

</span></pre>
</body>

</html>