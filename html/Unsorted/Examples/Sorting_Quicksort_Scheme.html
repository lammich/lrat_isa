<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Sorting_Quicksort_Scheme</title>
</head>


<body>
<div class="head">
<h1>Theory Sorting_Quicksort_Scheme</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><a href="Sorting_Quicksort_Scheme.html"><span>Sorting_Quicksort_Scheme</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> </span><a href="Sorting_Setup.html"><span>Sorting_Setup</span></a><span> </span><a href="Sorting_Partially_Sorted.html"><span>Sorting_Partially_Sorted</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

    </span><span class="comment1"><span>(* TODO: Move *)</span></span><span>
    
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Quicksort_Scheme.slice_complete&apos;|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.slice_complete&apos;|thm"><span>slice_complete'</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Quicksort_Scheme.slice_append1&apos;|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.slice_append1&apos;|thm"><span>slice_append1'</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span class="free"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice_def|fact"><span>Misc.slice_def</span></a><span class="main"><span>)</span></span><span>
      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Quicksort_Scheme.slice_append2&apos;|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.slice_append2&apos;|thm"><span>slice_append2'</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>l</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span class="free"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice_def|fact"><span>Misc.slice_def</span></a><span class="main"><span>)</span></span><span>
      


  </span><span class="keyword1"><span class="command"><span>abbreviation</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Quicksort_Scheme.is_threshold|const"><span>is_threshold</span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="numeral"><span>16</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>context</span></span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.weak_ordering|locale"><span>weak_ordering</span></a><span> </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.partition1_spec_def|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.partition1_spec_def|thm"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.partition1_spec_def_raw|axiom"><span class="entity_def" id="offset_541..551">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.partition1_spec.cong|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.partition1_spec.cong|thm"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.partition1_spec|const"><span class="entity_def" id="offset_553..568">partition1_spec</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span> 
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>≥</span></a></span><span> </span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> 
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>xs1</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs2</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="bound"><span>xs1</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="bound"><span>xs2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>xs1</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.list.Nil|const"><span>[]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>xs2</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.list.Nil|const"><span>[]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_Partially_Sorted.html#Sorting_Partially_Sorted.slice_LT|const"><span>slice_LT</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>≤</b>)</span></span></span><span> </span><span class="bound"><span>xs1</span></span><span> </span><span class="bound"><span>xs2</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort_aux1_def|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort_aux1_def|thm"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort_aux1_def_raw|axiom"><span class="entity_def" id="offset_720..730">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort_aux1.cong|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort_aux1.cong|thm"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort_aux1|const"><span class="entity_def" id="offset_731..745">introsort_aux1</span></span></span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list|type"><span>list</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list|type"><span>list</span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres|type"><span>nres</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>introsort_aux1</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/RefineG_Recursion.html#RefineG_Recursion.RECT|const"><span>RECT</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>introsort_aux1</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#Sorting_Quicksort_Scheme.is_threshold|const"><span>is_threshold</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
        </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="bound"><span>d</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span>
          </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.sort_spec|const"><span>sort_spec</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
          </span><span class="main"><span>(</span></span><span class="bound"><span>xs1</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs2</span></span><span class="main"><span>)</span></span><span class="main"><span>←</span></span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_553..568"><span>partition1_spec</span></a><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>;</span></span><span>
          </span><span class="bound"><span>xs1</span></span><span> </span><span class="main"><span>←</span></span><span> </span><span class="bound"><span>introsort_aux1</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs1</span></span><span class="main"><span>,</span></span><span class="bound"><span>d</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
          </span><span class="bound"><span>xs2</span></span><span> </span><span class="main"><span>←</span></span><span> </span><span class="bound"><span>introsort_aux1</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs2</span></span><span class="main"><span>,</span></span><span class="bound"><span>d</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
          </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs1</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span class="bound"><span>xs2</span></span><span class="main"><span>)</span></span><span>
        </span><span class="main"><span>}</span></span><span>
      </span><span class="main"><span>}</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span>
        </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>xs</span></span><span>
    </span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.slice_strict_LT_imp_LE|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.slice_strict_LT_imp_LE|thm"><span>slice_strict_LT_imp_LE</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Partially_Sorted.html#Sorting_Partially_Sorted.slice_LT|const"><span>slice_LT</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>ys</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Partially_Sorted.html#Sorting_Partially_Sorted.slice_LT|const"><span>slice_LT</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.le_by_lt|const"><span>le_by_lt</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>ys</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>erule</span></span><span> </span><a class="entity_ref" href="Sorting_Partially_Sorted.html#Sorting_Partially_Sorted.slice_LT_mono|fact"><span>slice_LT_mono</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Meson/meson_tactic.ML.html#Meson.meson|method"><span class="operator"><span>meson</span></span></a><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.le_by_lt_def|fact"><span>le_by_lt_def</span></a><span> </span><span>wo_less_asym</span><span class="main"><span>)</span></span><span>
      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort_aux1_correct|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort_aux1_correct|thm"><span class="entity_def" id="offset_1367..1389">introsort_aux1_correct</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_731..745"><span>introsort_aux1</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>xs'</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="bound"><span>xs'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_Partially_Sorted.html#Sorting_Partially_Sorted.part_sorted_wrt|const"><span>part_sorted_wrt</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.le_by_lt|const"><span>le_by_lt</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#Sorting_Quicksort_Scheme.is_threshold|const"><span>is_threshold</span></a><span> </span><span class="bound"><span>xs'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_720..730"><span>introsort_aux1_def</span></a><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_541..551"><span>partition1_spec_def</span></a><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.sort_spec_def|fact"><span>sort_spec_def</span></a><span>
      
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/RefineG_Recursion.html#RefineG_Recursion.RECT_rule_arb|fact"><span>RECT_rule_arb</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> V</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Wellfounded.html#Wellfounded.measure|const"><span>measure</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>d</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> pre</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>λ</span></span><span class="bound"><span>xss</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs'</span></span><span class="main"><span>,</span></span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>xss</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="bound"><span>xs'</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Eisbach.Eisbach.html#Eisbach.all|method"><span class="operator"><span>all</span></span></a><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Partially_Sorted.html#Sorting_Partially_Sorted.sorted_wrt_imp_part_sorted|fact"><span>sorted_wrt_imp_part_sorted</span></a><span> </span><a class="entity_ref" href="Sorting_Partially_Sorted.html#Sorting_Partially_Sorted.part_sorted_wrt_init|fact"><span>part_sorted_wrt_init</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>fail</span></span><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span>›</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order_trans|fact"><span>order_trans</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.rprems|method"><span class="operator"><span>rprems</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>applyS</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order_trans|fact"><span>order_trans</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.rprems|method"><span class="operator"><span>rprems</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>applyS</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span>  
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Sorting_Partially_Sorted.html#Sorting_Partially_Sorted.part_sorted_concatI|fact"><span>part_sorted_concatI</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span class="main"><span>)</span></span><span> 
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="Sorting_Partially_Sorted.html#Sorting_Partially_Sorted.slice_LT_mset_eq1|fact"><span>slice_LT_mset_eq1</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="Sorting_Partially_Sorted.html#Sorting_Partially_Sorted.slice_LT_mset_eq2|fact"><span>slice_LT_mset_eq2</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>le_by_lt</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
    
      
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.partition2_spec_def|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.partition2_spec_def|thm"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.partition2_spec_def_raw|axiom"><span class="entity_def" id="offset_2331..2341">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.partition2_spec.cong|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.partition2_spec.cong|thm"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.partition2_spec|const"><span class="entity_def" id="offset_2343..2358">partition2_spec</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span> 
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>≥</span></a></span><span> </span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> 
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>xs'</span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="bound"><span>xs'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_Partially_Sorted.html#Sorting_Partially_Sorted.slice_LT|const"><span>slice_LT</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>≤</b>)</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.take|const"><span>take</span></a><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>xs'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.drop|const"><span>drop</span></a><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>xs'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>
      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.partition2_spec_refine|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.partition2_spec_refine|thm"><span class="entity_def" id="offset_2530..2552">partition2_spec_refine</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><span>,</span></span><span class="free"><span>xs'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_2343..2358"><span>partition2_spec</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="main"><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.br|const"><span>br</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.take|const"><span>take</span></a><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.drop|const"><span>drop</span></a><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_553..568"><span>partition1_spec</span></a><span> </span><span class="free"><span>xs'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_541..551"><span>partition1_spec_def</span></a><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_2331..2341"><span>partition2_spec_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RES_refine|fact"><span>RES_refine</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset_eq_length|fact"><span>mset_eq_length</span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.in_br_conv|fact"><span>in_br_conv</span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>flip</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset_append|fact"><span>mset_append</span></a><span class="main"><span>)</span></span><span>
      
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort_aux2_def|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort_aux2_def|thm"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort_aux2_def_raw|axiom"><span class="entity_def" id="offset_2861..2871">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort_aux2.cong|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort_aux2.cong|thm"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort_aux2|const"><span class="entity_def" id="offset_2872..2886">introsort_aux2</span></span></span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list|type"><span>list</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list|type"><span>list</span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres|type"><span>nres</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>introsort_aux2</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/RefineG_Recursion.html#RefineG_Recursion.RECT|const"><span>RECT</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>introsort_aux</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#Sorting_Quicksort_Scheme.is_threshold|const"><span>is_threshold</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
        </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="bound"><span>d</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span>
          </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.sort_spec|const"><span>sort_spec</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
          </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>m</span></span><span class="main"><span>)</span></span><span class="main"><span>←</span></span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_2343..2358"><span>partition2_spec</span></a><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>;</span></span><span>
          </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
          </span><span class="bound"><span>xs1</span></span><span> </span><span class="main"><span>←</span></span><span> </span><span class="bound"><span>introsort_aux</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.take|const"><span>take</span></a><span> </span><span class="bound"><span>m</span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>d</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
          </span><span class="bound"><span>xs2</span></span><span> </span><span class="main"><span>←</span></span><span> </span><span class="bound"><span>introsort_aux</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.drop|const"><span>drop</span></a><span> </span><span class="bound"><span>m</span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>d</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
          </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs1</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span class="bound"><span>xs2</span></span><span class="main"><span>)</span></span><span>
        </span><span class="main"><span>}</span></span><span>
      </span><span class="main"><span>}</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span>
        </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>xs</span></span><span>
    </span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort_aux2_refine|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort_aux2_refine|thm"><span class="entity_def" id="offset_3373..3394">introsort_aux2_refine</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_2872..2886"><span>introsort_aux2</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="main"><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_731..745"><span>introsort_aux1</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_2861..2871"><span>introsort_aux2_def</span></a><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_720..730"><span>introsort_aux1_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_rcg|method"><span class="operator"><span>refine_rcg</span></span></a><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_2530..2552"><span>partition2_spec_refine</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Heuristics.html#Refine_Heuristics.refine_dref_type|method"><span class="operator"><span>refine_dref_type</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.in_br_conv|fact"><span>in_br_conv</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      
    
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.partition3_spec_def|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.partition3_spec_def|thm"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.partition3_spec_def_raw|axiom"><span class="entity_def" id="offset_3641..3651">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.partition3_spec.cong|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.partition3_spec.cong|thm"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.partition3_spec|const"><span class="entity_def" id="offset_3653..3668">partition3_spec</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span> 
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>≥</span></a></span><span class="numeral"><span>4</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> 
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>xs'</span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset|const"><span>slice_eq_mset</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="bound"><span>xs'</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_Partially_Sorted.html#Sorting_Partially_Sorted.slice_LT|const"><span>slice_LT</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>≤</b>)</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>xs'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="bound"><span>i</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="bound"><span>xs'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> 
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.partition3_spec_refine|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.partition3_spec_refine|thm"><span>partition3_spec_refine</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>xsi</span></span><span class="main"><span>,</span></span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_rel|const"><span>slice_rel</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_3653..3668"><span>partition3_spec</span></a><span> </span><span class="free"><span>xsi</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span>  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="main"><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_rel|const"><span>slice_rel</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>0</sub></span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.prod_rel_syn|const"><span>×<span class="hidden">⇩</span><sub>r</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.idx_shift_rel|const"><span>idx_shift_rel</span></a><span> </span><span class="free"><span>l</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_2343..2358"><span>partition2_spec</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_3641..3651"><span>partition3_spec_def</span></a><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_2331..2341"><span>partition2_spec_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RES_refine|fact"><span>RES_refine</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_rel_def|fact"><span>slice_rel_def</span></a><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.in_br_conv|fact"><span>in_br_conv</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span>2</span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_rel_def|fact"><span>slice_rel_def</span></a><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.in_br_conv|fact"><span>in_br_conv</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> xs'i ii
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.exI|fact"><span>exI</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> x</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="skolem"><span>xs'i</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjI|fact"><span>conjI</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_def|fact"><span>slice_eq_mset_def</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.idx_shift_rel_alt|fact"><span>idx_shift_rel_alt</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_def|fact"><span>slice_eq_mset_def</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.take_slice|fact"><span>take_slice</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.drop_slice|fact"><span>drop_slice</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.partition3_spec_refine&apos;|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.partition3_spec_refine&apos;|thm"><span class="entity_def" id="offset_4491..4514">partition3_spec_refine'</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span class="main"><span>(</span></span><span class="free"><span>xsi</span></span><span class="main"><span>,</span></span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slicep_rel|const"><span>slicep_rel</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>xsi'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span>xsi</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>l'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span>l</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>h'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span>h</span></span><span class="main"><span>⟧</span></span><span> 
      </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_3653..3668"><span>partition3_spec</span></a><span> </span><span class="free"><span>xsi</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span>  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="main"><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_rel|const"><span>slice_rel</span></a><span> </span><span class="free"><span>xsi'</span></span><span> </span><span class="free"><span>l'</span></span><span> </span><span class="free"><span>h'</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.prod_rel_syn|const"><span>×<span class="hidden">⇩</span><sub>r</sub></span></a></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.idx_shift_rel|const"><span>idx_shift_rel</span></a><span> </span><span class="free"><span>l'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_2343..2358"><span>partition2_spec</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_3641..3651"><span>partition3_spec_def</span></a><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_2331..2341"><span>partition2_spec_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RES_refine|fact"><span>RES_refine</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slicep_rel_def|fact"><span>slicep_rel_def</span></a><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.in_br_conv|fact"><span>in_br_conv</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span>2</span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_rel_def|fact"><span>slice_rel_def</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slicep_rel_def|fact"><span>slicep_rel_def</span></a><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.in_br_conv|fact"><span>in_br_conv</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> xs'i ii
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.exI|fact"><span>exI</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> x</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="skolem"><span>xs'i</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjI|fact"><span>conjI</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_def|fact"><span>slice_eq_mset_def</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.idx_shift_rel_alt|fact"><span>idx_shift_rel_alt</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_def|fact"><span>slice_eq_mset_def</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.take_slice|fact"><span>take_slice</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.drop_slice|fact"><span>drop_slice</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      
      
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort_aux3_def|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort_aux3_def|thm"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort_aux3_def_raw|axiom"><span class="entity_def" id="offset_5176..5186">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort_aux3.cong|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort_aux3.cong|thm"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort_aux3|const"><span class="entity_def" id="offset_5187..5201">introsort_aux3</span></span></span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list|type"><span>list</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list|type"><span>list</span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres|type"><span>nres</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>introsort_aux3</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span> 
    </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/RefineG_Recursion.html#RefineG_Recursion.RECT|const"><span>RECT</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>introsort_aux</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>l</span></span><span class="main"><span>,</span></span><span class="bound"><span>h</span></span><span class="main"><span>,</span></span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
        </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="bound"><span>h</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
        </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="bound"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="bound"><span>l</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#Sorting_Quicksort_Scheme.is_threshold|const"><span>is_threshold</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
          </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="bound"><span>d</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span>
            </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.slice_sort_spec|const"><span>slice_sort_spec</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="bound"><span>h</span></span><span>
          </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
            </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>m</span></span><span class="main"><span>)</span></span><span class="main"><span>←</span></span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_3653..3668"><span>partition3_spec</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="bound"><span>h</span></span><span class="main"><span>;</span></span><span>
            </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><span class="bound"><span>introsort_aux</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>l</span></span><span class="main"><span>,</span></span><span class="bound"><span>m</span></span><span class="main"><span>,</span></span><span class="bound"><span>d</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
            </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><span class="bound"><span>introsort_aux</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>m</span></span><span class="main"><span>,</span></span><span class="bound"><span>h</span></span><span class="main"><span>,</span></span><span class="bound"><span>d</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
            </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>xs</span></span><span>
          </span><span class="main"><span>}</span></span><span>
        </span><span class="main"><span>}</span></span><span>
        </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span>
          </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>xs</span></span><span>
      </span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort_aux3_refine|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort_aux3_refine|thm"><span class="entity_def" id="offset_5719..5740">introsort_aux3_refine</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>xsi</span></span><span class="main"><span>,</span></span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slicep_rel|const"><span>slicep_rel</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_5187..5201"><span>introsort_aux3</span></a><span> </span><span class="free"><span>xsi</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_rel|const"><span>slice_rel</span></a><span> </span><span class="free"><span>xsi</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_2872..2886"><span>introsort_aux2</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_5176..5186"><span>introsort_aux3_def</span></a><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_2861..2871"><span>introsort_aux2_def</span></a><span>
      
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>supply</span></span></span></span></span><span> </span><span class="entity_def" id="offset_5916..5922">recref</span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.RECT_dep_refine|fact"><span>RECT_dep_refine</span></a><span class="main"><span>[</span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> 
          R</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="bound"><span>xsi</span></span><span class="main"><span>::</span></span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list|type"><span>list</span></a><span class="main"><span>,</span></span><span> </span><span class="bound"><span>l</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>h</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>di</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xsi</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slicep_rel|const"><span>slicep_rel</span></a><span> </span><span class="bound"><span>l</span></span><span> </span><span class="bound"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>di</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="bound"><span>d</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>and</span></span></span></span><span>
          S</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xsi</span></span><span class="main"><span>::</span></span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list|type"><span>list</span></a><span class="main"><span>,</span></span><span> </span><span class="bound"><span>l</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>h</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>di</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_rel|const"><span>slice_rel</span></a><span> </span><span class="bound"><span>xsi</span></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="bound"><span>h</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>and</span></span></span></span><span>
          arb<span class="hidden">⇩</span><sub>0</sub> </span><span class="main"><span class="main"><span>=</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Unity|const"><span>()</span></a></span><span>"</span></span></span><span>
          </span><span class="main"><span>]</span></span><span>

      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_rcg|method"><span class="operator"><span>refine_rcg</span></span></a><span> 
        </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_5916..5922"><span>recref</span></a><span> 
        </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_4491..4514"><span>partition3_spec_refine'</span></a><span>
        </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.slice_sort_spec_refine_sort&apos;|fact"><span>slice_sort_spec_refine_sort'</span></a><span>
        </span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.refl|fact"><span>refl</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span>
        </span><span class="main"><span>)</span></span><span>

      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slicep_rel_def|fact"><span>slicep_rel_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slicep_rel_def|fact"><span>slicep_rel_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.rprems|method"><span class="operator"><span>rprems</span></span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_rel_alt|fact"><span>slice_rel_alt</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.idx_shift_rel_def|fact"><span>idx_shift_rel_def</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slicep_rel_take|fact"><span>slicep_rel_take</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.rprems|method"><span class="operator"><span>rprems</span></span></a><span>  
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_rel_alt|fact"><span>slice_rel_alt</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.idx_shift_rel_def|fact"><span>idx_shift_rel_def</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slicep_rel_eq_outside_range|fact"><span>slicep_rel_eq_outside_range</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slicep_rel_drop|fact"><span>slicep_rel_drop</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_rel_alt|fact"><span>slice_rel_alt</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.idx_shift_rel_def|fact"><span>idx_shift_rel_def</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjI|fact"><span>conjI</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slicep_rel_append|fact"><span>slicep_rel_append</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slicep_rel_eq_outside_range|fact"><span>slicep_rel_eq_outside_range</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span class="main"><span>)</span></span><span> 
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> 
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> 
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>drule</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.eq_outside_range_gen_trans|fact"><span>eq_outside_range_gen_trans</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> _ _ </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.refl|fact"><span>refl</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.refl|fact"><span>refl</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>erule</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.eq_outside_range_gen_trans|fact"><span>eq_outside_range_gen_trans</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.max_def|fact"><span>max_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.algebra_simps|fact"><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slicep_rel_def|fact"><span>slicep_rel_def</span></a><span> </span><span class="quasi_keyword"><span>split</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.if_splits|fact"><span>if_splits</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_rel_alt|fact"><span>slice_rel_alt</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.eq_outside_range_triv|fact"><span>eq_outside_range_triv</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slicep_rel_def|fact"><span>slicep_rel_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
    

    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.slice_part_sorted_spec_def|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.slice_part_sorted_spec_def|thm"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.slice_part_sorted_spec_def_raw|axiom"><span class="entity_def" id="offset_7395..7405">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.slice_part_sorted_spec.cong|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.slice_part_sorted_spec.cong|thm"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.slice_part_sorted_spec|const"><span class="entity_def" id="offset_7407..7429">slice_part_sorted_spec</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xsi</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xsi</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>xsi'</span></span><span class="main"><span>.</span></span><span> 
        </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.eq_outside_range|const"><span>eq_outside_range</span></a><span> </span><span class="bound"><span>xsi'</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xsi</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> 
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="bound"><span>xsi'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xsi</span></span></span></span><span class="main"><span>)</span></span><span> 
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_Partially_Sorted.html#Sorting_Partially_Sorted.part_sorted_wrt|const"><span>part_sorted_wrt</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.le_by_lt|const"><span>le_by_lt</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#Sorting_Quicksort_Scheme.is_threshold|const"><span>is_threshold</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="bound"><span>xsi'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    
          
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort_aux3_correct|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort_aux3_correct|thm"><span>introsort_aux3_correct</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_5187..5201"><span>introsort_aux3</span></a><span> </span><span class="free"><span>xsi</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_7407..7429"><span>slice_part_sorted_spec</span></a><span> </span><span class="free"><span>xsi</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    
</span><span class="comment1"><span>(*      have "(xsi, slice l h xsi) ∈ slicep_rel l h"
        unfolding slicep_rel_def apply auto
        *)</span></span><span>
    
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_7906..7907">A</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_rel|const"><span>slice_rel</span></a><span> </span><span class="free"><span>xsi</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>xs'</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="bound"><span>xs'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xsi</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_Partially_Sorted.html#Sorting_Partially_Sorted.part_sorted_wrt|const"><span>part_sorted_wrt</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.le_by_lt|const"><span>le_by_lt</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span class="main"><span>)</span></span><span> </span><span class="numeral"><span>16</span></span><span> </span><span class="bound"><span>xs'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
        </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_7407..7429"><span>slice_part_sorted_spec</span></a><span> </span><span class="free"><span>xsi</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_7395..7405"><span>slice_part_sorted_spec_def</span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_rel_alt|fact"><span>slice_rel_alt</span></a><span>  </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slicep_rel_def|fact"><span>slicep_rel_def</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
    
      </span><span class="keyword1"><span class="command"><span>note</span></span></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_5719..5740"><span>introsort_aux3_refine</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="free"><span>xsi</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xsi</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="free"><span>l</span></span></span><span> </span><span class="quoted"><span class="free"><span>h</span></span></span><span> </span><span class="quoted"><span class="free"><span>d</span></span></span><span class="main"><span>]</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>note</span></span></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_3373..3394"><span>introsort_aux2_refine</span></a><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>note</span></span></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_1367..1389"><span>introsort_aux1_correct</span></a><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>note</span></span></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_7906..7907"><span>A</span></a><span>
      </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slicep_rel_def|fact"><span>slicep_rel_def</span></a><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_7395..7405"><span>slice_part_sorted_spec_def</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>
        
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>    
      

    </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹In the paper, we summarized steps 2 and 3. Here are the relevant lemmas: ›</span></span></span><span>        
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.partition3_spec_alt|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.partition3_spec_alt|thm"><span class="entity_def" id="offset_8661..8680">partition3_spec_alt</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_3653..3668"><span>partition3_spec</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_rel|const"><span>slice_rel</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.prod_rel_syn|const"><span>×<span class="hidden">⇩</span><sub>r</sub></span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_553..568"><span>partition1_spec</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_3641..3651"><span>partition3_spec_def</span></a><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_541..551"><span>partition1_spec_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.pw_eq_iff|fact"><span>pw_eq_iff</span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_def|fact"><span>slice_eq_mset_def</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_rel_def|fact"><span>slice_rel_def</span></a><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.in_br_conv|fact"><span>in_br_conv</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/SMT/smt_systems.ML.html#SMT.smt|method"><span class="operator"><span>smt</span></span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_len|fact"><span>Sorting_Misc.slice_len</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.diff_is_0_eq|fact"><span>diff_is_0_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.order_class.leD|fact"><span>leD</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.linordered_semidom_class.le_add_diff_inverse|fact"><span>le_add_diff_inverse</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.less_imp_le_nat|fact"><span>less_imp_le_nat</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.less_le_trans|fact"><span>less_le_trans</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list.size|fact"><span>list.size</span></a><span class="main"><span class="main"><span>(</span></span></span><span>3</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset_append|fact"><span>mset_append</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_append|fact"><span>slice_append</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset_append|fact"><span>mset_append</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice_len|fact"><span>Misc.slice_len</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.ordered_ab_semigroup_add_imp_le_class.add_le_cancel_left|fact"><span>add_le_cancel_left</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.drop_all|fact"><span>drop_all</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Word_Lib.Many_More.html#Many_More.drop_append_miracle|fact"><span>drop_append_miracle</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.linorder_class.leI|fact"><span>leI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.linordered_semidom_class.le_add_diff_inverse|fact"><span>le_add_diff_inverse</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice_def|fact"><span>Misc.slice_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.cancel_ab_semigroup_add_class.add_diff_cancel_left&apos;|fact"><span>add_diff_cancel_left'</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.append_assoc|fact"><span>append_assoc</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.append_eq_conv_conj|fact"><span>append_eq_conv_conj</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.drop_slice|fact"><span>drop_slice</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.drop_take|fact"><span>drop_take</span></a><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.drop_take_drop_unsplit|fact"><span>drop_take_drop_unsplit</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

    </span><span class="keyword1"><span class="command"><span>corollary</span></span></span><span> </span><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.partition3_spec_alt&apos;|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.partition3_spec_alt&apos;|thm"><span class="entity_def" id="offset_9520..9540">partition3_spec_alt'</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_3653..3668"><span>partition3_spec</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="bound"><span>xsi'</span></span><span class="main"><span>,</span></span><span class="bound"><span>m</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="main"><span>(</span></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xsi'</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_rel|const"><span>slice_rel</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span>l</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_553..568"><span>partition1_spec</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_8661..8680"><span>partition3_spec_alt</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.pw_eq_iff|fact"><span>pw_eq_iff</span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      
    </span><span class="keyword1"><span class="command"><span>corollary</span></span></span><span> </span><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.partition3_spec_direct_refine|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.partition3_spec_direct_refine|thm"><span class="entity_def" id="offset_9842..9871">partition3_spec_direct_refine</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span> </span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>≥</span></a></span><span class="numeral"><span>4</span></span><span class="main"><span>;</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xsi</span></span><span class="main"><span>,</span></span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slicep_rel|const"><span>slicep_rel</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_3653..3668"><span>partition3_spec</span></a><span> </span><span class="free"><span>xsi</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="bound"><span>xsi'</span></span><span class="main"><span>,</span></span><span class="bound"><span>m</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="main"><span>(</span></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xsi'</span></span><span class="main"><span>,</span></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_rel|const"><span>slice_rel</span></a><span> </span><span class="free"><span>xsi</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span>l</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="bound"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_553..568"><span>partition1_spec</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_9520..9540"><span>partition3_spec_alt'</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slicep_rel_def|fact"><span>slicep_rel_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      
          
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.slice_part_sorted_spec_alt|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.slice_part_sorted_spec_alt|thm"><span>slice_part_sorted_spec_alt</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_7407..7429"><span>slice_part_sorted_spec</span></a><span> </span><span class="free"><span>xsi</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_rel|const"><span>slice_rel</span></a><span> </span><span class="free"><span>xsi</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span class="main"><span>(</span></span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xsi</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>xs'</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="bound"><span>xs'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>xsi</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_Partially_Sorted.html#Sorting_Partially_Sorted.part_sorted_wrt|const"><span>part_sorted_wrt</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.le_by_lt|const"><span>le_by_lt</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span class="main"><span>)</span></span><span> </span><span class="numeral"><span>16</span></span><span> </span><span class="bound"><span>xs'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_7395..7405"><span>slice_part_sorted_spec_def</span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.pw_eq_iff|fact"><span>pw_eq_iff</span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_rel_alt|fact"><span>slice_rel_alt</span></a><span>  </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slicep_rel_def|fact"><span>slicep_rel_def</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.eq_outside_rane_lenD|fact"><span>eq_outside_rane_lenD</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

    </span><span class="comment1"><span>(* Extracted this subgoal to present it in paper *)</span></span><span>      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort_aux3_direct_refine_aux1&apos;|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort_aux3_direct_refine_aux1&apos;|thm"><span class="entity_def" id="offset_10664..10698">introsort_aux3_direct_refine_aux1'</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>xs'</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_rel|const"><span>slice_rel</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>l</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>xs'</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_rel_def|fact"><span>slice_rel_def</span></a><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.in_br_conv|fact"><span>in_br_conv</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice_def|fact"><span>Misc.slice_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.cancel_ab_semigroup_add_class.add_diff_cancel_left&apos;|fact"><span>add_diff_cancel_left'</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.append.assoc|fact"><span>append.assoc</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.append_eq_conv_conj|fact"><span>append_eq_conv_conj</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.append_take_drop_id|fact"><span>append_take_drop_id</span></a><span class="main"><span>)</span></span><span>
      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort_aux3_direct_refine_aux1|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort_aux3_direct_refine_aux1|thm"><span class="entity_def" id="offset_10957..10990">introsort_aux3_direct_refine_aux1</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span class="main"><span>(</span></span><span class="free"><span>xsi'</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_rel|const"><span>slice_rel</span></a><span> </span><span class="free"><span>xsi</span></span><span> </span><span class="free"><span>l'</span></span><span> </span><span class="free"><span>h'</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xsi'</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slicep_rel|const"><span>slicep_rel</span></a><span> </span><span class="free"><span>l'</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>l'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slicep_rel_def|fact"><span>slicep_rel_def</span></a><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_10664..10698"><span>introsort_aux3_direct_refine_aux1'</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_rel_alt|fact"><span>slice_rel_alt</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slicep_rel_def|fact"><span>slicep_rel_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice_len|fact"><span>Misc.slice_len</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.ab_semigroup_add_class.add_ac|fact"><span>ab_semigroup_add_class.add_ac</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.le_add1|fact"><span>le_add1</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length_append|fact"><span>length_append</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.ordered_cancel_comm_monoid_diff_class.add_diff_inverse|fact"><span>ordered_cancel_comm_monoid_diff_class.add_diff_inverse</span></a><span class="main"><span>)</span></span><span>
    
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort_aux3_direct_refine|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort_aux3_direct_refine|thm"><span>introsort_aux3_direct_refine</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>xsi</span></span><span class="main"><span>,</span></span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slicep_rel|const"><span>slicep_rel</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_5187..5201"><span>introsort_aux3</span></a><span> </span><span class="free"><span>xsi</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.conc_fun|const"><span>⇓</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_rel|const"><span>slice_rel</span></a><span> </span><span class="free"><span>xsi</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_731..745"><span>introsort_aux1</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_5176..5186"><span>introsort_aux3_def</span></a><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_720..730"><span>introsort_aux1_def</span></a><span>
      
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>supply</span></span></span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine|attribute"><span class="operator"><span>refine</span></span></a><span> </span><span class="quasi_keyword"><span>del</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RECT_refine|fact"><span>RECT_refine</span></a><span>
      
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>supply</span></span></span></span></span><span> </span><span class="entity_def" id="offset_11626..11632">recref</span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.RECT_dep_refine|fact"><span>RECT_dep_refine</span></a><span class="main"><span>[</span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> 
          R</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="bound"><span>xsi</span></span><span class="main"><span>::</span></span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list|type"><span>list</span></a><span class="main"><span>,</span></span><span> </span><span class="bound"><span>l</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>h</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>di</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xsi</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slicep_rel|const"><span>slicep_rel</span></a><span> </span><span class="bound"><span>l</span></span><span> </span><span class="bound"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>di</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="bound"><span>d</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>and</span></span></span></span><span>
          S</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xsi</span></span><span class="main"><span>::</span></span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list|type"><span>list</span></a><span class="main"><span>,</span></span><span> </span><span class="bound"><span>l</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>h</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>di</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_rel|const"><span>slice_rel</span></a><span> </span><span class="bound"><span>xsi</span></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="bound"><span>h</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>and</span></span></span></span><span>
          arb<span class="hidden">⇩</span><sub>0</sub> </span><span class="main"><span class="main"><span>=</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Unity|const"><span>()</span></a></span><span>"</span></span></span><span>
          </span><span class="main"><span>]</span></span><span>

      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_rcg|method"><span class="operator"><span>refine_rcg</span></span></a><span> 
        </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_11626..11632"><span>recref</span></a><span>
        </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.slice_sort_spec_refine_sort&apos;|fact"><span>slice_sort_spec_refine_sort'</span></a><span>
        </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_9842..9871"><span>partition3_spec_direct_refine</span></a><span>
        </span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.refl|fact"><span>refl</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span>
        </span><span class="main"><span>)</span></span><span>

      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slicep_rel_def|fact"><span>slicep_rel_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slicep_rel_def|fact"><span>slicep_rel_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.rprems|method"><span class="operator"><span>rprems</span></span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_10957..10990"><span>introsort_aux3_direct_refine_aux1</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.rprems|method"><span class="operator"><span>rprems</span></span></a><span>  
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_rel_alt|fact"><span>slice_rel_alt</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slicep_rel_def|fact"><span>slicep_rel_def</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice_def|fact"><span>Misc.slice_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Word_Lib.Many_More.html#Many_More.drop_append_miracle|fact"><span>drop_append_miracle</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.drop_slice|fact"><span>drop_slice</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.eq_outside_range_def|fact"><span>eq_outside_range_def</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.add_diff_assoc|fact"><span>Nat.add_diff_assoc</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_len|fact"><span>Sorting_Misc.slice_len</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.cancel_ab_semigroup_add_class.add_diff_cancel_left&apos;|fact"><span>add_diff_cancel_left'</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.ordered_ab_semigroup_add_imp_le_class.add_le_cancel_left|fact"><span>add_le_cancel_left</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.comm_monoid_diff_class.diff_add_zero|fact"><span>diff_add_zero</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.diff_is_0_eq|fact"><span>diff_is_0_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length_append|fact"><span>length_append</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.eq_outside_rane_lenD|fact"><span>eq_outside_rane_lenD</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_rel_alt|fact"><span>slice_rel_alt</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.idx_shift_rel_def|fact"><span>idx_shift_rel_def</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjI|fact"><span>conjI</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slicep_rel_append|fact"><span>slicep_rel_append</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slicep_rel_eq_outside_range|fact"><span>slicep_rel_eq_outside_range</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span class="main"><span>)</span></span><span> 
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> 
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> 
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>drule</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.eq_outside_range_gen_trans|fact"><span>eq_outside_range_gen_trans</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> _ _ </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.refl|fact"><span>refl</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.refl|fact"><span>refl</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>erule</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.eq_outside_range_gen_trans|fact"><span>eq_outside_range_gen_trans</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.max_def|fact"><span>max_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.algebra_simps|fact"><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slicep_rel_def|fact"><span>slicep_rel_def</span></a><span> </span><span class="quasi_keyword"><span>split</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.if_splits|fact"><span>if_splits</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_rel_alt|fact"><span>slice_rel_alt</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.eq_outside_range_triv|fact"><span>eq_outside_range_triv</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slicep_rel_def|fact"><span>slicep_rel_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      
      
      
      
      
      
      
    
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.final_sort_spec_def|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.final_sort_spec_def|thm"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.final_sort_spec_def_raw|axiom"><span class="entity_def" id="offset_13444..13454">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.final_sort_spec.cong|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.final_sort_spec.cong|thm"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.final_sort_spec|const"><span class="entity_def" id="offset_13456..13471">final_sort_spec</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Sorting_Partially_Sorted.html#Sorting_Partially_Sorted.part_sorted_wrt|const"><span>part_sorted_wrt</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.le_by_lt|const"><span>le_by_lt</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#Sorting_Quicksort_Scheme.is_threshold|const"><span>is_threshold</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice|const"><span>slice</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.slice_sort_spec|const"><span>slice_sort_spec</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span>
      </span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort3_def|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort3_def|thm"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort3_def_raw|axiom"><span class="entity_def" id="offset_13623..13633">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort3.cong|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort3.cong|thm"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort3|const"><span class="entity_def" id="offset_13635..13645">introsort3</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
        </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_7407..7429"><span>slice_part_sorted_spec</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><span>;</span></span><span>
        </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_13456..13471"><span>final_sort_spec</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><span>;</span></span><span>
        </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="bound"><span>xs</span></span><span>
      </span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>  
    
    
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort3_correct|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.introsort3_correct|thm"><span>introsort3_correct</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_13635..13645"><span>introsort3</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.slice_sort_spec|const"><span>slice_sort_spec</span></a><span> </span><span class="main"><span class="free"><span>(<span class="hidden">❙</span><b>&lt;</b>)</span></span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span>h</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="free"><span>l</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_13623..13633"><span>introsort3_def</span></a><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_7395..7405"><span>slice_part_sorted_spec_def</span></a><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_13444..13454"><span>final_sort_spec_def</span></a><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.slice_sort_spec_alt|fact"><span>slice_sort_spec_alt</span></a><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.pw_le_iff|fact"><span>pw_le_iff</span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.eq_outside_rane_lenD|fact"><span>eq_outside_rane_lenD</span></a><span> </span><span class="quasi_keyword"><span>elim</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.eq_outside_range_gen_trans|fact"><span>eq_outside_range_gen_trans</span></a><span class="main"><span class="main"><span>[</span></span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="main"><span class="main"><span>_</span></span></span><span> </span><span class="main"><span class="main"><span>_</span></span></span><span> </span><span class="quoted"><span class="free"><span>l</span></span></span><span> </span><span class="quoted"><span class="free"><span>h</span></span></span><span> </span><span class="main"><span class="main"><span>_</span></span></span><span> </span><span class="quoted"><span class="free"><span>l</span></span></span><span> </span><span class="quoted"><span class="free"><span>h</span></span></span><span> </span><span class="quoted"><span class="free"><span>l</span></span></span><span> </span><span class="quoted"><span class="free"><span>h</span></span></span><span class="main"><span class="main"><span>,</span></span></span><span> </span><span class="operator"><span>simplified</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_13623..13633"><span>introsort3_def</span></a><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.slice_sort_spec_alt|fact"><span>slice_sort_spec_alt</span></a><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_7395..7405"><span>slice_part_sorted_spec_def</span></a><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_13444..13454"><span>final_sort_spec_def</span></a><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.eq_outside_range_triv|fact"><span>eq_outside_range_triv</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.sorted_wrt01|fact"><span>sorted_wrt01</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>            
        </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Setup.html#Sorting_Setup.slice_sort_spec_alt|fact"><span>slice_sort_spec_alt</span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span> 
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      
      
          
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.partition3_spec_for_paper|fact"><span class="entity_def" id="Sorting_Quicksort_Scheme.weak_ordering.partition3_spec_for_paper|thm"><span>partition3_spec_for_paper</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_3653..3668"><span>partition3_spec</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span> 
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>4</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> 
      </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>xs'</span></span><span class="main"><span>,</span></span><span class="bound"><span>m</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="bound"><span>xs'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset|const"><span>mset</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><span class="bound"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>∀</span></span><span class="bound"><span>j</span></span><span class="main"><span>∈</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>{</span></a></span><span class="bound"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>..&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.atLeastLessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>xs'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span class="free"><span><span class="hidden">❙</span><b>≤</b></span></span></span><span> </span><span class="bound"><span>xs'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Sorting_Quicksort_Scheme.html#offset_3641..3651"><span>partition3_spec_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.pw_eq_iff|fact"><span>pw_eq_iff</span></a><span> </span><a class="entity_ref" href="Sorting_Partially_Sorted.html#Sorting_Partially_Sorted.slice_LT_def|fact"><span>slice_LT_def</span></a><span> </span><a class="entity_ref" href="Sorting_Misc.html#Sorting_Misc.slice_eq_mset_def|fact"><span>slice_eq_mset_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Ball_def|fact"><span>Ball_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.in_set_conv_nth|fact"><span>in_set_conv_nth</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice_complete|fact"><span>slice_complete</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> a m i j
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>drule</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.spec|fact"><span>spec</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> x</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="skolem"><span>i</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice_nth|fact"><span>slice_nth</span></a><span class="main"><span>)</span></span><span> 
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>drule</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.spec|fact"><span>spec</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> x</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="skolem"><span>j</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>erule</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.mp|fact"><span>mp</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.exI|fact"><span>exI</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> x</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="skolem"><span>m</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice_nth|fact"><span>slice_nth</span></a><span class="main"><span>)</span></span><span> 
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Meson/meson_tactic.ML.html#Meson.meson|method"><span class="operator"><span>meson</span></span></a><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset_eq_length|fact"><span>mset_eq_length</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.size_mset|fact"><span>size_mset</span></a><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice_complete|fact"><span>slice_complete</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.dual_order.refl|fact"><span>dual_order.refl</span></a><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.mset_eq_length|fact"><span>mset_eq_length</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice_len|fact"><span>Misc.slice_len</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.ab_semigroup_add_class.add.commute|fact"><span>add.commute</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.le_add1|fact"><span>le_add1</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.less_diff_conv|fact"><span>less_diff_conv</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.less_or_eq_imp_le|fact"><span>less_or_eq_imp_le</span></a><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/HOL-Library.Multiset.html#Multiset.size_mset|fact"><span>size_mset</span></a><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.slice_nth|fact"><span>slice_nth</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      
      
      
      
  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>  


</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span></pre>
</body>

</html>