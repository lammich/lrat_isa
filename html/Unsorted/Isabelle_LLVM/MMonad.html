<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory MMonad</title>
</head>


<body>
<div class="head">
<h1>Theory MMonad</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹State-Exception-Nondeterminism Monad with Access Reports›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><a href="MMonad.html"><span>MMonad</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> </span><a href="NEMonad.html"><span>NEMonad</span></a><span> </span><a href="Generic_Memory.html"><span>Generic_Memory</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

  </span><span class="comment1"><span>(* TODO: Move *)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.fresh_freed_not_valid|fact"><span class="entity_def" id="MMonad.fresh_freed_not_valid(4)|thm"><span class="entity_def" id="MMonad.fresh_freed_not_valid(3)|thm"><span class="entity_def" id="MMonad.fresh_freed_not_valid(2)|thm"><span class="entity_def" id="MMonad.fresh_freed_not_valid(1)|thm"><span>fresh_freed_not_valid</span></span></span></span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.is_FRESH|const"><span>is_FRESH</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.addr.block|const"><span>addr.block</span></a><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.is_valid_addr|const"><span>is_valid_addr</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="free"><span>a</span></span><span>"</span></span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.is_FREED|const"><span>is_FREED</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.addr.block|const"><span>addr.block</span></a><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.is_valid_addr|const"><span>is_valid_addr</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="free"><span>a</span></span><span>"</span></span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.is_FRESH|const"><span>is_FRESH</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.addr.block|const"><span>addr.block</span></a><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.is_valid_ptr_addr|const"><span>is_valid_ptr_addr</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="free"><span>a</span></span><span>"</span></span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.is_FREED|const"><span>is_FREED</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.addr.block|const"><span>addr.block</span></a><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.is_valid_ptr_addr|const"><span>is_valid_ptr_addr</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="free"><span>a</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.is_valid_addr_def|fact"><span>is_valid_addr_def</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.is_valid_ptr_addr_def|fact"><span>is_valid_ptr_addr_def</span></a><span> </span><span class="quasi_keyword"><span>split</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.addr.split|fact"><span>addr.split</span></a><span class="main"><span>)</span></span><span>
  


  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹We define this Monad directly over our memory model, 
    but still generic in the stored values.
    
    The definition of the operations is done in two layers: first, we define the operations in the 
    ne-monad, prove that they preserve the consistency and non-emptiness invariant, and then
    lift them to the subtype for the actual M-monad.
  ›</span></span></span><span>


  </span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Invariant and Subtype›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
    Our monad requires the following invariants, which will be enforced by a subtype
  
    </span><span class="antiquoted"><span>▸</span></span><span> the reported ACC_REPORT is consistent with the observable changes on the state. 
      This is a sanity check property, which also enables us to show commutativity of par.
    </span><span class="antiquoted"><span>▸</span></span><span> each program returns at least one possible result.
      This is a sanity check property, which ensures that we don't accidentally verify a 
      'magic' program.
    </span><span class="antiquoted"><span>▸</span></span><span> the memory manager can choose any available addresses.
      This is required to give it enough flexibility to always leave non-conflicting choices
      for parallel composition.
  
  ›</span></span></span><span>
  
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.consistentM_def|fact"><span class="entity_def" id="MMonad.consistentM_def|thm"><span class="entity_def" id="MMonad.consistentM_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="MMonad.consistentM|const"><span>consistentM</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>s</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wlp|const"><span>wlp</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_consistent|const"><span>acc_consistent</span></a><span> </span><span class="bound"><span>s</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.consistentM_pw_def|fact"><span class="entity_def" id="MMonad.consistentM_pw_def|thm"><span class="entity_def" id="MMonad.consistentM_pw_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="MMonad.consistentM_pw|const"><span>consistentM_pw</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wlp|const"><span>wlp</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_consistent|const"><span>acc_consistent</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.non_emptyM_pw_def|fact"><span class="entity_def" id="MMonad.non_emptyM_pw_def|thm"><span class="entity_def" id="MMonad.non_emptyM_pw_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="MMonad.non_emptyM_pw|const"><span>non_emptyM_pw</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><a class="entity_ref" href="NEMonad.html#NEMonad.is_fail|const"><span>is_fail</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> 
    </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>B</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="bound"><span>B</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc.a|const"><span>acc.a</span></a><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>∩</span></a></span><span> </span><span class="bound"><span>B</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span> </span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.non_emptyM_def|fact"><span class="entity_def" id="MMonad.non_emptyM_def|thm"><span class="entity_def" id="MMonad.non_emptyM_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="MMonad.non_emptyM|const"><span>non_emptyM</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>s</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><a class="entity_ref" href="NEMonad.html#NEMonad.is_fail|const"><span>is_fail</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> 
    </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>B</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="bound"><span>B</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc.a|const"><span>acc.a</span></a><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>∩</span></a></span><span> </span><span class="bound"><span>B</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span> </span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.non_emptyM_pw|fact"><span class="entity_def" id="MMonad.non_emptyM_pw|thm"><span>non_emptyM_pw</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.non_emptyM|const"><span>non_emptyM</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>s</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.non_emptyM_pw|const"><span>non_emptyM_pw</span></a><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>m</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.non_emptyM_def|fact"><span>non_emptyM_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.non_emptyM_pw_def|fact"><span>non_emptyM_pw_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.consistentM_pw|fact"><span class="entity_def" id="MMonad.consistentM_pw|thm"><span>consistentM_pw</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.consistentM|const"><span>consistentM</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>s</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.consistentM_pw|const"><span>consistentM_pw</span></a><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>m</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.consistentM_def|fact"><span>consistentM_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.consistentM_pw_def|fact"><span>consistentM_pw_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.invarM_def|fact"><span class="entity_def" id="MMonad.invarM_def|thm"><span class="entity_def" id="MMonad.invarM_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="MMonad.invarM|const"><span>invarM</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.consistentM|const"><span>consistentM</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.non_emptyM|const"><span>non_emptyM</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span>"</span></span></span><span>  

  </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.invarM_pw_def|fact"><span class="entity_def" id="MMonad.invarM_pw_def|thm"><span class="entity_def" id="MMonad.invarM_pw_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="MMonad.invarM_pw|const"><span>invarM_pw</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.consistentM_pw|const"><span>consistentM_pw</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.non_emptyM_pw|const"><span>non_emptyM_pw</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span>"</span></span></span><span>
  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.invarM_pw|fact"><span class="entity_def" id="MMonad.invarM_pw|thm"><span>invarM_pw</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.invarM|const"><span>invarM</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>s</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.invarM_pw|const"><span>invarM_pw</span></a><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>m</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.invarM_def|fact"><span>invarM_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.invarM_pw_def|fact"><span>invarM_pw_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.consistentM_pw|fact"><span>consistentM_pw</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.non_emptyM_pw|fact"><span>non_emptyM_pw</span></a><span class="main"><span>)</span></span><span>
 
  </span><span class="comment1"><span>(* For presentation in paper *)</span></span><span>   
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.invarM|const"><span>invarM</span></a><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>μ</span></span><span> </span><span class="bound"><span>P</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="bound"><span>μ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.SPEC|const"><span>SPEC</span></a><span> </span><span class="bound"><span>P</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span>
    </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>ρ</span></span><span> </span><span class="bound"><span>μ'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="bound"><span>P</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>ρ</span></span><span class="main"><span>,</span></span><span class="bound"><span>μ'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_consistent|const"><span>acc_consistent</span></a><span> </span><span class="bound"><span>μ</span></span><span> </span><span class="bound"><span>ρ</span></span><span> </span><span class="bound"><span>μ'</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>B</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="bound"><span>B</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>ρ</span></span><span> </span><span class="bound"><span>μ'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="bound"><span>P</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>ρ</span></span><span class="main"><span>,</span></span><span class="bound"><span>μ'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc.a|const"><span>acc.a</span></a><span> </span><span class="bound"><span>ρ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>∩</span></a></span><span> </span><span class="bound"><span>B</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span> </span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.invarM_def|fact"><span>invarM_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.consistentM_def|fact"><span>consistentM_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.non_emptyM_def|fact"><span>non_emptyM_def</span></a><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wlp_def|fact"><span>wlp_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_fail_def|fact"><span>is_fail_def</span></a><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res_def|fact"><span>is_res_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.safe|method"><span class="operator"><span>safe</span></span></a><span class="main"><span class="keyword3"><span>;</span></span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.sel|fact"><span>neM.sel</span></a><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.simps|fact"><span>neM.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>3</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.collapse|fact"><span>neM.collapse</span></a><span class="main"><span>)</span></span><span>
    
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_2868..2873">lemma</span></span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>ρ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc.ACC_REPORT|const"><span>ACC_REPORT</span></a><span> </span><span class="free"><span>r</span></span><span> </span><span class="free"><span>w</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span>  
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_consistent|const"><span>acc_consistent</span></a><span> </span><span class="free"><span>μ</span></span><span> </span><span class="free"><span>ρ</span></span><span> </span><span class="free"><span>μ'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="main"><span>(</span></span><span>
      </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>addr</span></span><span class="main"><span>∈</span></span><span class="free"><span>r</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="free"><span>w</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.addr.block|const"><span>addr.block</span></a><span> </span><span class="bound"><span>addr</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.not_member|const"><span>∉</span></a></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.is_valid_addr|const"><span>is_valid_addr</span></a><span> </span><span class="free"><span>μ</span></span><span> </span><span class="bound"><span>addr</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span>
      </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>addr</span></span><span class="main"><span>∈</span></span><span class="free"><span>r</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="free"><span>w</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.addr.block|const"><span>addr.block</span></a><span> </span><span class="bound"><span>addr</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.not_member|const"><span>∉</span></a></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.is_valid_addr|const"><span>is_valid_addr</span></a><span> </span><span class="free"><span>μ'</span></span><span> </span><span class="bound"><span>addr</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span>
      </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>b</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.valid_block_trans|const"><span>valid_block_trans</span></a><span> </span><span class="free"><span>μ</span></span><span> </span><span class="free"><span>μ'</span></span><span> </span><span class="bound"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span>
      </span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.alloc_blocks|const"><span>alloc_blocks</span></a><span> </span><span class="free"><span>μ</span></span><span> </span><span class="free"><span>μ'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span>
      </span><span class="free"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.freed_blocks|const"><span>freed_blocks</span></a><span> </span><span class="free"><span>μ</span></span><span> </span><span class="free"><span>μ'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> 
      </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>addr</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.is_valid_addr|const"><span>is_valid_addr</span></a><span> </span><span class="free"><span>μ</span></span><span> </span><span class="bound"><span>addr</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.is_valid_addr|const"><span>is_valid_addr</span></a><span> </span><span class="free"><span>μ'</span></span><span> </span><span class="bound"><span>addr</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>addr</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.not_member|const"><span>∉</span></a></span><span> </span><span class="free"><span>w</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.get_addr|const"><span>get_addr</span></a><span> </span><span class="free"><span>μ</span></span><span> </span><span class="bound"><span>addr</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.get_addr|const"><span>get_addr</span></a><span> </span><span class="free"><span>μ'</span></span><span> </span><span class="bound"><span>addr</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_consistent_def|fact"><span>acc_consistent_def</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.valid_block_trans_def|fact"><span>valid_block_trans_def</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.alloc_blocks_def|fact"><span>alloc_blocks_def</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.freed_blocks_def|fact"><span>freed_blocks_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_2868..2873"><span>assms</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.is_ALLOC_conv|fact"><span>is_ALLOC_conv</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.safe|method"><span class="operator"><span>safe</span></span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/SMT/smt_systems.ML.html#SMT.smt|method"><span class="operator"><span>smt</span></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> best</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.UnI1|fact"><span>UnI1</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.addr.case_eq_if|fact"><span>addr.case_eq_if</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.block.disc|fact"><span>block.disc</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.block.distinct|fact"><span>block.distinct</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.is_valid_addr_alt|fact"><span>is_valid_addr_alt</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.mem_Collect_eq|fact"><span>mem_Collect_eq</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.addr.case_eq_if|fact"><span>addr.case_eq_if</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.is_valid_addr_alt|fact"><span>is_valid_addr_alt</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>,</span></span></span><span> lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.UnI2|fact"><span>UnI2</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.addr.case_eq_if|fact"><span>addr.case_eq_if</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.block.disc|fact"><span>block.disc</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.block.distinct|fact"><span>block.distinct</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.is_valid_addr_alt|fact"><span>is_valid_addr_alt</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.mem_Collect_eq|fact"><span>mem_Collect_eq</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.addr.case_eq_if|fact"><span>addr.case_eq_if</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.is_valid_addr_alt|fact"><span>is_valid_addr_alt</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
    
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_4054..4059">lemma</span></span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>ρ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc.ACC_REPORT|const"><span>ACC_REPORT</span></a><span> </span><span class="free"><span>r</span></span><span> </span><span class="free"><span>w</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span>  
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_consistent|const"><span>acc_consistent</span></a><span> </span><span class="free"><span>μ</span></span><span> </span><span class="free"><span>ρ</span></span><span> </span><span class="free"><span>μ'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="main"><span>(</span></span><span>
      </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>addr</span></span><span class="main"><span>∈</span></span><span class="free"><span>r</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="free"><span>w</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.addr.block|const"><span>addr.block</span></a><span> </span><span class="bound"><span>addr</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.not_member|const"><span>∉</span></a></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.is_valid_addr|const"><span>is_valid_addr</span></a><span> </span><span class="free"><span>μ</span></span><span> </span><span class="bound"><span>addr</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span>
      </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>addr</span></span><span class="main"><span>∈</span></span><span class="free"><span>r</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="free"><span>w</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.addr.block|const"><span>addr.block</span></a><span> </span><span class="bound"><span>addr</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.not_member|const"><span>∉</span></a></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.is_valid_addr|const"><span>is_valid_addr</span></a><span> </span><span class="free"><span>μ'</span></span><span> </span><span class="bound"><span>addr</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span>
      </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>b</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.valid_block_trans|const"><span>valid_block_trans</span></a><span> </span><span class="free"><span>μ</span></span><span> </span><span class="free"><span>μ'</span></span><span> </span><span class="bound"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span>
      </span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.alloc_blocks|const"><span>alloc_blocks</span></a><span> </span><span class="free"><span>μ</span></span><span> </span><span class="free"><span>μ'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span>
      </span><span class="free"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.freed_blocks|const"><span>freed_blocks</span></a><span> </span><span class="free"><span>μ</span></span><span> </span><span class="free"><span>μ'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> 
      </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>addr</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.is_valid_addr|const"><span>is_valid_addr</span></a><span> </span><span class="free"><span>μ</span></span><span> </span><span class="bound"><span>addr</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.is_valid_addr|const"><span>is_valid_addr</span></a><span> </span><span class="free"><span>μ'</span></span><span> </span><span class="bound"><span>addr</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>addr</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.not_member|const"><span>∉</span></a></span><span> </span><span class="free"><span>w</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.get_addr|const"><span>get_addr</span></a><span> </span><span class="free"><span>μ</span></span><span> </span><span class="bound"><span>addr</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.get_addr|const"><span>get_addr</span></a><span> </span><span class="free"><span>μ'</span></span><span> </span><span class="bound"><span>addr</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_consistent_def|fact"><span>acc_consistent_def</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.valid_block_trans_def|fact"><span>valid_block_trans_def</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.alloc_blocks_def|fact"><span>alloc_blocks_def</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.freed_blocks_def|fact"><span>freed_blocks_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_4054..4059"><span>assms</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.is_ALLOC_conv|fact"><span>is_ALLOC_conv</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.safe|method"><span class="operator"><span>safe</span></span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/SMT/smt_systems.ML.html#SMT.smt|method"><span class="operator"><span>smt</span></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> best</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.UnI1|fact"><span>UnI1</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.addr.case_eq_if|fact"><span>addr.case_eq_if</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.block.disc|fact"><span>block.disc</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.block.distinct|fact"><span>block.distinct</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.is_valid_addr_alt|fact"><span>is_valid_addr_alt</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.mem_Collect_eq|fact"><span>mem_Collect_eq</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.addr.case_eq_if|fact"><span>addr.case_eq_if</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.is_valid_addr_alt|fact"><span>is_valid_addr_alt</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>,</span></span></span><span> lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.UnI2|fact"><span>UnI2</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.addr.case_eq_if|fact"><span>addr.case_eq_if</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.block.disc|fact"><span>block.disc</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.block.distinct|fact"><span>block.distinct</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.is_valid_addr_alt|fact"><span>is_valid_addr_alt</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.mem_Collect_eq|fact"><span>mem_Collect_eq</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.addr.case_eq_if|fact"><span>addr.case_eq_if</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.is_valid_addr_alt|fact"><span>is_valid_addr_alt</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
    
    
  
  
      
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_5258..5263">lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.consistentMI|fact"><span class="entity_def" id="MMonad.consistentMI|thm"><span>consistentMI</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.intro|attribute"><span class="operator"><span>intro</span></span></a><span class="main"><span class="main"><span class="main"><span class="main"><span>?</span></span></span></span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wlp|const"><span>wlp</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>m</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_consistent|const"><span>acc_consistent</span></a><span> </span><span class="bound"><span>s</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.consistentM|const"><span>consistentM</span></a><span> </span><span class="free"><span>m</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_5258..5263"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.consistentM_def|fact"><span>consistentM_def</span></a><span> </span><span class="keyword1"><span class="command"><span>..</span></span></span><span>
    
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_5427..5432">lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.consistentMD|fact"><span class="entity_def" id="MMonad.consistentMD|thm"><span>consistentMD</span></span></span><span class="main"><span>:</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.consistentM|const"><span>consistentM</span></a><span> </span><span class="free"><span>m</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.wlp|const"><span>wlp</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>m</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_consistent|const"><span>acc_consistent</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_5427..5432"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.consistentM_def|fact"><span>consistentM_def</span></a><span> </span><span class="keyword1"><span class="command"><span>..</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.consistent_wlp|fact"><span class="entity_def" id="MMonad.consistent_wlp|thm"><span>consistent_wlp</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.consistentM|const"><span>consistentM</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_consistent|const"><span>acc_consistent</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>s'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.wlp|const"><span>wlp</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>m</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>Q</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.consistentM_def|fact"><span>consistentM_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.invarM_pw_FAIL|fact"><span class="entity_def" id="MMonad.invarM_pw_FAIL|thm"><span>invarM_pw_FAIL</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.invarM_pw|const"><span>invarM_pw</span></a><span> </span><span class="free"><span>s</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.invarM_pw_def|fact"><span>invarM_pw_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.consistentM_pw_def|fact"><span>consistentM_pw_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.non_emptyM_pw_def|fact"><span>non_emptyM_pw_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
  
  </span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Subtype Definition›</span></span></span><span>
    
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.arity_typerep_M|fact"><span class="entity_def" id="MMonad.typerep_M_def|fact"><span class="entity_def" id="MMonad.typerep_M_inst.typerep_M|fact"><span class="entity_def" id="MMonad.M.type_definition_M|fact"><span class="entity_def" id="MMonad.arity_type_M|fact"><span class="entity_def" id="MMonad.arity_typerep_M|thm"><span class="entity_def" id="MMonad.typerep_M_def|thm"><span class="entity_def" id="MMonad.typerep_M_inst.typerep_M|thm"><span class="entity_def" id="MMonad.M.type_definition_M|thm"><span class="entity_def" id="MMonad.arity_type_M|thm"><span class="entity_def" id="MMonad.typerep_M_def_raw|axiom"><span class="entity_def" id="MMonad.typerep_M_inst.typerep_M_def|axiom"><span class="entity_def" id="MMonad.M.type_definition_M|axiom"><span class="entity_def" id="MMonad.arity_type_M|axiom"><span class="entity_def" id="MMonad.typerep_M_inst.typerep_M|const"><span>typedef</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'r</span></span><span class="main"><span>,</span></span><span class="tfree"><span>'v</span></span><span class="main"><span>)</span></span><span> </span><span class="entity_def" id="MMonad.M|type"><span>M</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="bound"><span>m</span></span><span class="main"><span>::</span></span><span class="tfree"><span>'v</span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.memory|type"><span>memory</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'r</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod|type"><span>×</span></a></span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc|type"><span>acc</span></a><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod|type"><span>×</span></a></span><span class="tfree"><span>'v</span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.memory|type"><span>memory</span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM|type"><span>neM</span></a><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.invarM|const"><span>invarM</span></a><span> </span><span class="bound"><span>m</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>morphisms</span></span></span><span> </span><span class="entity_def" id="MMonad.M.run_induct|fact"><span class="entity_def" id="MMonad.M.run_cases|fact"><span class="entity_def" id="MMonad.M.run_inject|fact"><span class="entity_def" id="MMonad.M.run_inverse|fact"><span class="entity_def" id="MMonad.M.run|fact"><span class="entity_def" id="MMonad.M.run_induct|thm"><span class="entity_def" id="MMonad.M.run_cases|thm"><span class="entity_def" id="MMonad.M.run_inject|thm"><span class="entity_def" id="MMonad.M.run_inverse|thm"><span class="entity_def" id="MMonad.M.run|thm"><span class="entity_def" id="MMonad.M.run|const"><span>run</span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity_def" id="MMonad.M.Abs_M_induct|fact"><span class="entity_def" id="MMonad.M.Abs_M_cases|fact"><span class="entity_def" id="MMonad.M.Abs_M_inject|fact"><span class="entity_def" id="MMonad.M.Abs_M_inverse|fact"><span class="entity_def" id="MMonad.M.Abs_M_induct|thm"><span class="entity_def" id="MMonad.M.Abs_M_cases|thm"><span class="entity_def" id="MMonad.M.Abs_M_inject|thm"><span class="entity_def" id="MMonad.M.Abs_M_inverse|thm"><span class="entity_def" id="MMonad.M.Abs_M|const"><span>Abs_M</span></span></span></span></span></span></span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.invarM_def|fact"><span>invarM_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.consistentM_def|fact"><span>consistentM_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.non_emptyM_def|fact"><span>non_emptyM_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
    
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.Quotient_M|fact"><span class="entity_def" id="MMonad.M.domain|fact"><span class="entity_def" id="MMonad.M.bi_unique|fact"><span class="entity_def" id="MMonad.M.right_total|fact"><span class="entity_def" id="MMonad.M.right_unique|fact"><span class="entity_def" id="MMonad.M.left_unique|fact"><span class="entity_def" id="MMonad.M.rep_transfer|fact"><span class="entity_def" id="MMonad.arity_term_of_M|fact"><span class="entity_def" id="MMonad.term_of_M_triv|fact"><span class="entity_def" id="MMonad.term_of_M_inst.term_of_M|fact"><span class="entity_def" id="MMonad.cr_M_def|fact"><span class="entity_def" id="MMonad.M.lifting|bundle"><span class="entity_def" id="MMonad.Quotient_M|thm"><span class="entity_def" id="MMonad.M.domain|thm"><span class="entity_def" id="MMonad.M.bi_unique|thm"><span class="entity_def" id="MMonad.M.right_total|thm"><span class="entity_def" id="MMonad.M.right_unique|thm"><span class="entity_def" id="MMonad.M.left_unique|thm"><span class="entity_def" id="MMonad.M.rep_transfer|thm"><span class="entity_def" id="MMonad.arity_term_of_M|thm"><span class="entity_def" id="MMonad.term_of_M_triv|thm"><span class="entity_def" id="MMonad.term_of_M_inst.term_of_M|thm"><span class="entity_def" id="MMonad.cr_M_def|thm"><span class="entity_def" id="MMonad.term_of_M_triv_raw|axiom"><span class="entity_def" id="MMonad.term_of_M_inst.term_of_M_def|axiom"><span class="entity_def" id="MMonad.cr_M_def|axiom"><span class="entity_def" id="MMonad.term_of_M_inst.term_of_M|const"><span class="entity_def" id="MMonad.cr_M|const"><span>setup_lifting</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.M.type_definition_M|fact"><span>type_definition_M</span></a><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.invarM_run|fact"><span class="entity_def" id="MMonad.invarM_run|thm"><span>invarM_run</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.invarM|const"><span>invarM</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="free"><span>m</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.M.run|fact"><span>run</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.force|method"><span class="operator"><span>force</span></span></a><span>
    
  
  </span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Basic Monad Combinators›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>context</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>includes</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.monad_syntax_ne|bundle"><span>monad_syntax_ne</span></a><span>
  </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

    </span><span class="keyword2"><span class="keyword"><span>qualified</span></span></span><span> </span><span class="keyword1"><span class="command"><span>named_theorems</span></span></span><span> </span><span class="entity_def" id="MMonad.invarM_lemmas|attribute"><span class="entity_def" id="MMonad.invarM_lemmas|fact"><span>invarM_lemmas</span></span></span><span> </span><span class="quoted"><span>‹Monad invariant preservation lemmas›</span></span><span>
      
    </span><span class="keyword1"><span class="command"><span>declare</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.invarM_def|fact"><span>invarM_def</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="MMonad.html#MMonad.invarM_lemmas|attribute"><span class="operator"><span>invarM_lemmas</span></span></a><span class="main"><span>]</span></span><span>      
  
  
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.preturn_def|fact"><span class="entity_def" id="MMonad.preturn_def|thm"><span class="entity_def" id="MMonad.preturn_def_raw|axiom"><span class="entity_def" id="offset_6393..6403">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="MMonad.preturn|const"><span>preturn</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="NEMonad.html#NEMonad.RETURN|const"><span>return</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><span>,</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>::</span></span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc|type"><span>acc</span></a><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.pspec_def|fact"><span class="entity_def" id="MMonad.pspec_def|thm"><span class="entity_def" id="MMonad.pspec_def_raw|axiom"><span class="entity_def" id="offset_6451..6461">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="MMonad.pspec|const"><span>pspec</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>P</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>P</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.bot_class.bot|const"><span>bot</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>r</span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>P</span></span></span></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
    
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.pbind_def|fact"><span class="entity_def" id="MMonad.pbind_def|thm"><span class="entity_def" id="MMonad.pbind_def_raw|axiom"><span class="entity_def" id="offset_6546..6556">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="MMonad.pbind|const"><span>pbind</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span class="main"><span>;</span></span><span>
      </span><span class="main"><span>(</span></span><span class="bound"><span>r</span></span><span class="main"><span>,</span></span><span class="bound"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>;</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="NEMonad.html#NEMonad.RETURN|const"><span>return</span></a></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>r</span></span><span class="main"><span>,</span></span><span class="bound"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="bound"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><span>::</span></span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc|type"><span>acc</span></a><span class="main"><span>,</span></span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>  

    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="MMonad.html#MMonad.invarM_lemmas|attribute"><span class="operator"><span>invarM_lemmas</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.consistentM|const"><span>consistentM</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.preturn|const"><span>preturn</span></a><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.consistentM_def|fact"><span>consistentM_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_6393..6403"><span>preturn_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wp|method"><span class="operator"><span>wp</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_consistent_def|fact"><span>acc_consistent_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="MMonad.html#MMonad.invarM_lemmas|attribute"><span class="operator"><span>invarM_lemmas</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.consistentM|const"><span>consistentM</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.pspec|const"><span>pspec</span></a><span> </span><span class="free"><span>P</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.consistentM_def|fact"><span>consistentM_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_6451..6461"><span>pspec_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wp|method"><span class="operator"><span>wp</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_consistent_def|fact"><span>acc_consistent_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span>  </span><a class="entity_ref" href="NEMonad.html#NEMonad.wlp_FAIL|fact"><span>wlp_FAIL</span></a><span class="main"><span>)</span></span><span> </span><span class="comment1"><span>(* TODO: wlp_FAIL should be applied by wp, but isn't! *)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
            
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="MMonad.html#MMonad.invarM_lemmas|attribute"><span class="operator"><span>invarM_lemmas</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.consistentM|const"><span>consistentM</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.consistentM|const"><span>consistentM</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.consistentM|const"><span>consistentM</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.pbind|const"><span>pbind</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>supply</span></span></span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.wp_recursion_rule|attribute"><span class="operator"><span>wp_recursion_rule</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.consistent_wlp|fact"><span>consistent_wlp</span></a><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_6546..6556"><span>pbind_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wp|method"><span class="operator"><span>wp</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_consistent_trans|fact"><span>acc_consistent_trans</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      
    
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="MMonad.html#MMonad.invarM_lemmas|attribute"><span class="operator"><span>invarM_lemmas</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.non_emptyM|const"><span>non_emptyM</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.preturn|const"><span>preturn</span></a><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.non_emptyM_def|fact"><span>non_emptyM_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_6393..6403"><span>preturn_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="MMonad.html#MMonad.invarM_lemmas|attribute"><span class="operator"><span>invarM_lemmas</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.non_emptyM|const"><span>non_emptyM</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.pspec|const"><span>pspec</span></a><span> </span><span class="free"><span>P</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.non_emptyM_def|fact"><span>non_emptyM_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_6451..6461"><span>pspec_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
              
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="MMonad.html#MMonad.invarM_lemmas|attribute"><span class="operator"><span>invarM_lemmas</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.non_emptyM|const"><span>non_emptyM</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.non_emptyM|const"><span>non_emptyM</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.non_emptyM|const"><span>non_emptyM</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.pbind|const"><span>pbind</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.non_emptyM_def|fact"><span>non_emptyM_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_6546..6556"><span>pbind_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.distrib_lattice_class.inf_sup_distrib2|fact"><span>inf_sup_distrib2</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_plus_simps|fact"><span>acc_plus_simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>3</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.semilattice_sup_class.sup.idem|fact"><span>sup.idem</span></a><span class="main"><span>)</span></span><span>
      
    
      

    </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.Mreturn.rep_eq|fact"><span class="entity_def" id="MMonad.Mreturn.abs_eq|fact"><span class="entity_def" id="MMonad.Mreturn.transfer|fact"><span class="entity_def" id="MMonad.Mreturn.rsp|fact"><span class="entity_def" id="MMonad.Mreturn_def|fact"><span class="entity_def" id="MMonad.Mreturn.rep_eq|thm"><span class="entity_def" id="MMonad.Mreturn.abs_eq|thm"><span class="entity_def" id="MMonad.Mreturn.transfer|thm"><span class="entity_def" id="MMonad.Mreturn.rsp|thm"><span class="entity_def" id="MMonad.Mreturn_def|thm"><span class="entity_def" id="MMonad.Mreturn_def|axiom"><span>lift_definition</span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity_def" id="MMonad.Mreturn|const"><span>Mreturn</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'r</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'r</span></span><span class="main"><span>,</span></span><span class="tfree"><span>'v</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.M|type"><span>M</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="MMonad.html#MMonad.preturn|const"><span>preturn</span></a></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.invarM_lemmas|fact"><span class="dynamic"><span class="dynamic"><span>invarM_lemmas</span></span></span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.Mspec.rep_eq|fact"><span class="entity_def" id="MMonad.Mspec.abs_eq|fact"><span class="entity_def" id="MMonad.Mspec.transfer|fact"><span class="entity_def" id="MMonad.Mspec.rsp|fact"><span class="entity_def" id="MMonad.Mspec_def|fact"><span class="entity_def" id="MMonad.Mspec.rep_eq|thm"><span class="entity_def" id="MMonad.Mspec.abs_eq|thm"><span class="entity_def" id="MMonad.Mspec.transfer|thm"><span class="entity_def" id="MMonad.Mspec.rsp|thm"><span class="entity_def" id="MMonad.Mspec_def|thm"><span class="entity_def" id="MMonad.Mspec_def|axiom"><span>lift_definition</span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity_def" id="MMonad.Mspec|const"><span>Mspec</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="tfree"><span>'r</span></span><span class="main"><span>⇒</span></span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'r</span></span><span class="main"><span>,</span></span><span class="tfree"><span>'v</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.M|type"><span>M</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="MMonad.html#MMonad.pspec|const"><span>pspec</span></a></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.invarM_lemmas|fact"><span class="dynamic"><span class="dynamic"><span>invarM_lemmas</span></span></span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.Mbind.rep_eq|fact"><span class="entity_def" id="MMonad.Mbind.abs_eq|fact"><span class="entity_def" id="MMonad.Mbind.transfer|fact"><span class="entity_def" id="MMonad.Mbind.rsp|fact"><span class="entity_def" id="MMonad.Mbind_def|fact"><span class="entity_def" id="MMonad.Mbind.rep_eq|thm"><span class="entity_def" id="MMonad.Mbind.abs_eq|thm"><span class="entity_def" id="MMonad.Mbind.transfer|thm"><span class="entity_def" id="MMonad.Mbind.rsp|thm"><span class="entity_def" id="MMonad.Mbind_def|thm"><span class="entity_def" id="MMonad.Mbind_def|axiom"><span>lift_definition</span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity_def" id="MMonad.Mbind|const"><span>Mbind</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="tfree"><span>'x</span></span><span class="main"><span>,</span></span><span class="tfree"><span>'v</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.M|type"><span>M</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'x</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'r</span></span><span class="main"><span>,</span></span><span class="tfree"><span>'v</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.M|type"><span>M</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'r</span></span><span class="main"><span>,</span></span><span class="tfree"><span>'v</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.M|type"><span>M</span></a><span>"</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="MMonad.html#MMonad.pbind|const"><span>pbind</span></a></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.invarM_lemmas|fact"><span class="dynamic"><span class="dynamic"><span>invarM_lemmas</span></span></span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.invarM_pw|fact"><span>invarM_pw</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>THEN</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iffD1|fact"><span>iffD1</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    
        
  </span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Parallel Combinator›</span></span></span><span>
    
    
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.ppar_def|fact"><span class="entity_def" id="MMonad.ppar_def|thm"><span class="entity_def" id="MMonad.ppar_def_raw|axiom"><span class="entity_def" id="offset_8304..8314">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="MMonad.ppar|const"><span>ppar</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>s<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="main"><span>(</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>s<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>←</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="NEMonad.html#NEMonad.PAR|const"><span>∥</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span class="main"><span>;</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="NEMonad.html#NEMonad.ASSERT|const"><span>assert</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_consistent|const"><span>acc_consistent</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="bound"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>s<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_consistent|const"><span>acc_consistent</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="bound"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="bound"><span>s<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>;</span></span><span> </span><span class="comment1"><span>― ‹Ensure reported ACC_REPORT is 
        consistent with observable modifications on state. This will later be enforced by subtyping.›</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="NEMonad.html#NEMonad.ASSUME|const"><span>assume</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.spar_feasible|const"><span>spar_feasible</span></a><span> </span><span class="bound"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>;</span></span><span> </span><span class="comment1"><span>― ‹Filter out impossible combinations (where malloc did not sync)›</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="NEMonad.html#NEMonad.ASSERT|const"><span>assert</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_norace|const"><span>acc_norace</span></a><span> </span><span class="bound"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>;</span></span><span> </span><span class="comment1"><span>― ‹Fail on data races›</span></span><span>
      </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.combine_states|const"><span>combine_states</span></a><span> </span><span class="bound"><span>s<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="bound"><span>s<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>;</span></span><span> </span><span class="comment1"><span>― ‹Combine states›</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="NEMonad.html#NEMonad.RETURN|const"><span>return</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="bound"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="bound"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span> 
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="MMonad.html#MMonad.invarM_lemmas|attribute"><span class="operator"><span>invarM_lemmas</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.consistentM|const"><span>consistentM</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.consistentM|const"><span>consistentM</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.consistentM|const"><span>consistentM</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.ppar|const"><span>ppar</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>    
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>supply</span></span></span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.wp_recursion_rule|attribute"><span class="operator"><span>wp_recursion_rule</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.consistent_wlp|fact"><span>consistent_wlp</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>supply</span></span></span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.wp_rule|attribute"><span class="operator"><span>wp_rule</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wlp_PAR|fact"><span>wlp_PAR</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.consistentMD|fact"><span>consistentMD</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.consistentMD|fact"><span>consistentMD</span></a><span class="main"><span>]</span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_8304..8314"><span>ppar_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wp|method"><span class="operator"><span>wp</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wp|method"><span class="operator"><span>wp</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.feasible_parallel_execution.consistent&apos;|fact"><span>feasible_parallel_execution.consistent'</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.feasible_parallel_execution.intro|fact"><span>feasible_parallel_execution.intro</span></a><span class="main"><span>)</span></span><span>
      
      
    </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹To show that our parallel combinator does not rule out all executions,
      we need to exploit that, for any finite set of blocks, we always find an execution 
      that does not allocate this set of blocks.
    ›</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.finite_alloc_blocks|fact"><span class="entity_def" id="MMonad.finite_alloc_blocks|thm"><span>finite_alloc_blocks</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.intro|attribute"><span class="operator"><span>intro</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.alloc_blocks|const"><span>alloc_blocks</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="free"><span>s'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.alloc_blocks_def|fact"><span>alloc_blocks_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.finite_non_fresh|fact"><span>finite_non_fresh</span></a><span class="main"><span>)</span></span><span>
      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="MMonad.html#MMonad.invarM_lemmas|attribute"><span class="operator"><span>invarM_lemmas</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><a class="entity_ref" href="MMonad.html#MMonad.non_emptyM|const"><span>non_emptyM</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.consistentM|const"><span>consistentM</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.non_emptyM|const"><span>non_emptyM</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.consistentM|const"><span>consistentM</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.non_emptyM|const"><span>non_emptyM</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.ppar|const"><span>ppar</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.non_emptyM_def|fact"><span>non_emptyM_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_8304..8314"><span>ppar_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>goal_cases</span></span><span>
      </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_9885..9886">1</span><span> </span><span class="skolem"><span>s</span></span><span> </span><span class="skolem"><span>A</span></span><span class="main"><span>)</span></span><span>
      
      </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>x<span class="hidden">⇩</span><sub>1</sub></span></span></span><span> </span><span class="skolem"><span class="skolem"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span></span><span> </span><span class="skolem"><span class="skolem"><span>s<span class="hidden">⇩</span><sub>1</sub></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_9930..9932">R1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="skolem"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>s<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_9971..9973">I1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc.a|const"><span>acc.a</span></a><span> </span><span class="skolem"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>∩</span></a></span><span> </span><span class="skolem"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_9885..9886"><span>1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Meson/meson_tactic.ML.html#Meson.meson|method"><span class="operator"><span>meson</span></span></a><span>
      
      </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_consistent|const"><span>acc_consistent</span></a><span> </span><span class="skolem"><span>s</span></span><span> </span><span class="skolem"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="skolem"><span>s<span class="hidden">⇩</span><sub>1</sub></span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="MMonad.html#MMonad.consistentM|const"><span>consistentM</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span>›</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="skolem"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span>›</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.consistentM_def|fact"><span>consistentM_def</span></a><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wlp_def|fact"><span>wlp_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span> 

      </span><span class="keyword1"><span class="command"><span>interpret</span></span></span><span> c1</span><span class="main"><span>:</span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_consistent_loc|locale"><span>acc_consistent_loc</span></a><span> </span><span class="quoted"><span class="skolem"><span>s</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span></span><span> </span><span class="quoted"><span class="skolem"><span>s<span class="hidden">⇩</span><sub>1</sub></span></span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>unfold_locales</span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_10218..10220">by</span></span></span><span> </span><span class="operator"><span>fact</span></span><span> 
                
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.alloc_blocks|const"><span>alloc_blocks</span></a><span> </span><span class="skolem"><span>s</span></span><span> </span><span class="skolem"><span>s<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="skolem"><span>A</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_9885..9886"><span>1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc.a|const"><span>acc.a</span></a><span> </span><span class="skolem"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="skolem"><span>A</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_10218..10220"><span>c1.acc_a_alloc</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Presburger.html#Presburger.presburger|method"><span class="operator"><span>presburger</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>x<span class="hidden">⇩</span><sub>2</sub></span></span></span><span> </span><span class="skolem"><span class="skolem"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span></span><span> </span><span class="skolem"><span class="skolem"><span>s<span class="hidden">⇩</span><sub>2</sub></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_10421..10423">R2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="skolem"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>s<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_10462..10464">I2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc.a|const"><span>acc.a</span></a><span> </span><span class="skolem"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>∩</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc.a|const"><span>acc.a</span></a><span> </span><span class="skolem"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><span class="skolem"><span>A</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span>  
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_9885..9886"><span>1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_10540..10543">NF2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="skolem"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_9885..9886"><span>1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_10421..10423"><span>R2</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_consistent|const"><span>acc_consistent</span></a><span> </span><span class="skolem"><span>s</span></span><span> </span><span class="skolem"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="skolem"><span>s<span class="hidden">⇩</span><sub>2</sub></span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="MMonad.html#MMonad.consistentM|const"><span>consistentM</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span>›</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.consistentM_def|fact"><span>consistentM_def</span></a><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wlp_def|fact"><span>wlp_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span> 
  
      </span><span class="keyword1"><span class="command"><span>interpret</span></span></span><span> c2</span><span class="main"><span>:</span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_consistent_loc|locale"><span>acc_consistent_loc</span></a><span> </span><span class="quoted"><span class="skolem"><span>s</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span></span><span> </span><span class="quoted"><span class="skolem"><span>s<span class="hidden">⇩</span><sub>2</sub></span></span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>unfold_locales</span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_10769..10771">by</span></span></span><span> </span><span class="operator"><span>fact</span></span><span> 
        
        
      </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_10462..10464"><span>I2</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.spar_feasible|const"><span>spar_feasible</span></a><span> </span><span class="skolem"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="skolem"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.spar_feasible_def|fact"><span>spar_feasible_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_10218..10220"><span>c1.acc_a_alloc</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_10769..10771"><span>c2.acc_a_alloc</span></a><span class="main"><span>)</span></span><span>
      
      </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_9971..9973"><span>I1</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_10462..10464"><span>I2</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_9930..9932"><span>R1</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_10421..10423"><span>R2</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_10540..10543"><span>NF2</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_10960..10962">NI</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_norace|const"><span>acc_norace</span></a><span> </span><span class="skolem"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="skolem"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_9885..9886"><span>1</span></a><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span>
        
      </span><span class="keyword1"><span class="command"><span>interpret</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.valid_parallel_execution|locale"><span>valid_parallel_execution</span></a><span> </span><span class="quoted"><span class="skolem"><span>s</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>s<span class="hidden">⇩</span><sub>1</sub></span></span></span><span> </span><span class="quoted"><span class="skolem"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span></span><span> </span><span class="quoted"><span class="skolem"><span>s<span class="hidden">⇩</span><sub>2</sub></span></span></span><span> </span><span class="quoted"><span class="skolem"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>unfold_locales</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fact</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>
        
        
      </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.exI|fact"><span>exI</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> x</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="skolem"><span>x<span class="hidden">⇩</span><sub>1</sub></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.exI|fact"><span>exI</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> x</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="skolem"><span>x<span class="hidden">⇩</span><sub>2</sub></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.exI|fact"><span>exI</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> x</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="skolem"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
        
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjI|fact"><span>conjI</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.exI|fact"><span>exI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjI|fact"><span>conjI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.impI|fact"><span>impI</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>fact</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>fact</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_10960..10962"><span>NI</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>fact</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>fact</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_10960..10962"><span>NI</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>fact</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>fact</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_9971..9973"><span>I1</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_10462..10464"><span>I2</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>  
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
        
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  
    
    
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.Mpar.rep_eq|fact"><span class="entity_def" id="MMonad.Mpar.abs_eq|fact"><span class="entity_def" id="MMonad.Mpar.transfer|fact"><span class="entity_def" id="MMonad.Mpar.rsp|fact"><span class="entity_def" id="MMonad.Mpar_def|fact"><span class="entity_def" id="MMonad.Mpar.rep_eq|thm"><span class="entity_def" id="MMonad.Mpar.abs_eq|thm"><span class="entity_def" id="MMonad.Mpar.transfer|thm"><span class="entity_def" id="MMonad.Mpar.rsp|thm"><span class="entity_def" id="MMonad.Mpar_def|thm"><span class="entity_def" id="MMonad.Mpar_def|axiom"><span>lift_definition</span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity_def" id="MMonad.Mpar|const"><span>Mpar</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="tfree"><span>'x</span></span><span class="main"><span>,</span></span><span class="tfree"><span>'v</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.M|type"><span>M</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'y</span></span><span class="main"><span>,</span></span><span class="tfree"><span>'v</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.M|type"><span>M</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'x</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod|type"><span>×</span></a></span><span class="tfree"><span>'y</span></span><span class="main"><span>,</span></span><span class="tfree"><span>'v</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.M|type"><span>M</span></a><span>"</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="MMonad.html#MMonad.ppar|const"><span>ppar</span></a></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.invarM_lemmas|fact"><span class="dynamic"><span class="dynamic"><span>invarM_lemmas</span></span></span></a><span class="main"><span>)</span></span><span>
    
    
    </span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Memory Operations›</span></span></span><span>
  
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.malloc_def|fact"><span class="entity_def" id="MMonad.malloc_def|thm"><span class="entity_def" id="MMonad.malloc_def_raw|axiom"><span class="entity_def" id="offset_11855..11865">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="MMonad.malloc|const"><span>malloc</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>vs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><span class="bound"><span>b</span></span><span> </span><span class="main"><span>←</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="NEMonad.html#NEMonad.neM.SPEC|const"><span>spec</span></a></span><span> </span><span class="bound"><span>b</span></span><span class="main"><a class="entity_ref" href="NEMonad.html#NEMonad.neM.SPEC|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.is_FRESH|const"><span>is_FRESH</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="bound"><span>b</span></span><span class="main"><span>;</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="NEMonad.html#NEMonad.RETURN|const"><span>return</span></a></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>b</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_a|const"><span>acc_a</span></a><span> </span><span class="bound"><span>b</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.addr_alloc|const"><span>addr_alloc</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>vs</span></span></span></span><span> </span><span class="bound"><span>b</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.mfree_def|fact"><span class="entity_def" id="MMonad.mfree_def|thm"><span class="entity_def" id="MMonad.mfree_def_raw|axiom"><span class="entity_def" id="offset_11979..11989">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="MMonad.mfree|const"><span>mfree</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>b</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="NEMonad.html#NEMonad.ASSERT|const"><span>assert</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.is_ALLOC|const"><span>is_ALLOC</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>b</span></span></span></span><span class="main"><span>;</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="NEMonad.html#NEMonad.RETURN|const"><span>return</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Unity|const"><span>()</span></a></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_f|const"><span>acc_f</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>b</span></span></span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.addr_free|const"><span>addr_free</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>b</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>  

    </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.mvalid_addr_def|fact"><span class="entity_def" id="MMonad.mvalid_addr_def|thm"><span class="entity_def" id="MMonad.mvalid_addr_def_raw|axiom"><span class="entity_def" id="offset_12091..12101">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="MMonad.mvalid_addr|const"><span>mvalid_addr</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>a</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="NEMonad.html#NEMonad.ASSERT|const"><span>assert</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.is_valid_addr|const"><span>is_valid_addr</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>a</span></span></span></span><span class="main"><span>;</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="NEMonad.html#NEMonad.RETURN|const"><span>return</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Unity|const"><span>()</span></a></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_r|const"><span>acc_r</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>a</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>
        
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.mload_def|fact"><span class="entity_def" id="MMonad.mload_def|thm"><span class="entity_def" id="MMonad.mload_def_raw|axiom"><span class="entity_def" id="offset_12208..12218">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="MMonad.mload|const"><span>mload</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>a</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="NEMonad.html#NEMonad.ASSERT|const"><span>assert</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.is_valid_addr|const"><span>is_valid_addr</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>a</span></span></span></span><span class="main"><span>;</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="NEMonad.html#NEMonad.RETURN|const"><span>return</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.get_addr|const"><span>get_addr</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>a</span></span></span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_r|const"><span>acc_r</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>a</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.mstore_def|fact"><span class="entity_def" id="MMonad.mstore_def|thm"><span class="entity_def" id="MMonad.mstore_def_raw|axiom"><span class="entity_def" id="offset_12325..12335">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="MMonad.mstore|const"><span>mstore</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>a</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="NEMonad.html#NEMonad.ASSERT|const"><span>assert</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.is_valid_addr|const"><span>is_valid_addr</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>a</span></span></span></span><span class="main"><span>;</span></span><span>
      </span><span class="keyword1"><a class="entity_ref" href="NEMonad.html#NEMonad.RETURN|const"><span>return</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Unity|const"><span>()</span></a></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_w|const"><span>acc_w</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>a</span></span></span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.put_addr|const"><span>put_addr</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>a</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v</span></span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    
      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="MMonad.html#MMonad.invarM_lemmas|attribute"><span class="operator"><span>invarM_lemmas</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.consistentM|const"><span>consistentM</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.malloc|const"><span>malloc</span></a><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.consistentM_def|fact"><span>consistentM_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_11855..11865"><span>malloc_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wp|method"><span class="operator"><span>wp</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_consistent_def|fact"><span>acc_consistent_def</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.alloc_blocks_def|fact"><span>alloc_blocks_def</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.freed_blocks_def|fact"><span>freed_blocks_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="MMonad.html#MMonad.invarM_lemmas|attribute"><span class="operator"><span>invarM_lemmas</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.consistentM|const"><span>consistentM</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.mfree|const"><span>mfree</span></a><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.consistentM_def|fact"><span>consistentM_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_11979..11989"><span>mfree_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wp|method"><span class="operator"><span>wp</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_consistent_def|fact"><span>acc_consistent_def</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.alloc_blocks_def|fact"><span>alloc_blocks_def</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.freed_blocks_def|fact"><span>freed_blocks_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="MMonad.html#MMonad.invarM_lemmas|attribute"><span class="operator"><span>invarM_lemmas</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.consistentM|const"><span>consistentM</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.mvalid_addr|const"><span>mvalid_addr</span></a><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.consistentM_def|fact"><span>consistentM_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_12091..12101"><span>mvalid_addr_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wp|method"><span class="operator"><span>wp</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_consistent_def|fact"><span>acc_consistent_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span class="main"><span>)</span></span><span>
      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="MMonad.html#MMonad.invarM_lemmas|attribute"><span class="operator"><span>invarM_lemmas</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.consistentM|const"><span>consistentM</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.mload|const"><span>mload</span></a><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.consistentM_def|fact"><span>consistentM_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_12208..12218"><span>mload_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wp|method"><span class="operator"><span>wp</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_consistent_def|fact"><span>acc_consistent_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="main"><span>)</span></span><span>
      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="MMonad.html#MMonad.invarM_lemmas|attribute"><span class="operator"><span>invarM_lemmas</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.consistentM|const"><span>consistentM</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.mstore|const"><span>mstore</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.consistentM_def|fact"><span>consistentM_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_12325..12335"><span>mstore_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.wp|method"><span class="operator"><span>wp</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_consistent_def|fact"><span>acc_consistent_def</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.alloc_blocks_def|fact"><span>alloc_blocks_def</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.freed_blocks_def|fact"><span>freed_blocks_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>split</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.block.split|fact"><span>block.split</span></a><span class="main"><span>)</span></span><span>
      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="MMonad.html#MMonad.invarM_lemmas|attribute"><span class="operator"><span>invarM_lemmas</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.non_emptyM|const"><span>non_emptyM</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.malloc|const"><span>malloc</span></a><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.non_emptyM_def|fact"><span>non_emptyM_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_11855..11865"><span>malloc_def</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.alloc_blocks_def|fact"><span>alloc_blocks_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.ex_fresh|fact"><span>ex_fresh</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span>
  
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="MMonad.html#MMonad.invarM_lemmas|attribute"><span class="operator"><span>invarM_lemmas</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.non_emptyM|const"><span>non_emptyM</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.mfree|const"><span>mfree</span></a><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.non_emptyM_def|fact"><span>non_emptyM_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_11979..11989"><span>mfree_def</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.alloc_blocks_def|fact"><span>alloc_blocks_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>

    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="MMonad.html#MMonad.invarM_lemmas|attribute"><span class="operator"><span>invarM_lemmas</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.non_emptyM|const"><span>non_emptyM</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.mvalid_addr|const"><span>mvalid_addr</span></a><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.non_emptyM_def|fact"><span>non_emptyM_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_12091..12101"><span>mvalid_addr_def</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.alloc_blocks_def|fact"><span>alloc_blocks_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
                  
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="MMonad.html#MMonad.invarM_lemmas|attribute"><span class="operator"><span>invarM_lemmas</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.non_emptyM|const"><span>non_emptyM</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.mload|const"><span>mload</span></a><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.non_emptyM_def|fact"><span>non_emptyM_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_12208..12218"><span>mload_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="MMonad.html#MMonad.invarM_lemmas|attribute"><span class="operator"><span>invarM_lemmas</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.non_emptyM|const"><span>non_emptyM</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.mstore|const"><span>mstore</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.non_emptyM_def|fact"><span>non_emptyM_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_12325..12335"><span>mstore_def</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.alloc_blocks_def|fact"><span>alloc_blocks_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
    
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.Mmalloc.rep_eq|fact"><span class="entity_def" id="MMonad.Mmalloc.abs_eq|fact"><span class="entity_def" id="MMonad.Mmalloc.transfer|fact"><span class="entity_def" id="MMonad.Mmalloc.rsp|fact"><span class="entity_def" id="MMonad.Mmalloc_def|fact"><span class="entity_def" id="MMonad.Mmalloc.rep_eq|thm"><span class="entity_def" id="MMonad.Mmalloc.abs_eq|thm"><span class="entity_def" id="MMonad.Mmalloc.transfer|thm"><span class="entity_def" id="MMonad.Mmalloc.rsp|thm"><span class="entity_def" id="MMonad.Mmalloc_def|thm"><span class="entity_def" id="MMonad.Mmalloc_def|axiom"><span>lift_definition</span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity_def" id="MMonad.Mmalloc|const"><span>Mmalloc</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="tfree"><span>'v</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list|type"><span>list</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.block_idx|type"><span>block_idx</span></a><span class="main"><span>,</span></span><span class="tfree"><span>'v</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.M|type"><span>M</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="MMonad.html#MMonad.malloc|const"><span>malloc</span></a></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.invarM_lemmas|fact"><span class="dynamic"><span class="dynamic"><span>invarM_lemmas</span></span></span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.Mfree.rep_eq|fact"><span class="entity_def" id="MMonad.Mfree.abs_eq|fact"><span class="entity_def" id="MMonad.Mfree.transfer|fact"><span class="entity_def" id="MMonad.Mfree.rsp|fact"><span class="entity_def" id="MMonad.Mfree_def|fact"><span class="entity_def" id="MMonad.Mfree.rep_eq|thm"><span class="entity_def" id="MMonad.Mfree.abs_eq|thm"><span class="entity_def" id="MMonad.Mfree.transfer|thm"><span class="entity_def" id="MMonad.Mfree.rsp|thm"><span class="entity_def" id="MMonad.Mfree_def|thm"><span class="entity_def" id="MMonad.Mfree_def|axiom"><span>lift_definition</span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity_def" id="MMonad.Mfree|const"><span>Mfree</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.block_idx|type"><span>block_idx</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.unit|type"><span>unit</span></a><span class="main"><span>,</span></span><span class="tfree"><span>'v</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.M|type"><span>M</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="MMonad.html#MMonad.mfree|const"><span>mfree</span></a></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.invarM_lemmas|fact"><span class="dynamic"><span class="dynamic"><span>invarM_lemmas</span></span></span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.Mvalid_addr.rep_eq|fact"><span class="entity_def" id="MMonad.Mvalid_addr.abs_eq|fact"><span class="entity_def" id="MMonad.Mvalid_addr.transfer|fact"><span class="entity_def" id="MMonad.Mvalid_addr.rsp|fact"><span class="entity_def" id="MMonad.Mvalid_addr_def|fact"><span class="entity_def" id="MMonad.Mvalid_addr.rep_eq|thm"><span class="entity_def" id="MMonad.Mvalid_addr.abs_eq|thm"><span class="entity_def" id="MMonad.Mvalid_addr.transfer|thm"><span class="entity_def" id="MMonad.Mvalid_addr.rsp|thm"><span class="entity_def" id="MMonad.Mvalid_addr_def|thm"><span class="entity_def" id="MMonad.Mvalid_addr_def|axiom"><span>lift_definition</span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity_def" id="MMonad.Mvalid_addr|const"><span>Mvalid_addr</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.addr|type"><span>addr</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.unit|type"><span>unit</span></a><span class="main"><span>,</span></span><span class="tfree"><span>'v</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.M|type"><span>M</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="MMonad.html#MMonad.mvalid_addr|const"><span>mvalid_addr</span></a></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.invarM_lemmas|fact"><span class="dynamic"><span class="dynamic"><span>invarM_lemmas</span></span></span></a><span class="main"><span>)</span></span><span>
    </span><span class="comment1"><span>(*lift_definition Mvalid_ptr_addr :: "addr ⇒ (unit,'v) M" is mvalid_ptr_addr by (simp add: invarM_lemmas)*)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.Mload.rep_eq|fact"><span class="entity_def" id="MMonad.Mload.abs_eq|fact"><span class="entity_def" id="MMonad.Mload.transfer|fact"><span class="entity_def" id="MMonad.Mload.rsp|fact"><span class="entity_def" id="MMonad.Mload_def|fact"><span class="entity_def" id="MMonad.Mload.rep_eq|thm"><span class="entity_def" id="MMonad.Mload.abs_eq|thm"><span class="entity_def" id="MMonad.Mload.transfer|thm"><span class="entity_def" id="MMonad.Mload.rsp|thm"><span class="entity_def" id="MMonad.Mload_def|thm"><span class="entity_def" id="MMonad.Mload_def|axiom"><span>lift_definition</span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity_def" id="MMonad.Mload|const"><span>Mload</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.addr|type"><span>addr</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'v</span></span><span class="main"><span>,</span></span><span class="tfree"><span>'v</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.M|type"><span>M</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="MMonad.html#MMonad.mload|const"><span>mload</span></a></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.invarM_lemmas|fact"><span class="dynamic"><span class="dynamic"><span>invarM_lemmas</span></span></span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.Mstore.rep_eq|fact"><span class="entity_def" id="MMonad.Mstore.abs_eq|fact"><span class="entity_def" id="MMonad.Mstore.transfer|fact"><span class="entity_def" id="MMonad.Mstore.rsp|fact"><span class="entity_def" id="MMonad.Mstore_def|fact"><span class="entity_def" id="MMonad.Mstore.rep_eq|thm"><span class="entity_def" id="MMonad.Mstore.abs_eq|thm"><span class="entity_def" id="MMonad.Mstore.transfer|thm"><span class="entity_def" id="MMonad.Mstore.rsp|thm"><span class="entity_def" id="MMonad.Mstore_def|thm"><span class="entity_def" id="MMonad.Mstore_def|axiom"><span>lift_definition</span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity_def" id="MMonad.Mstore|const"><span>Mstore</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.addr|type"><span>addr</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'v</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.unit|type"><span>unit</span></a><span class="main"><span>,</span></span><span class="tfree"><span>'v</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.M|type"><span>M</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="MMonad.html#MMonad.mstore|const"><span>mstore</span></a></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.invarM_lemmas|fact"><span class="dynamic"><span class="dynamic"><span>invarM_lemmas</span></span></span></a><span class="main"><span>)</span></span><span>
    
    
  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>    


</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Pointwise Reasoning Setup›</span></span></span><span>    

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.M_eq_iff|fact"><span class="entity_def" id="MMonad.M_eq_iff|thm"><span>M_eq_iff</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_init|attribute"><span class="operator"><span>pw_init</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span>m'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>s</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="free"><span>m'</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Transfer/transfer.ML.html#Transfer.transfer|method"><span class="operator"><span>transfer</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
    
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.pw_Mreturn|fact"><span class="entity_def" id="MMonad.pw_Mreturn(2)|thm"><span class="entity_def" id="MMonad.pw_Mreturn(1)|thm"><span>pw_Mreturn</span></span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_simp|attribute"><span class="operator"><span>pw_simp</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.Mreturn|const"><span>Mreturn</span></a><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span>"</span></span></span><span>  
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.Mreturn|const"><span>Mreturn</span></a><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>r</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="free"><span>r</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>,</span></span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Transfer/transfer.ML.html#Transfer.transfer&apos;|method"><span class="operator"><span>transfer'</span></span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>unfold</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.preturn_def|fact"><span>preturn_def</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.pw_Mspec|fact"><span class="entity_def" id="MMonad.pw_Mspec(2)|thm"><span class="entity_def" id="MMonad.pw_Mspec(1)|thm"><span>pw_Mspec</span></span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_simp|attribute"><span class="operator"><span>pw_simp</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.Mspec|const"><span>Mspec</span></a><span> </span><span class="free"><span>P</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="free"><span>P</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.bot_class.bot|const"><span>bot</span></a><span>"</span></span></span><span>  
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.Mspec|const"><span>Mspec</span></a><span> </span><span class="free"><span>P</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>r</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="free"><span>r</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>,</span></span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Transfer/transfer.ML.html#Transfer.transfer&apos;|method"><span class="operator"><span>transfer'</span></span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>unfold</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.pspec_def|fact"><span>pspec_def</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.pw_Mbind1|fact"><span class="entity_def" id="MMonad.pw_Mbind1|thm"><span>pw_Mbind1</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_simp|attribute"><span class="operator"><span>pw_simp</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.Mbind|const"><span>Mbind</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_fail|const"><span>is_fail</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_fail|const"><span>is_fail</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Transfer/transfer.ML.html#Transfer.transfer|method"><span class="operator"><span>transfer</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.pbind_def|fact"><span>pbind_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
    
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.pw_Mbind2|fact"><span class="entity_def" id="MMonad.pw_Mbind2|thm"><span>pw_Mbind2</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_simp|attribute"><span class="operator"><span>pw_simp</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.Mbind|const"><span>Mbind</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>ris</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>case</span></span><span> </span><span class="free"><span>ris</span></span><span> </span><span class="keyword1"><span>of</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>r</span></span><span class="main"><span>,</span></span><span class="bound"><span>i''</span></span><span class="main"><span>,</span></span><span class="bound"><span>s''</span></span><span class="main"><span>)</span></span><span> 
      </span><span class="main"><span>⇒</span></span><span>  </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><a class="entity_ref" href="NEMonad.html#NEMonad.is_fail|const"><span>is_fail</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
        </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>i'</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>r</span></span><span class="main"><span>,</span></span><span class="bound"><span>i'</span></span><span class="main"><span>,</span></span><span class="bound"><span>s''</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>i''</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="bound"><span>i'</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Transfer/transfer.ML.html#Transfer.transfer|method"><span class="operator"><span>transfer</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.pbind_def|fact"><span>pbind_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.invarM_pw_iff|fact"><span class="entity_def" id="MMonad.invarM_pw_iff|thm"><span>invarM_pw_iff</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.invarM|const"><span>invarM</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>s</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> 
      </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>r</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>m</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>r</span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_consistent|const"><span>acc_consistent</span></a><span> </span><span class="bound"><span>s</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.non_emptyM_pw|const"><span>non_emptyM_pw</span></a><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>m</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.invarM_def|fact"><span>invarM_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.consistentM_def|fact"><span>consistentM_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.non_emptyM_pw|fact"><span>non_emptyM_pw</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>  
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res_def|fact"><span>is_res_def</span></a><span class="main"><span>)</span></span><span>
  

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.pw_Mpar1|fact"><span class="entity_def" id="MMonad.pw_Mpar1|thm"><span>pw_Mpar1</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_simp|attribute"><span class="operator"><span>pw_simp</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.Mpar|const"><span>Mpar</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.is_fail|const"><span>is_fail</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_fail|const"><span>is_fail</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span> 
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>s<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="bound"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="bound"><span>s<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>s<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>s<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span> 
          </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.spar_feasible|const"><span>spar_feasible</span></a><span> </span><span class="bound"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_norace|const"><span>acc_norace</span></a><span> </span><span class="bound"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Transfer/transfer.ML.html#Transfer.transfer|method"><span class="operator"><span>transfer</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.ppar_def|fact"><span>ppar_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.invarM_pw_iff|fact"><span>invarM_pw_iff</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="main"><span class="keyword3"><span>+</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.pw_Mpar2|fact"><span class="entity_def" id="MMonad.pw_Mpar2|thm"><span>pw_Mpar2</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_simp|attribute"><span class="operator"><span>pw_simp</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.Mpar|const"><span>Mpar</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>ris</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>case</span></span><span> </span><span class="free"><span>ris</span></span><span> </span><span class="keyword1"><span>of</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>r</span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>s'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⇒</span></span><span> 
        </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>s<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="bound"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="bound"><span>s<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>s<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>s<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.spar_feasible|const"><span>spar_feasible</span></a><span> </span><span class="bound"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span> 
          </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_norace|const"><span>acc_norace</span></a><span> </span><span class="bound"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>s<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="bound"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="bound"><span>s<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>s<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>s<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span> 
          </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.spar_feasible|const"><span>spar_feasible</span></a><span> </span><span class="bound"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>r</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="main"><span>(</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="bound"><span>i<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="bound"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>s'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.combine_states|const"><span>combine_states</span></a><span> </span><span class="bound"><span>s<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="bound"><span>i<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="bound"><span>s<span class="hidden">⇩</span><sub>2</sub></span></span><span>  </span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Transfer/transfer.ML.html#Transfer.transfer|method"><span class="operator"><span>transfer</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.ppar_def|fact"><span>ppar_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.invarM_pw_iff|fact"><span>invarM_pw_iff</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="main"><span class="keyword3"><span>+</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.no_result_is_FAIL|fact"><span class="entity_def" id="MMonad.no_result_is_FAIL|thm"><span>no_result_is_FAIL</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_simp|attribute"><span class="operator"><span>pw_simp</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>b</span></span><span> </span><span class="bound"><span>c</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>a</span></span><span class="main"><span>,</span></span><span class="bound"><span>b</span></span><span class="main"><span>,</span></span><span class="bound"><span>c</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite.emptyI|fact"><span>finite.emptyI</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.invarM_pw_iff|fact"><span>invarM_pw_iff</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.invarM_run|fact"><span>invarM_run</span></a><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_fail_def|fact"><span>is_fail_def</span></a><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res_def|fact"><span>is_res_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.non_emptyM_pw_def|fact"><span>non_emptyM_pw_def</span></a><span class="main"><span>)</span></span><span>
        
  </span><span class="keyword1"><span class="command"><span>context</span></span></span><span>    
    </span><span class="keyword2"><span class="keyword"><span>includes</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.monad_syntax_ne|bundle"><span>monad_syntax_ne</span></a><span>
  </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.run_Mmalloc|fact"><span class="entity_def" id="MMonad.run_Mmalloc|thm"><span>run_Mmalloc</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_simp|attribute"><span class="operator"><span>pw_simp</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.Mmalloc|const"><span>Mmalloc</span></a><span> </span><span class="free"><span>vs</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.malloc|const"><span>malloc</span></a><span> </span><span class="free"><span>vs</span></span><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Transfer/transfer.ML.html#Transfer.transfer|method"><span class="operator"><span>transfer</span></span></a><span> </span><span class="keyword1"><span class="command"><span>..</span></span></span><span>

    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.run_Mfree|fact"><span class="entity_def" id="MMonad.run_Mfree|thm"><span>run_Mfree</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_simp|attribute"><span class="operator"><span>pw_simp</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.Mfree|const"><span>Mfree</span></a><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.mfree|const"><span>mfree</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Transfer/transfer.ML.html#Transfer.transfer|method"><span class="operator"><span>transfer</span></span></a><span> </span><span class="keyword1"><span class="command"><span>..</span></span></span><span>

    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.run_Mvalid_addr|fact"><span class="entity_def" id="MMonad.run_Mvalid_addr|thm"><span>run_Mvalid_addr</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_simp|attribute"><span class="operator"><span>pw_simp</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.Mvalid_addr|const"><span>Mvalid_addr</span></a><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.mvalid_addr|const"><span>mvalid_addr</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Transfer/transfer.ML.html#Transfer.transfer|method"><span class="operator"><span>transfer</span></span></a><span> </span><span class="keyword1"><span class="command"><span>..</span></span></span><span>

    </span><span class="comment1"><span>(*lemma run_Mvalid_ptr_addr[pw_simp]: "run (Mvalid_ptr_addr a) s = mvalid_ptr_addr a s"  
      apply transfer ..*)</span></span><span>
      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.run_Mload|fact"><span class="entity_def" id="MMonad.run_Mload|thm"><span>run_Mload</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_simp|attribute"><span class="operator"><span>pw_simp</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.Mload|const"><span>Mload</span></a><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.mload|const"><span>mload</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Transfer/transfer.ML.html#Transfer.transfer|method"><span class="operator"><span>transfer</span></span></a><span> </span><span class="keyword1"><span class="command"><span>..</span></span></span><span>

    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.run_Mstore|fact"><span class="entity_def" id="MMonad.run_Mstore|thm"><span>run_Mstore</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_simp|attribute"><span class="operator"><span>pw_simp</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.Mstore|const"><span>Mstore</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.mstore|const"><span>mstore</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>v</span></span><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Transfer/transfer.ML.html#Transfer.transfer|method"><span class="operator"><span>transfer</span></span></a><span> </span><span class="keyword1"><span class="command"><span>..</span></span></span><span>
              
  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
    
      
</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Recursion Setup›</span></span></span><span>    
      
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.Mbot.rep_eq|fact"><span class="entity_def" id="MMonad.Mbot.abs_eq|fact"><span class="entity_def" id="MMonad.Mbot.transfer|fact"><span class="entity_def" id="MMonad.Mbot.rsp|fact"><span class="entity_def" id="MMonad.Mbot_def|fact"><span class="entity_def" id="MMonad.Mbot.rep_eq|thm"><span class="entity_def" id="MMonad.Mbot.abs_eq|thm"><span class="entity_def" id="MMonad.Mbot.transfer|thm"><span class="entity_def" id="MMonad.Mbot.rsp|thm"><span class="entity_def" id="MMonad.Mbot_def|thm"><span class="entity_def" id="MMonad.Mbot_def|axiom"><span>lift_definition</span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity_def" id="MMonad.Mbot|const"><span>Mbot</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="tfree"><span>'r</span></span><span class="main"><span>,</span></span><span class="tfree"><span>'v</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.M|type"><span>M</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.invarM_pw|fact"><span>invarM_pw</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>context</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_18040..18054">interpretation</span></span></span><span> FR</span><span class="main"><span>:</span></span><span> </span><a class="entity_ref" href="Flat_CCPO.html#Flat_CCPO.flat_rec|locale"><span>flat_rec</span></a><span> </span><span class="quoted"><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
    
    
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.Mle.rep_eq|fact"><span class="entity_def" id="MMonad.Mle.abs_eq|fact"><span class="entity_def" id="MMonad.Mle.transfer|fact"><span class="entity_def" id="MMonad.Mle.rsp|fact"><span class="entity_def" id="MMonad.Mle_def|fact"><span class="entity_def" id="MMonad.Mle.rep_eq|thm"><span class="entity_def" id="MMonad.Mle.abs_eq|thm"><span class="entity_def" id="MMonad.Mle.transfer|thm"><span class="entity_def" id="MMonad.Mle.rsp|thm"><span class="entity_def" id="MMonad.Mle_def|thm"><span class="entity_def" id="MMonad.Mle_def|axiom"><span class="entity_def" id="offset_18089..18104">lift_definition</span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity_def" id="MMonad.Mle|const"><span>Mle</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="tfree"><span>'r</span></span><span class="main"><span>,</span></span><span class="tfree"><span>'v</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.M|type"><span>M</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'r</span></span><span class="main"><span>,</span></span><span class="tfree"><span>'v</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.M|type"><span>M</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a><span>"</span></span></span><span> 
      </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_ord|const"><span>fun_ord</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_18040..18054"><span>FR.le</span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
      
      
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.fun_chain_def|fact"><span class="entity_def" id="MMonad.fun_chain_def|thm"><span class="entity_def" id="MMonad.fun_chain_def_raw|axiom"><span class="entity_def" id="offset_18189..18199">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="MMonad.fun_chain|const"><span>fun_chain</span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Complete_Partial_Order.html#Complete_Partial_Order.chain|const"><span>Complete_Partial_Order.chain</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_ord|const"><span>fun_ord</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_18040..18054"><span>FR.le</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.fun_chain&apos;_def|fact"><span class="entity_def" id="MMonad.fun_chain&apos;_def|thm"><span class="entity_def" id="MMonad.fun_chain&apos;_def_raw|axiom"><span class="entity_def" id="offset_18265..18275">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="MMonad.fun_chain&apos;|const"><span>fun_chain'</span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Complete_Partial_Order.html#Complete_Partial_Order.chain|const"><span>Complete_Partial_Order.chain</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Mle|const"><span>Mle</span></a><span>"</span></span></span><span>  
      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Transfer/transfer.ML.html#Transfer.transfer_rule|attribute"><span class="operator"><span>transfer_rule</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/BNF_Def.html#BNF_Def.rel_fun|const"><span>rel_fun</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/BNF_Def.html#BNF_Def.rel_set|const"><span>rel_set</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.cr_M|const"><span>cr_M</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>(=)</span></a></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.fun_chain|const"><span>fun_chain</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.fun_chain&apos;|const"><span>fun_chain'</span></a><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_18189..18199"><span>fun_chain_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_18265..18275"><span>fun_chain'_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Complete_Partial_Order.html#Complete_Partial_Order.chain_def|fact"><span>Complete_Partial_Order.chain_def</span></a><span>
      </span><span class="comment1"><span>(* TODP: clean up this proof *)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/BNF_Def.html#BNF_Def.rel_fun_def|fact"><span>rel_fun_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_ord_def|fact"><span>fun_ord_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/BNF_Def.html#BNF_Def.rel_set_def|fact"><span>rel_set_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>full_types</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_18089..18104"><span>Mle.rep_eq</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.cr_M_def|fact"><span>cr_M_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_ord_def|fact"><span>fun_ord_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>,</span></span></span><span> lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_18089..18104"><span>Mle.rep_eq</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.cr_M_def|fact"><span>cr_M_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_ord_def|fact"><span>fun_ord_def</span></a><span class="main"><span>)</span></span><span>
      
    
    
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.Mlub.rep_eq|fact"><span class="entity_def" id="MMonad.Mlub.abs_eq|fact"><span class="entity_def" id="MMonad.Mlub.transfer|fact"><span class="entity_def" id="MMonad.Mlub.rsp|fact"><span class="entity_def" id="MMonad.Mlub_def|fact"><span class="entity_def" id="MMonad.Mlub.rep_eq|thm"><span class="entity_def" id="MMonad.Mlub.abs_eq|thm"><span class="entity_def" id="MMonad.Mlub.transfer|thm"><span class="entity_def" id="MMonad.Mlub.rsp|thm"><span class="entity_def" id="MMonad.Mlub_def|thm"><span class="entity_def" id="MMonad.Mlub_def|axiom"><span>lift_definition</span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity_def" id="MMonad.Mlub|const"><span>Mlub</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="tfree"><span>'r</span></span><span class="main"><span>,</span></span><span class="tfree"><span>'v</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.M|type"><span>M</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'r</span></span><span class="main"><span>,</span></span><span class="tfree"><span>'v</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.M|type"><span>M</span></a><span>"</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>λ</span></span><span class="bound"><span>C</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.fun_chain|const"><span>fun_chain</span></a><span> </span><span class="bound"><span>C</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_lub|const"><span>fun_lub</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_18040..18054"><span>FR.lub</span></a><span> </span><span class="bound"><span>C</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.invarM_pw|fact"><span>invarM_pw</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> C s
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_18040..18054"><span>FR.fun_lub_apply</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_18189..18199"><span>fun_chain_def</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>drule</span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_18040..18054"><span>FR.chain_apply</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> x</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="skolem"><span>s</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>erule</span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_18040..18054"><span>FR.chain_cases</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.force|method"><span class="operator"><span>force</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.Mlub_empty_is_fail|fact"><span class="entity_def" id="MMonad.Mlub_empty_is_fail|thm"><span>Mlub_empty_is_fail</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_simp|attribute"><span class="operator"><span>pw_simp</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.Mlub|const"><span>Mlub</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Transfer/transfer.ML.html#Transfer.transfer|method"><span class="operator"><span>transfer</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_lub_def|fact"><span>fun_lub_def</span></a><span class="main"><span>)</span></span><span>
      
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.M_ccpo|fact"><span class="entity_def" id="MMonad.M_ccpo|thm"><span class="entity_def" id="offset_19264..19270">M_ccpo</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Complete_Partial_Order.html#Complete_Partial_Order.class.ccpo|const"><span>class.ccpo</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Mlub|const"><span>Mlub</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Mle|const"><span>Mle</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Flat_CCPO.html#Flat_CCPO.mk_lt|const"><span>mk_lt</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Mle|const"><span>Mle</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>intro_locales</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Flat_CCPO.html#Flat_CCPO.preorder_mk_ltI|fact"><span>preorder_mk_ltI</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>unfold_locales</span></span><span>
      
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Transfer/transfer.ML.html#Transfer.transfer|method"><span class="operator"><span>transfer</span></span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_ord_def|fact"><span>fun_ord_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_18040..18054"><span>FR.le_def</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Transfer/transfer.ML.html#Transfer.transfer|method"><span class="operator"><span>transfer</span></span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_ord_def|fact"><span>fun_ord_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_18040..18054"><span>FR.le_def</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Transfer/transfer.ML.html#Transfer.transfer|method"><span class="operator"><span>transfer</span></span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_ord_def|fact"><span>fun_ord_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_18040..18054"><span>FR.le_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.fun_eq_iff|fact"><span>fun_eq_iff</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span class="keyword3"><span>[</span></span></span><span class="main"><span class="keyword3"><span>]</span></span></span><span> 
      
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>fold</span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_18265..18275"><span>fun_chain'_def</span></a><span class="main"><span>)</span></span><span>
      
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Transfer/transfer.ML.html#Transfer.transfer|method"><span class="operator"><span>transfer</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_ord_def|fact"><span>fun_ord_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_18040..18054"><span>FR.fun_lub_apply</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_18189..18199"><span>fun_chain_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> C f s
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>drule</span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_18040..18054"><span>FR.chain_apply</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> x</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="skolem"><span>s</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>erule</span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_18040..18054"><span>FR.chain_cases</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_18040..18054"><span>FR.le_def</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
        
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Transfer/transfer.ML.html#Transfer.transfer|method"><span class="operator"><span>transfer</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_ord_def|fact"><span>fun_ord_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_18040..18054"><span>FR.fun_lub_apply</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_18189..18199"><span>fun_chain_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> C f s
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>drule</span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_18040..18054"><span>FR.chain_apply</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> x</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="skolem"><span>s</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>erule</span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_18040..18054"><span>FR.chain_cases</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_18040..18054"><span>FR.le_def</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.force|method"><span class="operator"><span>force</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.force|method"><span class="operator"><span>force</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
  

    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_20240..20254">interpretation</span></span></span><span> RS</span><span class="main"><span>:</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Complete_Partial_Order.html#Complete_Partial_Order.ccpo|locale"><span>ccpo</span></a><span> </span><span class="quoted"><a class="entity_ref" href="MMonad.html#MMonad.Mlub|const"><span>Mlub</span></a></span><span> </span><span class="quoted"><a class="entity_ref" href="MMonad.html#MMonad.Mle|const"><span>Mle</span></a></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Flat_CCPO.html#Flat_CCPO.mk_lt|const"><span>mk_lt</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Mle|const"><span>Mle</span></a><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_19264..19270"><span>M_ccpo</span></a><span class="main"><span>)</span></span><span> 
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_20313..20327">interpretation</span></span></span><span> RS</span><span class="main"><span>:</span></span><span> </span><a class="entity_ref" href="Flat_CCPO.html#Flat_CCPO.rec_setup|locale"><span>rec_setup</span></a><span> </span><span class="quoted"><a class="entity_ref" href="MMonad.html#MMonad.Mlub|const"><span>Mlub</span></a></span><span> </span><span class="quoted"><a class="entity_ref" href="MMonad.html#MMonad.Mle|const"><span>Mle</span></a></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Flat_CCPO.html#Flat_CCPO.mk_lt|const"><span>mk_lt</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Mle|const"><span>Mle</span></a><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>unfold_locales</span></span><span>
      
    </span><span class="comment1"><span>(* Adding one level of definitions. TODO: Maybe use global_interpretation?! *)</span></span><span>  
      
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.REC_def|fact"><span class="entity_def" id="MMonad.REC_def|thm"><span class="entity_def" id="MMonad.REC_def_raw|axiom"><span class="entity_def" id="offset_20490..20500">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="MMonad.REC|const"><span>REC</span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_20313..20327"><span>RS.REC</span></a><span>"</span></span></span><span>
    
    </span><span class="keyword1"><span class="command"><span>abbreviation</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="MMonad.M_mono&apos;|const"><span>M_mono'</span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="Flat_CCPO.html#Flat_CCPO.gen_is_mono&apos;|const"><span>gen_is_mono'</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Mle|const"><span>Mle</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Mle|const"><span>Mle</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>abbreviation</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="MMonad.M_mono_body|const"><span>M_mono_body</span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_20313..20327"><span>RS.is_mono_body</span></a><span>"</span></span></span><span>
    
    </span><span class="comment1"><span>(*
    definition "M_mono ≡ RS.fmono"

    definition M_mono' where "M_mono' F ≡ ∀D D'. fun_ord Mle D D' ⟶ Mle (F D) (F D')"
    
    lemma M_monoI[mono]: 
      assumes "⋀x. M_mono' (λD. F D x)"
      shows "M_mono F"
      using assms unfolding M_mono'_def M_mono_def Complete_Partial_Order.monotone_def fun_ord_def
      by blast
    *)</span></span><span>

    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_20974..20979">lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.REC_unfold|fact"><span class="entity_def" id="MMonad.REC_unfold|thm"><span>REC_unfold</span></span></span><span class="main"><span>:</span></span><span> 
      </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>MONO</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#offset_20313..20327"><span>RS.is_mono_body</span></a><span> </span><span class="free"><span>F</span></span><span>"</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.REC|const"><span>REC</span></a><span> </span><span class="free"><span>F</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>F</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.REC|const"><span>REC</span></a><span> </span><span class="free"><span>F</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_20490..20500"><span>REC_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_20313..20327"><span>RS.REC_unfold</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_20974..20979"><span>assms</span></a><span class="main"><span>)</span></span><span>
      
    </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Pointwise properties of recursive functions can be proved by well-founded induction 
      on the arguments.›</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_21241..21246">lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.REC_wf_induct|fact"><span class="entity_def" id="MMonad.REC_wf_induct|thm"><span>REC_wf_induct</span></span></span><span class="main"><span>:</span></span><span> 
      </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>WF</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Wellfounded.html#Wellfounded.wf|const"><span>wf</span></a><span> </span><span class="free"><span>V</span></span><span>"</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>MONO</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#offset_20313..20327"><span>RS.is_mono_body</span></a><span> </span><span class="free"><span>F</span></span><span>"</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>STEP</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span class="main"><span>(</span></span><span class="bound"><span>y</span></span><span class="main"><span>,</span></span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span class="free"><span>V</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>D</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>F</span></span><span> </span><span class="bound"><span>D</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>P</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.REC|const"><span>REC</span></a><span> </span><span class="free"><span>F</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_21241..21246"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_20490..20500"><span>REC_def</span></a><span> 
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_20313..20327"><span>RS.REC_wf_induct</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span>

    </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹For pointwise properties, which hold at non-terminating arguments, we
      can use the following induction scheme, which does not require a well-founded ordering.›</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.REC_pointwise_induct|fact"><span class="entity_def" id="MMonad.REC_pointwise_induct|thm"><span>REC_pointwise_induct</span></span></span><span class="main"><span>:</span></span><span> 
      </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>P</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_21739..21742">BOT</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span>"</span></span></span><span> 
      </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_21778..21782">STEP</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>D</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>D</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>F</span></span><span> </span><span class="bound"><span>D</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>P</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.REC|const"><span>REC</span></a><span> </span><span class="free"><span>F</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>s</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.REC|const"><span>REC</span></a><span> </span><span class="free"><span>F</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_20490..20500"><span>REC_def</span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>supply</span></span></span></span></span><span> </span><span class="entity_def" id="offset_21978..21979">R</span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_20313..20327"><span>RS.REC_pointwise_induct</span></a><span class="main"><span>[</span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> P</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>λ</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>m</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>s</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="bound"><span>m</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_21978..21979"><span>R</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> x
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Transfer/transfer.ML.html#Transfer.transfer|method"><span class="operator"><span>transfer</span></span></a><span> </span><span class="quasi_keyword"><span>fixing</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="free"><span>P</span></span></span><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_18189..18199"><span>fun_chain_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Complete_Partial_Order.html#Complete_Partial_Order.chain_empty|fact"><span>chain_empty</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_lub_def|fact"><span>fun_lub_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_21739..21742"><span>BOT</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> x
          </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Complete_Partial_Order.html#Complete_Partial_Order.ccpo.admissible_def|fact"><span>ccpo.admissible_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_18265..18275"><span>fun_chain'_def</span></a><span class="main"><span>[</span></span><span class="operator"><span>symmetric</span></span><span class="main"><span>]</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Transfer/transfer.ML.html#Transfer.transfer|method"><span class="operator"><span>transfer</span></span></a><span> </span><span class="quasi_keyword"><span>fixing</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="free"><span>P</span></span></span><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_18040..18054"><span>FR.fun_lub_apply</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> x C s
            </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_18189..18199"><span>fun_chain_def</span></a><span>
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>drule</span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_18040..18054"><span>FR.chain_apply</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> x</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="skolem"><span>s</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>erule</span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_18040..18054"><span>FR.chain_cases</span></a><span class="main"><span>)</span></span><span>
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_18040..18054"><span>FR.le_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_21739..21742"><span>BOT</span></a><span class="main"><span>)</span></span><span> 
            </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.force|method"><span class="operator"><span>force</span></span></a><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_21778..21782"><span>STEP</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span> 
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>..</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
    
</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Monotonicity Prover Setup›</span></span></span><span>      

    </span><span class="keyword2"><span class="keyword"><span>qualified</span></span></span><span> </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.Mle_alt|fact"><span class="entity_def" id="MMonad.Mle_alt|thm"><span class="entity_def" id="offset_22779..22786">Mle_alt</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.Mle|const"><span>Mle</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>s</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="MMonad.html#offset_18040..18054"><span>FR.le</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Transfer/transfer.ML.html#Transfer.transfer|method"><span class="operator"><span>transfer</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_ord_def|fact"><span>fun_ord_def</span></a><span class="main"><span>)</span></span><span>
      
    </span><span class="keyword2"><span class="keyword"><span>qualified</span></span></span><span> </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.pw_FR_le|fact"><span class="entity_def" id="MMonad.pw_FR_le|thm"><span class="entity_def" id="offset_22916..22924">pw_FR_le</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#offset_18040..18054"><span>FR.le</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="free"><span>a</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_fail|const"><span>is_fail</span></a><span> </span><span class="free"><span>a</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_18040..18054"><span>FR.le_def</span></a><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_fail_def|fact"><span>is_fail_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

    </span><span class="keyword1"><span class="command"><span>context</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>notes</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_init|attribute"><span class="operator"><span>pw_init</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_22779..22786"><span>Mle_alt</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_22916..22924"><span>pw_FR_le</span></a><span>
    </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>  
    
      </span><span class="comment1"><span>(*
      lemma mono_const[mono]: 
        "M_mono' (λ_. c)"  
        "M_mono' (λD. D y)"
        unfolding M_mono'_def fun_ord_def
        by auto 
        
      lemma mono_If[mono]: "
        M_mono' (λD. F D) ⟹ M_mono' (λD. G D) ⟹
        M_mono' (λD. if b then F D else G D)"  
        unfolding M_mono'_def
        by auto
      *)</span></span><span>
        
      </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.mono_Mbind1|fact"><span class="entity_def" id="MMonad.mono_Mbind1|thm"><span class="entity_def" id="offset_23440..23451">mono_Mbind1</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"
        </span><a class="entity_ref" href="MMonad.html#MMonad.M_mono&apos;|const"><span>M_mono'</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>D</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>F</span></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> 
        </span><a class="entity_ref" href="MMonad.html#MMonad.M_mono&apos;|const"><span>M_mono'</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>D</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Mbind|const"><span>Mbind</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>F</span></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
        </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.monotone_def|fact"><span>monotone_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_ord_def|fact"><span>fun_ord_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_22779..22786"><span>Mle_alt</span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw&apos;|method"><span class="operator"><span>pw'</span></span></a><span> 
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.safe|method"><span class="operator"><span>safe</span></span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

      </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.mono_Mbind2|fact"><span class="entity_def" id="MMonad.mono_Mbind2|thm"><span class="entity_def" id="offset_23655..23666">mono_Mbind2</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"
        </span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.M_mono&apos;|const"><span>M_mono'</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>D</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> 
        </span><a class="entity_ref" href="MMonad.html#MMonad.M_mono&apos;|const"><span>M_mono'</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>D</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Mbind|const"><span>Mbind</span></a><span> </span><span class="free"><span>F</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
        </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.monotone_def|fact"><span>monotone_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_ord_def|fact"><span>fun_ord_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_22779..22786"><span>Mle_alt</span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
                
      </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_23936..23941">lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.mono_Mbind|fact"><span class="entity_def" id="MMonad.mono_Mbind|thm"><span>mono_Mbind</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.partial_function_mono|attribute"><span class="operator"><span>partial_function_mono</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> 
        </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.M_mono&apos;|const"><span>M_mono'</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>D</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>F</span></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
        </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.M_mono&apos;|const"><span>M_mono'</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>D</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.M_mono&apos;|const"><span>M_mono'</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>D</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Mbind|const"><span>Mbind</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>F</span></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_23440..23451"><span>mono_Mbind1</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_23936..23941"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_23655..23666"><span>mono_Mbind2</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="free"><span>G</span></span></span><span class="main"><span>,</span></span><span> </span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_23936..23941"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>]</span></span><span>
        </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.monotone_def|fact"><span>monotone_def</span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_20240..20254"><span>RS.order.trans</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>

      </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.mono_Mpar1|fact"><span class="entity_def" id="MMonad.mono_Mpar1|thm"><span class="entity_def" id="offset_24284..24294">mono_Mpar1</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"
        </span><a class="entity_ref" href="MMonad.html#MMonad.M_mono&apos;|const"><span>M_mono'</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>D</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>F</span></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> 
        </span><a class="entity_ref" href="MMonad.html#MMonad.M_mono&apos;|const"><span>M_mono'</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>D</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Mpar|const"><span>Mpar</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>F</span></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
        </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.monotone_def|fact"><span>monotone_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_ord_def|fact"><span>fun_ord_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_22779..22786"><span>Mle_alt</span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw&apos;|method"><span class="operator"><span>pw'</span></span></a><span> 
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.safe|method"><span class="operator"><span>safe</span></span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
        
      </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.mono_Mpar2|fact"><span class="entity_def" id="MMonad.mono_Mpar2|thm"><span class="entity_def" id="offset_24503..24513">mono_Mpar2</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"
        </span><a class="entity_ref" href="MMonad.html#MMonad.M_mono&apos;|const"><span>M_mono'</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>D</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> 
        </span><a class="entity_ref" href="MMonad.html#MMonad.M_mono&apos;|const"><span>M_mono'</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>D</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Mpar|const"><span>Mpar</span></a><span> </span><span class="free"><span>F</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>G</span></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
        </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.monotone_def|fact"><span>monotone_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_ord_def|fact"><span>fun_ord_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_22779..22786"><span>Mle_alt</span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw&apos;|method"><span class="operator"><span>pw'</span></span></a><span> 
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.safe|method"><span class="operator"><span>safe</span></span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
        
      </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.mono_Mpar|fact"><span class="entity_def" id="MMonad.mono_Mpar|thm"><span>mono_Mpar</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.partial_function_mono|attribute"><span class="operator"><span>partial_function_mono</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"
        </span><a class="entity_ref" href="MMonad.html#MMonad.M_mono&apos;|const"><span>M_mono'</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>D</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>F</span></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> 
        </span><a class="entity_ref" href="MMonad.html#MMonad.M_mono&apos;|const"><span>M_mono'</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>D</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> 
        </span><a class="entity_ref" href="MMonad.html#MMonad.M_mono&apos;|const"><span>M_mono'</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>D</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Mpar|const"><span>Mpar</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>F</span></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>G</span></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_24284..24294"><span>mono_Mpar1</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_24503..24513"><span>mono_Mpar2</span></a><span>
        </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.monotone_def|fact"><span>monotone_def</span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_20240..20254"><span>RS.order.trans</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>

      </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_24989..24994">lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.mono_REC|fact"><span class="entity_def" id="MMonad.mono_REC|thm"><span>mono_REC</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.partial_function_mono|attribute"><span class="operator"><span>partial_function_mono</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> 
        </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>D</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_20313..20327"><span>RS.is_mono_body</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>F</span></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>DD</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.M_mono&apos;|const"><span>M_mono'</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>D</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>F</span></span><span> </span><span class="bound"><span>D</span></span><span> </span><span class="bound"><span>DD</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.M_mono&apos;|const"><span>M_mono'</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>D</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.REC|const"><span>REC</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>F</span></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_24989..24994"><span>assms</span></a><span>
        </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.monotone_def|fact"><span>monotone_def</span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_20490..20500"><span>REC_def</span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> D D'
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="MMonad.html#offset_20313..20327"><span>RS.REC_mono</span></a><span class="main"><span class="main"><span>[</span></span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="free"><span>F</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>D</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>D'</span></span></span><span class="main"><span class="main"><span>,</span></span></span><span> </span><span class="operator"><span>unfolded</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_ord_def|fact"><span>fun_ord_def</span></a><span class="main"><span class="main"><span>,</span></span></span><span> </span><span class="operator"><span>rule_format</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.fun_ord_def|fact"><span>fun_ord_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.monotone_def|fact"><span>monotone_def</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
        
    </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>          

    
</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Partial Function Setup›</span></span></span><span>        
    
    </span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="entity_def" id="MMonad.M_partial_function|fact"><span class="entity_def" id="MMonad.M_partial_function|thm"><span>M_partial_function</span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_20240..20254"><span>RS.partial_function_definitions</span></a><span>
    
  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>          

  
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.RSPF.fp_unfold|fact"><span class="entity_def" id="MMonad.RSPF.monotoneI|fact"><span class="entity_def" id="MMonad.RSPF.const_mono|fact"><span class="entity_def" id="MMonad.RSPF.fixp_induct_uc|fact"><span class="entity_def" id="MMonad.RSPF.fixp_rule_uc|fact"><span class="entity_def" id="MMonad.RSPF.mono_body_fixp|fact"><span class="entity_def" id="MMonad.RSPF.ccpo|fact"><span class="entity_def" id="MMonad.RSPF.lub_least|fact"><span class="entity_def" id="MMonad.RSPF.lub_upper|fact"><span class="entity_def" id="MMonad.RSPF.leq_antisym|fact"><span class="entity_def" id="MMonad.RSPF.leq_trans|fact"><span class="entity_def" id="MMonad.RSPF.leq_refl|fact"><span class="entity_def" id="MMonad.RSPF.partial_function_definitions_axioms|fact"><span class="entity_def" id="MMonad.RSPF.ccpo|thm"><span class="entity_def" id="MMonad.RSPF.leq_refl|thm"><span class="entity_def" id="MMonad.RSPF.fp_unfold|thm"><span class="entity_def" id="MMonad.RSPF.leq_trans|thm"><span class="entity_def" id="MMonad.RSPF.lub_least|thm"><span class="entity_def" id="MMonad.RSPF.lub_upper|thm"><span class="entity_def" id="MMonad.RSPF.monotoneI|thm"><span class="entity_def" id="MMonad.RSPF.leq_antisym|thm"><span class="entity_def" id="MMonad.RSPF.mono_body_fixp|thm"><span class="entity_def" id="MMonad.RSPF.fixp_induct_uc|thm"><span class="entity_def" id="MMonad.RSPF.fixp_rule_uc|thm"><span class="entity_def" id="MMonad.RSPF.const_mono|thm"><span class="entity_def" id="MMonad.RSPF.partial_function_definitions_axioms|thm"><span class="entity_def" id="MMonad.RSPF.admissible|const"><span class="entity_def" id="MMonad.RSPF.mono_body|const"><span class="entity_def" id="MMonad.RSPF.fixp_fun|const"><span class="entity_def" id="MMonad.RSPF.lub_fun|const"><span class="entity_def" id="MMonad.RSPF.le_fun|const"><span>interpretation</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> RSPF</span><span class="main"><span>:</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.partial_function_definitions|locale"><span>partial_function_definitions</span></a><span> </span><span class="quoted"><a class="entity_ref" href="MMonad.html#MMonad.Mle|const"><span>Mle</span></a></span><span> </span><span class="quoted"><a class="entity_ref" href="MMonad.html#MMonad.Mlub|const"><span>Mlub</span></a></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.M_partial_function|fact"><span>M_partial_function</span></a><span class="main"><span>)</span></span><span>
  
  </span><span class="keyword1"><span class="command"><span>declaration</span></span></span><span> </span><span class="quoted"><span>‹</span><span class="entity"><span>Partial_Function.init</span></span><span> </span><span class="inner_quoted"><span>"M"</span></span><span> </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><a class="entity_ref" href="MMonad.html#MMonad.RSPF.fixp_fun|const"><span>RSPF.fixp_fun</span></a></span><span class="antiquote"><span>}</span></span></span><span>
    </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><a class="entity_ref" href="MMonad.html#MMonad.RSPF.mono_body|const"><span>RSPF.mono_body</span></a></span><span class="antiquote"><span>}</span></span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.RSPF.fixp_rule_uc|fact"><span>RSPF.fixp_rule_uc</span></a><span class="antiquote"><span>}</span></span></span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.RSPF.fixp_induct_uc|fact"><span>RSPF.fixp_induct_uc</span></a><span class="antiquote"><span>}</span></span></span></span><span>
    </span><span class="main"><span>(</span></span><span>NONE</span><span class="main"><span>)</span></span><span>›</span></span><span>
  
    
  </span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Symmetry of parallel›</span></span></span><span>    
      
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.mswap_def|fact"><span class="entity_def" id="MMonad.mswap_def|thm"><span class="entity_def" id="MMonad.mswap_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="MMonad.mswap|const"><span>mswap</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>do<span class="hidden">⇩</span><sub>n</sub><span class="hidden">⇩</span><sub>e</sub></span></span><span> </span><span class="main"><span>{</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>←</span></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><span>;</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="NEMonad.html#NEMonad.RETURN|const"><span>return<span class="hidden">⇩</span><sub>n</sub><span class="hidden">⇩</span><sub>e</sub></span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>}</span></span><span>"</span></span></span><span>  
  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.pw_mswap|fact"><span class="entity_def" id="MMonad.pw_mswap(2)|thm"><span class="entity_def" id="MMonad.pw_mswap(1)|thm"><span>pw_mswap</span></span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_simp|attribute"><span class="operator"><span>pw_simp</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.mswap|const"><span>mswap</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_fail|const"><span>is_fail</span></a><span> </span><span class="free"><span>m</span></span><span>"</span></span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.mswap|const"><span>mswap</span></a><span> </span><span class="free"><span>m</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>ab</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>case</span></span><span> </span><span class="free"><span>ab</span></span><span> </span><span class="keyword1"><span>of</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.mswap_def|fact"><span>mswap_def</span></a><span> 
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="free"><span>ab</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span class="main"><span>)</span></span><span>
    
    
  </span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="entity_def" id="MMonad.combine_states_sym|fact"><span class="entity_def" id="MMonad.combine_states_sym|thm"><span>combine_states_sym</span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.valid_parallel_execution.combine_states_sym|fact"><span>valid_parallel_execution.combine_states_sym</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.valid_parallel_execution.intro|fact"><span>valid_parallel_execution.intro</span></a><span class="main"><span>]</span></span><span>  
    
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.ppar_sym|fact"><span class="entity_def" id="MMonad.ppar_sym|thm"><span>ppar_sym</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.invarM|const"><span>invarM</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.invarM|const"><span>invarM</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.ppar|const"><span>ppar</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.mswap|const"><span>mswap</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.ppar|const"><span>ppar</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.ppar_def|fact"><span>ppar_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>defer</span></span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> P<span class="hidden">⇩</span><sub>1</sub> P<span class="hidden">⇩</span><sub>2</sub>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subgoal_tac</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.invarM_pw|const"><span>invarM_pw</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.SPEC|const"><span>SPEC</span></a><span> </span><span class="skolem"><span>P<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subgoal_tac</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.invarM_pw|const"><span>invarM_pw</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.SPEC|const"><span>SPEC</span></a><span> </span><span class="skolem"><span>P<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
      
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>thin_tac</span></span><span> </span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.invarM|const"><a class="entity_ref" href="MMonad.html#MMonad.invarM|const"><a class="entity_ref" href="MMonad.html#MMonad.invarM|const"><span>invarM</span></a></a></a><span> </span><span class="main"><span class="main"><span class="main"><span>_</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>thin_tac</span></span><span> </span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>_</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span></a></span></a></span><span class="main"><span class="main"><span class="main"><span>_</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.spar_feasible_sym|fact"><span>spar_feasible_sym</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_norace_sym|fact"><span>acc_norace_sym</span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>-</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/SMT/smt_systems.ML.html#SMT.smt|method"><span class="operator"><span>smt</span></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> best</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.ab_semigroup_add_class.add.commute|fact"><span>add.commute</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.combine_states_sym|fact"><span>combine_states_sym</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_consistent_loc.intro|fact"><span>acc_consistent_loc.intro</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/SMT/smt_systems.ML.html#SMT.smt|method"><span class="operator"><span>smt</span></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> best</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.ab_semigroup_add_class.add.commute|fact"><span>add.commute</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.combine_states_sym|fact"><span>combine_states_sym</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_consistent_loc.intro|fact"><span>acc_consistent_loc.intro</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.invarM_pw|fact"><span>invarM_pw</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.invarM_pw|fact"><span>invarM_pw</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
    
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.res_run_consistentI|fact"><span class="entity_def" id="MMonad.res_run_consistentI|thm"><span>res_run_consistentI</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NEMonad.html#NEMonad.is_res|const"><span>is_res</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span class="free"><span>i</span></span><span class="main"><span>,</span></span><span class="free"><span>s'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_consistent|const"><span>acc_consistent</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>s'</span></span><span>"</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.invarM_pw_iff|fact"><span>invarM_pw_iff</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.invarM_run|fact"><span>invarM_run</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span>
        
    
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.Mpar_sym|fact"><span class="entity_def" id="MMonad.Mpar_sym|thm"><span>Mpar_sym</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.Mpar|const"><span>Mpar</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Mbind|const"><span>Mbind</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.Mpar|const"><span>Mpar</span></a><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Mreturn|const"><span>Mreturn</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>,</span></span><span class="bound"><span>r<span class="hidden">⇩</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.spar_feasible_sym|fact"><span>spar_feasible_sym</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_norace_sym|fact"><span>acc_norace_sym</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.spar_feasible_sym|fact"><span>spar_feasible_sym</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_norace_sym|fact"><span>acc_norace_sym</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.spar_feasible_sym|fact"><span>spar_feasible_sym</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_norace_sym|fact"><span>acc_norace_sym</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>,</span></span></span><span> opaque_lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.ab_semigroup_add_class.add.commute|fact"><span>add.commute</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.combine_states_sym|fact"><span>combine_states_sym</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.spar_feasible_sym|fact"><span>spar_feasible_sym</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.res_run_consistentI|fact"><span>res_run_consistentI</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.spar_feasible_sym|fact"><span>spar_feasible_sym</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.acc_norace_sym|fact"><span>acc_norace_sym</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>,</span></span></span><span> opaque_lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.ab_semigroup_add_class.add.commute|fact"><span>add.commute</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.combine_states_sym|fact"><span>combine_states_sym</span></a><span> </span><a class="entity_ref" href="Generic_Memory.html#Generic_Memory.spar_feasible_sym|fact"><span>spar_feasible_sym</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.res_run_consistentI|fact"><span>res_run_consistentI</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
   
  </span><span class="keyword1"><span class="command"><span>lifting_update</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.M.lifting|bundle"><span>M.lifting</span></a><span>  
  </span><span class="keyword1"><span class="command"><span>lifting_forget</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.M.lifting|bundle"><span>M.lifting</span></a><span>  
     
  
  
</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Syntax›</span></span></span><span>  
  
  </span><span class="comment1"><span>(*abbreviation (input) bind_doI where "bind_doI m (λx. f x) ≡ BIND m (λx. f x)"*)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>abbreviation</span></span></span><span> </span><span class="entity"><span class="entity_def" id="MMonad.then_doM|const"><span>then_doM</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>then_doM</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Mbind|const"><span>Mbind</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>nonterminal</span></span></span><span> </span><span class="entity_def" id="offset_28247..28256">doM_binds</span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_28261..28269">doM_bind</span><span>
  </span><span class="keyword1"><span class="command"><span>syntax</span></span></span><span>
    </span><span class="quoted"><span>"_doM_block"</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#offset_28247..28256"><span>doM_binds</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword1"><span>do<span class="hidden">⇩</span><sub>M</sub></span></span><span> </span><span class="keyword1"><span>{</span></span><span class="keyword3"><span>//</span></span><span class="keyword3"><span>(2</span></span><span>  _</span><span class="keyword3"><span>)</span></span><span class="keyword3"><span>//</span></span><span class="keyword1"><span>}</span></span><span>"</span></span><span> </span><span class="main"><span>[</span></span><span>12</span><span class="main"><span>]</span></span><span> 62</span><span class="main"><span>)</span></span><span>
    </span><span class="quoted"><span>"_doM_bind"</span></span><span>  </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>[</span></span><span>pttrn</span><span class="main"><span>,</span></span><span> </span><span class="tfree"><span>'a</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_28261..28269"><span>doM_bind</span></a><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword3"><span>(2</span></span><span>_ </span><span class="keyword1"><span>←</span></span><span class="keyword3"><span>/ </span></span><span>_</span><span class="keyword3"><span>)</span></span><span>"</span></span><span> 13</span><span class="main"><span>)</span></span><span>
    </span><span class="quoted"><span>"_doM_let"</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>[</span></span><span>pttrn</span><span class="main"><span>,</span></span><span> </span><span class="tfree"><span>'a</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_28261..28269"><span>doM_bind</span></a><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword3"><span>(2</span></span><span class="keyword1"><span>let</span></span><span> _ </span><span class="keyword1"><span>=</span></span><span class="keyword3"><span>/ </span></span><span>_</span><span class="keyword3"><span>)</span></span><span>"</span></span><span> </span><span class="main"><span>[</span></span><span>1000</span><span class="main"><span>,</span></span><span> 13</span><span class="main"><span>]</span></span><span> 13</span><span class="main"><span>)</span></span><span>
    </span><span class="quoted"><span>"_doM_then"</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_28261..28269"><span>doM_bind</span></a><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"_"</span></span><span> </span><span class="main"><span>[</span></span><span>14</span><span class="main"><span>]</span></span><span> 13</span><span class="main"><span>)</span></span><span>
    </span><span class="quoted"><span>"_doM_final"</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_28247..28256"><span>doM_binds</span></a><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"_"</span></span><span class="main"><span>)</span></span><span>
    </span><span class="quoted"><span>"_doM_cons"</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>[</span></span><a class="entity_ref" href="MMonad.html#offset_28261..28269"><span>doM_bind</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_28247..28256"><span>doM_binds</span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_28247..28256"><span>doM_binds</span></a><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"_</span><span class="keyword1"><span>;</span></span><span class="keyword3"><span>//</span></span><span>_"</span></span><span> </span><span class="main"><span>[</span></span><span>13</span><span class="main"><span>,</span></span><span> 12</span><span class="main"><span>]</span></span><span> 12</span><span class="main"><span>)</span></span><span>
    </span><span class="comment1"><span>(*"_thenM" :: "['a, 'b] ⇒ 'c" (infixr "⪢" 54)*)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>syntax</span></span></span><span> </span><span class="main"><span>(</span></span><span>ASCII</span><span class="main"><span>)</span></span><span>
    </span><span class="quoted"><span>"_doM_block"</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#offset_28247..28256"><span>doM_binds</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword1"><span>doM</span></span><span> </span><span class="keyword1"><span>{</span></span><span class="keyword3"><span>//</span></span><span class="keyword3"><span>(2</span></span><span>  _</span><span class="keyword3"><span>)</span></span><span class="keyword3"><span>//</span></span><span class="keyword1"><span>}</span></span><span>"</span></span><span> </span><span class="main"><span>[</span></span><span>12</span><span class="main"><span>]</span></span><span> 62</span><span class="main"><span>)</span></span><span>
    </span><span class="quoted"><span>"_doM_bind"</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>[</span></span><span>pttrn</span><span class="main"><span>,</span></span><span> </span><span class="tfree"><span>'a</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_28261..28269"><span>doM_bind</span></a><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword3"><span>(2</span></span><span>_ </span><span class="keyword1"><span>&lt;-</span></span><span class="keyword3"><span>/ </span></span><span>_</span><span class="keyword3"><span>)</span></span><span>"</span></span><span> 13</span><span class="main"><span>)</span></span><span>
    </span><span class="comment1"><span>(*"_thenM" :: "['a, 'b] ⇒ 'c" (infixr "&gt;&gt;" 54)*)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>translations</span></span></span><span>
    </span><span class="quoted"><span>"_doM_block </span><span class="main"><span>(</span></span><span>_doM_cons </span><span class="main"><span>(</span></span><span>_doM_then </span><span class="free"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>_doM_final </span><span class="free"><span>e</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span><span>
      </span><span class="main"><span>⇌</span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>CONST</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.then_doM|const"><span>then_doM</span></a><span> </span><span class="free"><span>t</span></span><span> </span><span class="free"><span>e</span></span><span>"</span></span><span>

    </span><span class="quoted"><span>"_doM_block </span><span class="main"><span>(</span></span><span>_doM_cons </span><span class="main"><span>(</span></span><span>_doM_bind </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>_doM_final </span><span class="free"><span>e</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span><span>
      </span><span class="main"><span>⇌</span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>CONST</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Mbind|const"><span>Mbind</span></a><span> </span><span class="free"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="free"><span>p</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>e</span></span><span class="main"><span>)</span></span><span>"</span></span><span>

    </span><span class="quoted"><span>"_doM_block </span><span class="main"><span>(</span></span><span>_doM_cons </span><span class="main"><span>(</span></span><span>_doM_let </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>bs</span></span><span class="main"><span>)</span></span><span>"</span></span><span>
      </span><span class="main"><span>⇌</span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>let</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="keyword1"><span>in</span></span><span> _doM_block </span><span class="free"><span>bs</span></span><span>"</span></span><span>

    </span><span class="quoted"><span>"_doM_block </span><span class="main"><span>(</span></span><span>_doM_cons </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>(</span></span><span>_doM_cons </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>cs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span><span>
      </span><span class="main"><span>⇌</span></span><span> </span><span class="quoted"><span>"_doM_block </span><span class="main"><span>(</span></span><span>_doM_cons </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>(</span></span><span>_doM_final </span><span class="main"><span>(</span></span><span>_doM_block </span><span class="main"><span>(</span></span><span>_doM_cons </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>cs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span><span>

    </span><span class="quoted"><span>"_doM_cons </span><span class="main"><span>(</span></span><span>_doM_let </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>_doM_final </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span>"</span></span><span>
      </span><span class="main"><span>⇌</span></span><span> </span><span class="quoted"><span>"_doM_final </span><span class="main"><span>(</span></span><span class="keyword1"><span>let</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span>"</span></span><span>

    </span><span class="quoted"><span>"_doM_block </span><span class="main"><span>(</span></span><span>_doM_final </span><span class="free"><span>e</span></span><span class="main"><span>)</span></span><span>"</span></span><span> </span><span class="main"><span>⇀</span></span><span> </span><span class="quoted"><span>"</span><span class="free"><span>e</span></span><span>"</span></span><span>
  
    </span><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="keyword1"><span>CONST</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.then_doM|const"><span>then_doM</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span><span> </span><span class="main"><span>⇀</span></span><span> </span><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="keyword1"><span>CONST</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Mbind|const"><span>Mbind</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>_</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span><span>
    
   
  </span><span class="keyword1"><span class="command"><span>notation</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Mreturn|const"><span>Mreturn</span></a><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword1"><span>return<span class="hidden">⇩</span><sub>M</sub></span></span><span> _"</span></span><span> 20</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>notation</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Mspec|const"><span>Mspec</span></a><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>binder</span></span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>spec<span class="hidden">⇩</span><sub>M</sub></span></span><span> "</span></span><span> 10</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>notation</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Mpar|const"><span>Mpar</span></a><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>infixr</span></span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>∥<span class="hidden">⇩</span><sub>M</sub></span></span><span>"</span></span><span> 50</span><span class="main"><span>)</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Monad Laws›</span></span></span><span>    
  
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.M_monad_laws|fact"><span class="entity_def" id="MMonad.M_monad_laws(3)|thm"><span class="entity_def" id="MMonad.M_monad_laws(2)|thm"><span class="entity_def" id="MMonad.M_monad_laws(1)|thm"><span>M_monad_laws</span></span></span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>doM</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>x</span></span><span class="main"><span>←</span></span><span class="keyword1"><a class="entity_ref" href="MMonad.html#MMonad.Mreturn|const"><span>return<span class="hidden">⇩</span><sub>M</sub></span></a></span><span> </span><span class="free"><span>a</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>a</span></span><span>"</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>doM</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>x</span></span><span class="main"><span>←</span></span><span class="free"><span>m</span></span><span class="main"><span>;</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="MMonad.html#MMonad.Mreturn|const"><span>return<span class="hidden">⇩</span><sub>M</sub></span></a></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>m</span></span><span>"</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>doM</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>y</span></span><span class="main"><span>←</span></span><span class="keyword1"><span>doM</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>x</span></span><span class="main"><span>←</span></span><span class="free"><span>m</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>}</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>g</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="keyword1"><span>doM</span></span><span> </span><span class="main"><span>{</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>←</span></span><span class="free"><span>m</span></span><span class="main"><span>;</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>←</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>g</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
  
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span> 
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span> 
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.group_cancel.add1|fact"><span>group_cancel.add1</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span> 
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>,</span></span></span><span> opaque_lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.semigroup_add_class.add.assoc|fact"><span>add.assoc</span></a><span class="main"><span>)</span></span><span>
  
  </span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Additional simp lemmas›</span></span></span><span>
  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.Mreturn_inj|fact"><span class="entity_def" id="MMonad.Mreturn_inj|thm"><span>Mreturn_inj</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="MMonad.html#MMonad.Mreturn|const"><span>return<span class="hidden">⇩</span><sub>M</sub></span></a></span><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="MMonad.html#MMonad.Mreturn|const"><span>return<span class="hidden">⇩</span><sub>M</sub></span></a></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="free"><span>a</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="free"><span>b</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
  
  
  
</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Derived Constructs›</span></span></span><span>  

  </span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Fail›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹We define fail via least upper bound of the empty set, and show that it behaves as expected›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.Mfail_def|fact"><span class="entity_def" id="MMonad.Mfail_def|thm"><span class="entity_def" id="MMonad.Mfail_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="MMonad.Mfail|const"><span>Mfail</span></span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword1"><span>fail<span class="hidden">⇩</span><sub>M</sub></span></span><span>"</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Mfail</span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Mlub|const"><span>Mlub</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span>
  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.run_Mfail|fact"><span class="entity_def" id="MMonad.run_Mfail|thm"><span>run_Mfail</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_simp|attribute"><span class="operator"><span>pw_simp</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Mfail|const"><span>Mfail</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.neM.FAIL|const"><span>FAIL</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Mfail_def|fact"><span>Mfail_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.M_bind_fail|fact"><span class="entity_def" id="MMonad.M_bind_fail(2)|thm"><span class="entity_def" id="MMonad.M_bind_fail(1)|thm"><span>M_bind_fail</span></span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>  
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>doM</span></span><span> </span><span class="main"><span>{</span></span><span class="free"><span>m</span></span><span class="main"><span>;</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="MMonad.html#MMonad.Mfail|const"><span>fail<span class="hidden">⇩</span><sub>M</sub></span></a></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="MMonad.html#MMonad.Mfail|const"><span>fail<span class="hidden">⇩</span><sub>M</sub></span></a></span><span>"</span></span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>doM</span></span><span> </span><span class="main"><span>{</span></span><span class="keyword1"><a class="entity_ref" href="MMonad.html#MMonad.Mfail|const"><span>fail<span class="hidden">⇩</span><sub>M</sub></span></a></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>m</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="MMonad.html#MMonad.Mfail|const"><span>fail<span class="hidden">⇩</span><sub>M</sub></span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span class="main"><span class="keyword3"><span>+</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.M_par_fail|fact"><span class="entity_def" id="MMonad.M_par_fail(2)|thm"><span class="entity_def" id="MMonad.M_par_fail(1)|thm"><span>M_par_fail</span></span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>  
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="MMonad.html#MMonad.Mfail|const"><span>fail<span class="hidden">⇩</span><sub>M</sub></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="MMonad.html#MMonad.Mpar|const"><span>∥<span class="hidden">⇩</span><sub>M</sub></span></a></span><span> </span><span class="free"><span>m<span class="hidden">⇩</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="MMonad.html#MMonad.Mfail|const"><span>fail<span class="hidden">⇩</span><sub>M</sub></span></a></span><span>"</span></span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>m<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="MMonad.html#MMonad.Mpar|const"><span>∥<span class="hidden">⇩</span><sub>M</sub></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="MMonad.html#MMonad.Mfail|const"><span>fail<span class="hidden">⇩</span><sub>M</sub></span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="MMonad.html#MMonad.Mfail|const"><span>fail<span class="hidden">⇩</span><sub>M</sub></span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span class="main"><span class="keyword3"><span>+</span></span></span><span>
          
  </span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Assert›</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.Massert_def|fact"><span class="entity_def" id="MMonad.Massert_def|thm"><span class="entity_def" id="MMonad.Massert_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="MMonad.Massert|const"><span>Massert</span></span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword1"><span>assert<span class="hidden">⇩</span><sub>m</sub></span></span><span> _"</span></span><span> 20</span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Massert</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>P</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>P</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Mreturn|const"><span>Mreturn</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Unity|const"><span>()</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Mfail|const"><span>Mfail</span></a><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.run_assert|fact"><span class="entity_def" id="MMonad.run_assert|thm"><span>run_assert</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="NEMonad.html#NEMonad.pw_simp|attribute"><span class="operator"><span>pw_simp</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.M.run|const"><span>run</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="MMonad.html#MMonad.Massert|const"><span>Massert</span></a><span> </span><span class="free"><span>P</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="keyword1"><span>do<span class="hidden">⇩</span><sub>n</sub><span class="hidden">⇩</span><sub>e</sub></span></span><span> </span><span class="main"><span>{</span></span><span class="keyword1"><a class="entity_ref" href="NEMonad.html#NEMonad.ASSERT|const"><span>assert<span class="hidden">⇩</span><sub>n</sub><span class="hidden">⇩</span><sub>e</sub></span></a></span><span> </span><span class="free"><span>P</span></span><span class="main"><span>;</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="NEMonad.html#NEMonad.RETURN|const"><span>return<span class="hidden">⇩</span><sub>n</sub><span class="hidden">⇩</span><sub>e</sub></span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Unity|const"><span>()</span></a></span><span class="main"><span>,</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>,</span></span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Massert_def|fact"><span>Massert_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.assert_True|fact"><span class="entity_def" id="MMonad.assert_True|thm"><span>assert_True</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.Massert|const"><span>Massert</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Mreturn|const"><span>Mreturn</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Unity|const"><span>()</span></a></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pw|method"><span class="operator"><span>pw</span></span></a><span>
    
  </span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹While›</span></span></span><span>
    
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="MMonad.Mwhile_def|fact"><span class="entity_def" id="MMonad.Mwhile_def|thm"><span class="entity_def" id="MMonad.Mwhile_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="MMonad.Mwhile|const"><span>Mwhile</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>b</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>c</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.REC|const"><span>REC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>while</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>doM</span></span><span> </span><span class="main"><span>{</span></span><span>
    </span><span class="bound"><span>bb</span></span><span> </span><span class="main"><span>←</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>b</span></span></span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>;</span></span><span>
    </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="bound"><span>bb</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>doM</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>←</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>c</span></span></span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>;</span></span><span>
      </span><span class="bound"><span>while</span></span><span> </span><span class="bound"><span>s</span></span><span>
    </span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="MMonad.html#MMonad.Mreturn|const"><span>return<span class="hidden">⇩</span><sub>M</sub></span></a></span><span> </span><span class="bound"><span>s</span></span><span>
  </span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.Mwhile_unfold|fact"><span class="entity_def" id="MMonad.Mwhile_unfold|thm"><span>Mwhile_unfold</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.Mwhile|const"><span>Mwhile</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="keyword1"><span>doM</span></span><span> </span><span class="main"><span>{</span></span><span>
    </span><span class="bound"><span>bb</span></span><span> </span><span class="main"><span>←</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>;</span></span><span>
    </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="bound"><span>bb</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="keyword1"><span>doM</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>←</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>;</span></span><span>
      </span><a class="entity_ref" href="MMonad.html#MMonad.Mwhile|const"><span>Mwhile</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="bound"><span>s</span></span><span>
    </span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="MMonad.html#MMonad.Mreturn|const"><span>return<span class="hidden">⇩</span><sub>M</sub></span></a></span><span> </span><span class="free"><span>s</span></span><span>
  </span><span class="main"><span>}</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Mwhile_def|fact"><span>Mwhile_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="MMonad.html#MMonad.REC_unfold|fact"><span>REC_unfold</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pf_mono_prover|method"><span class="operator"><span>pf_mono_prover</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>..</span></span></span><span>
    
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_31314..31319">lemma</span></span></span><span> </span><span class="entity_def" id="MMonad.Mwhile_mono|fact"><span class="entity_def" id="MMonad.Mwhile_mono|thm"><span>Mwhile_mono</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../../HOL/HOL/Partial_Function.html#Partial_Function.partial_function_mono|attribute"><span class="operator"><span>partial_function_mono</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>      
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.M_mono&apos;|const"><span>M_mono'</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>f</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.M_mono&apos;|const"><span>M_mono'</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>f</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="bound"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#MMonad.M_mono&apos;|const"><span>M_mono'</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>D</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Mwhile|const"><span>Mwhile</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span> </span><span class="bound"><span>D</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>σ</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Mwhile_def|fact"><span>Mwhile_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#offset_31314..31319"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="NEMonad.html#NEMonad.pf_mono_prover|method"><span class="operator"><span>pf_mono_prover</span></span></a><span>
    

</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Syntax Bundle›</span></span></span><span>    
  </span><span class="keyword1"><span class="command"><span>bundle</span></span></span><span> </span><span class="entity_def" id="MMonad.monad_syntax_M|bundle"><span>monad_syntax_M</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>syntax</span></span></span><span>
      </span><span class="quoted"><span>"_doM_block"</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="MMonad.html#offset_28247..28256"><span>doM_binds</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword1"><span>do</span></span><span> </span><span class="keyword1"><span>{</span></span><span class="keyword3"><span>//</span></span><span class="keyword3"><span>(2</span></span><span>  _</span><span class="keyword3"><span>)</span></span><span class="keyword3"><span>//</span></span><span class="keyword1"><span>}</span></span><span>"</span></span><span> </span><span class="main"><span>[</span></span><span>12</span><span class="main"><span>]</span></span><span> 62</span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>notation</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Mfail|const"><span>Mfail</span></a><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword1"><span>fail</span></span><span>"</span></span><span class="main"><span>)</span></span><span>      
    </span><span class="keyword1"><span class="command"><span>notation</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Mreturn|const"><span>Mreturn</span></a><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword1"><span>return</span></span><span> _"</span></span><span> 20</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>notation</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Mspec|const"><span>Mspec</span></a><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>binder</span></span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>spec</span></span><span> "</span></span><span> 10</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>notation</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Massert|const"><span>Massert</span></a><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword1"><span>assert</span></span><span> _"</span></span><span> 20</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>notation</span></span></span><span> </span><a class="entity_ref" href="MMonad.html#MMonad.Mpar|const"><span>Mpar</span></a><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>infixr</span></span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>∥</span></span><span>"</span></span><span> 50</span><span class="main"><span>)</span></span><span>
      
  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
  
    
    
    
      
  
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>        
            
        
</span><span class="comment1"><span>(* TODO:
    can we integrate independence of values not read into consistency?
    → will change admissibility proof, but should be OK!
    → will need a simulation relation spanning results, too. As results
      can contain pointers to changed memory layout.
      
*)</span></span><span>    
    
</span></pre>
</body>

</html>