<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Nat_Array_Dfun</title>
</head>


<body>
<div class="head">
<h1>Theory Nat_Array_Dfun</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Array based Default-Valued Function›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><a href="Nat_Array_Dfun.html"><span>Nat_Array_Dfun</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> </span><a href="Intf_Dfun.html"><span>Intf_Dfun</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="comment1"><span>(* TODO: Move *)</span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Nat_Array_Dfun.init_hnr|fact"><span class="entity_def" id="Nat_Array_Dfun.init_hnr|thm"><span>init_hnr</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.sepref_fr_rules|attribute"><span class="operator"><span>sepref_fr_rules</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry0|const"><span>uncurry0</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/MMonad.html#MMonad.Mreturn|const"><span>Mreturn</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow.html#LLVM_Shallow.llvm_rep_class.init|const"><span>init</span></a><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry0|const"><span>uncurry0</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow.html#LLVM_Shallow.llvm_rep_class.init|const"><span>init</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.unit_assn|const"><span>unit_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefttnd|const"><span>→<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.id_assn|const"><span>id_assn</span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref_to_hoare|method"><span class="operator"><span>sepref_to_hoare</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Basic_VCG.html#Basic_VCG.vcg|method"><span class="operator"><span>vcg</span></span></a><span>  

</span><span class="comment1"><span>(* TODO: Move *)</span></span><span>
</span><span class="comment1"><span>(* Introduce vassn-tag for arbitrary parameters. Useful to extract parameter-independent conditions from assertions *)</span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Nat_Array_Dfun.hfref_indep_vassn_tagI|fact"><span class="entity_def" id="Nat_Array_Dfun.hfref_indep_vassn_tagI|thm"><span>hfref_indep_vassn_tagI</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_435..436">A</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.vassn_tag|const"><span>vassn_tag</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span> </span><span class="free"><span>RS</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>,</span></span><span class="free"><span>c</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfref|const"><span>[</span></a></span><span class="free"><span>P</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfref|const"><span>]<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfref|const"><span>[</span></a></span><span class="free"><span>C</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfref|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span> </span><span class="free"><span>RS</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfref|const"><span>→<span class="hidden">⇩</span><sub>d</sub></span></a></span><span> </span><span class="free"><span>T</span></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfref|const"><span>[</span></a></span><span class="free"><span>CP</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfref|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>,</span></span><span class="free"><span>c</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfref|const"><span>[</span></a></span><span class="free"><span>P</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfref|const"><span>]<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfref|const"><span>[</span></a></span><span class="free"><span>C</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfref|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span> </span><span class="free"><span>RS</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfref|const"><span>→<span class="hidden">⇩</span><sub>d</sub></span></a></span><span> </span><span class="free"><span>T</span></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfref|const"><span>[</span></a></span><span class="free"><span>CP</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfref|const"><span>]<span class="hidden">⇩</span><sub>c</sub></span></a></span><span>"</span></span></span><span>  
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.hn_refine_vassn_tagI|fact"><span>hn_refine_vassn_tagI</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>drule</span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#offset_435..436"><span>A</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefD|fact"><span>hfrefD</span></a><span class="main"><span>)</span></span><span>

      
</span><span class="comment1"><span>(* TODO: Move *)</span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Nat_Array_Dfun.hr_comp_empty1_iff|fact"><span class="entity_def" id="Nat_Array_Dfun.hr_comp_empty1_iff|thm"><span>hr_comp_empty1_iff</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hr_comp|const"><span>hr_comp</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span> </span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Separation_Algebra.Separation_Algebra.html#Separation_Algebra.sep_algebra_class.sep_false|const"><span>sep_false</span></a><span class="main"><span>)</span></span><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span> </span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Separation_Algebra.Separation_Algebra.html#Separation_Algebra.sep_algebra_class.sep_false|const"><span>sep_false</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hr_comp_def|fact"><span>hr_comp_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Nat_Array_Dfun.hr_comp_empty2_iff|fact"><span class="entity_def" id="Nat_Array_Dfun.hr_comp_empty2_iff|thm"><span>hr_comp_empty2_iff</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hr_comp|const"><span>hr_comp</span></a><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span> </span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Separation_Algebra.Separation_Algebra.html#Separation_Algebra.sep_algebra_class.sep_false|const"><span>sep_false</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hr_comp_def|fact"><span>hr_comp_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.force|method"><span class="operator"><span>force</span></span></a><span>  
  
</span><span class="comment1"><span>(* TODO: Move *)</span></span><span>  
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Nat_Array_Dfun.vassn_tag_false|fact"><span class="entity_def" id="Nat_Array_Dfun.vassn_tag_false|thm"><span>vassn_tag_false</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.vassn_tag|const"><span>vassn_tag</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Separation_Algebra.Separation_Algebra.html#Separation_Algebra.sep_algebra_class.sep_false|const"><span>sep_false</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>  
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.vassn_tag_def|fact"><span>vassn_tag_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Nat_Array_Dfun.GEN_ALGO_is_init_pure|fact"><span class="entity_def" id="Nat_Array_Dfun.GEN_ALGO_is_init_pure|thm"><span>GEN_ALGO_is_init_pure</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.GEN_ALGO|const"><span>GEN_ALGO</span></a><span> </span><span class="free"><span>dflt</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.is_init|const"><span>is_init</span></a><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.is_pure|const"><span>is_pure</span></a><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.is_init_def|fact"><span>is_init_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.GEN_ALGO_def|fact"><span>GEN_ALGO_def</span></a><span class="main"><span>)</span></span><span>  
  
  
  


</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Functions </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>nat ⇒ 'a::default›</span></span></span><span>, based on dynamic array›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Intermediate Abstraction Level›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>context</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>dflt</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="tfree"><span class="quoted"><span class="tfree"><span>'a</span></span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span> 
    
    
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Nat_Array_Dfun.nat_map_\&lt;alpha&gt;_def|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_\&lt;alpha&gt;_def|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_\&lt;alpha&gt;_def_raw|axiom"><span class="entity_def" id="offset_1284..1294">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Nat_Array_Dfun.nat_map_\&lt;alpha&gt;|const"><span class="entity_def" id="offset_1295..1304">nat_map_α</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list|type"><span>list</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>nat_map_α</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="free"><span>dflt</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Nat_Array_Dfun.nat_map_init_size_def|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_init_size_def|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_init_size_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Nat_Array_Dfun.nat_map_init_size|const"><span>nat_map_init_size</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>nat_map_init_size</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="numeral"><span>16</span></span><span>"</span></span></span><span>  
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Nat_Array_Dfun.nat_map_empty_def|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_empty_def|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_empty_def_raw|axiom"><span class="entity_def" id="offset_1462..1472">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Nat_Array_Dfun.nat_map_empty|const"><span class="entity_def" id="offset_1473..1486">nat_map_empty</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list|type"><span>list</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>nat_map_empty</span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.replicate|const"><span>replicate</span></a><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_init_size|const"><span>nat_map_init_size</span></a><span> </span><span class="free"><span>dflt</span></span><span>"</span></span></span><span>  
         
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Nat_Array_Dfun.nat_map_lookup_def|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_lookup_def|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_lookup_def_raw|axiom"><span class="entity_def" id="offset_1569..1579">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Nat_Array_Dfun.nat_map_lookup|const"><span class="entity_def" id="offset_1581..1595">nat_map_lookup</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/IICF_List.html#IICF_List.op_list_get|const"><span>op_list_get</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="free"><span>dflt</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Nat_Array_Dfun.nat_map_newsize_def|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_newsize_def|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_newsize_def_raw|axiom"><span class="entity_def" id="offset_1652..1662">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Nat_Array_Dfun.nat_map_newsize|const"><span>nat_map_newsize</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres|type"><span>nres</span></a><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>nat_map_newsize</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>csz</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>nsz</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>csz</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="free"><span class="bound"><span class="entity"><span>nsz</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>sz'</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>nsz</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="bound"><span>sz'</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>

  
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_resize_def|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_resize_def|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_resize_def_raw|axiom"><span class="entity_def" id="offset_1791..1801">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_resize|const"><span class="entity_def" id="offset_1803..1824">nat_map_update_resize</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doN</span></span><span> </span><span class="main"><span>{</span></span><span>
  </span><span class="bound"><span>l</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/IICF_List.html#IICF_List.mop_list_length|const"><span>mop_list_length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>;</span></span><span>
  </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>l</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
  </span><span class="bound"><span>ns</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_newsize|const"><span>nat_map_newsize</span></a><span> </span><span class="bound"><span>l</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
  </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.ASSERT|const"><span>ASSERT</span></a><span class="main"><span>(</span></span><span class="bound"><span>l</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="bound"><span>ns</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
  </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/IICF_Array.html#IICF_Array.op_list_grow_init|const"><span>op_list_grow_init</span></a><span> </span><span class="free"><span>dflt</span></span><span> </span><span class="bound"><span>ns</span></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>;</span></span><span>
  </span><a class="entity_ref" href="../Isabelle_LLVM/IICF_List.html#IICF_List.mop_list_set|const"><span>mop_list_set</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v</span></span></span></span><span>
</span><span class="main"><span>}</span></span><span>"</span></span></span><span>  
    
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_def|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_def|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_def_raw|axiom"><span class="entity_def" id="offset_2007..2017">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update|const"><span class="entity_def" id="offset_2019..2033">nat_map_update</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
  </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span>
    </span><a class="entity_ref" href="../Isabelle_LLVM/IICF_List.html#IICF_List.mop_list_set|const"><span>mop_list_set</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v</span></span></span></span><span>
  </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> 
    </span><a class="entity_ref" href="Nat_Array_Dfun.html#offset_1803..1824"><span>nat_map_update_resize</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v</span></span></span></span><span>  
</span><span class="main"><span>}</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Nat_Array_Dfun.nat_map_reset_def|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_reset_def|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_reset_def_raw|axiom"><span class="entity_def" id="offset_2141..2151">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Nat_Array_Dfun.nat_map_reset|const"><span class="entity_def" id="offset_2153..2166">nat_map_reset</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> 
  </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span>length</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span>
    </span><a class="entity_ref" href="../Isabelle_LLVM/IICF_List.html#IICF_List.mop_list_set|const"><span>mop_list_set</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="free"><span>dflt</span></span><span>
  </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span>
    </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span>
"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Nat_Array_Dfun.nat_map_empty_correct|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_empty_correct|thm"><span>nat_map_empty_correct</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Nat_Array_Dfun.html#offset_1295..1304"><span>nat_map_α</span></a><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#offset_1473..1486"><span>nat_map_empty</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>dflt</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#offset_1284..1294"><span>nat_map_α_def</span></a><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#offset_1462..1472"><span>nat_map_empty_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.fun_eq_iff|fact"><span>fun_eq_iff</span></a><span class="main"><span>)</span></span><span> 
    
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Nat_Array_Dfun.nat_map_lookup_correct|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_lookup_correct|thm"><span>nat_map_lookup_correct</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Nat_Array_Dfun.html#offset_1581..1595"><span>nat_map_lookup</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#offset_1295..1304"><span>nat_map_α</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>i</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#offset_1569..1579"><span>nat_map_lookup_def</span></a><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#offset_1284..1294"><span>nat_map_α_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
  
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_correct|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_correct|thm"><span>nat_map_update_correct</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|attribute"><span class="operator"><span>refine_vcg</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Nat_Array_Dfun.html#offset_2019..2033"><span>nat_map_update</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>m'</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#offset_1295..1304"><span>nat_map_α</span></a><span> </span><span class="bound"><span>m'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#offset_1295..1304"><span>nat_map_α</span></a><span> </span><span class="free"><span>m</span></span><span class="main"><span>)</span></span><span class="main"><span>(</span></span><span class="free"><span>i</span></span><span class="main"><span>:=</span></span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#offset_2007..2017"><span>nat_map_update_def</span></a><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#offset_1791..1801"><span>nat_map_update_resize_def</span></a><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#offset_1652..1662"><span>nat_map_newsize_def</span></a><span> 
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#offset_1284..1294"><span>nat_map_α_def</span></a><span> 
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.fun_eq_iff|fact"><span>fun_eq_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth_append|fact"><span>nth_append</span></a><span> </span><span class="quasi_keyword"><span>split</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.if_splits|fact"><span>if_splits</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Nat_Array_Dfun.nat_map_reset_correct|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_reset_correct|thm"><span>nat_map_reset_correct</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|attribute"><span class="operator"><span>refine_vcg</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Nat_Array_Dfun.html#offset_2153..2166"><span>nat_map_reset</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.SPEC|const"><span>SPEC</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>m'</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#offset_1295..1304"><span>nat_map_α</span></a><span> </span><span class="bound"><span>m'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#offset_1295..1304"><span>nat_map_α</span></a><span> </span><span class="free"><span>m</span></span><span class="main"><span>)</span></span><span class="main"><span>(</span></span><span class="free"><span>i</span></span><span class="main"><span>:=</span></span><span class="free"><span>dflt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#offset_2141..2151"><span>nat_map_reset_def</span></a><span> 
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#offset_1284..1294"><span>nat_map_α_def</span></a><span> 
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.fun_eq_iff|fact"><span>fun_eq_iff</span></a><span> </span><span class="quasi_keyword"><span>split</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.if_splits|fact"><span>if_splits</span></a><span class="main"><span>)</span></span><span>
  
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Nat_Array_Dfun.nat_map_reset.mcomb|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_reset.arity|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_reset.itype|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_reset.pat|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_resize.mcomb|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_resize.arity|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_resize.itype|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_resize.pat|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update.mcomb|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update.arity|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update.itype|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update.pat|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_lookup.itype|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_lookup.pat|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_empty.itype|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_empty.pat|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_reset.mcomb|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_reset.arity|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_reset.itype|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_reset.pat|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_resize.mcomb|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_resize.arity|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_resize.itype|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_resize.pat|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update.mcomb|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update.arity|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update.itype|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update.pat|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_lookup.itype|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_lookup.pat|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_empty.itype|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_empty.pat|thm"><span>sepref_register</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="Nat_Array_Dfun.html#offset_1473..1486"><span>nat_map_empty</span></a></span><span> </span><span class="quoted"><a class="entity_ref" href="Nat_Array_Dfun.html#offset_1581..1595"><span>nat_map_lookup</span></a></span><span> </span><span class="quoted"><a class="entity_ref" href="Nat_Array_Dfun.html#offset_2019..2033"><span>nat_map_update</span></a></span><span> </span><span class="quoted"><a class="entity_ref" href="Nat_Array_Dfun.html#offset_1803..1824"><span>nat_map_update_resize</span></a></span><span> </span><span class="quoted"><a class="entity_ref" href="Nat_Array_Dfun.html#offset_2153..2166"><span>nat_map_reset</span></a></span><span> 
        
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>


</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Implementation›</span></span></span><span>


</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Max-Index computation›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Nat_Array_Dfun.nat_map_newsize_impl_def|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_newsize_impl_def|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_newsize_impl_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Nat_Array_Dfun.nat_map_newsize_impl|const"><span>nat_map_newsize_impl</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'l</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_More_Word_Lemmas.html#LLVM_More_Word_Lemmas.len2|class"><span>len2</span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/HOL-Library.Word.html#Word.word|type"><span>word</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'l</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/HOL-Library.Word.html#Word.word|type"><span>word</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'l</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/HOL-Library.Word.html#Word.word|type"><span>word</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Simple_Memory.html#Simple_Memory.llM|type"><span>llM</span></a><span>"</span></span></span><span> 
</span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Codegen_Preproc.html#LLVM_Codegen_Preproc.llvm_inline|attribute"><span class="operator"><span>llvm_inline</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>   
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>nat_map_newsize_impl</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>c</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>c'</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="keyword1"><span>doM</span></span><span> </span><span class="main"><span>{</span></span><span>
    </span><span class="bound"><span>max</span></span><span class="main"><span>::</span></span><span class="tfree"><span>'l</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/HOL-Library.Word.html#Word.word|type"><span>word</span></a><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_DS_Arith.html#LLVM_DS_Arith.ll_max_snat|const"><span>ll_max_snat</span></a><span class="main"><span>;</span></span><span>
    </span><span class="bound"><span>max</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow.html#LLVM_Shallow.ll_udiv|const"><span>ll_udiv</span></a><span> </span><span class="bound"><span>max</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_DS_Arith.html#LLVM_DS_Arith.signed_nat|const"><span>signed_nat</span></a><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
    </span><span class="bound"><span>b</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow.html#LLVM_Shallow.ll_icmp_ule|const"><span>ll_icmp_ule</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>c</span></span></span></span><span> </span><span class="bound"><span>max</span></span><span class="main"><span>;</span></span><span>
    </span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow.html#LLVM_Shallow.llc_if|const"><span>llc_if</span></a><span> </span><span class="bound"><span>b</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>doM</span></span><span> </span><span class="main"><span>{</span></span><span>
        </span><span class="bound"><span>c</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow.html#LLVM_Shallow.ll_mul|const"><span>ll_mul</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>c</span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_DS_Arith.html#LLVM_DS_Arith.signed_nat|const"><span>signed_nat</span></a><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
        </span><span class="bound"><span>cok</span></span><span> </span><span class="main"><span>←</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow.html#LLVM_Shallow.ll_icmp_sle|const"><span>ll_icmp_sle</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>c'</span></span></span></span><span> </span><span class="bound"><span>c</span></span><span class="main"><span>;</span></span><span>
        </span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow.html#LLVM_Shallow.llc_if|const"><span>llc_if</span></a><span> </span><span class="bound"><span>cok</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/MMonad.html#MMonad.Mreturn|const"><span>Mreturn</span></a><span> </span><span class="bound"><span>c</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/MMonad.html#MMonad.Mreturn|const"><span>Mreturn</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>c'</span></span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> 
      </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/MMonad.html#MMonad.Mreturn|const"><span>Mreturn</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>c'</span></span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>}</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Nat_Array_Dfun.nat_map_newsize_impl_rule|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_newsize_impl_rule|thm"><span>nat_map_newsize_impl_rule</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Basic_VCG.html#Basic_VCG.vcg_rules|attribute"><span class="operator"><span>vcg_rules</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow_RS.html#LLVM_Shallow_RS.llvm_htriple|const"><span>llvm_htriple</span></a><span> 
    </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Frame_Infer.html#Frame_Infer.pred_lift_AUTO_DEFER|const"><span>↑<span class="hidden">⇩</span><sub>d</sub></span></a></span><span class="main"><span>(</span></span><span class="keyword1"><span>LENGTH</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Separation_Algebra.Separation_Algebra.html#Separation_Algebra.sep_algebra_class.sep_conj|const"><span>**</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow_RS.html#LLVM_Shallow_RS.dr_assn_prefix|const"><span>↿</span></a></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_DS_Arith.html#LLVM_DS_Arith.snat.assn|const"><span>snat.assn</span></a><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>ci</span></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Separation_Algebra.Separation_Algebra.html#Separation_Algebra.sep_algebra_class.sep_conj|const"><span>**</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow_RS.html#LLVM_Shallow_RS.dr_assn_prefix|const"><span>↿</span></a></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_DS_Arith.html#LLVM_DS_Arith.snat.assn|const"><span>snat.assn</span></a><span> </span><span class="free"><span>c'</span></span><span> </span><span class="free"><span>ci'</span></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Separation_Algebra.Separation_Algebra.html#Separation_Algebra.sep_algebra_class.sep_conj|const"><span>**</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Frame_Infer.html#Frame_Infer.pred_lift_AUTO_DEFER|const"><span>↑<span class="hidden">⇩</span><sub>d</sub></span></a></span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span class="free"><span>c'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> 
    </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_newsize_impl|const"><span>nat_map_newsize_impl</span></a><span> </span><span class="free"><span>ci</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>ci'</span></span><span class="main"><span>::</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_More_Word_Lemmas.html#LLVM_More_Word_Lemmas.len2|class"><span>len2</span></a><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/HOL-Library.Word.html#Word.word|type"><span>word</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> 
    </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>ri</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Separation_Algebra.Separation_Algebra.html#Separation_Algebra.pred_ex|const"><span>EXS</span></a></span><span> </span><span class="bound"><span>r</span></span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Separation_Algebra.Separation_Algebra.html#Separation_Algebra.pred_ex|const"><span>.</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow_RS.html#LLVM_Shallow_RS.dr_assn_prefix|const"><span>↿</span></a></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_DS_Arith.html#LLVM_DS_Arith.snat.assn|const"><span>snat.assn</span></a><span> </span><span class="bound"><span>r</span></span><span> </span><span class="bound"><span>ri</span></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Separation_Algebra.Separation_Algebra.html#Separation_Algebra.sep_algebra_class.sep_conj|const"><span>**</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sep_Algebra_Add.html#Sep_Algebra_Add.pred_lift|const"><span>↑</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.max|const"><span>max</span></a><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>c'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="bound"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_newsize_impl_def|fact"><span>nat_map_newsize_impl_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow_RS.html#LLVM_Shallow_RS.vcg_monadify|method"><span class="operator"><span>vcg_monadify</span></span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Basic_VCG.html#Basic_VCG.vcg|method"><span class="operator"><span>vcg</span></span></a><span>

</span><span class="keyword1"><span class="command"><span>find_theorems</span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="../Isabelle_LLVM/LLVM_DS_Arith.html#LLVM_DS_Arith.snat.assn|const"><span>snat.assn</span></a></span><span> </span><span class="quoted"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.snat_rel|const"><span>snat_rel</span></a></span><span>  
  
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Nat_Array_Dfun.nat_map_newsize.mcomb|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_newsize.arity|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_newsize.itype|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_newsize.mcomb|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_newsize.arity|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_newsize.itype|thm"><span>sepref_register</span></span></span></span></span></span></span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_newsize|const"><span>nat_map_newsize</span></a></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Nat_Array_Dfun.nat_map_newsize_impl_refine|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_newsize_impl_refine|thm"><span>nat_map_newsize_impl_refine</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.sepref_fr_rules|attribute"><span class="operator"><span>sepref_fr_rules</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.uncurry|const"><span>uncurry</span></a><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_newsize_impl|const"><span>nat_map_newsize_impl</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.uncurry|const"><span>uncurry</span></a><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_newsize|const"><span>nat_map_newsize</span></a><span class="main"><span>)</span></span><span>
  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefcptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>LENGTH</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span class="numeral"><span>2</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefcptnd|const"><span>]<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.snat_assn&apos;|const"><span>snat_assn'</span></a><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_More_Word_Lemmas.html#LLVM_More_Word_Lemmas.len2|class"><span>len2</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.snat_assn&apos;|const"><span>snat_assn'</span></a><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_More_Word_Lemmas.html#LLVM_More_Word_Lemmas.len2|class"><span>len2</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefcptnd|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.snat_assn&apos;|const"><span>snat_assn'</span></a><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_More_Word_Lemmas.html#LLVM_More_Word_Lemmas.len2|class"><span>len2</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_newsize_def|fact"><span>nat_map_newsize_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref_to_hoare|method"><span class="operator"><span>sepref_to_hoare</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.in_snat_rel_conv_assn|fact"><span>in_snat_rel_conv_assn</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Basic_VCG.html#Basic_VCG.vcg&apos;|method"><span class="operator"><span>vcg'</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_pw_simps|fact"><span class="dynamic"><span class="dynamic"><span>refine_pw_simps</span></span></span></a><span class="main"><span>)</span></span><span>
  
  
</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Standard Operations›</span></span></span><span>  

</span><span class="keyword1"><span class="command"><span>sepref_def</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Nat_Array_Dfun.nat_map_empty_impl|const"><span>nat_map_empty_impl</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry0|const"><span>uncurry0</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_empty|const"><span>nat_map_empty</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow.html#LLVM_Shallow.llvm_rep_class.init|const"><span>init</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
  </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefcptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>5</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="keyword1"><span>LENGTH</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>)</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefcptnd|const"><span>]<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.unit_assn|const"><span>unit_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefcptnd|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/IICF_Array.html#IICF_Array.larray_assn&apos;|const"><span>larray_assn'</span></a><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_More_Word_Lemmas.html#LLVM_More_Word_Lemmas.len2|class"><span>len2</span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.id_assn|const"><span>id_assn</span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_empty_def|fact"><span>nat_map_empty_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/IICF_Array.html#IICF_Array.larray_fold_custom_replicate|fact"><span>larray_fold_custom_replicate</span></a><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_init_size_def|fact"><span>nat_map_init_size_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.annot_snat_const|method"><span class="operator"><span>annot_snat_const</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Nat_Array_Dfun.nat_map_empty_impl.refine|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_empty_impl_def|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_empty_impl.refine_raw|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_empty_impl.refine|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_empty_impl_def|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_empty_impl.refine_raw|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_empty_impl_def_raw|axiom"><span>by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref_dbg_keep|method"><span class="operator"><span>sepref_dbg_keep</span></span></a><span>

</span><span class="keyword1"><span class="command"><span>sepref_def</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Nat_Array_Dfun.nat_map_lookup_impl|const"><span>nat_map_lookup_impl</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Codegen_Preproc.html#LLVM_Codegen_Preproc.llvm_code|attribute"><span class="operator"><span>llvm_code</span></span></a><span class="main"><span>,</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Codegen_Preproc.html#LLVM_Codegen_Preproc.llvm_inline|attribute"><span class="operator"><span>llvm_inline</span></span></a><span class="main"><span>]</span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.uncurry|const"><span>uncurry</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>oo</span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_lookup|const"><span>nat_map_lookup</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow.html#LLVM_Shallow.llvm_rep_class.init|const"><span>init</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
  </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/IICF_Array.html#IICF_Array.larray_assn&apos;|const"><span>larray_assn'</span></a><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_More_Word_Lemmas.html#LLVM_More_Word_Lemmas.len2|class"><span>len2</span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.id_assn|const"><span>id_assn</span></a><span class="main"><span>)</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.snat_assn&apos;|const"><span>snat_assn'</span></a><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefttnd|const"><span>→<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.id_assn|const"><span>id_assn</span></a><span>"</span></span></span><span>  
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_lookup_def|fact"><span>nat_map_lookup_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Nat_Array_Dfun.nat_map_lookup_impl.refine|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_lookup_impl_def|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_lookup_impl.refine_raw|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_lookup_impl.refine|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_lookup_impl_def|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_lookup_impl.refine_raw|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_lookup_impl_def_raw|axiom"><span>by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref|method"><span class="operator"><span>sepref</span></span></a><span>

</span><span class="keyword1"><span class="command"><span>sepref_def</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_resize_impl|const"><span>nat_map_update_resize_impl</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry2|const"><span>uncurry2</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_update_resize|const"><span>nat_map_update_resize</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow.html#LLVM_Shallow.llvm_rep_class.init|const"><span>init</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
  </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefcptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="bound"><span>v</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="keyword1"><span>LENGTH</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_DS_Arith.html#LLVM_DS_Arith.max_snat|const"><span>max_snat</span></a><span> </span><span class="keyword1"><span>LENGTH</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>)</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefcptnd|const"><span>]<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/IICF_Array.html#IICF_Array.larray_assn&apos;|const"><span>larray_assn'</span></a><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_More_Word_Lemmas.html#LLVM_More_Word_Lemmas.len2|class"><span>len2</span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.id_assn|const"><span>id_assn</span></a><span class="main"><span>)</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfdrop|const"><span><span class="hidden">⇧</span><sup>d</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.snat_assn&apos;|const"><span>snat_assn'</span></a><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.id_assn|const"><span>id_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefcptnd|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/IICF_Array.html#IICF_Array.larray_assn&apos;|const"><span>larray_assn'</span></a><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_More_Word_Lemmas.html#LLVM_More_Word_Lemmas.len2|class"><span>len2</span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.id_assn|const"><span>id_assn</span></a><span>"</span></span></span><span>  
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_update_resize_def|fact"><span>nat_map_update_resize_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.annot_snat_const|method"><span class="operator"><span>annot_snat_const</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_resize_impl.refine|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_resize_impl_def|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_resize_impl.refine_raw|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_resize_impl.refine|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_resize_impl_def|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_resize_impl.refine_raw|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_resize_impl_def_raw|axiom"><span>by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref|method"><span class="operator"><span>sepref</span></span></a><span>
  
</span><span class="keyword1"><span class="command"><span>sepref_def</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_impl|const"><span>nat_map_update_impl</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Codegen_Preproc.html#LLVM_Codegen_Preproc.llvm_code|attribute"><span class="operator"><span>llvm_code</span></span></a><span class="main"><span>,</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Codegen_Preproc.html#LLVM_Codegen_Preproc.llvm_inline|attribute"><span class="operator"><span>llvm_inline</span></span></a><span class="main"><span>]</span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry2|const"><span>uncurry2</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_update|const"><span>nat_map_update</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow.html#LLVM_Shallow.llvm_rep_class.init|const"><span>init</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
  </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefcptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="bound"><span>v</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="keyword1"><span>LENGTH</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_DS_Arith.html#LLVM_DS_Arith.max_snat|const"><span>max_snat</span></a><span> </span><span class="keyword1"><span>LENGTH</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>)</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefcptnd|const"><span>]<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> 
        </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/IICF_Array.html#IICF_Array.larray_assn&apos;|const"><span>larray_assn'</span></a><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_More_Word_Lemmas.html#LLVM_More_Word_Lemmas.len2|class"><span>len2</span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.id_assn|const"><span>id_assn</span></a><span class="main"><span>)</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfdrop|const"><span><span class="hidden">⇧</span><sup>d</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.snat_assn&apos;|const"><span>snat_assn'</span></a><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.id_assn|const"><span>id_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefcptnd|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/IICF_Array.html#IICF_Array.larray_assn&apos;|const"><span>larray_assn'</span></a><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_More_Word_Lemmas.html#LLVM_More_Word_Lemmas.len2|class"><span>len2</span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.id_assn|const"><span>id_assn</span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_update_def|fact"><span>nat_map_update_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_impl.refine|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_impl_def|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_impl.refine_raw|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_impl.refine|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_impl_def|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_impl.refine_raw|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_impl_def_raw|axiom"><span>by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref|method"><span class="operator"><span>sepref</span></span></a><span>


</span><span class="keyword1"><span class="command"><span>sepref_def</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Nat_Array_Dfun.nat_map_reset_impl|const"><span>nat_map_reset_impl</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Codegen_Preproc.html#LLVM_Codegen_Preproc.llvm_code|attribute"><span class="operator"><span>llvm_code</span></span></a><span class="main"><span>,</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Codegen_Preproc.html#LLVM_Codegen_Preproc.llvm_inline|attribute"><span class="operator"><span>llvm_inline</span></span></a><span class="main"><span>]</span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.uncurry|const"><span>uncurry</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_reset|const"><span>nat_map_reset</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow.html#LLVM_Shallow.llvm_rep_class.init|const"><span>init</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
  </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/IICF_Array.html#IICF_Array.larray_assn&apos;|const"><span>larray_assn'</span></a><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_More_Word_Lemmas.html#LLVM_More_Word_Lemmas.len2|class"><span>len2</span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.id_assn|const"><span>id_assn</span></a><span class="main"><span>)</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfdrop|const"><span><span class="hidden">⇧</span><sup>d</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.snat_assn&apos;|const"><span>snat_assn'</span></a><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefttnd|const"><span>→<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/IICF_Array.html#IICF_Array.larray_assn&apos;|const"><span>larray_assn'</span></a><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_More_Word_Lemmas.html#LLVM_More_Word_Lemmas.len2|class"><span>len2</span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.id_assn|const"><span>id_assn</span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_reset_def|fact"><span>nat_map_reset_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Nat_Array_Dfun.nat_map_reset_impl.refine|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_reset_impl_def|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_reset_impl.refine_raw|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_reset_impl.refine|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_reset_impl_def|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_reset_impl.refine_raw|thm"><span class="entity_def" id="Nat_Array_Dfun.nat_map_reset_impl_def_raw|axiom"><span>by</span></span></span></span></span></span></span></span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Tool.html#Sepref_Tool.sepref|method"><span class="operator"><span>sepref</span></span></a><span>
  

</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Chaining of Refinements›</span></span></span><span>   

</span><span class="keyword1"><span class="command"><span>context</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>dflt</span></span><span class="main"><span>::</span></span><span> </span><span class="tfree"><span class="quoted"><span class="tfree"><span>'a</span></span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'c</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow.html#LLVM_Shallow.llvm_rep|class"><span>llvm_rep</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.assn|type"><span>assn</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_6170..6174">INIT</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.GEN_ALGO|const"><span>GEN_ALGO</span></a><span> </span><span class="free"><span>dflt</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.is_init|const"><span>is_init</span></a><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Custom Parametricity Rules›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹We define custom parametricity rules that depend on the correctness of the default element›</span></span></span><span>

  </span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Nat_Array_Dfun.init_param|fact"><span class="entity_def" id="Nat_Array_Dfun.init_param|thm"><span class="entity_def" id="offset_6373..6383">init_param</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow.html#LLVM_Shallow.llvm_rep_class.init|const"><span>init</span></a><span class="main"><span>,</span></span><span class="free"><span>dflt</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.the_pure|const"><span>the_pure</span></a><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#offset_6170..6174"><span>INIT</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.is_init_def|fact"><span>is_init_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.GEN_ALGO_def|fact"><span>GEN_ALGO_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Nat_Array_Dfun.nat_map_empty_param|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_empty_param|thm"><span>nat_map_empty_param</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry0|const"><span>uncurry0</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_empty|const"><span>nat_map_empty</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow.html#LLVM_Shallow.llvm_rep_class.init|const"><span>init</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry0|const"><span>uncurry0</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_empty|const"><span>nat_map_empty</span></a><span> </span><span class="free"><span>dflt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> 
    </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.unit_rel|const"><span>unit_rel</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.freftnd|const"><span>→<span class="hidden">⇩</span><sub>f</sub></span></a></span><span> </span><span class="main"><span>⟨</span></span><span class="main"><span>⟨</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.the_pure|const"><span>the_pure</span></a><span> </span><span class="free"><span>A</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.list_rel|const"><span>list_rel</span></a><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span>    
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_empty_def|fact"><span>nat_map_empty_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry0_def|fact"><span>uncurry0_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.frefI|fact"><span>frefI</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Param_Tool.html#Param_Tool.parametricity|method"><span class="operator"><span>parametricity</span></span></a><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#offset_6373..6383"><span>init_param</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>term</span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_lookup|const"><span>nat_map_lookup</span></a></span><span>  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Nat_Array_Dfun.nat_map_lookup_param|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_lookup_param|thm"><span>nat_map_lookup_param</span></span></span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_lookup|const"><span>nat_map_lookup</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow.html#LLVM_Shallow.llvm_rep_class.init|const"><span>init</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_lookup|const"><span>nat_map_lookup</span></a><span> </span><span class="free"><span>dflt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><span class="main"><span>⟨</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.the_pure|const"><span>the_pure</span></a><span> </span><span class="free"><span>A</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.list_rel|const"><span>list_rel</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.nat_rel|const"><span>nat_rel</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.the_pure|const"><span>the_pure</span></a><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_lookup_def|fact"><span>nat_map_lookup_def</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Param_Tool.html#Param_Tool.parametricity|method"><span class="operator"><span>parametricity</span></span></a><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#offset_6373..6383"><span>init_param</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Param_Tool.html#Param_Tool.parametricity|method"><span class="operator"><span>parametricity</span></span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      
  </span><span class="keyword1"><span class="command"><span>term</span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_update|const"><span>nat_map_update</span></a></span><span>  
  
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_param|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_param|thm"><span>nat_map_update_param</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_update|const"><span>nat_map_update</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow.html#LLVM_Shallow.llvm_rep_class.init|const"><span>init</span></a><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_update|const"><span>nat_map_update</span></a><span> </span><span class="free"><span>dflt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> 
    </span><span class="main"><span>⟨</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.the_pure|const"><span>the_pure</span></a><span> </span><span class="free"><span>A</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.list_rel|const"><span>list_rel</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.nat_rel|const"><span>nat_rel</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.the_pure|const"><span>the_pure</span></a><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="main"><span>⟨</span></span><span class="main"><span>⟨</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.the_pure|const"><span>the_pure</span></a><span> </span><span class="free"><span>A</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.list_rel|const"><span>list_rel</span></a><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_update_def|fact"><span>nat_map_update_def</span></a><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_update_resize_def|fact"><span>nat_map_update_resize_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Param_Tool.html#Param_Tool.parametricity|method"><span class="operator"><span>parametricity</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Param_Tool.html#Param_Tool.parametricity|method"><span class="operator"><span>parametricity</span></span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Param_Tool.html#Param_Tool.parametricity|method"><span class="operator"><span>parametricity</span></span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_relI|fact"><span>nres_relI</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Param_Tool.html#Param_Tool.parametricity|method"><span class="operator"><span>parametricity</span></span></a><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#offset_6373..6383"><span>init_param</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Param_Tool.html#Param_Tool.parametricity|method"><span class="operator"><span>parametricity</span></span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
        
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Nat_Array_Dfun.nat_map_reset_param|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_reset_param|thm"><span>nat_map_reset_param</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_reset|const"><span>nat_map_reset</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow.html#LLVM_Shallow.llvm_rep_class.init|const"><span>init</span></a><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_reset|const"><span>nat_map_reset</span></a><span> </span><span class="free"><span>dflt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> 
    </span><span class="main"><span>⟨</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.the_pure|const"><span>the_pure</span></a><span> </span><span class="free"><span>A</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.list_rel|const"><span>list_rel</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.nat_rel|const"><span>nat_rel</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="main"><span>⟨</span></span><span class="main"><span>⟨</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.the_pure|const"><span>the_pure</span></a><span> </span><span class="free"><span>A</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.list_rel|const"><span>list_rel</span></a><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST_def|fact"><span>PR_CONST_def</span></a><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_reset_def|fact"><span>nat_map_reset_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Param_Tool.html#Param_Tool.parametricity|method"><span class="operator"><span>parametricity</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Refine_Util.html#Refine_Util.clarsimp_all|method"><span class="operator"><span>clarsimp_all</span></span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Param_Tool.html#Param_Tool.parametricity|method"><span class="operator"><span>parametricity</span></span></a><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#offset_6373..6383"><span>init_param</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
    
        
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>    

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹We add the information about the correct default element to the refinement relation›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Nat_Array_Dfun.nm_ga_rel_def|fact"><span class="entity_def" id="Nat_Array_Dfun.nm_ga_rel_def|thm"><span class="entity_def" id="Nat_Array_Dfun.nm_ga_rel_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Nat_Array_Dfun.nm_ga_rel|const"><span>nm_ga_rel</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>dflt</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>A</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.GEN_ALGO|const"><span>GEN_ALGO</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>dflt</span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.is_init|const"><span>is_init</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>A</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="main"><span>⟨</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.the_pure|const"><span>the_pure</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>A</span></span></span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.list_rel|const"><span>list_rel</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Nat_Array_Dfun.nat_map_empty_param2|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_empty_param2|thm"><span>nat_map_empty_param2</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.GEN_ALGO|const"><span>GEN_ALGO</span></a><span> </span><span class="free"><span>dflt</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.is_init|const"><span>is_init</span></a><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> 
  </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry0|const"><span>uncurry0</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_empty|const"><span>nat_map_empty</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow.html#LLVM_Shallow.llvm_rep_class.init|const"><span>init</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry0|const"><span>uncurry0</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_empty|const"><span>nat_map_empty</span></a><span> </span><span class="free"><span>dflt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> 
    </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.unit_rel|const"><span>unit_rel</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.freftnd|const"><span>→<span class="hidden">⇩</span><sub>f</sub></span></a></span><span> </span><span class="main"><span>⟨</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nm_ga_rel|const"><span>nm_ga_rel</span></a><span> </span><span class="free"><span>dflt</span></span><span> </span><span class="free"><span>A</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>
  "</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_empty_param|fact"><span>nat_map_empty_param</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nm_ga_rel_def|fact"><span>nm_ga_rel_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.force|method"><span class="operator"><span>force</span></span></a><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Nat_Array_Dfun.nat_map_lookup_param2|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_lookup_param2|thm"><span>nat_map_lookup_param2</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"
  </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_lookup|const"><span>nat_map_lookup</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow.html#LLVM_Shallow.llvm_rep_class.init|const"><span>init</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_lookup|const"><span>nat_map_lookup</span></a><span> </span><span class="free"><span>dflt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nm_ga_rel|const"><span>nm_ga_rel</span></a><span> </span><span class="free"><span>dflt</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.nat_rel|const"><span>nat_rel</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.the_pure|const"><span>the_pure</span></a><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_lookup_param|fact"><span>nat_map_lookup_param</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="free"><span>dflt</span></span></span><span> </span><span class="quoted"><span class="free"><span>A</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nm_ga_rel_def|fact"><span>nm_ga_rel_def</span></a><span> 
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
  
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_param2|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_param2|thm"><span>nat_map_update_param2</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_update|const"><span>nat_map_update</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow.html#LLVM_Shallow.llvm_rep_class.init|const"><span>init</span></a><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_update|const"><span>nat_map_update</span></a><span> </span><span class="free"><span>dflt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> 
  </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nm_ga_rel|const"><span>nm_ga_rel</span></a><span> </span><span class="free"><span>dflt</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.nat_rel|const"><span>nat_rel</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.the_pure|const"><span>the_pure</span></a><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="main"><span>⟨</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nm_ga_rel|const"><span>nm_ga_rel</span></a><span> </span><span class="free"><span>dflt</span></span><span> </span><span class="free"><span>A</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_update_param|fact"><span>nat_map_update_param</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="free"><span>dflt</span></span></span><span> </span><span class="quoted"><span class="free"><span>A</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nm_ga_rel_def|fact"><span>nm_ga_rel_def</span></a><span> 
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Nat_Array_Dfun.nat_map_reset_param2|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_reset_param2|thm"><span>nat_map_reset_param2</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_reset|const"><span>nat_map_reset</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow.html#LLVM_Shallow.llvm_rep_class.init|const"><span>init</span></a><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_reset|const"><span>nat_map_reset</span></a><span> </span><span class="free"><span>dflt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> 
  </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nm_ga_rel|const"><span>nm_ga_rel</span></a><span> </span><span class="free"><span>dflt</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.nat_rel|const"><span>nat_rel</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="main"><span>⟨</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nm_ga_rel|const"><span>nm_ga_rel</span></a><span> </span><span class="free"><span>dflt</span></span><span> </span><span class="free"><span>A</span></span><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_reset_param|fact"><span>nat_map_reset_param</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="free"><span>dflt</span></span></span><span> </span><span class="quoted"><span class="free"><span>A</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nm_ga_rel_def|fact"><span>nm_ga_rel_def</span></a><span> 
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
  

</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Customized intermediate to abstract lemmas›</span></span></span><span>   

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Nat_Array_Dfun.nat_map_empty_refine|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_empty_refine|thm"><span>nat_map_empty_refine</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_empty|const"><span>nat_map_empty</span></a><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Intf_Dfun.html#Intf_Dfun.op_dfun_empty|const"><span>op_dfun_empty</span></a><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.br|const"><span>br</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_\&lt;alpha&gt;|const"><span>nat_map_α</span></a><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.top_class.top|const"><span>top</span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.in_br_conv|fact"><span>in_br_conv</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Nat_Array_Dfun.nat_map_lookup_refine|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_lookup_refine|thm"><span>nat_map_lookup_refine</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_lookup|const"><span>nat_map_lookup</span></a><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Intf_Dfun.html#Intf_Dfun.op_dfun_lookup|const"><span>op_dfun_lookup</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.br|const"><span>br</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_\&lt;alpha&gt;|const"><span>nat_map_α</span></a><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.top_class.top|const"><span>top</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.in_br_conv|fact"><span>in_br_conv</span></a><span class="main"><span>)</span></span><span>  

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_refine|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_refine|thm"><span>nat_map_update_refine</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_update|const"><span>nat_map_update</span></a><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp3|const"><span>ooo</span></a></span><span> </span><a class="entity_ref" href="Intf_Dfun.html#Intf_Dfun.op_dfun_upd|const"><span>op_dfun_upd</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.br|const"><span>br</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_\&lt;alpha&gt;|const"><span>nat_map_α</span></a><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.top_class.top|const"><span>top</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="main"><span>⟨</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.br|const"><span>br</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_\&lt;alpha&gt;|const"><span>nat_map_α</span></a><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.top_class.top|const"><span>top</span></a><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span>  
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span>  
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.in_br_conv|fact"><span>in_br_conv</span></a><span class="main"><span>)</span></span><span>  

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Nat_Array_Dfun.nat_map_reset_refine|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_reset_refine|thm"><span>nat_map_reset_refine</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_reset|const"><span>nat_map_reset</span></a><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>RETURN</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>oo</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><a class="entity_ref" href="Intf_Dfun.html#Intf_Dfun.op_dfun_reset|const"><span>op_dfun_reset</span></a><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.br|const"><span>br</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_\&lt;alpha&gt;|const"><span>nat_map_α</span></a><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.top_class.top|const"><span>top</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id|const"><span>Id</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.fun_rel_syn|const"><span>→</span></a></span><span> </span><span class="main"><span>⟨</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.br|const"><span>br</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_\&lt;alpha&gt;|const"><span>nat_map_α</span></a><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.top_class.top|const"><span>top</span></a><span class="main"><span>⟩</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.nres_rel|const"><span>nres_rel</span></a><span>"</span></span></span><span>  
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.refine_vcg|method"><span class="operator"><span>refine_vcg</span></span></a><span>  
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.in_br_conv|fact"><span>in_br_conv</span></a><span class="main"><span>)</span></span><span>  
  

</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Combined Refinements›</span></span></span><span>
      
</span><span class="keyword1"><span class="command"><span>type_synonym</span></span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'a</span></span><span class="main"><span>,</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>)</span></span><span> </span><span class="entity_def" id="Nat_Array_Dfun.nadf|type"><span>nadf</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="tfree"><span>'a</span></span><span class="main"><span>,</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/IICF_Array.html#IICF_Array.larray|type"><span>larray</span></a><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Nat_Array_Dfun.nadf_assn_def|fact"><span class="entity_def" id="Nat_Array_Dfun.nadf_assn_def|thm"><span class="entity_def" id="Nat_Array_Dfun.nadf_assn_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Nat_Array_Dfun.nadf_assn|const"><span>nadf_assn</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'a</span></span><span class="main"><span>⇒</span></span><span class="tfree"><span>'c</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow.html#LLVM_Shallow.llvm_rep|class"><span>llvm_rep</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.assn|type"><span>assn</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'c</span></span><span class="main"><span>,</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_More_Word_Lemmas.html#LLVM_More_Word_Lemmas.len2|class"><span>len2</span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nadf|type"><span>nadf</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.assn|type"><span>assn</span></a><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>nadf_assn</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>dflt</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>A</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hr_comp|const"><span>hr_comp</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hr_comp|const"><span>hr_comp</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/IICF_Array.html#IICF_Array.larray_assn|const"><span>larray_assn</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.id_assn|const"><span>id_assn</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nm_ga_rel|const"><span>nm_ga_rel</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>dflt</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>A</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Relators.html#Relators.br|const"><span>br</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_\&lt;alpha&gt;|const"><span>nat_map_α</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>dflt</span></span></span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.top_class.top|const"><span>top</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>  

</span><span class="keyword1"><span class="command"><span>abbreviation</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Nat_Array_Dfun.nadf_assn&apos;|const"><span>nadf_assn'</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'l</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_More_Word_Lemmas.html#LLVM_More_Word_Lemmas.len2|class"><span>len2</span></a><span> </span><span>itself</span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>_</span></span><span class="main"><span>,</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/IICF_Array.html#IICF_Array.larray|type"><span>larray</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.assn|type"><span>assn</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>nadf_assn'</span></span><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>dflt</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>A</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nadf_assn|const"><span>nadf_assn</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>dflt</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>A</span></span></span></span><span>"</span></span></span><span>
  
  
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Nat_Array_Dfun.nadf_vassn_tagD|fact"><span class="entity_def" id="Nat_Array_Dfun.nadf_vassn_tagD|thm"><span>nadf_vassn_tagD</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.dest|attribute"><span class="operator"><span>dest</span></span></a><span class="main"><span class="main"><span class="main"><span class="main"><span>!</span></span></span></span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.vassn_tag|const"><span>vassn_tag</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nadf_assn|const"><span>nadf_assn</span></a><span> </span><span class="free"><span>dflt</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>c</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.GEN_ALGO|const"><span>GEN_ALGO</span></a><span> </span><span class="free"><span>dflt</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.is_init|const"><span>is_init</span></a><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nadf_assn_def|fact"><span>nadf_assn_def</span></a><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nm_ga_rel_def|fact"><span>nm_ga_rel_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.ccontr|fact"><span>ccontr</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    
  
  
    
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Nat_Array_Dfun.op_nadf_empty_def|fact"><span class="entity_def" id="Nat_Array_Dfun.op_nadf_empty_def|thm"><span class="entity_def" id="Nat_Array_Dfun.op_nadf_empty_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Nat_Array_Dfun.op_nadf_empty|const"><span>op_nadf_empty</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'l</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_More_Word_Lemmas.html#LLVM_More_Word_Lemmas.len2|class"><span>len2</span></a><span> </span><span>itself</span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'v</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'v</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'vi</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow.html#LLVM_Shallow.llvm_rep|class"><span>llvm_rep</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.assn|type"><span>assn</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'k</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'v</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>op_nadf_empty</span></span><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>dflt</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>A</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="Intf_Dfun.html#Intf_Dfun.op_dfun_empty|const"><span>op_dfun_empty</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>dflt</span></span></span></span><span>"</span></span></span><span>  
</span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="entity_def" id="Nat_Array_Dfun.nadf_fold_custom_empty|fact"><span class="entity_def" id="Nat_Array_Dfun.nadf_fold_custom_empty|thm"><span>nadf_fold_custom_empty</span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.op_nadf_empty_def|fact"><span>op_nadf_empty_def</span></a><span class="main"><span>[</span></span><span class="operator"><span>symmetric</span></span><span class="main"><span>]</span></span><span>  


</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Nat_Array_Dfun.nadf_assn_intf|fact"><span class="entity_def" id="Nat_Array_Dfun.nadf_assn_intf|thm"><span>nadf_assn_intf</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.intf_of_assn|attribute"><span class="operator"><span>intf_of_assn</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.intf_of_assn|const"><span>intf_of_assn</span></a><span> </span><span class="free"><span>A</span></span><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.intf_of_assn|const"><span>intf_of_assn</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nadf_assn|const"><span>nadf_assn</span></a><span> </span><span class="free"><span>dflt</span></span><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span class="main"><span>,</span></span><span class="tfree"><span>'v</span></span><span class="main"><span>)</span></span><a class="entity_ref" href="Intf_Dfun.html#Intf_Dfun.i_dfun|type"><span>i_dfun</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  
</span><span class="keyword1"><span class="command"><span>context</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>notes</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.fcomp_norm_unfold|attribute"><span class="operator"><span>fcomp_norm_unfold</span></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nadf_assn_def|fact"><span>nadf_assn_def</span></a><span class="main"><span>[</span></span><span class="operator"><span>symmetric</span></span><span class="main"><span>]</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'v</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'vi</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow.html#LLVM_Shallow.llvm_rep|class"><span>llvm_rep</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.assn|type"><span>assn</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>dflt</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'v</span></span><span>"</span></span></span><span>
  </span><span class="comment1"><span>(* assumes PURE: "CONSTRAINT is_pure A" *)</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

      
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Nat_Array_Dfun.op_nadf_empty.itype|fact"><span class="entity_def" id="Nat_Array_Dfun.op_nadf_empty.pat|fact"><span class="entity_def" id="Nat_Array_Dfun.op_nadf_empty.itype|thm"><span class="entity_def" id="Nat_Array_Dfun.op_nadf_empty.pat|thm"><span>sepref_register</span></span></span></span></span></span></span><span> op_nadf_empty</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.op_nadf_empty|const"><span>op_nadf_empty</span></a><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_More_Word_Lemmas.html#LLVM_More_Word_Lemmas.len2|class"><span>len2</span></a><span class="main"><span>)</span></span><span> </span><span class="free"><span>dflt</span></span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="tfree"><span>'k</span></span><span class="main"><span>,</span></span><span class="tfree"><span>'v</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Intf_Dfun.html#Intf_Dfun.i_dfun|type"><span>i_dfun</span></a><span>"</span></span></span><span> 


  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Nat_Array_Dfun.nat_map_empty_hnr|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_empty_hnr|thm"><span>nat_map_empty_hnr</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.sepref_fr_rules|attribute"><span class="operator"><span>sepref_fr_rules</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.GEN_ALGO|const"><span>GEN_ALGO</span></a><span> </span><span class="free"><span>dflt</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.is_init|const"><span>is_init</span></a><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span>
    </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry0|const"><span>uncurry0</span></a><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_empty_impl|const"><span>nat_map_empty_impl</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry0|const"><span>uncurry0</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>Refine_Basic.RETURN</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.op_nadf_empty|const"><span>op_nadf_empty</span></a><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>dflt</span></span><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefcptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>5</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="keyword1"><span>LENGTH</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_More_Word_Lemmas.html#LLVM_More_Word_Lemmas.len2|class"><span>len2</span></a><span class="main"><span>)</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefcptnd|const"><span>]<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.unit_assn|const"><span>unit_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefcptnd|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nadf_assn&apos;|const"><span>nadf_assn'</span></a><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>dflt</span></span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_empty_impl.refine|fact"><span>nat_map_empty_impl.refine</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.FCOMP|attribute"><span class="operator"><span>FCOMP</span></span></a><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_empty_param2|fact"><span>nat_map_empty_param2</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.FCOMP|attribute"><span class="operator"><span>FCOMP</span></span></a><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_empty_refine|fact"><span>nat_map_empty_refine</span></a><span class="main"><span>]</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.fast|method"><span class="operator"><span>fast</span></span></a><span>
    
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Nat_Array_Dfun.nat_map_lookup_hnr|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_lookup_hnr|thm"><span>nat_map_lookup_hnr</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.sepref_fr_rules|attribute"><span class="operator"><span>sepref_fr_rules</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.uncurry|const"><span>uncurry</span></a><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_lookup_impl|const"><span>nat_map_lookup_impl</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.uncurry|const"><span>uncurry</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>Refine_Basic.RETURN</span></a><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>∘∘</span></a></span><span> </span><a class="entity_ref" href="Intf_Dfun.html#Intf_Dfun.op_dfun_lookup|const"><span>op_dfun_lookup</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nadf_assn|const"><span>nadf_assn</span></a><span> </span><span class="free"><span>dflt</span></span><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.snat_assn|const"><span>snat_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefttnd|const"><span>→<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.hfref_indep_vassn_tagI|fact"><span>hfref_indep_vassn_tagI</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_lookup_impl.refine|fact"><span>nat_map_lookup_impl.refine</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.FCOMP|attribute"><span class="operator"><span>FCOMP</span></span></a><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_lookup_param2|fact"><span>nat_map_lookup_param2</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.FCOMP|attribute"><span class="operator"><span>FCOMP</span></span></a><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_lookup_refine|fact"><span>nat_map_lookup_refine</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="free"><span>dflt</span></span></span><span> </span><span class="quoted"><span class="free"><span>A</span></span></span><span class="main"><span>]</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.GEN_ALGO_is_init_pure|fact"><span>GEN_ALGO_is_init_pure</span></a><span class="main"><span>)</span></span><span>
    
  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_hnr|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_update_hnr|thm"><span>nat_map_update_hnr</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.sepref_fr_rules|attribute"><span class="operator"><span>sepref_fr_rules</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry2|const"><span>uncurry2</span></a><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_update_impl|const"><span>nat_map_update_impl</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Misc.html#Sepref_Misc.uncurry2|const"><span>uncurry2</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>Refine_Basic.RETURN</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp3|const"><span>ooo</span></a></span><span> </span><a class="entity_ref" href="Intf_Dfun.html#Intf_Dfun.op_dfun_upd|const"><span>op_dfun_upd</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefcptnd|const"><span>[</span></a></span><span class="main"><span>λ</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="bound"><span>f</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="keyword1"><span>LENGTH</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_More_Word_Lemmas.html#LLVM_More_Word_Lemmas.len2|class"><span>len2</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_DS_Arith.html#LLVM_DS_Arith.max_snat|const"><span>max_snat</span></a><span> </span><span class="keyword1"><span>LENGTH</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>)</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefcptnd|const"><span>]<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> 
      </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nadf_assn&apos;|const"><span>nadf_assn'</span></a><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'l</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>dflt</span></span><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfdrop|const"><span><span class="hidden">⇧</span><sup>d</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.snat_assn|const"><span>snat_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><span class="free"><span>A</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefcptnd|const"><span>→</span></a></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nadf_assn|const"><span>nadf_assn</span></a><span> </span><span class="free"><span>dflt</span></span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span>    
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.hfref_indep_vassn_tagI|fact"><span>hfref_indep_vassn_tagI</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_update_impl.refine|fact"><span>nat_map_update_impl.refine</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.FCOMP|attribute"><span class="operator"><span>FCOMP</span></span></a><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_update_param2|fact"><span>nat_map_update_param2</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.FCOMP|attribute"><span class="operator"><span>FCOMP</span></span></a><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_update_refine|fact"><span>nat_map_update_refine</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="free"><span>dflt</span></span></span><span> </span><span class="quoted"><span class="free"><span>A</span></span></span><span class="main"><span>]</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.GEN_ALGO_is_init_pure|fact"><span>GEN_ALGO_is_init_pure</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Nat_Array_Dfun.nat_map_reset_hnr|fact"><span class="entity_def" id="Nat_Array_Dfun.nat_map_reset_hnr|thm"><span>nat_map_reset_hnr</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Translate.html#Sepref_Translate.sepref_fr_rules|attribute"><span class="operator"><span>sepref_fr_rules</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.uncurry|const"><span>uncurry</span></a><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_reset_impl|const"><span>nat_map_reset_impl</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.uncurry|const"><span>uncurry</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../AFP/Refine_Monadic/Refine_Basic.html#Refine_Basic.RETURN|const"><span>Refine_Basic.RETURN</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../AFP/Automatic_Refinement/Misc.html#Misc.comp2|const"><span>oo</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Id_Op.html#Sepref_Id_Op.PR_CONST|const"><span>PR_CONST</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Intf_Dfun.html#Intf_Dfun.op_dfun_reset|const"><span>op_dfun_reset</span></a><span> </span><span class="free"><span>dflt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nadf_assn|const"><span>nadf_assn</span></a><span> </span><span class="free"><span>dflt</span></span><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfdrop|const"><span><span class="hidden">⇧</span><sup>d</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfprod|const"><span>*<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_HOL_Bindings.html#Sepref_HOL_Bindings.snat_assn|const"><span>snat_assn</span></a><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfkeep|const"><span><span class="hidden">⇧</span><sup>k</sup></span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.hfrefttnd|const"><span>→<span class="hidden">⇩</span><sub>a</sub></span></a></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nadf_assn|const"><span>nadf_assn</span></a><span> </span><span class="free"><span>dflt</span></span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span>    
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.hfref_indep_vassn_tagI|fact"><span>hfref_indep_vassn_tagI</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_reset_impl.refine|fact"><span>nat_map_reset_impl.refine</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.FCOMP|attribute"><span class="operator"><span>FCOMP</span></span></a><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_reset_param2|fact"><span>nat_map_reset_param2</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Rules.html#Sepref_Rules.FCOMP|attribute"><span class="operator"><span>FCOMP</span></span></a><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_reset_refine|fact"><span>nat_map_reset_refine</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../../AFP/Automatic_Refinement/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="free"><span>dflt</span></span></span><span> </span><span class="quoted"><span class="free"><span>A</span></span></span><span class="main"><span>]</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.GEN_ALGO_is_init_pure|fact"><span>GEN_ALGO_is_init_pure</span></a><span class="main"><span>)</span></span><span>
    
    
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>        

</span><span class="keyword1"><span class="command"><span>synth_definition</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Nat_Array_Dfun.nadf_free|const"><span>nadf_free</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Codegen_Preproc.html#LLVM_Codegen_Preproc.llvm_code|attribute"><span class="operator"><span>llvm_code</span></span></a><span class="main"><span>]</span></span><span> </span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="main"><span>[</span></span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Frame.html#Sepref_Frame.sepref_frame_free_rules|attribute"><span class="operator"><span>sepref_frame_free_rules</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Basic.html#Sepref_Basic.MK_FREE|const"><span>MK_FREE</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nadf_assn|const"><span>nadf_assn</span></a><span> </span><span class="free"><span>dflt</span></span><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Isabelle_LLVM/HOL-Library.Rewrite.html#Rewrite.rewrite_HOLE|const"><span>⌑</span></a></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nadf_assn_def|fact"><span>nadf_assn_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="Nat_Array_Dfun.nadf_free.refine|fact"><span class="entity_def" id="Nat_Array_Dfun.nadf_free_def|fact"><span class="entity_def" id="Nat_Array_Dfun.nadf_free.refine_raw|fact"><span class="entity_def" id="Nat_Array_Dfun.nadf_free.refine|thm"><span class="entity_def" id="Nat_Array_Dfun.nadf_free_def|thm"><span class="entity_def" id="Nat_Array_Dfun.nadf_free.refine_raw|thm"><span class="entity_def" id="Nat_Array_Dfun.nadf_free_def_raw|axiom"><span>by</span></span></span></span></span></span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Frame.html#Sepref_Frame.free_thms|fact"><span>free_thms</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Sepref_Frame.html#Sepref_Frame.sepref_frame_free_rules|fact"><span class="dynamic"><span class="dynamic"><span>sepref_frame_free_rules</span></span></span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>


</span><span class="keyword1"><span class="command"><span>export_llvm</span></span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_empty_impl|const"><span>nat_map_empty_impl</span></a><span> </span><span class="main"><span>::</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>64</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/HOL-Library.Word.html#Word.word|type"><span>word</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod|type"><span>×</span></a></span><span> </span><span class="numeral"><span>8</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/HOL-Library.Word.html#Word.word|type"><span>word</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow.html#LLVM_Shallow.ptr|type"><span>ptr</span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Simple_Memory.html#Simple_Memory.llM|type"><span>llM</span></a><span>"</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_lookup_impl|const"><span>nat_map_lookup_impl</span></a><span> </span><span class="main"><span>::</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>64</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/HOL-Library.Word.html#Word.word|type"><span>word</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod|type"><span>×</span></a></span><span> </span><span class="numeral"><span>8</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/HOL-Library.Word.html#Word.word|type"><span>word</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow.html#LLVM_Shallow.ptr|type"><span>ptr</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>_</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Simple_Memory.html#Simple_Memory.llM|type"><span>llM</span></a><span>"</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_update_impl|const"><span>nat_map_update_impl</span></a><span> </span><span class="main"><span>::</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>64</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/HOL-Library.Word.html#Word.word|type"><span>word</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod|type"><span>×</span></a></span><span> </span><span class="numeral"><span>8</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/HOL-Library.Word.html#Word.word|type"><span>word</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow.html#LLVM_Shallow.ptr|type"><span>ptr</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>_</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Simple_Memory.html#Simple_Memory.llM|type"><span>llM</span></a><span>"</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Nat_Array_Dfun.html#Nat_Array_Dfun.nat_map_reset_impl|const"><span>nat_map_reset_impl</span></a><span> </span><span class="main"><span>::</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>64</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/HOL-Library.Word.html#Word.word|type"><span>word</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod|type"><span>×</span></a></span><span> </span><span class="numeral"><span>8</span></span><span> </span><a class="entity_ref" href="../../AFP/Refine_Monadic/HOL-Library.Word.html#Word.word|type"><span>word</span></a><span> </span><a class="entity_ref" href="../Isabelle_LLVM/LLVM_Shallow.html#LLVM_Shallow.ptr|type"><span>ptr</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>_</span></span><span> </span><a class="entity_ref" href="../Isabelle_LLVM/Simple_Memory.html#Simple_Memory.llM|type"><span>llM</span></a><span>"</span></span></span><span>


</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span></pre>
</body>

</html>